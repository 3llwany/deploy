"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[523],{71523:(re,Q,p)=>{p.r(Q),p.d(Q,{OrgManagementModule:()=>Jo});var n=p(36895),u=p(80458),v=p(30671),S=p(35478);function j(a,l){let i,t=[],o=[];for(;o.length<a.core_Org_Structure_Org.length;)T(a.core_Org_Structure_Org,o,t);return i=[{label:"structure",type:"org",styleClass:"structure-node",expanded:!0,expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder",data:{parentId:null,org:null,orgType:null,numEmp:0,structure:{id:null,ar_Name:a.ar_Name,en_Name:a.en_Name}},children:[]}],o.map(r=>{let m={label:`${r.core_Org?.code} - ${(0,S._)(r.core_Org?.ar_Name,r.core_Org?.en_Name)}`,type:"org",styleClass:"org-node",expanded:!1,data:{parentId:r.parenT_ID,org:r.core_Org,orgType:{id:r.core_Org_TYPE?.id,ar_Name:r.core_Org_TYPE?.ar_Name,en_Name:r.core_Org_TYPE?.en_Name},structure:null,structureId:l,numEmp:r.numEmp},children:[]};r.parenT_ID?U(m,i[0].children):i[0].children.push(m)}),i}function T(a,l,t){a.forEach(o=>{(null==o.parenT_ID||t.includes(o.parenT_ID))&&!t.includes(o.orG_ID)&&(l.push(o),t.push(o.orG_ID))})}function U(a,l){l.map(t=>{t.data.org?.id!=a.data.parentId||t.children.push(a)}),l.map(t=>{U(a,t.children)})}function H(a){let l=[{label:a[0].code,type:"job-title",styleClass:"job-title-node",expanded:!1,data:a[0],children:[]}];return K(l[0]),l}function K(a){a.data.chiledJobTitles?.map(l=>{let t={label:l.code,type:"job-title",styleClass:"job-title-node",expanded:!1,data:l,children:[]};a.children.push(t),K(t)})}function O(a,l){let t=a.findIndex(i=>i.id==l),o=[];return t>=0&&(o=[{label:(0,S._)(a[t]?.ar_Name,a[t]?.en_Name),type:"resources",styleClass:a[t].isSolidEmp?"":"dashed-border",expanded:!1,expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder",data:a[t],children:[]}],a.filter(i=>i.id!=l).map(i=>{let r={label:(0,S._)(i.ar_Name,i.en_Name),type:"resources",styleClass:i.isSolidEmp?"":"dashed-border",expanded:!1,expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder",data:i,children:[]};i.parentID==l?o[0].children.push(r):i.id!=l&&_(r,o[0].children)})),o}function _(a,l){l.map(t=>{t.data.id!=a.data.parentID||t.children.push(a)}),l.map(t=>{_(a,t.children)})}var b=p(15602),J=p(95751),e=p(94650),W=p(56808),q=p(93410),F=p(46896),ee=p(60544),te=p(91373),D=p(73546),E=p(86405),x=p(49274);let G=(()=>{class a extends J.U{constructor(t){super(),this.orgStructureService=t,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","froM_DATE","tO_DATE","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.dataSource=new v.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.orgStructureService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==b.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by(function M(a){return a.map(l=>({...l,froM_DATE:S.M.mapDate(l.froM_DATE),tO_DATE:S.M.mapDate(l.tO_DATE)}))}(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount}else this.errorList(r?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.orgStructureService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-index"]],features:[e.qOj],decls:10,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","orgStructure",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3),e.qZA(),e.TgZ(6,"app-material-table",4),e.NdJ("onChangePage",function(r){return o.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return o.onDelete(r)}),e.qZA()()()(),e.TgZ(7,"side-helping-menu",5),e.ALo(8,"translate"),e._UZ(9,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",o.globalFunctions),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("exportService",o.orgStructureService)("actions",o.rowFunctions),e.xp6(1),e.s9C("title",e.lcZ(8,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[q.I,F.T,ee.c,te.b,D.a8,D.n5,E.Ro,x.X$]}),a})();var g=p(24006),L=p(78937),N=p(70137),Y=p(25273),V=p(61064),se=p(52682),be=p(56500),oe=p(57566),ne=p(68506),k=p(10805),ae=p(57772),Ce=p(4159),ye=p.n(Ce),Te=p(53583);function le(a,l,t){const o=a.el.nativeElement,i=document.getElementById(l),r=i.offsetWidth+i.scrollWidth;ye()(o,{width:r,height:i.offsetWidth}).then(m=>{const y=m.toDataURL("image/png");if("image"==t){const ce=document.createElement("a");ce.href=y,ce.download=l+".jpeg",ce.click()}else if("pdf"==t){var fe=new Te.ZP("l","mm",[1200,"companyChart"==l?120:400]);const ce=fe.internal.pageSize.getWidth(),Lo=fe.internal.pageSize.getHeight();fe.addImage(y,"PNG",20,20,ce-20,Lo-20),fe.save(l+".pdf")}})}var I=p(65938),ve=p(8675),w=p(74513),de=p(77304),z=p(4859),me=p(26941);let xe=(()=>{class a extends J.U{constructor(t,o,i,r){super(),this.orgStructureService=t,this.organizationsService=o,this.dialogRef=i,this.data=r,this.submitted=!1,this.organizationList=[],this.viewName=w.S.organizations}ngOnInit(){this.form=this.fb.group({org_Structure_ID:[null],parenT_ID:[null],orG_TYPE_ID:[null,[g.kI.required]],orG_ID:[null,[g.kI.required]]}),this.getFormValues()}onChangeBusinessAndCompanyId(){this.formCtrls.org_Structure_ID.value>0&&this.checkNoBusinessOrCompany()&&this.getAllUnAssignedOrganizationsByStructureId()}getFormValues(){this.form.patchValue(this.data),setTimeout(()=>{this.form.value.parenT_ID||(this.formCtrls.orG_TYPE_ID.disable(),this.formCtrls.orG_TYPE_ID.setValue(1))},100)}get formCtrls(){return this.form.controls}submit(){this.submitted=!0,this.form.valid&&this.create({core_Org_Structure_Org:{org_Structure_ID:this.formCtrls.org_Structure_ID.value,orG_TYPE_ID:this.formCtrls.orG_TYPE_ID.value,orG_ID:this.formCtrls.orG_ID.value,parenT_ID:this.formCtrls.parenT_ID.value}})}create(t){this.showLoading(),this.orgStructureService.createNode(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.dialogRef.close(!0)):this.errorList(o?.message?.messages),this.hideLoading()})}getAllUnAssignedOrganizationsByStructureId(){this.showLoading(),this.organizationsService.GetAllUnAssignedByStructureId(this.formCtrls.org_Structure_ID.value).pipe(this.cancelRequest()).subscribe(t=>{(t.message.messageType=b.u.Success)?this.organizationList=t.data:this.errorList(t?.message?.messages),this.hideLoading()})}createDialog(t){this.dialogsService.addFromDropdownDialog(ve.w,t).afterClosed().subscribe(o=>{this.getAllUnAssignedOrganizationsByStructureId()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._),e.Y36(de.z),e.Y36(I.so),e.Y36(I.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-org-structure-node"]],features:[e.qOj],decls:18,vars:14,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","orgStructureNode",1,"d-inline-block","mtop-5","mbottom-10"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"clearfix"],["dialogContainer",""],[1,"row"],[1,"col-12","mtop-5"],[3,"formGroup"],[1,"col-md-6","col-12"],[3,"control","submitted","disableCompany","appendTo","filter"],["label","organization","optionDisabled","assignStr",3,"control","submitted","List","appendTo","filter","viewName","createNewDialog"],["align","end"],[3,"id","onClick"]],template:function(t,o){if(1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0),e._UZ(2,"page-title",1),e.TgZ(3,"button",2),e._UZ(4,"i",3),e.qZA(),e._UZ(5,"div",4),e.qZA(),e.TgZ(6,"mat-dialog-content",null,5)(8,"div",6)(9,"div",7)(10,"form",8)(11,"div",6)(12,"div",9),e._UZ(13,"app-org-types-dropdown",10),e.qZA(),e.TgZ(14,"div",9)(15,"app-prime-dropdown",11),e.NdJ("createNewDialog",function(r){return o.createDialog(r)}),e.qZA()()()()()()(),e.TgZ(16,"mat-dialog-actions",12)(17,"submit-btn",13),e.NdJ("onClick",function(){return o.submit()}),e.qZA()()),2&t){const i=e.MAs(7);e.xp6(3),e.Q6J("mat-dialog-close",!0),e.xp6(7),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.orG_TYPE_ID)("submitted",o.submitted)("disableCompany",!!o.formCtrls.parenT_ID.value)("appendTo",i)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.orG_ID)("submitted",o.submitted)("List",o.organizationList)("appendTo",i)("filter",!0)("viewName",o.viewName),e.xp6(2),e.Q6J("id",0)}},dependencies:[oe.p,F.T,z.lW,I.ZT,I.uh,I.xY,I.H8,E.Ro,ne.t,me.q,g._Y,g.JL,g.sg],styles:[".mat-dialog-container{padding:24px}@media (min-width: 320px) and (max-width: 991px){  .page-title{font-size:13px!important}}"]}),a})();var Ie=p(52614),ge=p(20408),De=p(91365),_e=p(25054);function Se(a,l){if(1&a&&(e._UZ(0,"p-image",14),e.ALo(1,"translate")),2&a){const t=e.oxw(2);e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",t.fileService.preview(t.employeeData.img))}}function Oe(a,l){1&a&&(e.TgZ(0,"div",15),e._UZ(1,"i",16),e.qZA())}function Ze(a,l){if(1&a&&(e.TgZ(0,"p"),e._UZ(1,"i",17),e.TgZ(2,"span",18),e._uU(3),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.contact)}}function Ae(a,l){if(1&a&&(e.TgZ(0,"p"),e._UZ(1,"i",19),e.TgZ(2,"span",18),e._uU(3),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.email)}}function Je(a,l){1&a&&(e.TgZ(0,"span",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"active")," "))}function Le(a,l){1&a&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"notActive")," "))}function we(a,l){if(1&a&&(e.ynx(0),e.TgZ(1,"p"),e.YNc(2,Je,3,3,"span",20),e.YNc(3,Le,3,3,"ng-template",null,21,e.W1O),e.qZA(),e.TgZ(5,"p",22),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"p",23)(9,"span",24),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.qZA()(),e.TgZ(14,"p",23)(15,"span",24),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"span"),e._uU(19),e.qZA()(),e.BQk()),2&a){const t=e.MAs(4),o=e.oxw(2);e.xp6(2),e.Q6J("ngIf",o.employeeData.isActive)("ngIfElse",t),e.xp6(4),e.hij(" ",e.lcZ(7,7,"noOfEmployeeReporting")," "),e.xp6(4),e.hij(" ",e.lcZ(11,9,"asSolidManager")," : "),e.xp6(3),e.hij(" ",null==o.employeeData?null:o.employeeData.manageSolidEmpNo,""),e.xp6(3),e.hij(" ",e.lcZ(17,11,"asDottedManager")," : "),e.xp6(3),e.hij(" ",null==o.employeeData?null:o.employeeData.manageDotesEmpNo,"")}}function Ee(a,l){if(1&a&&(e.ynx(0),e.TgZ(1,"div",6)(2,"div",7),e.YNc(3,Se,2,4,"p-image",8),e.YNc(4,Oe,2,0,"ng-template",null,9,e.W1O),e.qZA(),e.TgZ(6,"div",10)(7,"p",11),e._uU(8),e.qZA(),e.YNc(9,Ze,4,1,"p",5),e.YNc(10,Ae,4,1,"p",5),e.qZA()(),e.TgZ(11,"div",12)(12,"p",13),e._uU(13),e.ALo(14,"titlecase"),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"p"),e._uU(17),e.qZA(),e.TgZ(18,"p"),e._uU(19),e.qZA(),e.YNc(20,we,20,13,"ng-container",5),e.qZA(),e.BQk()),2&a){const t=e.MAs(5),o=e.oxw();e.xp6(3),e.Q6J("ngIf",o.employeeData.img&&""!=o.employeeData.img)("ngIfElse",t),e.xp6(5),e.hij(" ",o.msgTranslate(o.employeeData.ar_Name,o.employeeData.en_Name)," "),e.xp6(1),e.Q6J("ngIf",o.employeeData.contact),e.xp6(1),e.Q6J("ngIf",o.employeeData.email),e.xp6(3),e.hij(" ",e.lcZ(14,9,e.lcZ(15,11,"employment"))," "),e.xp6(4),e.hij(" ",o.employeeData.jobTitleName," "),e.xp6(2),e.hij(" ",o.employeeData.organization," "),e.xp6(1),e.Q6J("ngIf",!o.showMainData)}}function Ne(a,l){1&a&&(e._UZ(0,"span",29),e.TgZ(1,"div",30),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeData")," "))}function Pe(a,l){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",27),e.YNc(2,Ne,4,3,"ng-template",28),e.qZA(),e.BQk())}function Me(a,l){1&a&&(e.ynx(0),e._UZ(1,"app-structure-employee-card-skeleton"),e.BQk())}let ie=(()=>{class a extends J.U{constructor(t,o,i){super(),this.employeesService=t,this.dialogRef=o,this.data=i,this.loaded=!1,this.showMainData=!1,i&&(this.employeeId=i.employeeId,this.showMainData=i.showMainData??!1)}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.employeeId>0&&this.getEmployeeData()}getEmployeeData(){this.employeesService.getEmployeeCardById(this.employeeId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(t.data.length>0&&(this.employeeData=(0,Ie.A)(t.data)[0]),this.loaded=!0):this.errorList(t?.message?.messages)})}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ge.M),e.Y36(I.so),e.Y36(I.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-employee-card"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},features:[e.qOj],decls:11,vars:11,consts:[[1,"title"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"employee-card"],[4,"ngIf"],[1,"row"],[1,"col-md-4","col-12","img-container"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"col-md-8","col-12","text-break"],[1,"mtop-5"],[1,"mtop-20"],[1,"mbottom-14",2,"font-weight","bold"],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"pi","pi-phone"],[1,"mx-1"],[1,"fa","fa-envelope"],["class","badge bg-light-success",4,"ngIf","ngIfElse"],["no",""],[1,"mbottom-14","mtop-14",2,"font-weight","bold"],[1,"font-size-14"],[1,"d-inline-block"],[1,"badge","bg-light-success"],[1,"badge","bg-light-danger"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",2),e._UZ(6,"i",3),e.qZA()(),e.TgZ(7,"mat-dialog-content",4),e.YNc(8,Ee,21,13,"ng-container",5),e.YNc(9,Pe,3,0,"ng-container",5),e.YNc(10,Me,2,0,"ng-container",5),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,7,e.lcZ(4,9,"employeeDetails"))," "),e.xp6(3),e.ekj("ar",o.languageService.isArabic),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.Q6J("ngIf",o.employeeData&&o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&!o.loaded))},dependencies:[n.O5,De.v,z.lW,I.ZT,I.xY,k.jx,_e.E,ae.V,n.rS,x.X$],styles:[".title[_ngcontent-%COMP%]{background-color:#0000000a;margin:-24px;padding:24px 18px}.title[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{display:inline-block;margin-bottom:0;font-size:16px}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:-10px;margin-right:-15px}.title[_ngcontent-%COMP%]   button.ar[_ngcontent-%COMP%]{margin-left:-15px!important}  .mat-dialog-content.employee-card{margin-top:40px}  .mat-dialog-content.employee-card p{margin-bottom:.5rem;font-size:14px}"]}),a})(),ue=(()=>{class a{constructor(){}static groupBy(t,o){const i=t.reduce((r,m)=>(r[m[o]]?r[m[o]].push(m):r[m[o]]=[m],r),{});return Object.keys(i).map(r=>({key:r,List:i[r]}))}groupByPartOfProperty(t,o,i){const r=t.reduce((m,y)=>{let A=y[o].trim().slice(0,i).toUpperCase();return m[A]?m[A].push(y):m[A]=[y],m},{});return Object.keys(r).map(m=>({key:m,List:r[m]}))}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var he=p(31534),Z=p(37084);function Ue(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"p",16),e.NdJ("click",function(i){const m=e.CHM(t).$implicit,y=e.oxw(3);return e.KtG(y.openEmployeeCardDialog(i.target,m.id))}),e.TgZ(1,"span",17),e._UZ(2,"i",18),e.qZA(),e.TgZ(3,"span",19),e._uU(4),e.qZA()()}if(2&a){const t=l.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function c(a,l){if(1&a&&(e.ynx(0),e.TgZ(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14),e.YNc(4,Ue,5,3,"p",15),e.qZA(),e.BQk()),2&a){const t=l.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function f(a,l){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",11),e.NdJ("keyup",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,c,5,2,"ng-container",12),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function s(a,l){1&a&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function d(a,l){1&a&&(e._UZ(0,"span",22),e.TgZ(1,"div",23),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInOrg")," "))}function h(a,l){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",20),e.YNc(2,d,4,3,"ng-template",21),e.qZA(),e.BQk())}let C=(()=>{class a extends J.U{constructor(t,o,i,r,m){super(),this.employeesService=t,this.groupByService=o,this.dialogRef=i,this.data=r,this.dialog=m,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=r.expandedIndex,this.nodeData=r.nodeData}ngOnInit(){this.checkNoBusinessOrCompany()&&this.nodeData.structureId>0&&this.nodeData.org.id>0&&this.getEmployeesByOrgId();const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}getEmployeesByOrgId(){this.employeesService.getAllByStructureAndOrgId(this.nodeData.structureId,this.nodeData.org.id).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(this.employees=t.data,this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0):this.errorList(t?.message?.messages)})}sortAndGroupEmployees(){this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let r=this.getHeaderElement(t).getBoundingClientRect(),y={};return y.left=r.left+r.width/2+350<=window.innerWidth?`${r.left+r.width/2}px`:r.left-175-10>=0?r.left-175-10+"px":null,this.dialog.open(ie,{data:{employeeId:o},position:y,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(A=>{})}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ge.M),e.Y36(ue),e.Y36(I.so),e.Y36(I.WI),e.Y36(I.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-details-employees"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},features:[e.qOj],decls:20,vars:11,consts:[[1,"details-dialog-title"],[1,"mb-2"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"org-name"],[1,"details-dialog","company"],["multi",""],[3,"expanded"],[1,"expantion-body"],[4,"ngIf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[4,"ngFor","ngForOf"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"h6",2),e._uU(4),e.qZA(),e.TgZ(5,"button",3),e._UZ(6,"i",4),e.qZA()(),e.TgZ(7,"p",5),e._uU(8),e.qZA()(),e.TgZ(9,"mat-dialog-content",6)(10,"mat-accordion",7)(11,"mat-expansion-panel",8)(12,"mat-expansion-panel-header")(13,"mat-panel-title"),e._uU(14),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9),e.YNc(17,f,4,4,"ng-container",10),e.YNc(18,s,2,0,"ng-container",10),e.YNc(19,h,3,0,"ng-container",10),e.qZA()()()()),2&t&&(e.xp6(4),e.AsE(" ",o.nodeData.org.code," - ",o.msgTranslate(o.nodeData.org.ar_Name,o.nodeData.org.en_Name)," "),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.hij(" ",o.msgTranslate(o.nodeData.orgType.ar_Name,o.nodeData.orgType.en_Name)," "),e.xp6(3),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(15,9,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded))},dependencies:[n.sg,n.O5,he.b,z.lW,I.ZT,I.xY,Z.pp,Z.ib,Z.yz,Z.yK,E.Ro,k.jx,ae.V,x.X$]}),a})();var P=p(44132),$=p(40445),pe=p(3848),je=p(10266),We=p(12453),Fe=p(86467),Be=p(44850);function Ve(a,l){if(1&a&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=l.$implicit,o=e.oxw(2);let i;e.xp6(1),e.HOy(" ",o.msgTranslate(null==t.core_Org?null:t.core_Org.ar_Name,null==t.core_Org?null:t.core_Org.en_Name)," ( ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," ",e.lcZ(2,4,"of")," ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ) ")}}function Xe(a,l){if(1&a&&(e.TgZ(0,"div",14),e.YNc(1,Ve,3,6,"p",15),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.nodeData.core_Org_Job_Title)}}function et(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"p",20),e.NdJ("click",function(i){const m=e.CHM(t).$implicit,y=e.oxw(3);return e.KtG(y.openEmployeeCardDialog(i.target,m.id))}),e.TgZ(1,"span",21),e._UZ(2,"i",22),e.qZA(),e.TgZ(3,"span",23),e._uU(4),e.qZA()()}if(2&a){const t=l.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function tt(a,l){if(1&a&&(e.ynx(0),e.TgZ(1,"div",17),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e.YNc(4,et,5,3,"p",19),e.qZA(),e.BQk()),2&a){const t=l.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function ot(a,l){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",16),e.NdJ("keyup",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,tt,5,2,"ng-container",15),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function nt(a,l){1&a&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function at(a,l){1&a&&(e._UZ(0,"span",26),e.TgZ(1,"div",27),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInJob")," "))}function it(a,l){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",24),e.YNc(2,at,4,3,"ng-template",25),e.qZA(),e.BQk())}let rt=(()=>{class a extends J.U{constructor(t,o,i,r){super(),this.groupByService=t,this.dialogRef=o,this.data=i,this.dialog=r,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=i.expandedIndex,this.nodeData=i.nodeData,this.employees=this.nodeData.core_Person_Instance_Job_Title.map(m=>m.core_Person_Instance?.core_Person),this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}sortAndGroupEmployees(){this.employees=this.employees.filter(t=>{if(t)return t}),this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let r=this.getHeaderElement(t).getBoundingClientRect(),y={};return y.left=r.left+r.width/2+350<=window.innerWidth?`${r.left+r.width/2}px`:r.left-175-10>=0?r.left-175-10+"px":null,this.dialog.open(ie,{data:{employeeId:o},position:y,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(A=>{})}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ue),e.Y36(I.so),e.Y36(I.WI),e.Y36(I.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-job-title-details-dialog"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},features:[e.qOj],decls:51,vars:32,consts:[[1,"details-dialog-title"],[1,"mb-2"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"type-name","info"],[1,"clearfix"],[1,"details-dialog","jobtitle"],["multi",""],[3,"expanded"],[1,"expantion-body"],[1,"table-container"],["class","no-employees",4,"ngIf"],[1,"expantion-body","employee-body"],[4,"ngIf"],[1,"no-employees"],[4,"ngFor","ngForOf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"button",2),e._UZ(4,"i",3),e.qZA(),e.TgZ(5,"h6",4),e._uU(6),e.qZA()(),e._UZ(7,"p",5),e.qZA(),e.TgZ(8,"mat-dialog-content",6)(9,"mat-accordion",7)(10,"mat-expansion-panel",8)(11,"mat-expansion-panel-header")(12,"mat-panel-title"),e._uU(13),e.ALo(14,"translate"),e.qZA()(),e.TgZ(15,"div",9)(16,"div",10)(17,"table")(18,"tbody")(19,"tr")(20,"th"),e._uU(21),e.ALo(22,"titlecase"),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.qZA()(),e.TgZ(26,"tr")(27,"th"),e._uU(28),e.ALo(29,"titlecase"),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"td"),e._uU(32),e.qZA()(),e.TgZ(33,"tr")(34,"th"),e._uU(35),e.ALo(36,"titlecase"),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"td"),e._uU(39),e.qZA()()()()(),e._UZ(40,"mat-divider"),e.YNc(41,Xe,2,1,"div",11),e.qZA()(),e.TgZ(42,"mat-expansion-panel",8)(43,"mat-expansion-panel-header")(44,"mat-panel-title"),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"div",12),e.YNc(48,ot,4,4,"ng-container",13),e.YNc(49,nt,2,0,"ng-container",13),e.YNc(50,it,3,0,"ng-container",13),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(4),e.Q6J("expanded",0==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(14,16,"details")),e.xp6(8),e.Oqu(e.lcZ(22,18,e.lcZ(23,20,"code"))),e.xp6(4),e.Oqu(o.nodeData.code),e.xp6(3),e.Oqu(e.lcZ(29,22,e.lcZ(30,24,"jobTitle"))),e.xp6(4),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(3),e.Oqu(e.lcZ(36,26,e.lcZ(37,28,"jobFamily"))),e.xp6(4),e.hij(" ",o.msgTranslate(null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.ar_Name,null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",o.nodeData.core_Org_Job_Title.length>0),e.xp6(1),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(46,30,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded))},dependencies:[n.sg,n.O5,he.b,z.lW,Be.d,I.ZT,I.xY,Z.pp,Z.ib,Z.yz,Z.yK,E.Ro,k.jx,ae.V,n.rS,x.X$],styles:[".mat-dialog-content.details-dialog.jobtitle .mat-expansion-panel-body{padding:0}  .mat-dialog-content.details-dialog.jobtitle .table-container{padding:0 24px 16px}  .mat-dialog-content.details-dialog.jobtitle .no-employees,   .mat-dialog-content.details-dialog.jobtitle .employee-body{padding:16px 24px 0}"]}),a})();var X=p(26315),Qe=p(18521);let st=(()=>{class a extends Qe.K{constructor(){super()}getJobTitleHierarchy(t){return this.get("OrgManagement/JobTitle/GetAll_Structure",{params:{$filter:`id eq ${t}`,$expand:`${X.db.core_Org_Job_Title}/${X.db.core_Org},${X.db.Core_Person_Instance_Job_Title}.${X.db.Core_Person_Instance}.${X.db.Core_Person},${X.db.Core_Job_Title_Family}`}})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var lt=p(89609),qe=p(70502),pt=p(62160);const ct=["jobTitleChart"];function dt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"app-job-title-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)}}function mt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"app-employee-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getAllEmployeeJobTitles())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.employeeId)("filter",!0)}}function gt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",3)(1,"app-prime-dropdown",14),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)("List",t.employeeJobTitles)}}function _t(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",15)(1,"i",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(13);return e.KtG(i.exportChart(r,"jobTitleChart","image"))}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"i",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(13);return e.KtG(i.exportChart(r,"jobTitleChart","pdf"))}),e.ALo(4,"translate"),e.qZA()()}2&a&&(e.xp6(1),e.s9C("matTooltip",e.lcZ(2,2,"exportAsImage")),e.xp6(2),e.s9C("matTooltip",e.lcZ(4,4,"exportAsPdf")))}function ut(a,l){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",26),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function ht(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",27)(1,"i",28),e.NdJ("click",function(i){e.CHM(t);const r=e.oxw().$implicit,m=e.oxw();return e.KtG(m.openJobTitleDetailsDialog(i.target,r.data,1))}),e.TgZ(2,"span"),e._uU(3),e.qZA()()()}if(2&a){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.data.core_Person_Instance_Job_Title.length," ")}}function ft(a,l){if(1&a&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&a){const t=l.$implicit,o=e.oxw(3);let i;e.xp6(1),e.lnq(" ",o.msgTranslate(null==t.core_Org?null:t.core_Org.ar_Name,null==t.core_Org?null:t.core_Org.en_Name)," ( ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," / ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ) ")}}function bt(a,l){if(1&a&&(e.TgZ(0,"div",29),e.YNc(1,ft,2,3,"p",30),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.data.core_Org_Job_Title)}}function Ct(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",31),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return r.expandNode(i),e.KtG(r.changePositions())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.children.length," ",e.lcZ(2,2,1==t.children.length?"jobTitleBelow":"jobTitlesBelow")," ")}}function yt(a,l){if(1&a){const t=e.EpF();e.YNc(0,ut,6,8,"ng-container",18),e.TgZ(1,"div",19),e.NdJ("click",function(i){const m=e.CHM(t).$implicit,y=e.oxw();return e.KtG(y.openJobTitleDetailsDialog(i.target,m.data,0))}),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"div",20)(5,"p"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",21),e.YNc(8,ht,4,1,"div",22),e.YNc(9,bt,2,1,"div",23),e.YNc(10,Ct,3,4,"div",24),e.qZA()}if(2&a){const t=l.$implicit,o=e.oxw();e.Q6J("ngIf",o.jobTitleOrgChart&&(null==o.jobTitleOrgChart[0]||null==o.jobTitleOrgChart[0].data?null:o.jobTitleOrgChart[0].data.parentJobTitleID)>0&&1==t.data.currentFirstNode),e.xp6(1),e.Q6J("id",t.data.id),e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(1),e.AsE(" ",t.data.code," - ",o.msgTranslate(t.data.ar_Name,t.data.en_Name)," "),e.xp6(3),e.hij(" ",o.msgTranslate(null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.ar_Name,null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",(null==t.data.core_Person_Instance_Job_Title?null:t.data.core_Person_Instance_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.core_Org_Job_Title?null:t.data.core_Org_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}function Tt(a,l){1&a&&e._UZ(0,"app-chart-skeleton",32),2&a&&e.Q6J("width",280)}let vt=(()=>{class a extends J.U{constructor(t,o,i){super(),this.jobTitleChartService=t,this.employeeJobInformationService=o,this.dialog=i,this.loading=!1,this.lastSelectedJobId=0,this.searchTypeList=[],this.employeeJobTitles=[],this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0},this.exportChart=le}ngOnInit(){this.form=this.fb.group({searchTypeId:[null],jobTitleId:[null],employeeId:[null]}),setTimeout(()=>{this.searchTypeList=[{id:1,ar_Name:"\u0627\u0644\u0648\u0638\u0627\u0626\u0641",en_Name:"Job titles"},{id:2,ar_Name:"\u0627\u0644\u0645\u0648\u0638\u0641\u064a\u0646",en_Name:"Employees"}]},100)}onChangeBusinessAndCompanyId(){this.jobTitleOrgChart=null,this.checkNoBusinessOrCompany()&&this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}get formCtrls(){return this.form.controls}getJobTitleOrgChart(t){t>0&&(this.lastSelectedJobId=t,this.jobTitleOrgChart=null,this.loading=!0,this.jobTitleChartService.getJobTitleHierarchy(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?(this.jobTitleOrgChart=H(o.data),this.jobTitleOrgChart[0].data.currentFirstNode=!0,this.changePositions(),this.lastSelectedJobId==t&&(this.loading=!1)):(this.errorList(o?.message?.messages),this.loading=!1)}))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)}onChangeSearchType(){this.formCtrls.jobTitleId.reset(),this.formCtrls.employeeId.reset()}onChangeSearchValue(){this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}upOneLevel(){1==this.formCtrls.searchTypeId.value?this.formCtrls.jobTitleId.setValue(this.jobTitleOrgChart[0].data.parentJobTitleID):2==this.formCtrls.searchTypeId.value&&(this.onChangeSearchType(),this.getJobTitleOrgChart(this.jobTitleOrgChart[0].data.parentJobTitleID))}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}openJobTitleDetailsDialog(t,o,i){let m=this.getHeaderElement(t).getBoundingClientRect(),A={};return A.left=m.left+m.width+10+350<=window.innerWidth?`${m.left+m.width+10}px`:m.left-350-10>=0?m.left-350-10+"px":null,this.dialog.open(rt,{data:{nodeData:o,expandedIndex:i},position:A,width:"350px",maxHeight:"90hv",autoFocus:!1}).afterClosed().subscribe(ze=>{})}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}openEmployeeCardDialog(t,o){let r=this.getHeaderElement(t).getBoundingClientRect(),y={};return y.left=r.left+r.width/2+350<=window.innerWidth?`${r.left+r.width/2}px`:r.left-175-r.width/2+10>=0?r.left-175-r.width/2+10+"px":null,this.dialog.open(ie,{data:{employeeId:o},position:y,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(A=>{})}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}getAllEmployeeJobTitles(){let t=this.formCtrls.employeeId.value;t>0&&(this.showLoading(),this.employeeJobInformationService.getAllCurrentJobsByEmployeeId(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?this.employeeJobTitles=o.data:this.errorList(o?.message?.messages),this.hideLoading()}))}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(st),e.Y36(lt._),e.Y36(I.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-job-title-org-chart"]],viewQuery:function(t,o){if(1&t&&e.Gf(ct,5),2&t){let i;e.iGM(i=e.CRH())&&(o.jobTitleChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},features:[e.qOj],decls:16,vars:12,consts:[[1,"organizationchart-container","job-title-chart"],[3,"formGroup"],[1,"row","mx-0"],[1,"col-md-3","col-12"],["label","searchBy",3,"control","List","change"],[3,"control","filter","change",4,"ngIf"],["class","col-md-3 col-12",4,"ngIf"],["class","float-right",4,"ngIf"],["id","jobTitleChart",3,"scroll"],[3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["jobTitleChart",""],["pTemplate","job-title"],[3,"width",4,"ngIf"],[3,"control","filter","change"],["label","jobTitle",3,"control","filter","List","change"],[1,"float-right"],[1,"ft-image","font-large-1","info","m-1",3,"matTooltip","click"],[1,"ft-file","font-large-1","info","m-1",3,"matTooltip","click"],[4,"ngIf"],[1,"node-header",3,"id","click"],[1,"node-content","main-data"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","fte-content",4,"ngIf"],["class","node-footer info",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"fte-content"],[4,"ngFor","ngForOf"],[1,"node-footer","info",3,"click"],[3,"width"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-prime-dropdown",4),e.NdJ("change",function(){return o.onChangeSearchType()}),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,dt,1,2,"app-job-title-dropdown",5),e.YNc(7,mt,1,2,"app-employee-dropdown",5),e.qZA(),e.YNc(8,gt,2,3,"div",6),e.TgZ(9,"div",3),e.YNc(10,_t,5,6,"div",7),e.qZA()()(),e.TgZ(11,"div",8),e.NdJ("scroll",function(r){return o.onScroll(r)}),e.TgZ(12,"p-organizationChart",9,10),e.NdJ("onNodeExpand",function(){return o.changePositions()})("onNodeCollapse",function(){return o.changePositions()}),e.YNc(14,yt,11,10,"ng-template",11),e.qZA()(),e.YNc(15,Tt,1,1,"app-chart-skeleton",12),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.searchTypeId)("List",o.searchTypeList),e.xp6(2),e.Q6J("ngIf",1==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",2==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.employeeId.value>0),e.xp6(1),e.ekj("col-md-6",!(o.formCtrls.employeeId.value>0)),e.xp6(1),e.Q6J("ngIf",null!=o.jobTitleOrgChart),e.xp6(2),e.Q6J("value",o.jobTitleOrgChart)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",o.loading))},dependencies:[n.sg,n.O5,P.$,qe.J,z.lW,je.gM,ne.t,pt.W,g._Y,g.JL,g.sg,k.jx,Fe.OE,x.X$],styles:[".job-title-chart .p-organizationchart-node-content{border-radius:10px;width:280px!important}  .job-title-chart .main-data p{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}  .job-title-chart .node-header{border-top-left-radius:10px;border-top-right-radius:10px;cursor:pointer}  .job-title-chart .node-footer{background-color:inherit;border-bottom-left-radius:10px;border-bottom-right-radius:10px;padding-bottom:10px;padding-top:10px;font-size:13px}  .job-title-chart .node-footer:hover{background-color:#e8f3f8;color:#525050!important}  .job-title-chart .p-organizationchart-node-content .node-header:hover{background:#e8f3f8!important}  .job-title-chart .no-employees{margin-top:1.8rem;text-align:start;color:#525050;padding-bottom:.3rem}  .job-title-chart .employees-no-section{border-bottom:1px solid #dee2e6!important}  .job-title-chart .fte-content{padding:15px .7rem 0;text-align:start}  .job-title-chart .ft-image,   .job-title-chart .ft-file{cursor:pointer}"]}),a})(),xt=(()=>{class a extends Qe.K{constructor(){super()}getEmployeesChart(t){return this.get("personnel/Employees/GetAll_EmployeesCard_Structure",{params:{PerinsID:t}})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const It=["resourceChart"];function Dt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",12)(1,"i",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(9);return e.KtG(i.exportChart(r,"resourceChart","image"))}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"i",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),r=e.MAs(9);return e.KtG(i.exportChart(r,"resourceChart","pdf"))}),e.ALo(4,"translate"),e.qZA()()}2&a&&(e.xp6(1),e.s9C("matTooltip",e.lcZ(2,2,"exportAsImage")),e.xp6(2),e.s9C("matTooltip",e.lcZ(4,4,"exportAsPdf")))}function St(a,l){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function Ot(a,l){if(1&a&&(e._UZ(0,"p-image",26),e.ALo(1,"translate")),2&a){const t=e.oxw().$implicit,o=e.oxw();e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",o.fileService.preview(t.data.img))}}function Zt(a,l){1&a&&(e.TgZ(0,"div",27),e._UZ(1,"i",28),e.qZA())}function At(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw();return r.expandNode(i),e.KtG(r.changePositions())}),e._uU(1),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function Jt(a,l){if(1&a){const t=e.EpF();e.YNc(0,St,6,8,"ng-container",11),e.TgZ(1,"div",15)(2,"div",16)(3,"div",17),e.YNc(4,Ot,2,4,"p-image",18),e.YNc(5,Zt,2,0,"ng-template",null,19,e.W1O),e.qZA(),e.TgZ(7,"div",20),e.NdJ("click",function(i){const m=e.CHM(t).$implicit,y=e.oxw();return e.KtG(y.openEmployeeDetailsDialog(i.target,m.data))}),e.TgZ(8,"p",21),e._uU(9),e.ALo(10,"titlecase"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"titlecase"),e.qZA(),e.TgZ(14,"p"),e._uU(15),e.ALo(16,"date"),e.qZA()()()(),e.TgZ(17,"div",22),e.YNc(18,At,2,1,"div",23),e.qZA()}if(2&a){const t=l.$implicit,o=e.MAs(6),i=e.oxw();e.Q6J("ngIf",i.resourcesChart&&(null==i.resourcesChart[0]||null==i.resourcesChart[0].data?null:i.resourcesChart[0].data.parentID)>0&&1==t.data.currentFirstNode),e.xp6(1),e.Q6J("id",t.data.id),e.xp6(3),e.Q6J("ngIf",t.data.img&&"/"!=t.data.img)("ngIfElse",o),e.xp6(5),e.hij(" ",e.lcZ(10,8,i.msgTranslate(t.data.ar_Name,t.data.en_Name))," "),e.xp6(3),e.hij(" ",e.lcZ(13,10,i.msgTranslate(t.data.jobTitleNameAr,t.data.jobTitleName))," "),e.xp6(3),e.hij(" ",e.xi3(16,12,t.data.joiningDate,"dd-MM-yyyy")," "),e.xp6(3),e.Q6J("ngIf",t.children.length>0)}}function Lt(a,l){1&a&&e._UZ(0,"app-chart-skeleton")}let wt=(()=>{class a extends J.U{constructor(t,o){super(),this.resourcesChartService=t,this.dialog=o,this.loading=!1,this.lastSelectedEmpId=0,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0},this.exportChart=le}ngOnInit(){this.form=this.fb.group({employeeId:[null]})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getResourcesChart(this.formCtrls.employeeId.value)}get formCtrls(){return this.form.controls}getResourcesChart(t){t>0&&(this.lastSelectedEmpId=t,this.resourcesChart=null,this.loading=!0,this.resourcesChartService.getEmployeesChart(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?(this.resourcesChart=O(o.data,this.lastSelectedEmpId),this.resourcesChart[0].data.currentFirstNode=!0,this.changePositions(),this.lastSelectedEmpId==t&&(this.loading=!1)):(this.errorList(o?.message?.messages),this.loading=!1)}))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)}onChangeEmployee(){this.getResourcesChart(this.formCtrls.employeeId.value)}upOneLevel(){this.formCtrls.employeeId.setValue(this.resourcesChart[0].data.parentID)}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}openEmployeeDetailsDialog(t,o){let r=this.getHeaderElement(t).getBoundingClientRect(),y={};return y.left=r.left+r.width/2+350<=window.innerWidth?`${r.left+r.width/2}px`:r.left-175-r.width/2+10>=0?r.left-175-r.width/2+10+"px":null,this.dialog.open(ie,{data:{employeeId:o.id},position:y,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(A=>{})}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xt),e.Y36(I.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-resources-chart"]],viewQuery:function(t,o){if(1&t&&e.Gf(It,5),2&t){let i;e.iGM(i=e.CRH())&&(o.resourceChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},features:[e.qOj],decls:12,vars:7,consts:[[1,"organizationchart-container","resources-chart"],[3,"formGroup"],[1,"row","mx-0"],[1,"col-lg-4","col-md-6","col-12"],[3,"control","filter","change"],[1,"col-lg-4","offset-lg-4","col-md-4","offset-md-2","col-12"],["class","float-right",4,"ngIf"],["id","resourceChart",3,"scroll"],[3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["resourceChart",""],["pTemplate","resources"],[4,"ngIf"],[1,"float-right"],[1,"ft-image","font-large-1","info","m-1",3,"matTooltip","click"],[1,"ft-file","font-large-1","info","m-1",3,"matTooltip","click"],[1,"node-header",3,"id"],[1,"node-content","main-data"],[1,"img-emp-chart"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"p-2","info-content",3,"click"],[1,"info"],[1,"node-content"],["class","node-footer",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-employee-dropdown",4),e.NdJ("change",function(){return o.onChangeEmployee()}),e.qZA()(),e.TgZ(5,"div",5),e.YNc(6,Dt,5,6,"div",6),e.qZA()()(),e.TgZ(7,"div",7),e.NdJ("scroll",function(r){return o.onScroll(r)}),e.TgZ(8,"p-organizationChart",8,9),e.NdJ("onNodeExpand",function(){return o.changePositions()})("onNodeCollapse",function(){return o.changePositions()}),e.YNc(10,Jt,19,15,"ng-template",10),e.qZA()(),e.YNc(11,Lt,1,0,"app-chart-skeleton",11),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.employeeId)("filter",!0),e.xp6(2),e.Q6J("ngIf",null!=o.resourcesChart),e.xp6(2),e.Q6J("value",o.resourcesChart)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",o.loading))},dependencies:[n.O5,P.$,qe.J,z.lW,je.gM,g._Y,g.JL,g.sg,k.jx,Fe.OE,_e.E,n.rS,n.uU,x.X$],styles:[".resources-chart .p-organizationchart-node-content{width:150px!important;border-color:#c1c3c4}  .resources-chart .p-organizationchart-node-content.dashed-border{border-style:dashed}  .resources-chart .info-content{cursor:pointer;margin-top:-10px}  .resources-chart .node-header{padding:0}  .resources-chart .node-header p{margin:0 0 5px}  .resources-chart .img-emp-chart{display:flex;align-items:center;justify-content:center;height:90px}  .resources-chart .img-emp-chart p-image,   .resources-chart .img-emp-chart .p-image-preview-container>img{height:70px;width:70px;border-radius:50%}  .resources-chart .img-emp-chart .p-image-preview-indicator{border-radius:50%}  .resources-chart .img-emp-chart .alt-img-preview{background-color:#00000024;display:flex;align-items:center;justify-content:center;height:70px;width:70px;border-radius:50%}  .resources-chart .img-emp-chart .alt-img-preview i{font-size:2.5rem;color:#000000ad}  .resources-chart .ft-image,   .resources-chart .ft-file{cursor:pointer}"]}),a})();const Et=["companyChart"];function Nt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"app-org-types-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getAllOrganizationsByOrgType())}),e.qZA()(),e.TgZ(3,"div",12),e._UZ(4,"app-prime-dropdown",14),e.qZA(),e.TgZ(5,"div",12)(6,"div",15)(7,"i",16),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(9),r=e.oxw();return e.KtG(r.exportChart(i,"companyChart","image"))}),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"i",17),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(9),r=e.oxw();return e.KtG(r.exportChart(i,"companyChart","pdf"))}),e.ALo(10,"translate"),e.qZA()()()()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Q6J("control",t.formCtrls.organizationTypeId)("filter",!0),e.xp6(2),e.Q6J("control",t.formCtrls.organization_ID)("List",t.organizationList),e.xp6(3),e.s9C("matTooltip",e.lcZ(8,6,"exportAsImage")),e.xp6(2),e.s9C("matTooltip",e.lcZ(10,8,"exportAsPdf"))}}function Pt(a,l){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function Mt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"i",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit,r=e.oxw(2);return e.KtG(r.onDelete(i))}),e.ALo(1,"translate"),e.qZA()}2&a&&e.s9C("matTooltip",e.lcZ(1,1,"General.delete"))}function Ut(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",26),e.YNc(1,Mt,2,3,"i",27),e.TgZ(2,"i",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openAddEditDialog(i))}),e.ALo(3,"translate"),e.qZA()()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.data.org),e.xp6(1),e.s9C("matTooltip",e.lcZ(3,2,"General.add"))}}function jt(a,l){if(1&a&&(e.TgZ(0,"div",30)(1,"p"),e._uU(2),e.qZA()()),2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",o.msgTranslate(null==t.data.orgType?null:t.data.orgType.ar_Name,null==t.data.orgType?null:t.data.orgType.en_Name)," ")}}function Ft(a,l){if(1&a&&(e.TgZ(0,"div",30)(1,"p"),e._uU(2),e.qZA()()),2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",o.msgTranslate(t.data.structure.ar_Name,t.data.structure.en_Name)," ")}}function Bt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",31)(1,"i",32),e.NdJ("click",function(i){e.CHM(t);const r=e.oxw().$implicit,m=e.oxw(2);return e.KtG(m.openOrgDetailsDialog(i.target,r.data,1))}),e.TgZ(2,"span"),e._uU(3),e.qZA()()()}if(2&a){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.data.numEmp," ")}}function Qt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(2);return r.expandNode(i),e.KtG(r.changePositions())}),e._uU(1),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function Gt(a,l){if(1&a&&(e.YNc(0,Pt,6,8,"ng-container",10),e.TgZ(1,"div",18)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,Ut,4,4,"div",19),e.YNc(6,jt,3,1,"div",20),e.YNc(7,Ft,3,1,"div",20),e.qZA(),e.TgZ(8,"div",21),e.YNc(9,Bt,4,1,"div",22),e.YNc(10,Qt,2,1,"div",23),e.qZA()),2&a){const t=l.$implicit,o=e.oxw(2);let i;e.Q6J("ngIf",o.orgStructureDetailsFiltered&&(null==o.orgStructureDetailsFiltered[0]||null==o.orgStructureDetailsFiltered[0].data?null:o.orgStructureDetailsFiltered[0].data.parentId)>0&&1==t.data.currentFirstNode),e.xp6(1),e.Q6J("id",null!==(i=null==t.data.org?null:t.data.org.id)&&void 0!==i?i:null),e.xp6(1),e.Tol(o.msgTranslate("mleft-50","mright-50")),e.xp6(1),e.hij(" ",t.data.structure?e.lcZ(4,10,t.label):t.label," "),e.xp6(2),e.Q6J("ngIf",!o.canNotEdit),e.xp6(1),e.Q6J("ngIf",t.data.org),e.xp6(1),e.Q6J("ngIf",t.data.structure),e.xp6(2),e.Q6J("ngIf",t.data.numEmp>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}function Rt(a,l){1&a&&e._UZ(0,"app-chart-skeleton")}function zt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"mat-tab-group",1)(1,"mat-tab",2),e.ALo(2,"titlecase"),e.ALo(3,"translate"),e.TgZ(4,"div",3)(5,"form",4),e.YNc(6,Nt,11,10,"div",5),e.qZA(),e.TgZ(7,"div",6),e.NdJ("scroll",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onScroll(i))}),e.TgZ(8,"p-organizationChart",7,8),e.NdJ("onNodeExpand",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePositions())})("onNodeCollapse",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePositions())}),e.YNc(10,Gt,11,12,"ng-template",9),e.qZA()(),e.YNc(11,Rt,1,0,"app-chart-skeleton",10),e.qZA()(),e.TgZ(12,"mat-tab",2),e.ALo(13,"titlecase"),e.ALo(14,"translate"),e._UZ(15,"app-job-title-org-chart"),e.qZA(),e.TgZ(16,"mat-tab",2),e.ALo(17,"titlecase"),e.ALo(18,"translate"),e._UZ(19,"app-resources-chart"),e.qZA()()}if(2&a){const t=e.oxw();e.Q6J("dir",t.languageService.isArabic?"rtl":"ltr"),e.xp6(1),e.s9C("label",e.lcZ(2,11,e.lcZ(3,13,"companyOrgStructure"))),e.xp6(3),e.ekj("ar",t.languageService.isArabic),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(2),e.Q6J("value",t.orgStructureDetailsFiltered)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",t.loading),e.xp6(1),e.s9C("label",e.lcZ(13,15,e.lcZ(14,17,"jobtitleChart"))),e.xp6(4),e.s9C("label",e.lcZ(17,19,e.lcZ(18,21,"resources")))}}let Ye=(()=>{class a extends J.U{constructor(t,o,i){super(),this.orgStructureService=t,this.organizationsService=o,this.dialog=i,this.orgStructureDetailsFiltered=[],this.organizationList=[],this.loading=!0,this.firstOnChange=!0,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0},this.upOneLevelLastPositionsBeforeScroll={btnLeft:0,lineLeft:0},this.exportChart=le}ngOnInit(){this.form=this.fb.group({organizationTypeId:[null],organization_ID:[{value:null,disabled:!0}]}),this.formCtrls.organization_ID.valueChanges.subscribe(t=>{(null==t||t>0)&&this.onChangeOrg(t)})}ngOnChanges(t){t.orgStructureId&&(this.firstOnChange?this.firstOnChange=!1:this.onChangeBusinessAndCompanyId())}onChangeBusinessAndCompanyId(){this.orgStructureId>0&&this.checkNoBusinessOrCompany()&&this.getStructureDetails()}get formCtrls(){return this.form.controls}getStructureDetails(){this.loading=!0,this.orgStructureDetails=null,this.orgStructureDetailsFiltered=[],this.orgStructureService.getByIdWithHierarchy(this.orgStructureId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(this.orgStructureDetails=j(t.data[0],this.orgStructureId),this.orgStructureDetailsFiltered=this.orgStructureDetails.slice(),this.loading=!1):(this.errorList(t?.message?.messages),this.loading=!1)})}onChangeOrg(t){this.orgStructureDetailsFiltered=[],t>0?this.getChartDataByOrg(t,this.orgStructureDetails[0]):this.orgStructureDetailsFiltered=this.orgStructureDetails}getChartDataByOrg(t,o,i=!1){o.children.map(r=>{if(r.data.org?.id==t)return this.orgStructureDetailsFiltered=[r],this.orgStructureDetailsFiltered[0].data.currentFirstNode=!0,i&&(this.formCtrls.organizationTypeId.setValue(r.data.orgType.id),this.formCtrls.organization_ID.setValue(r.data.org.id)),void this.changePositions()}),o.children.map(r=>this.getChartDataByOrg(t,r,i))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},50)}upOneLevel(){this.orgStructureDetailsFiltered[0].data.currentFirstNode=!1,this.formCtrls.organization_ID.setValue(0);let t=this.orgStructureDetailsFiltered[0].data.parentId;t?this.getChartDataByOrg(t,this.orgStructureDetails[0],!0):this.orgStructureDetailsFiltered=this.orgStructureDetails}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}onDelete(t){let o=this.msgTranslate(t.data.org.ar_Name,t.data.org.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.deleteNode(t)})}deleteNode(t){let o={StructureID:this.orgStructureId,OrgID:t.data.org.id};this.showLoading(),this.orgStructureService.DeleteNode(o).subscribe(i=>{i.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getStructureDetails(),this.getAllOrganizationsByOrgType()):this.errorList(i?.message?.messages),this.hideLoading()})}openAddEditDialog(t){return this.dialog.open(xe,{data:{org_Structure_ID:this.orgStructureId,parenT_ID:t.data.org?.id??null},minWidth:"50vw",autoFocus:!1}).afterClosed().subscribe(o=>{o&&(this.getStructureDetails(),this.getAllOrganizationsByOrgType())})}openOrgDetailsDialog(t,o,i){let m=this.getHeaderElement(t).getBoundingClientRect(),A={};return A.left=m.left+m.width+10+350<=window.innerWidth?`${m.left+m.width+10}px`:m.left-350-10>=0?m.left-350-10+"px":null,this.dialog.open(C,{data:{org_Structure_ID:this.orgStructureId,nodeData:o,expandedIndex:i},position:A,width:"350px",maxHeight:"90hv",autoFocus:!1}).afterClosed().subscribe(ze=>{})}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}getAllOrganizationsByOrgType(){let t=this.formCtrls.organizationTypeId.value;this.formCtrls.organization_ID.setValue(null),t>0?(this.organizationsService.GetAllByOrgTypeAndStructure(t,this.orgStructureId).pipe(this.cancelRequest()).subscribe(o=>{(o.message.messageType=b.u.Success)?this.organizationList=o.data:this.errorList(o?.message?.messages)}),this.formCtrls.organization_ID.enable()):this.formCtrls.organization_ID.disable()}onWindowResize(t){this.changePositions()}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._),e.Y36(de.z),e.Y36(I.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-hierarchy-details"]],viewQuery:function(t,o){if(1&t&&e.Gf(Et,5),2&t){let i;e.iGM(i=e.CRH())&&(o.companyChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(r){return o.onWindowResize(r)},!1,e.Jf7)},inputs:{orgStructureId:"orgStructureId",canNotEdit:"canNotEdit"},features:[e.qOj,e.TTD],decls:3,vars:1,consts:[["class","col-12 w-100 view-tabs-group",3,"dir",4,"ngIf"],[1,"col-12","w-100","view-tabs-group",3,"dir"],[3,"label"],[1,"organizationchart-container","company-chart"],[3,"formGroup"],["class","row mx-0",4,"ngIf"],["id","companyChart",3,"scroll"],["styleClass","company",3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["companyChart",""],["pTemplate","org"],[4,"ngIf"],[1,"row","mx-0"],[1,"col-md-4","col-12"],[3,"control","filter","change"],["label","organization",3,"control","List"],[1,"float-right"],[1,"ft-image","font-large-1","info","m-1",3,"matTooltip","click"],[1,"ft-file","font-large-1","info","m-1",3,"matTooltip","click"],[1,"node-header",3,"id"],["class","action-icons",4,"ngIf"],["class","node-content main-data",4,"ngIf"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","node-footer",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],[1,"action-icons"],["mat-icon-button","","class","pi pi-trash danger",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",1,"pi","pi-plus","info",3,"matTooltip","click"],["mat-icon-button","",1,"pi","pi-trash","danger",3,"matTooltip","click"],[1,"node-content","main-data"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e._UZ(0,"p-toast")(1,"ngx-spinner"),e.YNc(2,zt,20,23,"mat-tab-group",0)),2&t&&(e.xp6(2),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[n.O5,P.$,z.lW,$.Lv,pe.SP,pe.uX,je.gM,E.Ro,ne.t,me.q,g._Y,g.JL,g.sg,k.jx,We.FN,Fe.OE,vt,wt,n.rS,x.X$],styles:[".mat-tab-body-content{padding:0;overflow-y:auto!important}  .view-tabs-group .mat-tab-header .mat-tab-labels{justify-content:flex-start}  .mat-dialog-content{max-height:65vh!important}[_nghost-%COMP%]     .company-chart .node-header i{font-size:16px;cursor:pointer}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header{position:relative}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header span{display:inline-block}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons{float:right;position:absolute;top:12px;right:0}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons i{font-size:1rem;margin-right:10px}.ar[_ngcontent-%COMP%]   .action-icons[_ngcontent-%COMP%]{float:left!important;left:0!important;right:auto!important;right:initial!important}.ar[_ngcontent-%COMP%]   .action-icons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;margin-right:0}.ft-image[_ngcontent-%COMP%], .ft-file[_ngcontent-%COMP%]{cursor:pointer}"]}),a})();function qt(a,l){if(1&a&&e._UZ(0,"app-add-new-btn",5),2&a){const t=e.oxw();e.MGl("url","/org-management/",t.moduleId,"/org-structure/add"),e.Q6J("params",t.parentParam)}}function Yt(a,l){if(1&a&&e._UZ(0,"app-prime-dropdown",18),2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.CopyStructureID)("submitted",t.submitted)("List",t.structureList)}}function kt(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"reset-form-btn",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}function $t(a,l){1&a&&(e._UZ(0,"span",22),e.TgZ(1,"div",23),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"canNotEditOrgStructure")," "))}function Ht(a,l){1&a&&(e.TgZ(0,"p-messages",20),e.YNc(1,$t,4,3,"ng-template",21),e.qZA())}let ke=(()=>{class a extends J.U{constructor(t){super(),this.orgStructureService=t,this.submitted=!1,this.todayDate=new Date,this.structureList=[],this.todayDate.setHours(0,0,0,0)}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],en_Name:[null,[g.kI.required,L.w.whiteSpace]],ar_Name:[null,[g.kI.required,L.w.whiteSpace]],froM_DATE:[null,[g.kI.required]],CopyStructureID:[null]}),this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&(0==this.orgStructureId?this.getAllStructures():this.getById())}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.orgStructureService.getById(this.orgStructureId).pipe(this.cancelRequest()).subscribe(t=>{t?.message?.messageType==b.u.Success?(this.orgStructure=t.data[0],this.orgStructureToEdit()):this.errorList(t?.message?.messages),this.hideLoading()})}orgStructureToEdit(){this.form.patchValue(this.orgStructure)}submit(){this.submitted=!0,this.form.valid&&(0==this.formCtrls.id.value?this.create():this.update())}create(){const t={Core_Org_Structure:{en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:S.M.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE)},CopyStructureID:this.formCtrls.CopyStructureID.value};this.showLoading(),this.orgStructureService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructureId=o.data.id,this.formCtrls.id.setValue(this.orgStructureId),this.navigateTo(`/org-management/${this.moduleId}/org-structure/edit/${this.orgStructureId}`),this.orgStructure=o.data,this.formCtrls.CopyStructureID.reset()):this.errorList(o?.message?.messages),this.hideLoading()})}update(){const t={id:this.form.value.id,en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:S.M.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE),to_DATE:S.M.mapDateReverse(this.orgStructure.tO_DATE)};this.showLoading(),this.orgStructureService.update(t).subscribe(o=>{o.message.messageType==b.u.Success?(this.updateSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructure=o.data):this.errorList(o?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}canNotEdit(){return new Date(this.todayDate).getTime()>=new Date(this.orgStructure?.froM_DATE).getTime()}getAllStructures(){this.orgStructureService.getAll().pipe(this.cancelRequest()).subscribe(t=>{(t.message.messageType=b.u.Success)?this.structureList=[{id:0,ar_Name:"\u0627\u0646\u0634\u0627\u0621 \u062c\u062f\u064a\u062f",en_Name:"Create new"},...t.data]:this.errorList(t?.message?.messages)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-org-structure"]],features:[e.qOj],decls:26,vars:19,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","orgStructure","editTitle","editOrgStructure",3,"id"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["label","froM_DATE",3,"control","submitted","minDate","disabled"],["label","copyFromPreviousStructure",3,"control","submitted","List",4,"ngIf"],["align","end"],[3,"click",4,"ngIf"],[3,"id","onClick"],["severity","warn",4,"ngIf"],[3,"orgStructureId","canNotEdit"],["label","copyFromPreviousStructure",3,"control","submitted","List"],[3,"click"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3),e.YNc(6,qt,1,2,"app-add-new-btn",4),e._UZ(7,"app-back-btn",5),e.qZA(),e.TgZ(8,"mat-card-content",6)(9,"div",0)(10,"div",1)(11,"form",7)(12,"div",0)(13,"div",8),e._UZ(14,"app-input",9),e.qZA(),e.TgZ(15,"div",8),e._UZ(16,"app-input",10),e.qZA(),e.TgZ(17,"div",8),e._UZ(18,"app-datepicker",11),e.qZA(),e.TgZ(19,"div",8),e.YNc(20,Yt,1,3,"app-prime-dropdown",12),e.qZA()()()()()(),e.TgZ(21,"mat-card-actions",13),e.YNc(22,kt,1,0,"reset-form-btn",14),e.TgZ(23,"submit-btn",15),e.NdJ("onClick",function(){return o.submit()}),e.qZA()(),e.YNc(24,Ht,2,0,"p-messages",16),e._UZ(25,"app-org-structure-hierarchy-details",17),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.en_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.ar_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.froM_DATE)("submitted",o.submitted)("minDate",o.todayDate)("disabled",o.canNotEdit()),e.xp6(2),e.Q6J("ngIf",0==o.form.value.id),e.xp6(2),e.Q6J("ngIf",0==o.formCtrls.id.value),e.xp6(1),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.canNotEdit()),e.xp6(1),e.Q6J("orgStructureId",o.orgStructureId||o.formCtrls.CopyStructureID.value)("canNotEdit",0==o.orgStructureId||o.canNotEdit()))},dependencies:[n.O5,N.Q,Y.a,V.a,se.J,be.J,oe.p,F.T,D.a8,D.dn,D.n5,D.hq,E.Ro,ne.t,g._Y,g.JL,g.sg,k.jx,ae.V,Ye,x.X$]}),a})();var Ge=p(36162);function Kt(a,l){if(1&a&&e._UZ(0,"app-org-structure-hierarchy-details",6),2&a){const t=e.oxw();e.Q6J("orgStructureId",t.orgStructureId)("canNotEdit",!0)}}let Wt=(()=>{class a extends J.U{constructor(){super(),this.orgStructureId=0}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-details"]],features:[e.qOj],decls:8,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"mtop-15"],["title","orgStructureDetails"],[3,"url","params"],[3,"orgStructureId","canNotEdit",4,"ngIf"],[3,"orgStructureId","canNotEdit"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3)(6,"app-back-btn",4),e.qZA(),e.YNc(7,Kt,1,2,"app-org-structure-hierarchy-details",5),e.qZA()()()),2&t&&(e.xp6(6),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(1),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[n.O5,V.a,F.T,D.a8,D.n5,E.Ro,Ye]}),a})();var Vt=p(6314),Xt=p(92972);let eo=(()=>{class a extends J.U{constructor(t){super(),this.jobTitleService=t,this.mandatoryColomns=["Ser","id","code","en_Name","ar_Name","actions"],this.optionalColomns=["jobFamily"],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.dataSource=new v.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.jobTitleService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==b.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by((0,Vt.gc)(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount}else this.errorList(r?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.jobTitleService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Xt._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-jobs-profile-index"]],features:[e.qOj],decls:10,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","jobsProfile",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3),e.qZA(),e.TgZ(6,"app-material-table",4),e.NdJ("onChangePage",function(r){return o.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return o.onDelete(r)}),e.qZA()()()(),e.TgZ(7,"side-helping-menu",5),e.ALo(8,"translate"),e._UZ(9,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",null==o.globalFunctions?null:o.globalFunctions.reverse()),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("exportService",o.jobTitleService)("actions",o.rowFunctions),e.xp6(1),e.s9C("title",e.lcZ(8,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[q.I,F.T,ee.c,te.b,D.a8,D.n5,E.Ro,x.X$]}),a})();var $e=p(61900),to=p(63581);function He(a){return a.map(l=>({...l,kpi:(0,S._)(l.core_KPI?.ar_Name,l.core_KPI?.en_Name)}))}var oo=p(24850);let no=(()=>{class a extends Qe.K{constructor(){super()}create(t){return this.post("OrgStructure/Create_KpiOrg",t)}getList(t,o){return this.get("OrgStructure/GetList_KpiOrg",{params:{...t,$expand:X.db.core_KPI,$filter:`orgId eq ${o}`}})}getAll(){return this.get("OrgStructure/GetAll_KpiOrg").pipe((0,oo.U)(t=>(t.data=He(t.data),t)))}Delete(t){return this.delete("OrgStructure/Delete_KpiOrg",{params:{Id:t}})}exportExcel(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var ao=p(85443),io=p(50260),ro=p(50162);function so(a,l){if(1&a){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"app-material-table",13),e.NdJ("onChangePage",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.getList(i.pageIndex+1,i.pageSize))})("deleteRow",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onDelete(i))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)}}let lo=(()=>{class a extends J.U{constructor(t){super(),this.orgKpisService=t,this.submitted=!1,this.mandatoryColomns=["Ser","kpi","actions"],this.isLoaded=!0,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({OrgTypeId:[null,[g.kI.required]],OrgId:[null,[g.kI.required]],KPI_Id:[null,[g.kI.required]]})}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null))}get formCtrls(){return this.form.controls}getList(t,o){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null));let i=this.formCtrls.OrgId.value;i>0&&(this.isLoaded=!1,this.page.pageIndex=t,o&&(this.page.pageSize=o),this.orgKpisService.getList({PageNumber:t,pageSize:this.page.pageSize},i).pipe(this.cancelRequest()).subscribe(m=>{m.message.messageType==b.u.Success?(this.dataSource=new v.by(He(m.data)),this.isLoaded=!0,this.page.length=m.meta.totalItemCount):this.errorList(m?.message?.messages)}))}submit(){this.submitted=!0,this.form.valid&&this.create({OrgId:this.form.value.OrgId,KPI_Id:this.form.value.KPI_Id})}create(t){this.showLoading(),this.orgKpisService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.clearForm(),this.addSuccessfullyMsg(o?.message?.messageTypeName),this.getList(this.lastPage)):this.errorList(o?.message?.messages),this.hideLoading()})}onDelete(t){this.deleteDialog(t.kpi).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.orgKpisService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}clearForm(){this.formCtrls.KPI_Id.reset(),this.submitted=!1}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(no))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-kpis"]],features:[e.qOj],decls:21,vars:14,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["title","orgKpis"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","orgTypeControl","submitted","filter","change"],["align","end"],[3,"onClick"],[4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3)(6,"app-back-btn",4),e.qZA(),e.TgZ(7,"mat-card-content",5)(8,"div",0)(9,"div",1)(10,"form",6)(11,"div",0)(12,"div",7),e._UZ(13,"app-org-types-dropdown-current-structure",8),e.qZA(),e.TgZ(14,"div",7)(15,"app-organization-by-org-type-dropdown",9),e.NdJ("change",function(){return o.getList(o.firstPage)}),e.qZA()(),e.TgZ(16,"div",7),e._UZ(17,"app-kpi-dropdown",8),e.qZA()()()()()(),e.TgZ(18,"mat-card-actions",10)(19,"submit-btn",11),e.NdJ("onClick",function(){return o.submit()}),e.qZA()(),e.YNc(20,so,3,6,"ng-container",12),e.qZA()()()),2&t&&(e.xp6(6),e.MGl("url","/org-management/",o.moduleId,"/org-structure"),e.Q6J("params",o.pageParams),e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.OrgTypeId)("submitted",o.submitted)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.OrgId)("orgTypeControl",o.formCtrls.OrgTypeId)("submitted",o.submitted)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.KPI_Id)("submitted",o.submitted)("filter",!0),e.xp6(3),e.Q6J("ngIf",o.formCtrls.OrgId.value>0))},dependencies:[n.O5,q.I,V.a,oe.p,F.T,D.a8,D.dn,D.n5,D.hq,Be.d,E.Ro,ao.A,io.v,ro.M,g._Y,g.JL,g.sg]}),a})();var Re=p(49057);let co=(()=>{class a extends J.U{constructor(t){super(),this.policyGroupService=t,this.mandatoryColomns=["Ser","id","ar_Name","en_Name","policyGroupType","noOfEmployees","actions"],this.optionalColomns=[],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.policyGroupService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(1==r.message.messageType){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by(function po(a){return a.map(l=>({id:l?.core_PolicyGroup?.id,ar_Name:l?.core_PolicyGroup?.ar_Name,en_Name:l?.core_PolicyGroup?.en_Name,policyGroupType:(0,S._)(l?.core_PolicyGroup?.core_PolicyGroup_Type?.ar_Name,l?.core_PolicyGroup?.core_PolicyGroup_Type?.en_Name),noOfEmployees:l.countEmpsOnPolicy}))}(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount}else this.errorList(r?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.policyGroupService.Delete(t.id).subscribe(o=>{1==o.message.messageType?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Re.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-policy-group-index"]],features:[e.qOj],decls:10,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","policyGroups",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","exportService","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card",2)(4,"mat-card-title"),e._UZ(5,"page-title",3),e.qZA(),e.TgZ(6,"app-material-table",4),e.NdJ("onChangePage",function(r){return o.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return o.onDelete(r)}),e.qZA()()()(),e.TgZ(7,"side-helping-menu",5),e.ALo(8,"translate"),e._UZ(9,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",o.globalFunctions),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("actions",o.rowFunctions)("exportService",o.policyGroupService),e.xp6(1),e.s9C("title",e.lcZ(8,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[q.I,F.T,ee.c,te.b,D.a8,D.n5,E.Ro,x.X$]}),a})();var mo=p(33975);const go=function(){return[]};let _o=(()=>{class a{constructor(t,o,i){this.model=t,this.dialogRef=o,this.policyGroupService=i,this.policyStartDate=new g.NI(""),this.appHelper=new J.U,this.selectedEmployees=[],this.mandatoryColomns=["employee","code",mo.g.selectColName],t?.intersectionEmployees&&(t?.intersectionEmployees.map(r=>{r.employee=(0,S._)(r.employeeNameAR,r.employeeNameEN),r.code=r.employeeCode}),this.dataSource=new v.by(t?.intersectionEmployees)),this.policyStartDate.valueChanges.subscribe(r=>{})}submit(){0!==this.selectedEmployees?.length?(this.appHelper.showLoading(),this.policyGroupService.saveIntersectionEmployees(this.selectedEmployees).subscribe(t=>{t?.message?.messageType==b.u.Success?(this.selectedEmployees=[],this.dialogRef.close(!0),this.appHelper.addSuccessfullyMsg(t?.message?.messageTypeName)):this.appHelper.errorList(t?.message?.messages),this.appHelper.hideLoading()})):this.appHelper.error("mustSelectEmployeeAtLeast","validation")}onSelectEmployee(t){const o=[];this.dataSource.data.forEach(i=>{if(i.isSelected){let r={employeeId:i.employeeId,policyGroupId:this.model.data.id,policyGroupTypeId:this.model.data.policyGroup_Type_ID,policyStartDate:S.M.transformData(this.policyStartDate?.value)};o.push(r)}}),this.selectedEmployees=o}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(I.WI),e.Y36(I.so),e.Y36(Re.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-intersection-emp-dialog"]],decls:21,vars:17,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","intersectionEmployee",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"container-fluid","mx-0","mt-1"],[1,"row"],[1,"col-12"],[1,"col-md-4","col-12"],["label","startDate",3,"control"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showSpaceTop","showPaginator","showFilter","selectedItems"],["mat-dialog-actions","","align","end"],["mat-raised-button","",1,"btn","btn-light",3,"mat-dialog-close"],["mat-raised-button","",1,"btn","btn-darkBlue",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA(),e.TgZ(3,"button",2),e._UZ(4,"i",3),e.qZA()(),e.TgZ(5,"mat-dialog-content",4)(6,"div",5)(7,"div",6)(8,"div",5)(9,"div",7),e._UZ(10,"app-datepicker",8),e.qZA()()(),e.TgZ(11,"div",6)(12,"app-material-table",9),e.NdJ("selectedItems",function(r){return o.onSelectEmployee(r)}),e.qZA()()()(),e.TgZ(13,"div",10)(14,"button",11),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return o.submit()}),e._uU(18),e.ALo(19,"translate"),e.qZA()(),e._UZ(20,"ngx-spinner")),2&t&&(e.xp6(3),e.Q6J("mat-dialog-close",!1),e.xp6(7),e.Q6J("control",o.policyStartDate),e.xp6(2),e.Q6J("isLoaded",!0)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",e.DdM(16,go))("showSpaceTop",!1)("showPaginator",!1)("showFilter",!1),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.hij(" ",e.lcZ(16,12,"General.cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(19,14,"save")," "))},dependencies:[N.Q,q.I,F.T,z.lW,I.ZT,I.uh,I.xY,I.H8,E.Ro,x.X$]}),a})();var B=(()=>{return(a=B||(B={}))[a.OPEN=1]="OPEN",a[a.ORGANIZATIONS=2]="ORGANIZATIONS",a[a.JOB_TITLE=3]="JOB_TITLE",a[a.LOCATION=4]="LOCATION",B;var a})();const uo=[{label:"open",value:B.OPEN,cssClass:"col-6 col-lg-3 px-2"},{label:"organizations",value:B.ORGANIZATIONS,cssClass:"col-6 col-lg-3 px-2"},{label:"job",value:B.JOB_TITLE,cssClass:"col-6 col-lg-3 px-2"},{label:"location",value:B.LOCATION,cssClass:"col-6 col-lg-3 px-2"}];var ho=p(45679),fo=p(92393),bo=p(86195),Co=p(29260);function yo(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"div",20)(1,"app-employee-select-table",21),e.NdJ("onSelect",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getSelectedEmp(i))})("length",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getEmployeesCount(i))}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("reset",t.resetEmployeeList)}}function To(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"mat-card",14)(1,"mat-card-title",0),e._uU(2),e._UZ(3,"page-title",15),e.qZA(),e._UZ(4,"mat-divider",2),e.TgZ(5,"mat-card-content",16)(6,"div",4),e.YNc(7,yo,2,1,"div",17),e.qZA()(),e.TgZ(8,"mat-card-actions",18)(9,"submit-btn",19),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.qZA()()()}if(2&a){const t=e.oxw();let o;e.xp6(2),e.hij(" ",null!==(o=t.selectedCount)&&void 0!==o?o:""," "),e.xp6(1),e.Q6J("title",t.getTitle()),e.xp6(4),e.Q6J("ngIf",t.groupingTypeCtrl.value==t.groupingList.OPEN),e.xp6(2),e.Q6J("id",t.formCtrls.id.value)("color",t.btn.darkBlue)("iconPositionBefore",!1)}}function vo(a,l){if(1&a){const t=e.EpF();e.TgZ(0,"app-material-table",23),e.NdJ("onChangePage",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getDetailsList(i.pageIndex+1,i.pageSize))})("deleteRow",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onDelete(i))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("page",t.page)("showSpaceTop",!1)}}function xo(a,l){if(1&a&&(e.TgZ(0,"mat-card",14)(1,"mat-card-title",0),e._uU(2),e._UZ(3,"page-title",15),e.qZA(),e._UZ(4,"mat-divider",2),e.TgZ(5,"mat-card-content",16)(6,"div",4)(7,"div",20),e.YNc(8,vo,1,7,"app-material-table",22),e.qZA()()()()),2&a){const t=e.oxw();let o;e.xp6(2),e.hij(" ",null!==(o=null==t.dataSource||null==t.dataSource.data?null:t.dataSource.data.length)&&void 0!==o?o:0," "),e.xp6(1),e.Q6J("title",t.getTitle()),e.xp6(5),e.Q6J("ngIf",t.policyGroupId>0)}}let Io=(()=>{class a extends J.U{constructor(t){super(),this.policyGroupService=t,this.submitted=!1,this.radioList=uo,this.groupingList=B,this.mandatoryColomns=["employee","actions"],this.optionalColomns=[],this.isLoaded=!1,this.actionType=ho.U,this.activatedRoute.paramMap.subscribe(o=>{this.policyGroupId=Number(o.get("id"))??0,this.policyGroupId||this.radioList.map(i=>i.disabled=!1)})}orgChanged(t){console.log(t)}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,g.kI.required],en_Name:[null,g.kI.required],policyGroup_Type_ID:[null,g.kI.required],groupingType:[B.OPEN,g.kI.required],selectedEmployeesIDs:[null],orgTypeId:[null],orgId:[null],countryId:[null],selectedOrgIDs:[null],selectedLocationsIDs:[null],selectedJobsIDs:[null]})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.policyGroupId>0&&(this.getById(),this.getDetailsList(this.firstPage))}get formCtrls(){return this.form.controls}get groupingTypeCtrl(){return this.form.get("groupingType")}submit(){if(this.submitted=!0,0==this.formCtrls.id.value){if(this.form.value.groupingType==B.OPEN&&0==this.form.value.selectedEmployeesIDs?.length)return void this.error("mustSelectEmployeeAtLeast","validation");if(this.form.value.groupingType==B.ORGANIZATIONS&&0==this.form.value.selectedOrgIDs?.length)return void this.error("mustSelectOrgAtLeast","validation");if(this.form.value.groupingType==B.LOCATION&&0==this.form.value.selectedLocationsIDs?.length)return void this.error("mustSelectLocationAtLeast","validation")}if(this.form.valid){const t={core_PolicyGroup:{id:this.formCtrls.id.value,ar_Name:this.formCtrls.ar_Name.value,en_Name:this.formCtrls.en_Name.value,policyGroup_Type_ID:this.formCtrls.policyGroup_Type_ID.value,groupingType:this.groupingTypeCtrl.value},selectedEmployeesIDs:this.formCtrls.selectedEmployeesIDs.value,selectedOrgIDs:this.formCtrls.selectedOrgIDs.value,SelectedLocationsIDs:this.formCtrls.selectedLocationsIDs.value};t.core_PolicyGroup.id>0?this.update(t):this.create(t)}}create(t){this.showLoading(),this.policyGroupService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.policyGroupId=o.data.id,this.formCtrls.id.setValue(this.policyGroupId),this.disableRadioList(),o?.intersectionEmployees?.length>0&&this.intersectionEmpDialog(o),this.navigateTo(`/org-management/${this.moduleId}/policy-group/edit/${this.policyGroupId}`),this.addSuccessfullyMsg(o?.message?.messageTypeName),this.getDetailsList(this.firstPage),this.resetEmployeeList=!0):this.errorList(o?.message?.messages),this.hideLoading()})}update(t){this.showLoading(),this.policyGroupService.edit(t).subscribe(o=>{o.message.messageType==b.u.Success?(o?.intersectionEmployees?.length>0&&this.intersectionEmpDialog(o),this.updateSuccessfullyMsg(o?.message?.messageTypeName),this.getDetailsList(this.firstPage),this.resetEmployeeList=!0):this.errorList(o?.message?.messages),this.hideLoading()})}getById(){this.showLoading(),this.policyGroupService.getById(this.policyGroupId).subscribe(t=>{t.message.messageType==b.u.Success?(this.form.patchValue(t.data[0]),this.disableRadioList()):this.errorList(t?.message?.messages),this.hideLoading()})}getDetailsList(t,o){this.showLoading(),this.page.pageIndex=t,o&&(this.page.pageSize=o);let i={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.policyGroupService.getDetailsList(i,this.policyGroupId).subscribe(r=>{r.message.messageType==b.u.Success?(r.data.map(m=>m.employee=(0,S._)(m.itemNameAR,m.itemNameEN)),this.dataSource=new v.by(r.data),this.page.length=r.meta.totalItemCount,this.isLoaded=!0):this.errorList(r?.message?.messages),this.hideLoading()})}intersectionEmpDialog(t){this.dialogsService.addEditDialog(_o,t).afterClosed().subscribe(o=>{o&&this.getDetailsList(this.currentPage)})}onDelete(t){let o=(0,S._)(t.itemNameAR,t.itemNameEN);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.policyGroupService.deleteDetails({PolicyGroupId:t.policyGroupId,itemId:t.itemId,gropingType:this.form.value.groupingType}).subscribe(i=>{1==i.message.messageType?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getDetailsList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(i?.message?.messages),this.hideLoading()})}getSelectedEmp(t){let o=[];t.forEach(i=>o.push(i.id)),this.formCtrls.selectedEmployeesIDs.setValue(o)}disableRadioList(){this.radioList.map(t=>t.disabled=!0)}changeGrouping(){this.formCtrls.orgId.reset(),this.formCtrls.selectedOrgIDs.reset()}getEmployeesCount(t){this.selectedCount=t}clearForm(){this.form.reset({id:0,groupingType:B.OPEN}),this.submitted=!1}getTitle(){return this.groupingTypeCtrl.value==this.groupingList.OPEN?"selectedEmployees":this.groupingTypeCtrl.value==this.groupingList.ORGANIZATIONS?"organization":this.groupingTypeCtrl.value==this.groupingList.LOCATION?"location":this.groupingTypeCtrl.value==this.groupingList.JOB_TITLE?"jobTitle":void 0}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Re.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-policy-group"]],features:[e.qOj],decls:20,vars:13,consts:[[1,"title-no-margin"],["title","generalInfo"],[1,"mt-2"],[1,"container-fluid","mt-4"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","ar_Name",3,"control","submitted"],["label","en_Name",3,"control","submitted"],[3,"control","submitted","disable"],[1,"col-12","mt-1"],["label","groupingType","titleClass","col-12 col-lg-2",3,"control","radioList","submitted","change"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[3,"title"],[1,"mt-4","px-2"],["class","col col-lg-6",4,"ngIf"],["align","end"],["icon","fas fa-save",3,"id","color","iconPositionBefore","onClick"],[1,"col","col-lg-6"],[3,"reset","onSelect","length"],["class","table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showSpaceTop","onChangePage","deleteRow",4,"ngIf"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showSpaceTop","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0),e._UZ(2,"page-title",1),e.qZA(),e._UZ(3,"mat-divider",2),e.TgZ(4,"mat-card-content",3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",4)(9,"div",7),e._UZ(10,"app-input",8),e.qZA(),e.TgZ(11,"div",7),e._UZ(12,"app-input",9),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"policy-group-type-dropdown",10),e.qZA(),e.TgZ(15,"div",11)(16,"app-radio-button",12),e.NdJ("change",function(){return o.changeGrouping()}),e.qZA()()()()()()()(),e.YNc(17,To,10,6,"mat-card",13),e.YNc(18,xo,9,3,"mat-card",13),e._UZ(19,"ngx-spinner")),2&t&&(e.xp6(7),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.ar_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.en_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.policyGroup_Type_ID)("submitted",o.submitted)("disable",o.policyGroupId>0),e.xp6(2),e.Q6J("control",o.formCtrls.groupingType)("radioList",o.radioList)("submitted",o.submitted),e.xp6(1),e.Q6J("ngIf",o.groupingTypeCtrl.value),e.xp6(1),e.Q6J("ngIf",o.policyGroupId>0))},dependencies:[n.O5,Y.a,fo._,q.I,oe.p,F.T,bo.f,D.a8,D.dn,D.n5,D.hq,Be.d,E.Ro,Co.X,g._Y,g.JL,g.sg],styles:[".navbar[_ngcontent-%COMP%]{background:#FFF!important}"]}),a})();const Do=["stepper"];function So(a,l){if(1&a&&e._UZ(0,"app-add-new-btn",3),2&a){const t=e.oxw();e.MGl("url","/org-management/",t.moduleId,"/policy-group/add"),e.Q6J("params",t.parentParam)}}let Ke=(()=>{class a extends J.U{constructor(){super(),this.activatedRoute.paramMap.subscribe(t=>{this.policyGroupId=Number(t.get("id"))??0})}ngOnInit(){}stepChanged(){this.stepper.selected.interacted=!1}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-policy-group-core"]],viewQuery:function(t,o){if(1&t&&e.Gf(Do,5),2&t){let i;e.iGM(i=e.CRH())&&(o.stepper=i.first)}},features:[e.qOj],decls:8,vars:3,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","addPolicyGroup"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"cards-no-shadow","has-fixed-title"],[1,"ptop-85"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ynx(2),e.YNc(3,So,1,2,"app-add-new-btn",2),e._UZ(4,"app-back-btn",3),e.BQk(),e.qZA(),e.TgZ(5,"mat-card-content",4)(6,"div",5),e._UZ(7,"app-add-policy-group"),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngIf",o.policyGroupId>0),e.xp6(1),e.MGl("url","/org-management/",o.moduleId,"/policy-group"),e.Q6J("params",o.pageParams))},dependencies:[n.O5,V.a,se.J,F.T,D.dn,D.n5,Io]}),a})();var R=p(3710);const Oo=[{path:"org-structure",data:{view:w.S.org_structure},children:[{path:"",redirectTo:"index",pathMatch:Ge.U.full},{path:"index",component:G,data:{view:w.S.org_structure_index},canActivate:[R.r]},{path:"add",component:ke,data:{view:w.S.add_org_structure},canActivate:[R.r]},{path:"edit/:orgStructureId",component:ke,data:{view:w.S.add_org_structure},canActivate:[R.r]},{path:"details/:orgStructureId",component:Wt,data:{view:w.S.org_structure_details},canActivate:[R.r]},{path:"kpis",component:lo,data:{view:w.S.org_kpis},canActivate:[R.r]}]},{path:"job-profile",data:{view:w.S.job_profile},children:[{path:"",redirectTo:"index",pathMatch:Ge.U.full},{path:"index",component:eo,data:{view:w.S.job_profile_index},canActivate:[R.r]},{path:"add",component:$e.g,data:{view:w.S.add_job_profile},canActivate:[R.r]},{path:"edit/:jobId",component:$e.g,data:{view:w.S.add_job_profile},canActivate:[R.r]},{path:"assign-job-to-org",component:to.A,data:{view:w.S.assign_job_to_org},canActivate:[R.r]}]},{path:"policy-group",data:{view:w.S.policy_group},children:[{path:"",redirectTo:"index",pathMatch:Ge.U.full},{path:"index",component:co,data:{view:w.S.policy_group_index},canActivate:[R.r]},{path:"add",component:Ke,data:{view:w.S.add_policy_group},canActivate:[R.r]},{path:"edit/:id",component:Ke,data:{view:w.S.add_policy_group},canActivate:[R.r]}]}];let Zo=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.Bz.forChild(Oo),u.Bz]}),a})();var Ao=p(62361);let Jo=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[n.ez,Zo,Ao.m]}),a})()},45390:(re,Q,p)=>{p.d(Q,{b:()=>Ue});var n=p(94650),u=p(95751),v=p(30671),S=p(22699),M=p(74513),j=p(15602),T=p(65938),U=p(24006),H=p(35478),K=p(89609),O=p(70137),_=p(57566),b=p(46896),J=p(4859),e=p(86405),W=p(49274);let q=(()=>{class c extends u.U{constructor(s,d,h){super(),this.employeeJobInfoService=s,this.dialogRef=d,this.job=h,this.CloseDate=new U.NI("",U.kI.required),this.submitted=!1}submit(){if(this.submitted=!0,this.CloseDate.valid){this.showLoading("close");let s={Employee_Job_Title_ID:this.job?.id,CloseDate:H.M.transformData(this.CloseDate.value)};this.employeeJobInfoService.close(s).subscribe(d=>{d.message.messageType==j.u.Success?(this.success(d?.message?.messageTypeName),this.CloseDate.reset(),this.submitted=!1,this.dialogRef.close()):this.errorList(d?.message?.messages),this.hideLoading("close")})}}}return c.\u0275fac=function(s){return new(s||c)(n.Y36(K._),n.Y36(T.so),n.Y36(T.WI))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-close-job-dialog"]],features:[n.qOj],decls:17,vars:11,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","close_job",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"container-fluid","mx-0","mt-3"],[1,"row"],[1,"col-md-4","col-5"],["label","date",3,"control","submitted"],[1,"col-4"],["label","close_job","icon","fas fa-save",1,"btn-large","mt-1","line-height-3","mr-0","ml-0",3,"color","iconPositionBefore","onClick"],["mat-dialog-actions","","align","end"],["mat-raised-button","",1,"btn","btn-light",3,"mat-dialog-close"],[3,"name"]],template:function(s,d){1&s&&(n.TgZ(0,"div",0)(1,"h4"),n._UZ(2,"page-title",1),n._uU(3),n.qZA(),n.TgZ(4,"button",2),n._UZ(5,"i",3),n.qZA()(),n.TgZ(6,"mat-dialog-content",4)(7,"div",5)(8,"div",6),n._UZ(9,"app-datepicker",7),n.qZA(),n.TgZ(10,"div",8)(11,"submit-btn",9),n.NdJ("onClick",function(){return d.submit()}),n.qZA()()()(),n.TgZ(12,"div",10)(13,"button",11),n._uU(14),n.ALo(15,"translate"),n.qZA()(),n._UZ(16,"ngx-spinner",12)),2&s&&(n.xp6(3),n.hij(" ",d.msgTranslate(null==d.job||null==d.job.core_Job_Title?null:d.job.core_Job_Title.ar_Name,null==d.job||null==d.job.core_Job_Title?null:d.job.core_Job_Title.en_Name)," "),n.xp6(1),n.Q6J("mat-dialog-close",!1),n.xp6(5),n.Q6J("control",d.CloseDate)("submitted",d.submitted),n.xp6(2),n.Q6J("color",d.btn.darkBlue)("iconPositionBefore",!1),n.xp6(2),n.Q6J("mat-dialog-close",!1),n.xp6(1),n.hij(" ",n.lcZ(15,9,"General.cancel")," "),n.xp6(2),n.Q6J("name","close"))},dependencies:[O.Q,_.p,b.T,J.lW,T.ZT,T.uh,T.xY,T.H8,e.Ro,W.X$]}),c})();var F=p(61757),ee=p(18521);let te=(()=>{class c extends ee.K{constructor(){super()}create(s){return this.post("Personnel/Employees/Create_EmployeeManger",s)}getList(s,d){return this.get("Personnel/Employees/GetList_EmployeeManger",{params:{...d,orgid:s}})}getAll(s,d){return this.get("Personnel/Employees/GetAll_EmployeeManger",{params:{prtid:s,orgid:d}})}Delete(s){return this.delete("Personnel/Employees/Delete_EmployeeManger",{params:s})}}return c.\u0275fac=function(s){return new(s||c)},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();var D=p(93410),E=p(44850);let x=(()=>{class c extends u.U{constructor(s,d,h){super(),this.EmployeeAssignAsOrgManagerService=s,this.org=d,this.dialogRef=h,this.mandatoryColomns=["employee","startDate","endDate","actions"],this.optionalColomns=[],this.isLoaded=!1,this.submitted=!1,this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,M.S.emp_job_info_assign_manager_sec)}ngOnInit(){this.form=this.fb.group({from_Date:[null,[U.kI.required]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.org.person_Instance_ID>0&&this.getList(this.firstPage)}getList(s,d){this.dataSource=new v.by(null),this.isLoaded=!1,this.page.pageIndex=s,d&&(this.page.dialogSize=d),this.EmployeeAssignAsOrgManagerService.getList(this.org.core_Org?.id,{PageNumber:s,pageSize:this.page.dialogSize}).pipe(this.cancelRequest()).subscribe(C=>{C.message.messageType==j.u.Success?(this.dataSource=new v.by((0,F.GP)(C.data)),this.page.length=C.meta.totalItemCount,this.isLoaded=!0):this.errorList(C?.message?.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){const s={Person_Instance_ID:this.org.person_Instance_ID,Person_Instance_Org_ID:this.org.id,From_Date:H.M.mapDateReverse(this.form.value.from_Date)};this.create(s)}}create(s){this.showLoading("manager"),this.EmployeeAssignAsOrgManagerService.create(s).subscribe(d=>{d?.message?.messageType==j.u.Success?(this.clearForm(),this.addSuccessfullyMsg(d?.message?.messageTypeName),this.getList(this.firstPage)):this.errorList(d?.message?.messages),this.hideLoading("manager")})}onDelete(s){this.deleteDialog(`${s.employee} (${s.startDate} - ${s.endDate})`).subscribe(h=>{h&&this.delete(s)})}delete(s){let d={prtid:s.person_Instance_ID,orgperid:s.person_Instance_Org_ID,fromdate:H.M.mapDateReverse(s.from_Date)};this.showLoading("manager"),this.EmployeeAssignAsOrgManagerService.Delete(d).subscribe(h=>{h.message.messageType==j.u.Success?(this.deleteSuccessfullyMsg(h?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.dialogSize)):this.errorList(h?.message?.messages),this.hideLoading("manager")})}clearForm(){this.form.reset(),this.submitted=!1}}return c.\u0275fac=function(s){return new(s||c)(n.Y36(te),n.Y36(T.WI),n.Y36(T.so))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-assign-as-org-manager-dialog"]],features:[n.qOj],decls:15,vars:15,consts:[[3,"name"],["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","assignManager",1,"d-inline-block","mtop-5"],["mat-icon-button","","mat-dialog-close","",1,"float-right","mb-1","bg-light-danger","mr-1"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],[3,"formGroup"],[1,"row","ptop-20"],[1,"col-md-6","col-4"],["label","date",3,"control","submitted"],[1,"col-4"],["icon","fas fa-save",1,"btn-large","mt-1","line-height-3",3,"color","iconPositionBefore","onClick"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","isDialogSize","showFilter","showSpaceTop","onChangePage","deleteRow"]],template:function(s,d){1&s&&(n._UZ(0,"ngx-spinner",0),n.TgZ(1,"div",1)(2,"h4"),n._UZ(3,"page-title",2),n.qZA(),n.TgZ(4,"button",3),n._UZ(5,"i",4),n.qZA()(),n.TgZ(6,"mat-dialog-content",5)(7,"form",6)(8,"div",7)(9,"div",8),n._UZ(10,"app-datepicker",9),n.qZA(),n.TgZ(11,"div",10)(12,"submit-btn",11),n.NdJ("onClick",function(){return d.submit()}),n.qZA()()()(),n._UZ(13,"mat-divider"),n.TgZ(14,"app-material-table",12),n.NdJ("onChangePage",function(C){return d.getList(C.pageIndex+1,C.pageSize)})("deleteRow",function(C){return d.onDelete(C)}),n.qZA()()),2&s&&(n.Q6J("name","manager"),n.xp6(7),n.Q6J("formGroup",d.form),n.xp6(3),n.Q6J("control",d.formCtrls.from_Date)("submitted",d.submitted),n.xp6(2),n.Q6J("color",d.btn.darkBlue)("iconPositionBefore",!1),n.xp6(2),n.Q6J("isLoaded",d.isLoaded)("dataSource",d.dataSource)("mandatoryColomns",d.mandatoryColomns)("optionalColomns",d.optionalColomns)("page",d.page)("actions",d.rowFunctions)("isDialogSize",!0)("showFilter",!1)("showSpaceTop",!1))},dependencies:[O.Q,D.I,_.p,b.T,J.lW,E.d,T.ZT,T.uh,T.xY,e.Ro,U._Y,U.JL,U.sg]}),c})();var G=p(36895),g=p(98814),L=p(58313),N=p(9615),Y=p(73546),V=p(10266),se=p(96308),be=p(98739);function oe(c,f){1&c&&(n.TgZ(0,"th",18),n._uU(1,"Ser"),n.qZA())}function ne(c,f){1&c&&(n.TgZ(0,"td",19),n._UZ(1,"i",20),n.qZA())}function k(c,f){1&c&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"status")))}function ae(c,f){if(1&c&&(n.TgZ(0,"td",19),n._uU(1),n.qZA()),2&c){const s=f.$implicit,d=n.oxw(3);n.xp6(1),n.hij(" ",d.msgTranslate(null==s.core_Status?null:s.core_Status.ar_Name,null==s.core_Status?null:s.core_Status.en_Name)," ")}}function Ce(c,f){1&c&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"from_Date")))}function ye(c,f){if(1&c&&(n.TgZ(0,"td",19),n._uU(1),n.ALo(2,"date"),n.qZA()),2&c){const s=f.$implicit;n.xp6(1),n.hij(" ",n.xi3(2,1,null==s?null:s.from_Date,"dd-MM-yyyy")," ")}}function Te(c,f){1&c&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"to_Date")))}function le(c,f){if(1&c&&(n.TgZ(0,"td",19),n._uU(1),n.ALo(2,"date"),n.qZA()),2&c){const s=f.$implicit;n.xp6(1),n.hij(" ",n.xi3(2,1,null==s?null:s.to_Date,"dd-MM-yyyy")," ")}}function I(c,f){1&c&&n._UZ(0,"th",18)}function ve(c,f){1&c&&(n.TgZ(0,"th",25),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"org actions"),""))}function w(c,f){if(1&c&&(n.TgZ(0,"thead")(1,"tr",24)(2,"th",25),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"th",25),n._uU(6),n.ALo(7,"translate"),n.qZA(),n.TgZ(8,"th",25),n._uU(9),n.ALo(10,"translate"),n.qZA(),n.TgZ(11,"th",25),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"th",25),n._uU(15),n.ALo(16,"translate"),n.qZA(),n.TgZ(17,"th",25),n._uU(18),n.ALo(19,"translate"),n.qZA(),n.YNc(20,ve,3,3,"th",26),n.qZA()()),2&c){const s=n.oxw(5);n.xp6(3),n.hij(" ",n.lcZ(4,7,"organization"),""),n.xp6(3),n.hij(" ",n.lcZ(7,9,"from_Date"),""),n.xp6(3),n.hij(" ",n.lcZ(10,11,"job"),""),n.xp6(3),n.hij(" ",n.lcZ(13,13,"from_Date"),""),n.xp6(3),n.hij(" ",n.lcZ(16,15,"counted"),""),n.xp6(3),n.hij(" ",n.lcZ(19,17,"job actions"),""),n.xp6(2),n.Q6J("ngIf",!s.hideActions)}}function de(c,f){if(1&c&&(n.TgZ(0,"td",35),n._uU(1),n.qZA()),2&c){const s=n.oxw(2).$implicit,d=n.oxw(5);n.Q6J("rowSpan",null==s.core_Person_Instance_Job_Title?null:s.core_Person_Instance_Job_Title.length),n.xp6(1),n.hij(" ",d.msgTranslate(null==s||null==s.core_Org?null:s.core_Org.ar_Name,null==s||null==s.core_Org?null:s.core_Org.en_Name)," ")}}function z(c,f){if(1&c&&(n.TgZ(0,"td",36),n._uU(1),n.ALo(2,"date"),n.qZA()),2&c){const s=n.oxw(2).$implicit;n.Q6J("rowSpan",null==s.core_Person_Instance_Job_Title?null:s.core_Person_Instance_Job_Title.length),n.xp6(1),n.hij(" ",n.xi3(2,2,null==s?null:s.from_Date,"dd-MM-yyyy")," ")}}function me(c,f){1&c&&(n.TgZ(0,"span",37),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"yes")," "))}function xe(c,f){1&c&&(n.TgZ(0,"span",38),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"no")," "))}function Ie(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"td",35)(1,"app-row-functions",39),n.NdJ("onAction",function(h){n.CHM(s);const C=n.oxw(2).$implicit,P=n.oxw(2).$implicit,$=n.oxw(3);return n.KtG($.orgOnAction(h,P,C))}),n.qZA()()}if(2&c){const s=n.oxw(2).$implicit,d=n.oxw(5);n.Q6J("rowSpan",null==s.core_Person_Instance_Job_Title?null:s.core_Person_Instance_Job_Title.length),n.xp6(1),n.Q6J("actions",d.orgRowFunctions)}}function ge(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"tr",28),n.YNc(1,de,2,2,"td",29),n.YNc(2,z,3,5,"td",30),n.TgZ(3,"td",31),n._uU(4),n.qZA(),n.TgZ(5,"td",31),n._uU(6),n.ALo(7,"date"),n.qZA(),n.TgZ(8,"td",31),n.YNc(9,me,3,3,"span",32),n.YNc(10,xe,3,3,"ng-template",null,33,n.W1O),n.qZA(),n.TgZ(12,"td",31)(13,"app-row-functions",34),n.NdJ("editRow",function(){const C=n.CHM(s).$implicit,P=n.oxw().$implicit,$=n.oxw(2).$implicit,pe=n.oxw(3);return pe.currentAction.emit(null),n.KtG(pe.toEdit($,P,C))})("deleteRow",function(){const C=n.CHM(s).$implicit,P=n.oxw(3).$implicit,$=n.oxw(3);return n.KtG($.onDeleteJob(P,C))})("onAction",function(h){const P=n.CHM(s).$implicit,$=n.oxw(6);return n.KtG($.jobOnAction(h,P))}),n.qZA()(),n.YNc(14,Ie,2,2,"td",29),n.qZA()}if(2&c){const s=f.$implicit,d=f.index,h=n.MAs(11),C=n.oxw(6);n.xp6(1),n.Q6J("ngIf",0==d),n.xp6(1),n.Q6J("ngIf",0==d),n.xp6(2),n.hij(" ",C.msgTranslate(null==s||null==s.core_Job_Title?null:s.core_Job_Title.ar_Name,null==s||null==s.core_Job_Title?null:s.core_Job_Title.en_Name)," "),n.xp6(2),n.hij(" ",n.xi3(7,8,null==s?null:s.from_Date,"dd-MM-yyyy")," "),n.xp6(3),n.Q6J("ngIf",null==s?null:s.is_Manpower_Affected)("ngIfElse",h),n.xp6(4),n.Q6J("actions",C.jobRowFunctions),n.xp6(1),n.Q6J("ngIf",0==d&&!C.hideActions)}}function De(c,f){if(1&c&&(n.ynx(0),n.YNc(1,ge,15,11,"tr",27),n.BQk()),2&c){const s=f.$implicit;n.xp6(1),n.Q6J("ngForOf",s.core_Person_Instance_Job_Title)}}function _e(c,f){if(1&c&&(n.TgZ(0,"table",22),n.YNc(1,w,21,19,"thead",0),n.TgZ(2,"tbody"),n.YNc(3,De,2,1,"ng-container",23),n.qZA()()),2&c){const s=n.oxw(),d=s.index,h=s.$implicit;n.ekj("nested-job-table",0===d),n.xp6(1),n.Q6J("ngIf",0===d),n.xp6(2),n.Q6J("ngForOf",null==h?null:h.core_Person_Instance_Org)}}function Se(c,f){if(1&c&&(n.TgZ(0,"td",19),n.YNc(1,_e,4,4,"table",21),n.qZA()),2&c){const s=f.$implicit;n.xp6(1),n.Q6J("ngIf",(null==s||null==s.core_Person_Instance_Org?null:s.core_Person_Instance_Org.length)>0)}}function Oe(c,f){1&c&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&c&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"actions")))}function Ze(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"a",41),n.NdJ("click",function(){n.CHM(s);const h=n.oxw(2).$implicit,C=n.oxw(3);return n.KtG(C.onDeleteStatus(h))}),n.ALo(1,"translate"),n._UZ(2,"i",42),n.qZA()}if(2&c){const s=n.oxw().$implicit;n.Tol(s.color),n.Q6J("matTooltip",n.lcZ(1,5,s.name)),n.xp6(2),n.Tol(s.icon)}}function Ae(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"a",41),n.NdJ("click",function(){n.CHM(s);const h=n.oxw(2).$implicit,C=n.oxw(3);return n.KtG(C.onAssign(h))}),n.ALo(1,"translate"),n._UZ(2,"i",42),n.qZA()}if(2&c){const s=n.oxw().$implicit;n.Tol(s.color),n.Q6J("matTooltip",n.lcZ(1,5,s.name)),n.xp6(2),n.Tol(s.icon)}}function Je(c,f){if(1&c&&(n.ynx(0),n.YNc(1,Ze,3,7,"a",40),n.YNc(2,Ae,3,7,"a",40),n.BQk()),2&c){const s=f.$implicit,d=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf","delete"==s.name.toLowerCase()&&0==(null==d.core_Person_Instance_Org?null:d.core_Person_Instance_Org.length)),n.xp6(1),n.Q6J("ngIf","assign"==s.name.toLowerCase())}}function Le(c,f){if(1&c&&(n.TgZ(0,"td",19),n.YNc(1,Je,3,2,"ng-container",23),n.qZA()),2&c){const s=n.oxw(3);n.xp6(1),n.Q6J("ngForOf",s.statusRowFunctions.basic)}}function we(c,f){1&c&&n._UZ(0,"tr",43)}function Ee(c,f){1&c&&n._UZ(0,"tr",44)}function Ne(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"app-prime-paginator",45),n.NdJ("onChangePage",function(h){n.CHM(s);const C=n.oxw(3);return n.KtG(C.getList(h.pageIndex+1,h.pageSize))}),n.qZA()}if(2&c){const s=n.oxw(3);n.Q6J("page",s.page)("isDialogSize",!0)}}function Pe(c,f){if(1&c){const s=n.EpF();n.TgZ(0,"mat-paginator",46),n.NdJ("page",function(h){n.CHM(s);const C=n.oxw(3);return n.KtG(C.getList(h.pageIndex+1,h.pageSize))}),n.qZA()}if(2&c){const s=n.oxw(3);n.Q6J("pageSizeOptions",s.page.pageSizeOptions)("length",s.page.length)("pageSize",s.page.dialogSize)("pageIndex",s.page.pageIndex-1)("hidePageSize",!0)("showFirstLastButtons",!1)}}function Me(c,f){if(1&c&&(n.ynx(0),n.TgZ(1,"mat-card-content")(2,"div",4)(3,"table",5),n.ynx(4,6),n.YNc(5,oe,2,0,"th",7),n.YNc(6,ne,2,0,"td",8),n.BQk(),n.ynx(7,9),n.YNc(8,k,3,3,"th",7),n.YNc(9,ae,2,1,"td",8),n.BQk(),n.ynx(10,10),n.YNc(11,Ce,3,3,"th",7),n.YNc(12,ye,3,4,"td",8),n.BQk(),n.ynx(13,11),n.YNc(14,Te,3,3,"th",7),n.YNc(15,le,3,4,"td",8),n.BQk(),n.ynx(16,12),n.YNc(17,I,1,0,"th",7),n.YNc(18,Se,2,1,"td",8),n.BQk(),n.ynx(19,13),n.YNc(20,Oe,3,3,"th",7),n.YNc(21,Le,2,1,"td",8),n.BQk(),n.YNc(22,we,1,0,"tr",14),n.YNc(23,Ee,1,0,"tr",15),n.qZA()()(),n.YNc(24,Ne,1,2,"app-prime-paginator",16),n.YNc(25,Pe,1,6,"mat-paginator",17),n.BQk()),2&c){const s=n.oxw(2);n.xp6(3),n.Q6J("dataSource",s.dataSource),n.xp6(19),n.Q6J("matHeaderRowDef",s.displayedColumns),n.xp6(1),n.Q6J("matRowDefColumns",s.displayedColumns),n.xp6(1),n.Q6J("ngIf",!s.hideActions&&s.page.length>s.page.dialogSize),n.xp6(1),n.Q6J("ngIf",s.hideActions&&s.page.length>s.page.dialogSize)}}function ie(c,f){if(1&c&&(n.TgZ(0,"div",47),n._UZ(1,"app-table-skeleton",48),n.qZA()),2&c){const s=n.oxw(2);n.xp6(1),n.Q6J("displayedColumns",s.displayedColumns)}}function ue(c,f){if(1&c&&(n.TgZ(0,"div",49),n._UZ(1,"img",50)(2,"br"),n._uU(3),n.ALo(4,"translate"),n.qZA()),2&c){const s=n.oxw(2);n.xp6(1),n.Q6J("src",s.assets.empty,n.LSH),n.xp6(2),n.hij(" ",n.lcZ(4,2,"emptytable")," ")}}function he(c,f){if(1&c&&(n.ynx(0),n.YNc(1,Me,26,5,"ng-container",0),n.YNc(2,ie,2,1,"div",2),n.YNc(3,ue,5,4,"div",3),n.BQk()),2&c){const s=n.oxw();n.xp6(1),n.Q6J("ngIf",(null==s.dataSource||null==s.dataSource.data?null:s.dataSource.data.length)>0),n.xp6(1),n.Q6J("ngIf",!(s.isLoaded||null!=s.dataSource&&s.dataSource.data)),n.xp6(1),n.Q6J("ngIf",0==(null==s.dataSource||null==s.dataSource.data?null:s.dataSource.data.length)&&s.isLoaded||!s.dataSource&&s.isLoaded)}}var Z=(()=>{return(c=Z||(Z={})).assign="assign",c.append="append",c.edit="edit",c.delete="delete",c.close="close",c.assignManager="assignManager",Z;var c})();let Ue=(()=>{class c extends u.U{constructor(s,d){super(),this.employeeJobInformationService=s,this.dialog=d,this.hideActions=!1,this.isMatPaginator=!1,this.rowToEdit=new n.vpe,this.afterDelete=new n.vpe,this.currentAction=new n.vpe,this.employeeId=0,this.employeeInstanceId=0,this.displayedColumns=["status","status_date","status_end_date","org","actions"],this.isLoaded=!1,this.jobRowFunctions={basic:[],dropdown:[]},this.orgRowFunctions={basic:[],dropdown:[]},this.statusRowFunctions={basic:[],dropdown:[]},this.employeeId=S.w.EmployeeId,this.employeeInstanceId=S.w.EmployeeInstanceId,S.w.employeeInstanceId$.subscribe(h=>this.employeeInstanceId=h),this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,M.S.emp_job_info_sec),this.jobRowFunctions.basic=this.rowFunctions.basic.filter(h=>{let C=h.name.toLocaleLowerCase();return C.includes(Z.edit)||C.includes(Z.delete)||C.includes(Z.close)}),this.orgRowFunctions.basic=this.rowFunctions.basic.filter(h=>!this.jobRowFunctions.basic.map(C=>C.id).includes(h.id)),this.statusRowFunctions.basic=this.rowFunctions.dropdown}ngOnChanges(s){s.hasUpdate&&s.hasUpdate.currentValue&&this.employeeInstanceId>0&&this.getList(this.firstPage),this.hideActions&&(this.statusRowFunctions.basic=this.statusRowFunctions.basic.filter(d=>d.name.toLowerCase()===Z.delete),this.jobRowFunctions.basic=this.jobRowFunctions.basic.filter(d=>d.name.toLowerCase()===Z.delete))}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.employeeId>0&&this.getList(this.firstPage)}getList(s,d){this.dataSource=new v.by(null),this.isLoaded=!1,this.page.pageIndex=s,this.isLoaded=!1,d&&(this.page.dialogSize=d),this.employeeJobInformationService.getList(this.employeeId,{PageNumber:s,pageSize:this.page.dialogSize}).pipe(this.cancelRequest()).subscribe(C=>{C.message.messageType==j.u.Success?(this.dataSource=new v.by(C.data),this.page.length=C.meta.totalItemCount,this.isLoaded=!0):this.errorList(C?.message?.messages)})}toEdit(s,d,h){this.rowToEdit.emit({status:s,org:d,job:h})}onDeleteJob(s,d){let h=this.msgTranslate(d.core_Job_Title.ar_Name,d.core_Job_Title.en_Name);this.deleteDialog(h).subscribe(C=>{C&&this.delete(s,d)})}onDeleteStatus(s){let d=this.msgTranslate(s.core_Status.ar_Name,s.core_Status.en_Name);this.deleteDialog(d).subscribe(h=>{h&&this.delete(s,null,!0)})}delete(s,d,h=!1){this.showLoading("table"),this.employeeJobInformationService.Delete({employeeStatusID:s.id,employeeJobTitleID:d?.id??0,DeleteStatusIfOrphan:h}).subscribe(P=>{P.message.messageType==j.u.Success?(this.deleteSuccessfullyMsg(P?.message?.messageTypeName),1==this.dataSource.data.length&&this.currentPage>1?this.getList(this.prevPage,this.page.dialogSize):(this.getList(this.currentPage,this.page.dialogSize),this.afterDelete.emit(s))):this.errorList(P?.message?.messages),this.hideLoading("table")})}openCloseDialog(s){this.dialog.open(q,{data:s,height:"auto",minWidth:"40%",autoFocus:!1,panelClass:"dialog-emp-form"}).afterClosed().subscribe(d=>{})}onAssign(s){this.currentAction.emit(Z.assign),this.toEdit(s,null,null)}orgOnAction(s,d,h){s.fun.name==Z.assignManager&&this.openAssignManagerDialog(h),s.fun.name==Z.append&&(this.currentAction.emit(Z.append),this.toEdit(d,h,null))}jobOnAction(s,d){"close"==s.fun.name&&this.openCloseDialog(d)}openAssignManagerDialog(s){this.dialog.open(x,{data:s,minWidth:"50%",height:"auto",autoFocus:!1,panelClass:"dialog-emp-form"}).afterClosed().subscribe(d=>{})}}return c.\u0275fac=function(s){return new(s||c)(n.Y36(K._),n.Y36(T.uw))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-emp-job-table"]],inputs:{hasUpdate:"hasUpdate",hideActions:"hideActions",isMatPaginator:"isMatPaginator"},outputs:{rowToEdit:"rowToEdit",afterDelete:"afterDelete",currentAction:"currentAction"},features:[n.qOj,n.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[3,"name"],["class","mtop-25",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"mat-elevation-z8","f-w","table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Ser"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","status_date"],["matColumnDef","status_end_date"],["matColumnDef","org"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","isDialogSize","onChangePage",4,"ngIf"],[3,"pageSizeOptions","length","pageSize","pageIndex","hidePageSize","showFirstLastButtons","page",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"fas","fa-bars"],["class","table table-responsive-sm",3,"nested-job-table",4,"ngIf"],[1,"table","table-responsive-sm"],[4,"ngFor","ngForOf"],[1,"border-0",2,"color","#5a5a5a"],[1,"border-top-0","padding-10"],["class","border-top-0 padding-10",4,"ngIf"],["style","color: #374761","class","border-top-0 border-bottom-1",4,"ngFor","ngForOf"],[1,"border-top-0","border-bottom-1",2,"color","#374761"],["class","padding-10 vertical-align-middle",3,"rowSpan",4,"ngIf"],["class","padding-10",3,"rowSpan",4,"ngIf"],[1,"padding-10"],["class","success",4,"ngIf","ngIfElse"],["no",""],["iconSize","font-small-3",3,"actions","editRow","deleteRow","onAction"],[1,"padding-10","vertical-align-middle",3,"rowSpan"],[1,"padding-10",3,"rowSpan"],[1,"success"],[1,"danger"],["iconSize","font-small-3",3,"actions","onAction"],[3,"class","matTooltip","click",4,"ngIf"],[3,"matTooltip","click"],[1,"font-medium-1","mr-2","p-0"],["mat-header-row",""],["mat-row",""],[3,"page","isDialogSize","onChangePage"],[3,"pageSizeOptions","length","pageSize","pageIndex","hidePageSize","showFirstLastButtons","page"],[1,"mtop-25"],[3,"displayedColumns"],[1,"text-center"],[3,"src"]],template:function(s,d){1&s&&(n.YNc(0,he,4,3,"ng-container",0),n._UZ(1,"ngx-spinner",1)),2&s&&(n.Q6J("ngIf",d.employeeId>0),n.xp6(1),n.Q6J("name","table"))},dependencies:[G.sg,G.O5,g.I,L.h,N.m,Y.dn,V.gM,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,se.YE,se.nU,be.NW,e.Ro,G.uU,W.X$],styles:[".table-container[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]{padding:5px!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]{font-size:12px}.nested-job-table[_ngcontent-%COMP%]{margin:-50px 0 0}.nested-job-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none;font-weight:400}.nested-job-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%], .table-responsive-sm[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%]{border:0}  .mat-paginator[ng-reflect-hide-page-size=true] .mat-paginator-range-label{display:none}"]}),c})()},45679:(re,Q,p)=>{p.d(Q,{U:()=>D}),p(95751),p(22699),p(33975),p(35478),p(89609),p(70137),p(12613),p(57566),p(29467),p(18183),p(68506),p(85443),p(15362),p(50260),p(99892),p(45390);var D=(()=>{return(x=D||(D={})).assign="assign",x.append="append",x.edit="edit",x.delete="delete",x.close="close",x.assignManager="assignManager",D;var x})()},61757:(re,Q,p)=>{p.d(Q,{GP:()=>K,JB:()=>H,M3:()=>M,PI:()=>U,hN:()=>S,i5:()=>v,kI:()=>j,zB:()=>T});var n=p(50046),u=p(35478);function v(O){return O.map(_=>({..._,custodies:(0,u._)(_.core_Covenant?.ar_Name,_.core_Covenant?.en_Name),froM_DATE:u.M.mapDate(_.fromDate),endDate:u.M.mapDate(_.toDate),date:u.M.mapDate(_?.fromDate)+(_?.toDate?" - "+u.M.mapDate(_?.toDate):"")}))}function S(O){return O.map(_=>({..._,plan:(0,u._)(_.att_Plan?.ar_Name,_.att_Plan?.en_Name),employee:(0,u._)(_.core_Person_Instance?.core_Person?.ar_Name,_.core_Person_Instance?.core_Person?.en_Name),startDate:u.M.mapDate(_.fromDate),toDateOriginal:_.toDate,toDate:u.M.mapDate(_.toDate)}))}function M(O){return O.map(_=>({..._,insuranceOffice:(0,u._)(_.core_Insurance_Office?.ar_Name,_.core_Insurance_Office?.en_Name),fromDate:u.M.mapDate(_.froM_DATE),endDate:u.M.mapDate(_.enD_DATE),date:u.M.mapDate(_?.froM_DATE)+(_?.enD_DATE?" - "+u.M.mapDate(_?.enD_DATE):"")}))}function j(O){let _=O.map(b=>({...b,country:(0,u._)(b.comm_Country?.ar_Name,b.comm_Country?.en_NAme),governorate:(0,u._)(b.comm_Governorate?.ar_Name,b.comm_Governorate?.en_Name),froM_DATE:u.M.mapDate(b.from_Date),tO_DATE:u.M.mapDate(b.to_Date)}));return _.map(b=>{b.allAddress=`${b.location??"-"}, ${b.governorate??"-"}`,b.date=b?.froM_DATE+(b?.to_Date?" - "+b?.tO_DATE:"")}),_}function T(O){return O.map(_=>({..._,documentName:(0,u._)(_.ar_Name_Type,_.en_Name_Type),attachmentType:n.g.getValue(_.is_Attached),attachment:_.attachmentFilePath?"/"+_.attachmentFilePath:""}))}function U(O){return O.map(_=>({..._,contractType:(0,u._)(_.core_Contract_Type?.ar_Name,_.core_Contract_Type?.en_Name),start_date:u.M.mapDate(_.starT_DATE),end_date:u.M.mapDate(_.enD_DATE),actual_End_Date:u.M.mapDate(_.actual_End_Date)}))}function H(O){return O.map(_=>({..._,supervisor:(0,u._)(_.manager?.core_Person?.ar_Name,_.manager?.core_Person?.en_Name),fromDate:u.M.mapDate(_.from_Date),toDate:u.M.mapDate(_.tO_Date)}))}function K(O){return O.map(_=>({..._,employee:(0,u._)(_.core_Person_Instance?.core_Person?.ar_Name,_.core_Person_Instance?.core_Person?.en_Name),startDate:u.M.mapDate(_.from_Date),endDate:u.M.mapDate(_.to_Date)}))}},89609:(re,Q,p)=>{p.d(Q,{_:()=>S});var n=p(18521),u=p(26315),v=p(94650);let S=(()=>{class M extends n.K{constructor(){super(),this.expand=`${u.db.Core_Person_Instance_Org}/${u.db.core_Person_Instance_Job_Title},\n    ${u.db.Core_Person_Instance_Org}.${u.db.core_Org},${u.db.Core_Person_Instance_Org}/${u.db.core_Person_Instance_Job_Title}.${u.db.Core_Job_Title},\n    ${u.db.core_Status}, ${u.db.core_Status_Properties}`}create(T){return this.post("Personnel/Employees/Create_EmployeeStatusPosition",T)}update(T){return this.post("Personnel/Employees/Edit_EmployeeStatusPosition",T)}appendJob(T){return this.post("Personnel/Employees/AppendJob",T)}assignOrgAndJob(T){return this.post("Personnel/Employees/AssignOrgAndJob",T)}getStatusPositionCard(T){return this.get("Personnel/Employees/Get_StatusPositionCard",{params:{Person_Instance_ID:T}})}getList(T,U){return this.get("Personnel/Employees/GetList_EmployeeStatusPosition",{params:{...U,$filter:`Person_Instance_ID  eq ${T}`,$expand:this.expand}})}getAll(T){return this.get("Personnel/Employees/GetAll_EmployeeStatusPosition",{params:{$filter:`Person_Instance_ID  eq ${T}`,$expand:this.expand}})}getAllCurrentJobsByEmployeeId(T){return this.get("personnel/Employees/GetAll_Current_Job_Emp",{params:{PerinsID:T}})}Delete(T){return this.delete("Personnel/Employees/Delete_EmployeeStatusPosition",{params:T})}close(T){return this.post("Personnel/Employees/Close_EmployeeStatusPosition",null,{params:T})}}return M.\u0275fac=function(T){return new(T||M)},M.\u0275prov=v.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})()},50046:(re,Q,p)=>{p.d(Q,{g:()=>n});var u,n=(()=>{return(u=n||(n={}))[u.attached=1]="attached",u[u.handDelivery=2]="handDelivery",u[u.notNeed=3]="notNeed",n;var u})();(u=n||(n={})).getValue=function v(S){switch(S){case u.attached:return"attachment";case u.handDelivery:return"isHandDelivered";case u.notNeed:return"notNeed";default:return""}}}}]);