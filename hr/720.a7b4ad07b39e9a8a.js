"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[720],{90720:(se,Q,c)=>{c.r(Q),c.d(Q,{OrgManagementModule:()=>Po});var n=c(36895),g=c(80458),v=c(30671),D=c(35478);function M(a,s){let i,t=[],o=[];for(;o.length<a.core_Org_Structure_Org.length;)y(a.core_Org_Structure_Org,o,t);return i=[{label:"structure",type:"org",styleClass:"structure-node",expanded:!0,data:{parentId:null,org:null,orgType:null,numEmp:0,structure:{id:null,ar_Name:a.ar_Name,en_Name:a.en_Name}},children:[]}],o.map(l=>{let f={label:`${l.core_Org?.code} - ${(0,D._)(l.core_Org?.ar_Name,l.core_Org?.en_Name)}`,type:"org",styleClass:"org-node",expanded:!1,data:{parentId:l.parenT_ID,org:l.core_Org,orgType:{id:l.core_Org_TYPE?.id,ar_Name:l.core_Org_TYPE?.ar_Name,en_Name:l.core_Org_TYPE?.en_Name},structure:null,structureId:s,numEmp:l.numEmp},children:[]};l.parenT_ID?P(f,i[0].children):i[0].children.push(f)}),i}function y(a,s,t){a.forEach(o=>{(null==o.parenT_ID||t.includes(o.parenT_ID))&&!t.includes(o.orG_ID)&&(s.push(o),t.push(o.orG_ID))})}function P(a,s){s.map(t=>{t.data.org?.id!=a.data.parentId||t.children.push(a)}),s.map(t=>{P(a,t.children)})}function $(a){let s=[{label:a[0].code,type:"job-title",styleClass:"job-title-node",expanded:!1,data:a[0],children:[]}];return K(s[0]),s}function K(a){a.data.chiledJobTitles?.map(s=>{let t={label:s.code,type:"job-title",styleClass:"job-title-node",expanded:!1,data:s,children:[]};a.children.push(t),K(t)})}function O(a,s){let t=a.findIndex(i=>i.id==s),o=[];return t>=0&&(o=[{label:(0,D._)(a[t]?.ar_Name,a[t]?.en_Name),type:"resources",styleClass:a[t].isSolidEmp?"":"dashed-border",expanded:!1,data:a[t],children:[]}],a.filter(i=>i.id!=s).map(i=>{let l={label:(0,D._)(i.ar_Name,i.en_Name),type:"resources",styleClass:i.isSolidEmp?"":"dashed-border",expanded:!1,data:i,children:[]};i.parentID==s?o[0].children.push(l):i.id!=s&&m(l,o[0].children)})),o}function m(a,s){s.map(t=>{t.data.id!=a.data.parentID||t.children.push(a)}),s.map(t=>{m(a,t.children)})}var b=c(15602),Z=c(95751),e=c(94650),W=c(56808),k=c(93410),U=c(46896),X=c(60544),ee=c(91373),I=c(73546),L=c(49274);let S=(()=>{class a extends Z.U{constructor(t){super(),this.orgStructureService=t,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","froM_DATE","tO_DATE","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.dataSource=new v.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.orgStructureService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(l.message.messageType==b.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by(function N(a){return a.map(s=>({...s,froM_DATE:D.M.mapDate(s.froM_DATE),tO_DATE:D.M.mapDate(s.tO_DATE)}))}(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.orgStructureService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-index"]],features:[e.qOj],decls:9,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","orgStructure",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"app-material-table",4),e.NdJ("onChangePage",function(l){return o.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return o.onDelete(l)}),e.qZA()()()(),e.TgZ(6,"side-helping-menu",5),e.ALo(7,"translate"),e._UZ(8,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(4),e.Q6J("globalFunctions",o.globalFunctions),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("exportService",o.orgStructureService)("actions",o.rowFunctions),e.xp6(1),e.s9C("title",e.lcZ(7,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[k.I,U.T,X.c,ee.b,I.a8,I.n5,L.X$]}),a})();var C=c(24006),T=c(78937),A=c(70137),E=c(25273),z=c(61064),te=c(52682),pe=c(56500),oe=c(57566),ne=c(68506),H=c(10805),ae=c(57772),x=c(65938),be=c(8675),J=c(74513),de=c(77304),q=c(4859),me=c(26941);let Ce=(()=>{class a extends Z.U{constructor(t,o,i,l){super(),this.orgStructureService=t,this.organizationsService=o,this.dialogRef=i,this.data=l,this.submitted=!1,this.organizationList=[],this.viewName=J.S.organizations}ngOnInit(){this.form=this.fb.group({org_Structure_ID:[null],parenT_ID:[null],orG_TYPE_ID:[null,[C.kI.required]],orG_ID:[null,[C.kI.required]]}),this.getFormValues()}onChangeBusinessAndCompanyId(){this.formCtrls.org_Structure_ID.value>0&&this.checkNoBusinessOrCompany()&&this.getAllUnAssignedOrganizationsByStructureId()}getFormValues(){this.form.patchValue(this.data),setTimeout(()=>{this.form.value.parenT_ID||(this.formCtrls.orG_TYPE_ID.disable(),this.formCtrls.orG_TYPE_ID.setValue(1))},100)}get formCtrls(){return this.form.controls}submit(){this.submitted=!0,this.form.valid&&this.create({core_Org_Structure_Org:{org_Structure_ID:this.formCtrls.org_Structure_ID.value,orG_TYPE_ID:this.formCtrls.orG_TYPE_ID.value,orG_ID:this.formCtrls.orG_ID.value,parenT_ID:this.formCtrls.parenT_ID.value}})}create(t){this.showLoading(),this.orgStructureService.createNode(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.dialogRef.close(!0)):this.errorList(o?.message?.messages),this.hideLoading()})}getAllUnAssignedOrganizationsByStructureId(){this.showLoading(),this.organizationsService.GetAllUnAssignedByStructureId(this.formCtrls.org_Structure_ID.value).pipe(this.cancelRequest()).subscribe(t=>{(t.message.messageType=b.u.Success)?this.organizationList=t.data:this.errorList(t?.message?.messages),this.hideLoading()})}createDialog(t){this.dialogsService.addFromDropdownDialog(be.w,t).afterClosed().subscribe(o=>{this.getAllUnAssignedOrganizationsByStructureId()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._),e.Y36(de.z),e.Y36(x.so),e.Y36(x.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-org-structure-node"]],features:[e.qOj],decls:17,vars:14,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","orgStructureNode",1,"d-inline-block","mtop-5","mbottom-10"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"clearfix"],["dialogContainer",""],[1,"row"],[1,"col-12","mtop-5"],[3,"formGroup"],[1,"col-md-6","col-12"],[3,"control","submitted","disableCompany","appendTo","filter"],["label","organization","optionDisabled","assignStr",3,"control","submitted","List","appendTo","filter","viewName","createNewDialog"],["align","end"],[3,"id","onClick"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"page-title",1),e.TgZ(2,"button",2),e._UZ(3,"i",3),e.qZA(),e._UZ(4,"div",4),e.qZA(),e.TgZ(5,"mat-dialog-content",null,5)(7,"div",6)(8,"div",7)(9,"form",8)(10,"div",6)(11,"div",9),e._UZ(12,"app-org-types-dropdown",10),e.qZA(),e.TgZ(13,"div",9)(14,"app-prime-dropdown",11),e.NdJ("createNewDialog",function(l){return o.createDialog(l)}),e.qZA()()()()()()(),e.TgZ(15,"mat-dialog-actions",12)(16,"submit-btn",13),e.NdJ("onClick",function(){return o.submit()}),e.qZA()()),2&t){const i=e.MAs(6);e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(7),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.orG_TYPE_ID)("submitted",o.submitted)("disableCompany",!!o.formCtrls.parenT_ID.value)("appendTo",i)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.orG_ID)("submitted",o.submitted)("List",o.organizationList)("appendTo",i)("filter",!0)("viewName",o.viewName),e.xp6(2),e.Q6J("id",0)}},dependencies:[oe.p,U.T,q.lW,x.ZT,x.uh,x.xY,x.H8,ne.t,me.q,C._Y,C.JL,C.sg],styles:[".add-structure-node .mat-dialog-container{padding:24px}@media (min-width: 320px) and (max-width: 991px){  .page-title{font-size:13px!important}}"]}),a})();var ye=c(52614),ge=c(20408),Te=c(91365),ue=c(25054);function ve(a,s){if(1&a&&(e._UZ(0,"p-image",14),e.ALo(1,"translate")),2&a){const t=e.oxw(2);e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",t.fileService.preview(t.employeeData.img))}}function xe(a,s){1&a&&(e.TgZ(0,"div",15),e._UZ(1,"i",16),e.qZA())}function Ie(a,s){if(1&a&&(e.TgZ(0,"p"),e._UZ(1,"i",17),e.TgZ(2,"span",18),e._uU(3),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.contact)}}function De(a,s){if(1&a&&(e.TgZ(0,"p"),e._UZ(1,"i",19),e.TgZ(2,"span",18),e._uU(3),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.email)}}function Se(a,s){1&a&&(e.TgZ(0,"span",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"active")," "))}function Oe(a,s){1&a&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"notActive")," "))}function Ze(a,s){if(1&a&&(e.ynx(0),e.TgZ(1,"p"),e.YNc(2,Se,3,3,"span",20),e.YNc(3,Oe,3,3,"ng-template",null,21,e.W1O),e.qZA(),e.TgZ(5,"p",22),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"p",23)(9,"span",24),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.qZA()(),e.TgZ(14,"p",23)(15,"span",24),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"span"),e._uU(19),e.qZA()(),e.BQk()),2&a){const t=e.MAs(4),o=e.oxw(2);e.xp6(2),e.Q6J("ngIf",o.employeeData.isActive)("ngIfElse",t),e.xp6(4),e.hij(" ",e.lcZ(7,7,"noOfEmployeeReporting")," "),e.xp6(4),e.hij(" ",e.lcZ(11,9,"asSolidManager")," : "),e.xp6(3),e.hij(" ",null==o.employeeData?null:o.employeeData.manageSolidEmpNo,""),e.xp6(3),e.hij(" ",e.lcZ(17,11,"asDottedManager")," : "),e.xp6(3),e.hij(" ",null==o.employeeData?null:o.employeeData.manageDotesEmpNo,"")}}function Ae(a,s){if(1&a&&(e.ynx(0),e.TgZ(1,"div",6)(2,"div",7),e.YNc(3,ve,2,4,"p-image",8),e.YNc(4,xe,2,0,"ng-template",null,9,e.W1O),e.qZA(),e.TgZ(6,"div",10)(7,"p",11),e._uU(8),e.qZA(),e.YNc(9,Ie,4,1,"p",5),e.YNc(10,De,4,1,"p",5),e.qZA()(),e.TgZ(11,"div",12)(12,"p",13),e._uU(13),e.ALo(14,"titlecase"),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"p"),e._uU(17),e.qZA(),e.TgZ(18,"p"),e._uU(19),e.qZA(),e.YNc(20,Ze,20,13,"ng-container",5),e.qZA(),e.BQk()),2&a){const t=e.MAs(5),o=e.oxw();e.xp6(3),e.Q6J("ngIf",o.employeeData.img&&""!=o.employeeData.img)("ngIfElse",t),e.xp6(5),e.hij(" ",o.msgTranslate(o.employeeData.ar_Name,o.employeeData.en_Name)," "),e.xp6(1),e.Q6J("ngIf",o.employeeData.contact),e.xp6(1),e.Q6J("ngIf",o.employeeData.email),e.xp6(3),e.hij(" ",e.lcZ(14,9,e.lcZ(15,11,"employment"))," "),e.xp6(4),e.hij(" ",o.employeeData.jobTitleName," "),e.xp6(2),e.hij(" ",o.employeeData.organization," "),e.xp6(1),e.Q6J("ngIf",!o.showMainData)}}function Je(a,s){1&a&&(e._UZ(0,"span",29),e.TgZ(1,"div",30),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeData")," "))}function Le(a,s){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",27),e.YNc(2,Je,4,3,"ng-template",28),e.qZA(),e.BQk())}function Ee(a,s){1&a&&(e.ynx(0),e._UZ(1,"app-structure-employee-card-skeleton"),e.BQk())}let le=(()=>{class a extends Z.U{constructor(t,o,i){super(),this.employeesService=t,this.dialogRef=o,this.data=i,this.loaded=!1,this.showMainData=!1,i&&(this.employeeId=i.employeeId,this.showMainData=i.showMainData??!1)}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.employeeId>0&&this.getEmployeeData()}getEmployeeData(){this.employeesService.getEmployeeCardById(this.employeeId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(t.data.length>0&&(this.employeeData=(0,ye.A)(t.data)[0]),this.loaded=!0):this.errorList(t?.message?.messages)})}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ge.M),e.Y36(x.so),e.Y36(x.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-employee-card"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},features:[e.qOj],decls:11,vars:11,consts:[[1,"title"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"employee-card"],[4,"ngIf"],[1,"row"],[1,"col-md-4","col-12","img-container"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"col-md-8","col-12","text-break"],[1,"mtop-5"],[1,"mtop-20"],[1,"mbottom-14",2,"font-weight","bold"],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"pi","pi-phone"],[1,"mx-1"],[1,"fa","fa-envelope"],["class","badge bg-light-success",4,"ngIf","ngIfElse"],["no",""],[1,"mbottom-14","mtop-14",2,"font-weight","bold"],[1,"font-size-14"],[1,"d-inline-block"],[1,"badge","bg-light-success"],[1,"badge","bg-light-danger"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h6",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"button",2),e._UZ(6,"i",3),e.qZA()(),e.TgZ(7,"mat-dialog-content",4),e.YNc(8,Ae,21,13,"ng-container",5),e.YNc(9,Le,3,0,"ng-container",5),e.YNc(10,Ee,2,0,"ng-container",5),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,7,e.lcZ(4,9,"employeeDetails"))," "),e.xp6(3),e.ekj("ar",o.languageService.isArabic),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.Q6J("ngIf",o.employeeData&&o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&!o.loaded))},dependencies:[n.O5,Te.v,q.lW,x.ZT,x.xY,H.jx,ue.E,ae.V,n.rS,L.X$],styles:[".title[_ngcontent-%COMP%]{background-color:#0000000a;margin:-24px;padding:24px 18px}.title[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{display:inline-block;margin-bottom:0;font-size:16px}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:-10px;margin-right:-15px}.title[_ngcontent-%COMP%]   button.ar[_ngcontent-%COMP%]{margin-left:-15px!important}  .mat-dialog-content.employee-card{margin-top:40px}  .mat-dialog-content.employee-card p{margin-bottom:.5rem;font-size:14px}"]}),a})(),_e=(()=>{class a{constructor(){}static groupBy(t,o){const i=t.reduce((l,f)=>(l[f[o]]?l[f[o]].push(f):l[f[o]]=[f],l),{});return Object.keys(i).map(l=>({key:l,List:i[l]}))}groupByPartOfProperty(t,o,i){const l=t.reduce((f,B)=>{let re=B[o].trim().slice(0,i).toUpperCase();return f[re]?f[re].push(B):f[re]=[B],f},{});return Object.keys(l).map(f=>({key:f,List:l[f]}))}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var he=c(31534),Y=c(37084);function Ne(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"p",16),e.NdJ("click",function(i){const f=e.CHM(t).$implicit,B=e.oxw(3);return e.KtG(B.openEmployeeCardDialog(i.target,f.id))}),e.TgZ(1,"span",17),e._UZ(2,"i",18),e.qZA(),e.TgZ(3,"span",19),e._uU(4),e.qZA()()}if(2&a){const t=s.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function Pe(a,s){if(1&a&&(e.ynx(0),e.TgZ(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14),e.YNc(4,Ne,5,3,"p",15),e.qZA(),e.BQk()),2&a){const t=s.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function we(a,s){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",11),e.NdJ("keyup",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,Pe,5,2,"ng-container",12),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function Me(a,s){1&a&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function w(a,s){1&a&&(e._UZ(0,"span",22),e.TgZ(1,"div",23),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInOrg")," "))}function Ue(a,s){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",20),e.YNc(2,w,4,3,"ng-template",21),e.qZA(),e.BQk())}let p=(()=>{class a extends Z.U{constructor(t,o,i,l,f){super(),this.employeesService=t,this.groupByService=o,this.dialogRef=i,this.data=l,this.dialog=f,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=l.expandedIndex,this.nodeData=l.nodeData}ngOnInit(){this.checkNoBusinessOrCompany()&&this.nodeData.structureId>0&&this.nodeData.org.id>0&&this.getEmployeesByOrgId();const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}getEmployeesByOrgId(){this.employeesService.getAllByStructureAndOrgId(this.nodeData.structureId,this.nodeData.org.id).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(this.employees=t.data,this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0):this.errorList(t?.message?.messages)})}sortAndGroupEmployees(){this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let i=this.getHeaderElement(t),l={employeeId:o};this.dialogsService.dialogLeftOrRightCard(le,i.getBoundingClientRect(),350,!0,"80hv",l)}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ge.M),e.Y36(_e),e.Y36(x.so),e.Y36(x.WI),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-details-employees"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},features:[e.qOj],decls:19,vars:11,consts:[[1,"details-dialog-title"],[1,"mb-2"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"org-name"],[1,"details-dialog","company"],["multi",""],[3,"expanded"],[1,"expantion-body"],[4,"ngIf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[4,"ngFor","ngForOf"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h6",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e._UZ(5,"i",4),e.qZA()(),e.TgZ(6,"p",5),e._uU(7),e.qZA()(),e.TgZ(8,"mat-dialog-content",6)(9,"mat-accordion",7)(10,"mat-expansion-panel",8)(11,"mat-expansion-panel-header")(12,"mat-panel-title"),e._uU(13),e.ALo(14,"translate"),e.qZA()(),e.TgZ(15,"div",9),e.YNc(16,we,4,4,"ng-container",10),e.YNc(17,Me,2,0,"ng-container",10),e.YNc(18,Ue,3,0,"ng-container",10),e.qZA()()()()),2&t&&(e.xp6(3),e.AsE(" ",o.nodeData.org.code," - ",o.msgTranslate(o.nodeData.org.ar_Name,o.nodeData.org.en_Name)," "),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.hij(" ",o.msgTranslate(o.nodeData.orgType.ar_Name,o.nodeData.orgType.en_Name)," "),e.xp6(3),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(14,9,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded))},dependencies:[n.sg,n.O5,he.b,q.lW,x.ZT,x.xY,Y.pp,Y.ib,Y.yz,Y.yK,H.jx,ae.V,L.X$]}),a})();var _=c(44132),r=c(79417),d=c(40445),u=c(3848),h=c(10266),j=c(12453),R=c(86467),ie=c(44850);function $e(a,s){if(1&a&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=s.$implicit,o=e.oxw(2);let i;e.xp6(1),e.HOy(" ",o.msgTranslate(null==t.core_Org?null:t.core_Org.ar_Name,null==t.core_Org?null:t.core_Org.en_Name)," ( ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," ",e.lcZ(2,4,"of")," ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ) ")}}function Ke(a,s){if(1&a&&(e.TgZ(0,"div",14),e.YNc(1,$e,3,6,"p",15),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.nodeData.core_Org_Job_Title)}}function We(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"p",20),e.NdJ("click",function(i){const f=e.CHM(t).$implicit,B=e.oxw(3);return e.KtG(B.openEmployeeCardDialog(i.target,f.id))}),e.TgZ(1,"span",21),e._UZ(2,"i",22),e.qZA(),e.TgZ(3,"span",23),e._uU(4),e.qZA()()}if(2&a){const t=s.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function Ve(a,s){if(1&a&&(e.ynx(0),e.TgZ(1,"div",17),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e.YNc(4,We,5,3,"p",19),e.qZA(),e.BQk()),2&a){const t=s.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function Xe(a,s){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",16),e.NdJ("keyup",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,Ve,5,2,"ng-container",15),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function et(a,s){1&a&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function tt(a,s){1&a&&(e._UZ(0,"span",26),e.TgZ(1,"div",27),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInJob")," "))}function ot(a,s){1&a&&(e.ynx(0),e.TgZ(1,"p-messages",24),e.YNc(2,tt,4,3,"ng-template",25),e.qZA(),e.BQk())}let nt=(()=>{class a extends Z.U{constructor(t,o,i,l){super(),this.groupByService=t,this.dialogRef=o,this.data=i,this.dialog=l,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=i.expandedIndex,this.nodeData=i.nodeData,this.employees=this.nodeData.core_Person_Instance_Job_Title.map(f=>f.core_Person_Instance?.core_Person),this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}sortAndGroupEmployees(){this.employees=this.employees.filter(t=>{if(t)return t}),this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let i=this.getHeaderElement(t),l={employeeId:o};this.dialogsService.dialogLeftOrRightCard(le,i.getBoundingClientRect(),350,!0,"80hv",l)}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(_e),e.Y36(x.so),e.Y36(x.WI),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-job-title-details-dialog"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},features:[e.qOj],decls:50,vars:32,consts:[[1,"details-dialog-title"],[1,"mb-2"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"type-name","info"],[1,"clearfix"],[1,"details-dialog","jobtitle"],["multi",""],[3,"expanded"],[1,"expantion-body"],[1,"table-container"],["class","no-employees",4,"ngIf"],[1,"expantion-body","employee-body"],[4,"ngIf"],[1,"no-employees"],[4,"ngFor","ngForOf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e._UZ(3,"i",3),e.qZA(),e.TgZ(4,"h6",4),e._uU(5),e.qZA()(),e._UZ(6,"p",5),e.qZA(),e.TgZ(7,"mat-dialog-content",6)(8,"mat-accordion",7)(9,"mat-expansion-panel",8)(10,"mat-expansion-panel-header")(11,"mat-panel-title"),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",9)(15,"div",10)(16,"table")(17,"tbody")(18,"tr")(19,"th"),e._uU(20),e.ALo(21,"titlecase"),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA()(),e.TgZ(25,"tr")(26,"th"),e._uU(27),e.ALo(28,"titlecase"),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"td"),e._uU(31),e.qZA()(),e.TgZ(32,"tr")(33,"th"),e._uU(34),e.ALo(35,"titlecase"),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"td"),e._uU(38),e.qZA()()()()(),e._UZ(39,"mat-divider"),e.YNc(40,Ke,2,1,"div",11),e.qZA()(),e.TgZ(41,"mat-expansion-panel",8)(42,"mat-expansion-panel-header")(43,"mat-panel-title"),e._uU(44),e.ALo(45,"translate"),e.qZA()(),e.TgZ(46,"div",12),e.YNc(47,Xe,4,4,"ng-container",13),e.YNc(48,et,2,0,"ng-container",13),e.YNc(49,ot,3,0,"ng-container",13),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(4),e.Q6J("expanded",0==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(13,16,"details")),e.xp6(8),e.Oqu(e.lcZ(21,18,e.lcZ(22,20,"code"))),e.xp6(4),e.Oqu(o.nodeData.code),e.xp6(3),e.Oqu(e.lcZ(28,22,e.lcZ(29,24,"jobTitle"))),e.xp6(4),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(3),e.Oqu(e.lcZ(35,26,e.lcZ(36,28,"jobFamily"))),e.xp6(4),e.hij(" ",o.msgTranslate(null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.ar_Name,null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",o.nodeData.core_Org_Job_Title.length>0),e.xp6(1),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(45,30,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded))},dependencies:[n.sg,n.O5,he.b,q.lW,ie.d,x.ZT,x.xY,Y.pp,Y.ib,Y.yz,Y.yK,H.jx,ae.V,n.rS,L.X$],styles:[".mat-dialog-content.details-dialog.jobtitle .mat-expansion-panel-body{padding:0}  .mat-dialog-content.details-dialog.jobtitle .table-container{padding:0 24px 16px}  .mat-dialog-content.details-dialog.jobtitle .no-employees,   .mat-dialog-content.details-dialog.jobtitle .employee-body{padding:16px 24px 0}"]}),a})();var V=c(26315),je=c(1903);let at=(()=>{class a extends je.K{constructor(){super()}getJobTitleHierarchy(t){return this.get("OrgManagement/JobTitle/GetAll_Structure",{params:{$filter:`id eq ${t}`,$expand:`${V.db.core_Org_Job_Title}/${V.db.core_Org},${V.db.Core_Person_Instance_Job_Title}.${V.db.Core_Person_Instance}.${V.db.Core_Person},${V.db.Core_Job_Title_Family}`}})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var it=c(89609),ze=c(70502),rt=c(62160),st=c(69846),lt=c(4159),ct=c.n(lt),pt=c(53583);function dt(a,s,t,o){o.$display.next(!0);const i=a.el.nativeElement,l=document.getElementById(s),f=l.offsetWidth+l.scrollWidth;ct()(i,{width:f,height:l.offsetWidth}).then(B=>{const re=B.toDataURL("image/png");if("image"==t){const ce=document.createElement("a");ce.href=re,ce.download=s+".jpeg",ce.click()}else if("pdf"==t){var fe=new pt.ZP("l","mm",[1200,"companyChart"==s?120:400]);const ce=fe.internal.pageSize.getWidth(),Mo=fe.internal.pageSize.getHeight();fe.addImage(re,"PNG",20,20,ce-20,Mo-20),fe.save(s+".pdf")}o.$display.next(!1)})}var mt=c(67579);let Fe=(()=>{class a{constructor(t){this.loading=t,this.imgExport=new e.vpe,this.pdfExport=new e.vpe,this.svg=new st.El,this.exportChart=dt}exportImg(){this.imgExport.emit()}exportPdf(){this.imgExport.emit()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(mt.b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["export-chart-buttons"]],inputs:{resource:"resource",elementId:"elementId"},outputs:{imgExport:"imgExport",pdfExport:"pdfExport"},decls:7,vars:14,consts:[[1,"float-right"],["width","40","height","40",1,"pointer","px-1",3,"src","matTooltip","title","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"img",1),e.NdJ("click",function(){return o.exportChart(o.resource,o.elementId,"image",o.loading)}),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"img",1),e.NdJ("click",function(){return o.exportChart(o.resource,o.elementId,"pdf",o.loading)}),e.ALo(5,"translate"),e.ALo(6,"translate"),e.qZA()()),2&t&&(e.xp6(1),e.s9C("matTooltip",e.lcZ(2,6,"exportAsImage")),e.s9C("title",e.lcZ(3,8,"exportAsImage")),e.Q6J("src",o.svg.img,e.LSH),e.xp6(3),e.s9C("matTooltip",e.lcZ(5,10,"exportAsPdf")),e.s9C("title",e.lcZ(6,12,"exportAsPdf")),e.Q6J("src",o.svg.pdf,e.LSH))},dependencies:[h.gM,L.X$]}),a})();const gt=["jobTitleChart"];function ut(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"app-job-title-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)}}function _t(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"app-employee-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getAllEmployeeJobTitles())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.employeeId)("filter",!0)}}function ht(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",3)(1,"app-prime-dropdown",14),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)("List",t.employeeJobTitles)}}function ft(a,s){if(1&a&&(e.TgZ(0,"div",3),e._UZ(1,"export-chart-buttons",15),e.qZA()),2&a){const t=e.oxw(),o=e.MAs(12);e.ekj("col-md-6",!(t.formCtrls.employeeId.value>0)),e.xp6(1),e.Q6J("resource",o)}}function bt(a,s){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",24),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function Ct(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",25)(1,"i",26),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw().$implicit,f=e.oxw();return e.KtG(f.openJobTitleDetailsDialog(i.target,l.data,1))}),e.TgZ(2,"span"),e._uU(3),e.qZA()()()}if(2&a){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.data.core_Person_Instance_Job_Title.length," ")}}function yt(a,s){if(1&a&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&a){const t=s.$implicit,o=e.oxw(3);let i;e.xp6(1),e.lnq(" ",o.msgTranslate(null==t.core_Org?null:t.core_Org.ar_Name,null==t.core_Org?null:t.core_Org.en_Name)," ( ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," / ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ) ")}}function Tt(a,s){if(1&a&&(e.TgZ(0,"div",27),e.YNc(1,yt,2,3,"p",28),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.data.core_Org_Job_Title)}}function vt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return l.expandNode(i),e.KtG(l.changePositions())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.children.length," ",e.lcZ(2,2,1==t.children.length?"jobTitleBelow":"jobTitlesBelow")," ")}}function xt(a,s){if(1&a){const t=e.EpF();e.YNc(0,bt,6,8,"ng-container",16),e.TgZ(1,"div",17),e.NdJ("click",function(i){const f=e.CHM(t).$implicit,B=e.oxw();return e.KtG(B.openJobTitleDetailsDialog(i.target,f.data,0))}),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"div",18)(5,"p"),e._uU(6),e.qZA()()(),e.TgZ(7,"div",19),e.YNc(8,Ct,4,1,"div",20),e.YNc(9,Tt,2,1,"div",21),e.YNc(10,vt,3,4,"div",22),e.qZA()}if(2&a){const t=s.$implicit,o=e.oxw();e.Q6J("ngIf",o.jobTitleOrgChart&&(null==o.jobTitleOrgChart[0]||null==o.jobTitleOrgChart[0].data?null:o.jobTitleOrgChart[0].data.parentJobTitleID)>0&&1==t.data.currentFirstNode),e.xp6(1),e.Q6J("id",t.data.id),e.xp6(2),e.AsE(" ",t.data.code," - ",o.msgTranslate(t.data.ar_Name,t.data.en_Name)," "),e.xp6(3),e.hij(" ",o.msgTranslate(null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.ar_Name,null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",(null==t.data.core_Person_Instance_Job_Title?null:t.data.core_Person_Instance_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.core_Org_Job_Title?null:t.data.core_Org_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}function It(a,s){1&a&&e._UZ(0,"app-chart-skeleton",30),2&a&&e.Q6J("width",280)}let Dt=(()=>{class a extends Z.U{constructor(t,o,i){super(),this.jobTitleChartService=t,this.employeeJobInformationService=o,this.dialog=i,this.loading=!1,this.lastSelectedJobId=0,this.searchTypeList=[],this.employeeJobTitles=[],this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({searchTypeId:[null],jobTitleId:[null],employeeId:[null]}),setTimeout(()=>{this.searchTypeList=[{id:1,ar_Name:"\u0627\u0644\u0648\u0638\u0627\u0626\u0641",en_Name:"Job titles"},{id:2,ar_Name:"\u0627\u0644\u0645\u0648\u0638\u0641\u064a\u0646",en_Name:"Employees"}]},100)}onChangeBusinessAndCompanyId(){this.jobTitleOrgChart=null,this.checkNoBusinessOrCompany()&&this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}get formCtrls(){return this.form.controls}getJobTitleOrgChart(t){t>0&&(this.lastSelectedJobId=t,this.jobTitleOrgChart=null,this.loading=!0,this.jobTitleChartService.getJobTitleHierarchy(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?(this.jobTitleOrgChart=$(o.data),this.jobTitleOrgChart[0].data.currentFirstNode=!0,this.changePositions(),this.lastSelectedJobId==t&&(this.loading=!1)):(this.errorList(o?.message?.messages),this.loading=!1)}))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)}onChangeSearchType(){this.formCtrls.jobTitleId.reset(),this.formCtrls.employeeId.reset()}onChangeSearchValue(){this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}upOneLevel(){1==this.formCtrls.searchTypeId.value?this.formCtrls.jobTitleId.setValue(this.jobTitleOrgChart[0].data.parentJobTitleID):2==this.formCtrls.searchTypeId.value&&(this.onChangeSearchType(),this.getJobTitleOrgChart(this.jobTitleOrgChart[0].data.parentJobTitleID))}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}openJobTitleDetailsDialog(t,o,i){let l=this.getHeaderElement(t),f={nodeData:o,expandedIndex:i};this.dialogsService.dialogLeftOrRightCard(nt,l.getBoundingClientRect(),350,!1,"90hv",f)}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}getAllEmployeeJobTitles(){let t=this.formCtrls.employeeId.value;t>0&&(this.showLoading(),this.employeeJobInformationService.getAllCurrentJobsByEmployeeId(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?this.employeeJobTitles=o.data:this.errorList(o?.message?.messages),this.hideLoading()}))}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(at),e.Y36(it._),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-job-title-org-chart"]],viewQuery:function(t,o){if(1&t&&e.Gf(gt,5),2&t){let i;e.iGM(i=e.CRH())&&(o.jobTitleChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},features:[e.qOj],decls:15,vars:10,consts:[[1,"organizationchart-container","job-title-chart"],[1,"mbottom-20",3,"formGroup"],[1,"row","mx-0"],[1,"col-md-3","col-12"],["label","searchBy",3,"control","List","change"],[3,"control","filter","change",4,"ngIf"],["class","col-md-3 col-12",4,"ngIf"],["class","col-md-3 col-12",3,"col-md-6",4,"ngIf"],["id","jobTitleChart","appScrollableHorizontal","",3,"scroll"],[3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["jobTitleChart",""],["pTemplate","job-title"],[3,"width",4,"ngIf"],[3,"control","filter","change"],["label","jobTitle",3,"control","filter","List","change"],["elementId","jobTitleChart",3,"resource"],[4,"ngIf"],[1,"node-header",3,"id","click"],[1,"node-content","main-data"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","fte-content",4,"ngIf"],["class","node-footer info",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"fte-content"],[4,"ngFor","ngForOf"],[1,"node-footer","info",3,"click"],[3,"width"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-prime-dropdown",4),e.NdJ("change",function(){return o.onChangeSearchType()}),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,ut,1,2,"app-job-title-dropdown",5),e.YNc(7,_t,1,2,"app-employee-dropdown",5),e.qZA(),e.YNc(8,ht,2,3,"div",6),e.YNc(9,ft,2,3,"div",7),e.qZA()(),e.TgZ(10,"div",8),e.NdJ("scroll",function(l){return o.onScroll(l)}),e.TgZ(11,"p-organizationChart",9,10),e.NdJ("onNodeExpand",function(){return o.changePositions()})("onNodeCollapse",function(){return o.changePositions()}),e.YNc(13,xt,11,8,"ng-template",11),e.qZA()(),e.YNc(14,It,1,1,"app-chart-skeleton",12),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.searchTypeId)("List",o.searchTypeList),e.xp6(2),e.Q6J("ngIf",1==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",2==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.employeeId.value>0),e.xp6(1),e.Q6J("ngIf",null!=o.jobTitleOrgChart),e.xp6(2),e.Q6J("value",o.jobTitleOrgChart)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",o.loading))},dependencies:[n.sg,n.O5,_.$,ze.J,r.c,q.lW,ne.t,rt.W,C._Y,C.JL,C.sg,H.jx,R.OE,Fe,L.X$],styles:[".job-title-chart .p-organizationchart-node-content{border-radius:10px;width:280px!important}  .job-title-chart .main-data p{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}  .job-title-chart .node-header{border-top-left-radius:10px;border-top-right-radius:10px;cursor:pointer}  .job-title-chart .node-footer{background-color:inherit;border-bottom-left-radius:10px;border-bottom-right-radius:10px;padding-bottom:10px;padding-top:10px;font-size:13px}  .job-title-chart .node-footer:hover{background-color:#f2f4f5;color:#525050!important}  .job-title-chart .p-organizationchart-node-content .node-header:hover{background:#f2f4f5!important}  .job-title-chart .no-employees{margin-top:1.8rem;text-align:start;color:#525050;padding-bottom:.3rem}  .job-title-chart .employees-no-section{border-bottom:1px solid #dee2e6!important}  .job-title-chart .fte-content{padding:15px .7rem 0;text-align:start}  .job-title-chart .ft-image,   .job-title-chart .ft-file{cursor:pointer}"]}),a})(),St=(()=>{class a extends je.K{constructor(){super()}getEmployeesChart(t){return this.get("personnel/Employees/GetAll_EmployeesCard_Structure",{params:{PerinsID:t}})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const Ot=["resourceChart"];function Zt(a,s){if(1&a&&(e.TgZ(0,"div",11),e._UZ(1,"export-chart-buttons",12),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("resource",t.resourcesChart)}}function At(a,s){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",23),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function Jt(a,s){if(1&a&&(e._UZ(0,"p-image",24),e.ALo(1,"translate")),2&a){const t=e.oxw().$implicit,o=e.oxw();e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",o.fileService.preview(t.data.img))}}function Lt(a,s){1&a&&(e.TgZ(0,"div",25),e._UZ(1,"i",26),e.qZA())}function Et(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",27),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw();return l.expandNode(i),e.KtG(l.changePositions())}),e._uU(1),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function Nt(a,s){if(1&a){const t=e.EpF();e.YNc(0,At,6,8,"ng-container",10),e.TgZ(1,"div",13)(2,"div",14)(3,"div",15),e.YNc(4,Jt,2,4,"p-image",16),e.YNc(5,Lt,2,0,"ng-template",null,17,e.W1O),e.qZA(),e.TgZ(7,"div",18),e.NdJ("click",function(i){const f=e.CHM(t).$implicit,B=e.oxw();return e.KtG(B.openEmployeeDetailsDialog(i.target,f.data))}),e.TgZ(8,"p",19),e._uU(9),e.ALo(10,"titlecase"),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"titlecase"),e.qZA(),e.TgZ(14,"p"),e._uU(15),e.ALo(16,"date"),e.qZA()()()(),e.TgZ(17,"div",20),e.YNc(18,Et,2,1,"div",21),e.qZA()}if(2&a){const t=s.$implicit,o=e.MAs(6),i=e.oxw();e.Q6J("ngIf",i.resourcesChart&&(null==i.resourcesChart[0]||null==i.resourcesChart[0].data?null:i.resourcesChart[0].data.parentID)>0&&1==t.data.currentFirstNode),e.xp6(1),e.Q6J("id",t.data.id),e.xp6(3),e.Q6J("ngIf",t.data.img&&"/"!=t.data.img)("ngIfElse",o),e.xp6(5),e.hij(" ",e.lcZ(10,8,i.msgTranslate(t.data.ar_Name,t.data.en_Name))," "),e.xp6(3),e.hij(" ",e.lcZ(13,10,i.msgTranslate(t.data.jobTitleNameAr,t.data.jobTitleName))," "),e.xp6(3),e.hij(" ",e.xi3(16,12,t.data.joiningDate,"dd-MM-yyyy")," "),e.xp6(3),e.Q6J("ngIf",t.children.length>0)}}function Pt(a,s){1&a&&e._UZ(0,"app-chart-skeleton")}let wt=(()=>{class a extends Z.U{constructor(t,o){super(),this.resourcesChartService=t,this.dialog=o,this.loading=!1,this.lastSelectedEmpId=0,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({employeeId:[null]})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getResourcesChart(this.formCtrls.employeeId.value)}get formCtrls(){return this.form.controls}getResourcesChart(t){t>0&&(this.lastSelectedEmpId=t,this.resourcesChart=null,this.loading=!0,this.resourcesChartService.getEmployeesChart(t).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==b.u.Success?(this.resourcesChart=O(o.data,this.lastSelectedEmpId),this.resourcesChart[0].data.currentFirstNode=!0,this.changePositions(),this.lastSelectedEmpId==t&&(this.loading=!1)):(this.errorList(o?.message?.messages),this.loading=!1)}))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)}onChangeEmployee(){this.getResourcesChart(this.formCtrls.employeeId.value)}upOneLevel(){this.formCtrls.employeeId.setValue(this.resourcesChart[0].data.parentID)}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}openEmployeeDetailsDialog(t,o){let i=this.getHeaderElement(t),l={employeeId:o.id};this.dialogsService.dialogLeftOrRightCard(le,i.getBoundingClientRect(),350,!0,"80hv",l,!0)}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(St),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-resources-chart"]],viewQuery:function(t,o){if(1&t&&e.Gf(Ot,5),2&t){let i;e.iGM(i=e.CRH())&&(o.resourceChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},features:[e.qOj],decls:11,vars:7,consts:[[1,"organizationchart-container","resources-chart"],[1,"mbottom-20",3,"formGroup"],[1,"row","mx-0"],[1,"col-lg-4","col-md-6","col-12"],[3,"control","filter","change"],["class","col-lg-4 offset-lg-4 col-md-4 offset-md-2 col-12",4,"ngIf"],["id","resourceChart","appScrollableHorizontal","",3,"scroll"],[3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["resourceChart",""],["pTemplate","resources"],[4,"ngIf"],[1,"col-lg-4","offset-lg-4","col-md-4","offset-md-2","col-12"],["elementId","resourceChart",3,"resource"],[1,"node-header",3,"id"],[1,"node-content","main-data"],[1,"img-emp-chart"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"p-2","info-content",3,"click"],[1,"info"],[1,"node-content"],["class","node-footer",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-employee-dropdown",4),e.NdJ("change",function(){return o.onChangeEmployee()}),e.qZA()(),e.YNc(5,Zt,2,1,"div",5),e.qZA()(),e.TgZ(6,"div",6),e.NdJ("scroll",function(l){return o.onScroll(l)}),e.TgZ(7,"p-organizationChart",7,8),e.NdJ("onNodeExpand",function(){return o.changePositions()})("onNodeCollapse",function(){return o.changePositions()}),e.YNc(9,Nt,19,15,"ng-template",9),e.qZA()(),e.YNc(10,Pt,1,0,"app-chart-skeleton",10),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.employeeId)("filter",!0),e.xp6(1),e.Q6J("ngIf",null!=o.resourcesChart),e.xp6(2),e.Q6J("value",o.resourcesChart)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",o.loading))},dependencies:[n.O5,_.$,ze.J,r.c,q.lW,C._Y,C.JL,C.sg,H.jx,R.OE,ue.E,Fe,n.rS,n.uU,L.X$],styles:[".resources-chart .p-organizationchart-node-content{width:150px!important;border-color:#c1c3c4}  .resources-chart .p-organizationchart-node-content.dashed-border{border-style:dashed}  .resources-chart .info-content{cursor:pointer;margin-top:-10px}  .resources-chart .node-header{padding:0}  .resources-chart .node-header p{margin:0 0 5px}  .resources-chart .img-emp-chart{display:flex;align-items:center;justify-content:center;height:90px}  .resources-chart .img-emp-chart p-image,   .resources-chart .img-emp-chart .p-image-preview-container>img{height:70px;width:70px;border-radius:50%}  .resources-chart .img-emp-chart .p-image-preview-indicator{border-radius:50%}  .resources-chart .img-emp-chart .alt-img-preview{background-color:#00000024;display:flex;align-items:center;justify-content:center;height:70px;width:70px;border-radius:50%}  .resources-chart .img-emp-chart .alt-img-preview i{font-size:2.5rem;color:#000000ad}  .resources-chart .ft-image,   .resources-chart .ft-file{cursor:pointer}"]}),a})();const Mt=["companyChart"];function Ut(a,s){if(1&a&&(e.TgZ(0,"div",12),e._UZ(1,"export-chart-buttons",16),e.qZA()),2&a){e.oxw(2);const t=e.MAs(9);e.xp6(1),e.Q6J("resource",t)}}function jt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"app-org-types-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getAllOrganizationsByOrgType())}),e.qZA()(),e.TgZ(3,"div",12),e._UZ(4,"app-prime-dropdown",14),e.qZA(),e.YNc(5,Ut,2,1,"div",15),e.qZA()}if(2&a){e.oxw();const t=e.MAs(9),o=e.oxw();e.xp6(2),e.Q6J("control",o.formCtrls.organizationTypeId)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.organization_ID)("List",o.organizationList),e.xp6(1),e.Q6J("ngIf",t)}}function Ft(a,s){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.upOneLevel())}),e._UZ(2,"i",24),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"div"),e.BQk()}if(2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.AsE(" ",e.lcZ(4,6,"upOneLevel")," ",t.parent," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px")}}function Bt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"i",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit,l=e.oxw(2);return e.KtG(l.onDelete(i))}),e.ALo(1,"translate"),e.qZA()}2&a&&e.s9C("matTooltip",e.lcZ(1,1,"General.delete"))}function Qt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,Bt,2,3,"i",26),e.TgZ(2,"i",27),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.openAddEditDialog(i))}),e.ALo(3,"translate"),e.qZA()()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.data.org),e.xp6(1),e.s9C("matTooltip",e.lcZ(3,2,"General.add"))}}function Gt(a,s){if(1&a&&(e.TgZ(0,"div",29)(1,"p"),e._uU(2),e.qZA()()),2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",o.msgTranslate(null==t.data.orgType?null:t.data.orgType.ar_Name,null==t.data.orgType?null:t.data.orgType.en_Name)," ")}}function zt(a,s){if(1&a&&(e.TgZ(0,"div",29)(1,"p"),e._uU(2),e.qZA()()),2&a){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",o.msgTranslate(t.data.structure.ar_Name,t.data.structure.en_Name)," ")}}function Rt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",30)(1,"i",31),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw().$implicit,f=e.oxw(2);return e.KtG(f.openOrgDetailsDialog(i.target,l.data,1))}),e.TgZ(2,"span"),e._uU(3),e.qZA()()()}if(2&a){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.data.numEmp," ")}}function qt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",32),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return l.expandNode(i),e.KtG(l.changePositions())}),e._uU(1),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function Yt(a,s){if(1&a&&(e.YNc(0,Ft,6,8,"ng-container",10),e.TgZ(1,"div",17)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,Qt,4,4,"div",18),e.YNc(6,Gt,3,1,"div",19),e.YNc(7,zt,3,1,"div",19),e.qZA(),e.TgZ(8,"div",20),e.YNc(9,Rt,4,1,"div",21),e.YNc(10,qt,2,1,"div",22),e.qZA()),2&a){const t=s.$implicit,o=e.oxw(2);let i;e.Q6J("ngIf",o.orgStructureDetailsFiltered&&(null==o.orgStructureDetailsFiltered[0]||null==o.orgStructureDetailsFiltered[0].data?null:o.orgStructureDetailsFiltered[0].data.parentId)>0&&1==t.data.currentFirstNode),e.xp6(1),e.ekj("text-start",!o.canNotEdit),e.Q6J("id",null!==(i=null==t.data.org?null:t.data.org.id)&&void 0!==i?i:null),e.xp6(2),e.hij(" ",t.data.structure?e.lcZ(4,10,t.label):t.label," "),e.xp6(2),e.Q6J("ngIf",!o.canNotEdit),e.xp6(1),e.Q6J("ngIf",t.data.org),e.xp6(1),e.Q6J("ngIf",t.data.structure),e.xp6(2),e.Q6J("ngIf",t.data.numEmp>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}function kt(a,s){1&a&&e._UZ(0,"app-chart-skeleton")}function Ht(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"mat-tab-group",1)(1,"mat-tab",2),e.ALo(2,"titlecase"),e.ALo(3,"translate"),e.TgZ(4,"div",3)(5,"form",4),e.YNc(6,jt,6,5,"div",5),e.qZA(),e.TgZ(7,"div",6),e.NdJ("scroll",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.onScroll(i))}),e.TgZ(8,"p-organizationChart",7,8),e.NdJ("onNodeExpand",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePositions())})("onNodeCollapse",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePositions())}),e.YNc(10,Yt,11,12,"ng-template",9),e.qZA()(),e.YNc(11,kt,1,0,"app-chart-skeleton",10),e.qZA()(),e.TgZ(12,"mat-tab",2),e.ALo(13,"titlecase"),e.ALo(14,"translate"),e._UZ(15,"app-job-title-org-chart"),e.qZA(),e.TgZ(16,"mat-tab",2),e.ALo(17,"titlecase"),e.ALo(18,"translate"),e._UZ(19,"app-resources-chart"),e.qZA()()}if(2&a){const t=e.oxw();e.Q6J("dir",t.languageService.isArabic?"rtl":"ltr"),e.xp6(1),e.s9C("label",e.lcZ(2,11,e.lcZ(3,13,"companyOrgStructure"))),e.xp6(3),e.ekj("ar",t.languageService.isArabic),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",!t.loading),e.xp6(2),e.Q6J("value",t.orgStructureDetailsFiltered)("preserveSpace",!1),e.xp6(3),e.Q6J("ngIf",t.loading),e.xp6(1),e.s9C("label",e.lcZ(13,15,e.lcZ(14,17,"jobtitleChart"))),e.xp6(4),e.s9C("label",e.lcZ(17,19,e.lcZ(18,21,"resources")))}}let Re=(()=>{class a extends Z.U{constructor(t,o,i){super(),this.orgStructureService=t,this.organizationsService=o,this.dialog=i,this.orgStructureDetailsFiltered=[],this.organizationList=[],this.loading=!0,this.firstOnChange=!0,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0},this.upOneLevelLastPositionsBeforeScroll={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({organizationTypeId:[null],organization_ID:[{value:null,disabled:!0}]}),this.formCtrls.organization_ID.valueChanges.subscribe(t=>{(null==t||t>0)&&this.onChangeOrg(t)})}ngOnChanges(t){t.orgStructureId&&(this.firstOnChange?this.firstOnChange=!1:this.onChangeBusinessAndCompanyId())}onChangeBusinessAndCompanyId(){this.orgStructureId>0&&this.checkNoBusinessOrCompany()&&this.getStructureDetails()}get formCtrls(){return this.form.controls}getStructureDetails(){this.loading=!0,this.orgStructureDetails=null,this.orgStructureDetailsFiltered=[],this.orgStructureService.getByIdWithHierarchy(this.orgStructureId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==b.u.Success?(this.orgStructureDetails=M(t.data[0],this.orgStructureId),this.orgStructureDetailsFiltered=this.orgStructureDetails.slice(),this.loading=!1):(this.errorList(t?.message?.messages),this.loading=!1)})}onChangeOrg(t){this.orgStructureDetailsFiltered=[],t>0?this.getChartDataByOrg(t,this.orgStructureDetails[0]):this.orgStructureDetailsFiltered=this.orgStructureDetails}getChartDataByOrg(t,o,i=!1){o.children.map(l=>{if(l.data.org?.id==t)return this.orgStructureDetailsFiltered=[l],this.orgStructureDetailsFiltered[0].data.currentFirstNode=!0,i&&(this.formCtrls.organizationTypeId.setValue(l.data.orgType.id),this.formCtrls.organization_ID.setValue(l.data.org.id)),void this.changePositions()}),o.children.map(l=>this.getChartDataByOrg(t,l,i))}changePositions(){setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},50)}upOneLevel(){this.orgStructureDetailsFiltered[0].data.currentFirstNode=!1,this.formCtrls.organization_ID.setValue(0);let t=this.orgStructureDetailsFiltered[0].data.parentId;t?this.getChartDataByOrg(t,this.orgStructureDetails[0],!0):this.orgStructureDetailsFiltered=this.orgStructureDetails}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn")?.getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.width/2}onDelete(t){let o=this.msgTranslate(t.data.org.ar_Name,t.data.org.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.deleteNode(t)})}deleteNode(t){let o={StructureID:this.orgStructureId,OrgID:t.data.org.id};this.showLoading(),this.orgStructureService.DeleteNode(o).subscribe(i=>{i.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getStructureDetails(),this.getAllOrganizationsByOrgType()):this.errorList(i?.message?.messages),this.hideLoading()})}openAddEditDialog(t){return this.dialog.open(Ce,{data:{org_Structure_ID:this.orgStructureId,parenT_ID:t.data.org?.id??null},minWidth:"50vw",panelClass:"add-structure-node",autoFocus:!1}).afterClosed().subscribe(o=>{o&&(this.getStructureDetails(),this.getAllOrganizationsByOrgType())})}openOrgDetailsDialog(t,o,i){let l=this.getHeaderElement(t),f={org_Structure_ID:this.orgStructureId,nodeData:o,expandedIndex:i};this.dialogsService.dialogLeftOrRightCard(p,l.getBoundingClientRect(),350,!1,"90hv",f)}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}getAllOrganizationsByOrgType(){let t=this.formCtrls.organizationTypeId.value;this.formCtrls.organization_ID.setValue(null),t>0?(this.organizationsService.GetAllByOrgTypeAndStructure(t,this.orgStructureId).pipe(this.cancelRequest()).subscribe(o=>{(o.message.messageType=b.u.Success)?this.organizationList=o.data:this.errorList(o?.message?.messages)}),this.formCtrls.organization_ID.enable()):this.formCtrls.organization_ID.disable()}onWindowResize(t){this.changePositions()}onScroll(t){this.changePositions()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._),e.Y36(de.z),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-hierarchy-details"]],viewQuery:function(t,o){if(1&t&&e.Gf(Mt,5),2&t){let i;e.iGM(i=e.CRH())&&(o.companyChart=i.first)}},hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onWindowResize(l)},!1,e.Jf7)},inputs:{orgStructureId:"orgStructureId",canNotEdit:"canNotEdit"},features:[e.qOj,e.TTD],decls:2,vars:1,consts:[["class","col-12 w-100 view-tabs-group",3,"dir",4,"ngIf"],[1,"col-12","w-100","view-tabs-group",3,"dir"],[3,"label"],[1,"organizationchart-container","company-chart"],[1,"mbottom-20",3,"formGroup"],["class","row mx-0",4,"ngIf"],["id","companyChart","appScrollableHorizontal","",3,"scroll"],["styleClass","company",3,"value","preserveSpace","onNodeExpand","onNodeCollapse"],["companyChart",""],["pTemplate","org"],[4,"ngIf"],[1,"row","mx-0"],[1,"col-md-4","col-12"],[3,"control","filter","change"],["label","organization",3,"control","List"],["class","col-md-4 col-12",4,"ngIf"],["elementId","companyChart",3,"resource"],[1,"node-header",3,"id"],["class","action-icons",4,"ngIf"],["class","node-content main-data",4,"ngIf"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","node-footer",3,"click",4,"ngIf"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],[1,"action-icons"],["mat-icon-button","","class","pi pi-trash danger",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",1,"pi","pi-plus","info",3,"matTooltip","click"],["mat-icon-button","",1,"pi","pi-trash","danger",3,"matTooltip","click"],[1,"node-content","main-data"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e._UZ(0,"p-toast"),e.YNc(1,Ht,20,23,"mat-tab-group",0)),2&t&&(e.xp6(1),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[n.O5,_.$,r.c,q.lW,d.Lv,u.SP,u.uX,h.gM,ne.t,me.q,C._Y,C.JL,C.sg,H.jx,j.FN,R.OE,Dt,wt,Fe,n.rS,L.X$],styles:[".mat-tab-body-content{padding:0;overflow-y:auto!important}  .view-tabs-group .mat-tab-header .mat-tab-labels{justify-content:flex-start}  .mat-dialog-content{max-height:65vh!important}[_nghost-%COMP%]     .company-chart .node-header i{font-size:16px;cursor:pointer}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header{position:relative}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header span{display:inline-block;max-width:calc(100% - 44px)}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons{float:right;position:absolute;top:12px;right:0}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons i{font-size:1rem;margin-right:10px}.ar[_ngcontent-%COMP%]   .action-icons[_ngcontent-%COMP%]{float:left!important;left:0!important;right:auto!important;right:initial!important}.ar[_ngcontent-%COMP%]   .action-icons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;margin-right:0}.ft-image[_ngcontent-%COMP%], .ft-file[_ngcontent-%COMP%]{cursor:pointer}"]}),a})();function $t(a,s){if(1&a&&e._UZ(0,"app-add-new-btn",5),2&a){const t=e.oxw();e.MGl("url","/org-management/",t.moduleId,"/org-structure/add"),e.Q6J("params",t.parentParam)}}function Kt(a,s){if(1&a&&e._UZ(0,"app-prime-dropdown",18),2&a){const t=e.oxw();e.Q6J("control",t.formCtrls.CopyStructureID)("submitted",t.submitted)("List",t.structureList)}}function Wt(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"reset-form-btn",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}function Vt(a,s){1&a&&(e._UZ(0,"span",22),e.TgZ(1,"div",23),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"canNotEditOrgStructure")," "))}function Xt(a,s){1&a&&(e.TgZ(0,"p-messages",20),e.YNc(1,Vt,4,3,"ng-template",21),e.qZA())}let qe=(()=>{class a extends Z.U{constructor(t){super(),this.orgStructureService=t,this.submitted=!1,this.todayDate=new Date,this.structureList=[],this.todayDate.setHours(0,0,0,0)}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],en_Name:[null,[C.kI.required,T.w.whiteSpace]],ar_Name:[null,[C.kI.required,T.w.whiteSpace]],froM_DATE:[null,[C.kI.required]],CopyStructureID:[null]}),this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&(0==this.orgStructureId?this.getAllStructures():this.getById())}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.orgStructureService.getById(this.orgStructureId).pipe(this.cancelRequest()).subscribe(t=>{t?.message?.messageType==b.u.Success?(this.orgStructure=t.data[0],this.orgStructureToEdit()):this.errorList(t?.message?.messages),this.hideLoading()})}orgStructureToEdit(){this.form.patchValue(this.orgStructure)}submit(){this.submitted=!0,this.form.valid&&(0==this.formCtrls.id.value?this.create():this.update())}create(){const t={Core_Org_Structure:{en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:D.M.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE)},CopyStructureID:this.formCtrls.CopyStructureID.value};this.showLoading(),this.orgStructureService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructureId=o.data.id,this.formCtrls.id.setValue(this.orgStructureId),this.navigateTo(`/org-management/${this.moduleId}/org-structure/edit/${this.orgStructureId}`),this.orgStructure=o.data,this.formCtrls.CopyStructureID.reset()):this.errorList(o?.message?.messages),this.hideLoading()})}update(){const t={id:this.form.value.id,en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:D.M.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE),to_DATE:D.M.mapDateReverse(this.orgStructure.tO_DATE)};this.showLoading(),this.orgStructureService.update(t).subscribe(o=>{o.message.messageType==b.u.Success?(this.updateSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructure=o.data):this.errorList(o?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}canNotEdit(){return new Date(this.todayDate).getTime()>=new Date(this.orgStructure?.froM_DATE).getTime()}getAllStructures(){this.orgStructureService.getAll().pipe(this.cancelRequest()).subscribe(t=>{(t.message.messageType=b.u.Success)?this.structureList=[{id:0,ar_Name:"\u0627\u0646\u0634\u0627\u0621 \u062c\u062f\u064a\u062f",en_Name:"Create new"},...t.data]:this.errorList(t?.message?.messages)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(W._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-org-structure"]],features:[e.qOj],decls:25,vars:19,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","orgStructure","editTitle","editOrgStructure",3,"id"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["label","froM_DATE",3,"control","submitted","minDate","disabled"],["label","copyFromPreviousStructure",3,"control","submitted","List",4,"ngIf"],["align","end"],[3,"click",4,"ngIf"],[3,"id","onClick"],["severity","warn",4,"ngIf"],[3,"orgStructureId","canNotEdit"],["label","copyFromPreviousStructure",3,"control","submitted","List"],[3,"click"],["severity","warn"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.YNc(5,$t,1,2,"app-add-new-btn",4),e._UZ(6,"app-back-btn",5),e.qZA(),e.TgZ(7,"mat-card-content",6)(8,"div",0)(9,"div",1)(10,"form",7)(11,"div",0)(12,"div",8),e._UZ(13,"app-input",9),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"app-input",10),e.qZA(),e.TgZ(16,"div",8),e._UZ(17,"app-datepicker",11),e.qZA(),e.TgZ(18,"div",8),e.YNc(19,Kt,1,3,"app-prime-dropdown",12),e.qZA()()()()()(),e.TgZ(20,"mat-card-actions",13),e.YNc(21,Wt,1,0,"reset-form-btn",14),e.TgZ(22,"submit-btn",15),e.NdJ("onClick",function(){return o.submit()}),e.qZA()(),e.YNc(23,Xt,2,0,"p-messages",16),e._UZ(24,"app-org-structure-hierarchy-details",17),e.qZA()()()),2&t&&(e.xp6(4),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.en_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.ar_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.froM_DATE)("submitted",o.submitted)("minDate",o.todayDate)("disabled",o.canNotEdit()),e.xp6(2),e.Q6J("ngIf",0==o.form.value.id),e.xp6(2),e.Q6J("ngIf",0==o.formCtrls.id.value),e.xp6(1),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.canNotEdit()),e.xp6(1),e.Q6J("orgStructureId",o.orgStructureId||o.formCtrls.CopyStructureID.value)("canNotEdit",0==o.orgStructureId||o.canNotEdit()))},dependencies:[n.O5,A.Q,E.a,z.a,te.J,pe.J,oe.p,U.T,I.a8,I.dn,I.n5,I.hq,ne.t,C._Y,C.JL,C.sg,H.jx,ae.V,Re,L.X$]}),a})();var Be=c(36162);function eo(a,s){if(1&a&&e._UZ(0,"app-org-structure-hierarchy-details",6),2&a){const t=e.oxw();e.Q6J("orgStructureId",t.orgStructureId)("canNotEdit",!0)}}let to=(()=>{class a extends Z.U{constructor(){super(),this.orgStructureId=0}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-structure-details"]],features:[e.qOj],decls:7,vars:3,consts:[[1,"row"],[1,"col-12"],[1,"mtop-15"],["title","orgStructureDetails"],[3,"url","params"],[3,"orgStructureId","canNotEdit",4,"ngIf"],[3,"orgStructureId","canNotEdit"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3)(5,"app-back-btn",4),e.qZA(),e.YNc(6,eo,1,2,"app-org-structure-hierarchy-details",5),e.qZA()()()),2&t&&(e.xp6(5),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(1),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[n.O5,z.a,U.T,I.a8,I.n5,Re]}),a})();var oo=c(6314),no=c(92972);let ao=(()=>{class a extends Z.U{constructor(t){super(),this.jobTitleService=t,this.mandatoryColomns=["Ser","id","code","en_Name","ar_Name","actions"],this.optionalColomns=["jobFamily"],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.dataSource=new v.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.jobTitleService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(l.message.messageType==b.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by((0,oo.gc)(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.jobTitleService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(no._))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-jobs-profile-index"]],features:[e.qOj],decls:9,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","jobsProfile",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"app-material-table",4),e.NdJ("onChangePage",function(l){return o.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return o.onDelete(l)}),e.qZA()()()(),e.TgZ(6,"side-helping-menu",5),e.ALo(7,"translate"),e._UZ(8,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(4),e.Q6J("globalFunctions",null==o.globalFunctions?null:o.globalFunctions.reverse()),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("exportService",o.jobTitleService)("actions",o.rowFunctions),e.xp6(1),e.s9C("title",e.lcZ(7,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[k.I,U.T,X.c,ee.b,I.a8,I.n5,L.X$]}),a})();var Ye=c(61900),io=c(63581);function ke(a){return a.map(s=>({...s,kpi:(0,D._)(s.core_KPI?.ar_Name,s.core_KPI?.en_Name)}))}var ro=c(24850);let so=(()=>{class a extends je.K{constructor(){super()}create(t){return this.post("OrgStructure/Create_KpiOrg",t)}getList(t,o){return this.get("OrgStructure/GetList_KpiOrg",{params:{...t,$expand:V.db.core_KPI,$filter:`orgId eq ${o}`}})}getAll(){return this.get("OrgStructure/GetAll_KpiOrg").pipe((0,ro.U)(t=>(t.data=ke(t.data),t)))}Delete(t){return this.delete("OrgStructure/Delete_KpiOrg",{params:{Id:t}})}exportExcel(){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var lo=c(85443),co=c(50260),po=c(50162);function mo(a,s){if(1&a){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"app-material-table",13),e.NdJ("onChangePage",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.getList(i.pageIndex+1,i.pageSize))})("deleteRow",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.onDelete(i))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)}}let go=(()=>{class a extends Z.U{constructor(t){super(),this.orgKpisService=t,this.submitted=!1,this.mandatoryColomns=["Ser","kpi","actions"],this.isLoaded=!0,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({OrgTypeId:[null,[C.kI.required]],OrgId:[null,[C.kI.required]],KPI_Id:[null,[C.kI.required]]})}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null))}get formCtrls(){return this.form.controls}getList(t,o){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null));let i=this.formCtrls.OrgId.value;i>0&&(this.isLoaded=!1,this.page.pageIndex=t,o&&(this.page.pageSize=o),this.orgKpisService.getList({PageNumber:t,pageSize:this.page.pageSize},i).pipe(this.cancelRequest()).subscribe(f=>{f.message.messageType==b.u.Success?(this.dataSource=new v.by(ke(f.data)),this.isLoaded=!0,this.page.length=f.meta.totalItemCount,this.page.meta=f.meta):this.errorList(f?.message?.messages)}))}submit(){this.submitted=!0,this.form.valid&&this.create({OrgId:this.form.value.OrgId,KPI_Id:this.form.value.KPI_Id})}create(t){this.showLoading(),this.orgKpisService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.clearForm(),this.addSuccessfullyMsg(o?.message?.messageTypeName),this.getList(this.lastPage)):this.errorList(o?.message?.messages),this.hideLoading()})}onDelete(t){this.deleteDialog(t.kpi).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.orgKpisService.Delete(t.id).subscribe(o=>{o.message.messageType==b.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}clearForm(){this.formCtrls.KPI_Id.reset(),this.submitted=!1}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-org-kpis"]],features:[e.qOj],decls:20,vars:14,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["title","orgKpis"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","orgTypeControl","submitted","filter","change"],["align","end"],[3,"onClick"],[4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3)(5,"app-back-btn",4),e.qZA(),e.TgZ(6,"mat-card-content",5)(7,"div",0)(8,"div",1)(9,"form",6)(10,"div",0)(11,"div",7),e._UZ(12,"app-org-types-dropdown-current-structure",8),e.qZA(),e.TgZ(13,"div",7)(14,"app-organization-by-org-type-dropdown",9),e.NdJ("change",function(){return o.getList(o.firstPage)}),e.qZA()(),e.TgZ(15,"div",7),e._UZ(16,"app-kpi-dropdown",8),e.qZA()()()()()(),e.TgZ(17,"mat-card-actions",10)(18,"submit-btn",11),e.NdJ("onClick",function(){return o.submit()}),e.qZA()(),e.YNc(19,mo,3,6,"ng-container",12),e.qZA()()()),2&t&&(e.xp6(5),e.MGl("url","/org-management/",o.moduleId,"/org-structure"),e.Q6J("params",o.pageParams),e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.OrgTypeId)("submitted",o.submitted)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.OrgId)("orgTypeControl",o.formCtrls.OrgTypeId)("submitted",o.submitted)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.KPI_Id)("submitted",o.submitted)("filter",!0),e.xp6(3),e.Q6J("ngIf",o.formCtrls.OrgId.value>0))},dependencies:[n.O5,k.I,z.a,oe.p,U.T,I.a8,I.dn,I.n5,I.hq,ie.d,lo.A,co.v,po.M,C._Y,C.JL,C.sg]}),a})();var Qe=c(49057);let _o=(()=>{class a extends Z.U{constructor(t){super(),this.policyGroupService=t,this.mandatoryColomns=["Ser","id","ar_Name","en_Name","policyGroupType","noOfEmployees","actions"],this.optionalColomns=[],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o),this.policyGroupService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(1==l.message.messageType){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new v.by(function uo(a){return a.map(s=>({id:s?.core_PolicyGroup?.id,ar_Name:s?.core_PolicyGroup?.ar_Name,en_Name:s?.core_PolicyGroup?.en_Name,policyGroupType:(0,D._)(s?.core_PolicyGroup?.core_PolicyGroup_Type?.ar_Name,s?.core_PolicyGroup?.core_PolicyGroup_Type?.en_Name),noOfEmployees:s.countEmpsOnPolicy}))}(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.policyGroupService.Delete(t.id).subscribe(o=>{1==o.message.messageType?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Qe.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-policy-group-index"]],features:[e.qOj],decls:9,vars:12,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","policyGroups",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","exportService","onChangePage","deleteRow"],[3,"title"],[3,"serviceId"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"app-material-table",4),e.NdJ("onChangePage",function(l){return o.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return o.onDelete(l)}),e.qZA()()()(),e.TgZ(6,"side-helping-menu",5),e.ALo(7,"translate"),e._UZ(8,"app-dashboard-display",6),e.qZA()),2&t&&(e.xp6(4),e.Q6J("globalFunctions",o.globalFunctions),e.xp6(1),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("actions",o.rowFunctions)("exportService",o.policyGroupService),e.xp6(1),e.s9C("title",e.lcZ(7,10,"Dashboard")),e.xp6(2),e.Q6J("serviceId",o.getCurrentServiceId()))},dependencies:[k.I,U.T,X.c,ee.b,I.a8,I.n5,L.X$]}),a})();var ho=c(33975);const fo=function(){return[]};let bo=(()=>{class a{constructor(t,o,i){this.model=t,this.dialogRef=o,this.policyGroupService=i,this.policyStartDate=new C.NI(""),this.appHelper=new Z.U,this.selectedEmployees=[],this.mandatoryColomns=["employee","code",ho.g.selectColName],t?.intersectionEmployees&&(t?.intersectionEmployees.map(l=>{l.employee=(0,D._)(l.employeeNameAR,l.employeeNameEN),l.code=l.employeeCode}),this.dataSource=new v.by(t?.intersectionEmployees)),this.policyStartDate.valueChanges.subscribe(l=>{})}submit(){0!==this.selectedEmployees?.length?(this.appHelper.showLoading(),this.policyGroupService.saveIntersectionEmployees(this.selectedEmployees).subscribe(t=>{t?.message?.messageType==b.u.Success?(this.selectedEmployees=[],this.dialogRef.close(!0),this.appHelper.addSuccessfullyMsg(t?.message?.messageTypeName)):this.appHelper.errorList(t?.message?.messages),this.appHelper.hideLoading()})):this.appHelper.error("mustSelectEmployeeAtLeast","validation")}onSelectEmployee(t){const o=[];this.dataSource.data.forEach(i=>{if(i.isSelected){let l={employeeId:i.employeeId,policyGroupId:this.model.data.id,policyGroupTypeId:this.model.data.policyGroup_Type_ID,policyStartDate:D.M.transformData(this.policyStartDate?.value)};o.push(l)}}),this.selectedEmployees=o}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.WI),e.Y36(x.so),e.Y36(Qe.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-intersection-emp-dialog"]],decls:20,vars:17,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","intersectionEmployee",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"container-fluid","mx-0","mt-1"],[1,"row"],[1,"col-12"],[1,"col-md-4","col-12"],["label","startDate",3,"control"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showSpaceTop","showPaginator","showFilter","selectedItems"],["mat-dialog-actions","","align","end"],["mat-raised-button","",1,"btn","btn-light",3,"mat-dialog-close"],["mat-raised-button","",1,"btn","btn-darkBlue",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA(),e.TgZ(3,"button",2),e._UZ(4,"i",3),e.qZA()(),e.TgZ(5,"mat-dialog-content",4)(6,"div",5)(7,"div",6)(8,"div",5)(9,"div",7),e._UZ(10,"app-datepicker",8),e.qZA()()(),e.TgZ(11,"div",6)(12,"app-material-table",9),e.NdJ("selectedItems",function(l){return o.onSelectEmployee(l)}),e.qZA()()()(),e.TgZ(13,"div",10)(14,"button",11),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return o.submit()}),e._uU(18),e.ALo(19,"translate"),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("mat-dialog-close",!1),e.xp6(7),e.Q6J("control",o.policyStartDate),e.xp6(2),e.Q6J("isLoaded",!0)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",e.DdM(16,fo))("showSpaceTop",!1)("showPaginator",!1)("showFilter",!1),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.hij(" ",e.lcZ(16,12,"General.cancel")," "),e.xp6(3),e.hij(" ",e.lcZ(19,14,"save")," "))},dependencies:[A.Q,k.I,U.T,q.lW,x.ZT,x.uh,x.xY,x.H8,L.X$]}),a})();var F=(()=>{return(a=F||(F={}))[a.OPEN=1]="OPEN",a[a.ORGANIZATIONS=2]="ORGANIZATIONS",a[a.JOB_TITLE=3]="JOB_TITLE",a[a.LOCATION=4]="LOCATION",F;var a})();const Co=[{label:"open",value:F.OPEN,cssClass:"col-6 col-lg-3 px-2"},{label:"organizations",value:F.ORGANIZATIONS,cssClass:"col-6 col-lg-3 px-2"},{label:"job",value:F.JOB_TITLE,cssClass:"col-6 col-lg-3 px-2"},{label:"location",value:F.LOCATION,cssClass:"col-6 col-lg-3 px-2"}];var yo=c(45679),To=c(92393),vo=c(86195),xo=c(29260);function Io(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",20)(1,"app-employee-select-table",21),e.NdJ("onSelect",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.getSelectedEmp(i))})("length",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.getEmployeesCount(i))}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("reset",t.resetEmployeeList)}}function Do(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"mat-card",14)(1,"mat-card-title",0),e._uU(2),e._UZ(3,"page-title",15),e.qZA(),e._UZ(4,"mat-divider",2),e.TgZ(5,"mat-card-content",16)(6,"div",4),e.YNc(7,Io,2,1,"div",17),e.qZA()(),e.TgZ(8,"mat-card-actions",18)(9,"submit-btn",19),e.NdJ("onClick",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e.qZA()()()}if(2&a){const t=e.oxw();let o;e.xp6(2),e.hij(" ",null!==(o=t.selectedCount)&&void 0!==o?o:""," "),e.xp6(1),e.Q6J("title",t.getTitle()),e.xp6(4),e.Q6J("ngIf",t.groupingTypeCtrl.value==t.groupingList.OPEN),e.xp6(2),e.Q6J("id",t.formCtrls.id.value)("color",t.btn.darkBlue)("iconPositionBefore",!1)}}function So(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"app-material-table",23),e.NdJ("onChangePage",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.getDetailsList(i.pageIndex+1,i.pageSize))})("deleteRow",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onDelete(i))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("page",t.page)("showSpaceTop",!1)}}function Oo(a,s){if(1&a&&(e.TgZ(0,"mat-card",14)(1,"mat-card-title",0),e._uU(2),e._UZ(3,"page-title",15),e.qZA(),e._UZ(4,"mat-divider",2),e.TgZ(5,"mat-card-content",16)(6,"div",4)(7,"div",20),e.YNc(8,So,1,7,"app-material-table",22),e.qZA()()()()),2&a){const t=e.oxw();let o;e.xp6(2),e.hij(" ",null!==(o=null==t.dataSource||null==t.dataSource.data?null:t.dataSource.data.length)&&void 0!==o?o:0," "),e.xp6(1),e.Q6J("title",t.getTitle()),e.xp6(5),e.Q6J("ngIf",t.policyGroupId>0)}}let Zo=(()=>{class a extends Z.U{constructor(t){super(),this.policyGroupService=t,this.submitted=!1,this.radioList=Co,this.groupingList=F,this.mandatoryColomns=["employee","actions"],this.optionalColomns=[],this.isLoaded=!1,this.actionType=yo.U,this.activatedRoute.paramMap.subscribe(o=>{this.policyGroupId=Number(o.get("id"))??0,this.policyGroupId||this.radioList.map(i=>i.disabled=!1)})}orgChanged(t){console.log(t)}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,C.kI.required],en_Name:[null,C.kI.required],policyGroup_Type_ID:[null,C.kI.required],groupingType:[F.OPEN,C.kI.required],selectedEmployeesIDs:[null],orgTypeId:[null],orgId:[null],countryId:[null],selectedOrgIDs:[null],selectedLocationsIDs:[null],selectedJobsIDs:[null]})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.policyGroupId>0&&(this.getById(),this.getDetailsList(this.firstPage))}get formCtrls(){return this.form.controls}get groupingTypeCtrl(){return this.form.get("groupingType")}submit(){if(this.submitted=!0,0==this.formCtrls.id.value){if(this.form.value.groupingType==F.OPEN&&0==this.form.value.selectedEmployeesIDs?.length)return void this.error("mustSelectEmployeeAtLeast","validation");if(this.form.value.groupingType==F.ORGANIZATIONS&&0==this.form.value.selectedOrgIDs?.length)return void this.error("mustSelectOrgAtLeast","validation");if(this.form.value.groupingType==F.LOCATION&&0==this.form.value.selectedLocationsIDs?.length)return void this.error("mustSelectLocationAtLeast","validation")}if(this.form.valid){const t={core_PolicyGroup:{id:this.formCtrls.id.value,ar_Name:this.formCtrls.ar_Name.value,en_Name:this.formCtrls.en_Name.value,policyGroup_Type_ID:this.formCtrls.policyGroup_Type_ID.value,groupingType:this.groupingTypeCtrl.value},selectedEmployeesIDs:this.formCtrls.selectedEmployeesIDs.value,selectedOrgIDs:this.formCtrls.selectedOrgIDs.value,SelectedLocationsIDs:this.formCtrls.selectedLocationsIDs.value};t.core_PolicyGroup.id>0?this.update(t):this.create(t)}}create(t){this.showLoading(),this.policyGroupService.create(t).subscribe(o=>{o?.message?.messageType==b.u.Success?(this.policyGroupId=o.data.id,this.formCtrls.id.setValue(this.policyGroupId),this.disableRadioList(),o?.intersectionEmployees?.length>0&&this.intersectionEmpDialog(o),this.navigateTo(`/org-management/${this.moduleId}/policy-group/edit/${this.policyGroupId}`),this.addSuccessfullyMsg(o?.message?.messageTypeName),this.getDetailsList(this.firstPage),this.resetEmployeeList=!0):this.errorList(o?.message?.messages),this.hideLoading()})}update(t){this.showLoading(),this.policyGroupService.edit(t).subscribe(o=>{o.message.messageType==b.u.Success?(o?.intersectionEmployees?.length>0&&this.intersectionEmpDialog(o),this.updateSuccessfullyMsg(o?.message?.messageTypeName),this.getDetailsList(this.firstPage),this.resetEmployeeList=!0):this.errorList(o?.message?.messages),this.hideLoading()})}getById(){this.showLoading(),this.policyGroupService.getById(this.policyGroupId).subscribe(t=>{t.message.messageType==b.u.Success?(this.form.patchValue(t.data[0]),this.disableRadioList()):this.errorList(t?.message?.messages),this.hideLoading()})}getDetailsList(t,o){this.showLoading(),this.page.pageIndex=t,o&&(this.page.pageSize=o);let i={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.policyGroupService.getDetailsList(i,this.policyGroupId).subscribe(l=>{l.message.messageType==b.u.Success?(l.data.map(f=>f.employee=(0,D._)(f.itemNameAR,f.itemNameEN)),this.dataSource=new v.by(l.data),this.page.length=l.meta.totalItemCount,this.page.meta=l.meta,this.isLoaded=!0):this.errorList(l?.message?.messages),this.hideLoading()})}intersectionEmpDialog(t){this.dialogsService.addEditDialog(bo,t).afterClosed().subscribe(o=>{o&&this.getDetailsList(this.currentPage)})}onDelete(t){let o=(0,D._)(t.itemNameAR,t.itemNameEN);this.deleteDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.policyGroupService.deleteDetails({PolicyGroupId:t.policyGroupId,itemId:t.itemId,gropingType:this.form.value.groupingType}).subscribe(i=>{1==i.message.messageType?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getDetailsList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(i?.message?.messages),this.hideLoading()})}getSelectedEmp(t){let o=[];t.forEach(i=>o.push(i.id)),this.formCtrls.selectedEmployeesIDs.setValue(o)}disableRadioList(){this.radioList.map(t=>t.disabled=!0)}changeGrouping(){this.formCtrls.orgId.reset(),this.formCtrls.selectedOrgIDs.reset()}getEmployeesCount(t){this.selectedCount=t}clearForm(){this.form.reset({id:0,groupingType:F.OPEN}),this.submitted=!1}getTitle(){return this.groupingTypeCtrl.value==this.groupingList.OPEN?"selectedEmployees":this.groupingTypeCtrl.value==this.groupingList.ORGANIZATIONS?"organization":this.groupingTypeCtrl.value==this.groupingList.LOCATION?"location":this.groupingTypeCtrl.value==this.groupingList.JOB_TITLE?"jobTitle":void 0}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Qe.B))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-policy-group"]],features:[e.qOj],decls:19,vars:13,consts:[[1,"title-no-margin"],["title","generalInfo"],[1,"mt-2"],[1,"container-fluid","mt-4"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","ar_Name",3,"control","submitted"],["label","en_Name",3,"control","submitted"],[3,"control","submitted","disable"],[1,"col-12","mt-1"],["label","groupingType","titleClass","col-12 col-lg-2",3,"control","radioList","submitted","change"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[3,"title"],[1,"mt-4","px-2"],["class","col col-lg-6",4,"ngIf"],["align","end"],["icon","fas fa-save",3,"id","color","iconPositionBefore","onClick"],[1,"col","col-lg-6"],[3,"reset","onSelect","length"],["class","table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showSpaceTop","onChangePage","deleteRow",4,"ngIf"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showSpaceTop","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0),e._UZ(2,"page-title",1),e.qZA(),e._UZ(3,"mat-divider",2),e.TgZ(4,"mat-card-content",3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",4)(9,"div",7),e._UZ(10,"app-input",8),e.qZA(),e.TgZ(11,"div",7),e._UZ(12,"app-input",9),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"policy-group-type-dropdown",10),e.qZA(),e.TgZ(15,"div",11)(16,"app-radio-button",12),e.NdJ("change",function(){return o.changeGrouping()}),e.qZA()()()()()()()(),e.YNc(17,Do,10,6,"mat-card",13),e.YNc(18,Oo,9,3,"mat-card",13)),2&t&&(e.xp6(7),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.ar_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.en_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.policyGroup_Type_ID)("submitted",o.submitted)("disable",o.policyGroupId>0),e.xp6(2),e.Q6J("control",o.formCtrls.groupingType)("radioList",o.radioList)("submitted",o.submitted),e.xp6(1),e.Q6J("ngIf",o.groupingTypeCtrl.value),e.xp6(1),e.Q6J("ngIf",o.policyGroupId>0))},dependencies:[n.O5,E.a,To._,k.I,oe.p,U.T,vo.f,I.a8,I.dn,I.n5,I.hq,ie.d,xo.X,C._Y,C.JL,C.sg],styles:[".navbar[_ngcontent-%COMP%]{background:#FFF!important}"]}),a})();const Ao=["stepper"];function Jo(a,s){if(1&a&&e._UZ(0,"app-add-new-btn",3),2&a){const t=e.oxw();e.MGl("url","/org-management/",t.moduleId,"/policy-group/add"),e.Q6J("params",t.parentParam)}}let He=(()=>{class a extends Z.U{constructor(){super(),this.activatedRoute.paramMap.subscribe(t=>{this.policyGroupId=Number(t.get("id"))??0})}ngOnInit(){}stepChanged(){this.stepper.selected.interacted=!1}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-policy-group-core"]],viewQuery:function(t,o){if(1&t&&e.Gf(Ao,5),2&t){let i;e.iGM(i=e.CRH())&&(o.stepper=i.first)}},features:[e.qOj],decls:8,vars:3,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","addPolicyGroup"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"has-fixed-title"],[1,"ptop-85"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ynx(2),e.YNc(3,Jo,1,2,"app-add-new-btn",2),e._UZ(4,"app-back-btn",3),e.BQk(),e.qZA(),e.TgZ(5,"mat-card-content",4)(6,"div",5),e._UZ(7,"app-add-policy-group"),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngIf",o.policyGroupId>0),e.xp6(1),e.MGl("url","/org-management/",o.moduleId,"/policy-group"),e.Q6J("params",o.pageParams))},dependencies:[n.O5,z.a,te.J,U.T,I.dn,I.n5,Zo]}),a})();var G=c(3710);const Lo=[{path:"org-structure",data:{view:J.S.org_structure},children:[{path:"",redirectTo:"index",pathMatch:Be.U.full},{path:"index",component:S,data:{view:J.S.org_structure_index},canActivate:[G.r]},{path:"add",component:qe,data:{view:J.S.add_org_structure},canActivate:[G.r]},{path:"edit/:orgStructureId",component:qe,data:{view:J.S.add_org_structure},canActivate:[G.r]},{path:"details/:orgStructureId",component:to,data:{view:J.S.org_structure_details},canActivate:[G.r]},{path:"kpis",component:go,data:{view:J.S.org_kpis},canActivate:[G.r]}]},{path:"job-profile",data:{view:J.S.job_profile},children:[{path:"",redirectTo:"index",pathMatch:Be.U.full},{path:"index",component:ao,data:{view:J.S.job_profile_index},canActivate:[G.r]},{path:"add",component:Ye.g,data:{view:J.S.add_job_profile},canActivate:[G.r]},{path:"edit/:jobId",component:Ye.g,data:{view:J.S.add_job_profile},canActivate:[G.r]},{path:"assign-job-to-org",component:io.A,data:{view:J.S.assign_job_to_org},canActivate:[G.r]}]},{path:"policy-group",data:{view:J.S.policy_group},children:[{path:"",redirectTo:"index",pathMatch:Be.U.full},{path:"index",component:_o,data:{view:J.S.policy_group_index},canActivate:[G.r]},{path:"add",component:He,data:{view:J.S.add_policy_group},canActivate:[G.r]},{path:"edit/:id",component:He,data:{view:J.S.add_policy_group},canActivate:[G.r]}]}];let Eo=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.Bz.forChild(Lo),g.Bz]}),a})();var No=c(66393);let Po=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[n.ez,Eo,No.m]}),a})()},45390:(se,Q,c)=>{c.d(Q,{b:()=>Ue});var n=c(94650),g=c(95751),v=c(30671),D=c(22699),N=c(74513),M=c(15602),y=c(65938),P=c(24006),$=c(35478),K=c(89609),O=c(70137),m=c(57566),b=c(46896),Z=c(4859),e=c(86405),W=c(49274);let k=(()=>{class p extends g.U{constructor(r,d,u){super(),this.employeeJobInfoService=r,this.dialogRef=d,this.job=u,this.CloseDate=new P.NI("",P.kI.required),this.submitted=!1}submit(){if(this.submitted=!0,this.CloseDate.valid){this.showLoading("close");let r={Employee_Job_Title_ID:this.job?.id,CloseDate:$.M.transformData(this.CloseDate.value)};this.employeeJobInfoService.close(r).subscribe(d=>{d.message.messageType==M.u.Success?(this.success(d?.message?.messageTypeName),this.CloseDate.reset(),this.submitted=!1,this.dialogRef.close()):this.errorList(d?.message?.messages),this.hideLoading("close")})}}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(K._),n.Y36(y.so),n.Y36(y.WI))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-close-job-dialog"]],features:[n.qOj],decls:17,vars:11,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","close_job",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"container-fluid","mx-0","mt-3"],[1,"row"],[1,"col-md-4","col-5"],["label","date",3,"control","submitted"],[1,"col-4"],["label","close_job","icon","fas fa-save",1,"btn-large","mt-1","line-height-3","mr-0","ml-0",3,"color","iconPositionBefore","onClick"],["mat-dialog-actions","","align","end"],["mat-raised-button","",1,"btn","btn-light",3,"mat-dialog-close"],[3,"name"]],template:function(r,d){1&r&&(n.TgZ(0,"div",0)(1,"h4"),n._UZ(2,"page-title",1),n._uU(3),n.qZA(),n.TgZ(4,"button",2),n._UZ(5,"i",3),n.qZA()(),n.TgZ(6,"mat-dialog-content",4)(7,"div",5)(8,"div",6),n._UZ(9,"app-datepicker",7),n.qZA(),n.TgZ(10,"div",8)(11,"submit-btn",9),n.NdJ("onClick",function(){return d.submit()}),n.qZA()()()(),n.TgZ(12,"div",10)(13,"button",11),n._uU(14),n.ALo(15,"translate"),n.qZA()(),n._UZ(16,"ngx-spinner",12)),2&r&&(n.xp6(3),n.hij(" ",d.msgTranslate(null==d.job||null==d.job.core_Job_Title?null:d.job.core_Job_Title.ar_Name,null==d.job||null==d.job.core_Job_Title?null:d.job.core_Job_Title.en_Name)," "),n.xp6(1),n.Q6J("mat-dialog-close",!1),n.xp6(5),n.Q6J("control",d.CloseDate)("submitted",d.submitted),n.xp6(2),n.Q6J("color",d.btn.darkBlue)("iconPositionBefore",!1),n.xp6(2),n.Q6J("mat-dialog-close",!1),n.xp6(1),n.hij(" ",n.lcZ(15,9,"General.cancel")," "),n.xp6(2),n.Q6J("name","close"))},dependencies:[O.Q,m.p,b.T,Z.lW,y.ZT,y.uh,y.xY,y.H8,e.Ro,W.X$]}),p})();var U=c(61757),X=c(1903);let ee=(()=>{class p extends X.K{constructor(){super()}create(r){return this.post("Personnel/Employees/Create_EmployeeManger",r)}getList(r,d){return this.get("Personnel/Employees/GetList_EmployeeManger",{params:{...d,orgid:r}})}getAll(r,d){return this.get("Personnel/Employees/GetAll_EmployeeManger",{params:{prtid:r,orgid:d}})}Delete(r){return this.delete("Personnel/Employees/Delete_EmployeeManger",{params:r})}}return p.\u0275fac=function(r){return new(r||p)},p.\u0275prov=n.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})();var I=c(93410),L=c(44850);let S=(()=>{class p extends g.U{constructor(r,d,u){super(),this.EmployeeAssignAsOrgManagerService=r,this.org=d,this.dialogRef=u,this.mandatoryColomns=["employee","startDate","endDate","actions"],this.optionalColomns=[],this.isLoaded=!1,this.submitted=!1,this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,N.S.emp_job_info_assign_manager_sec)}ngOnInit(){this.form=this.fb.group({from_Date:[null,[P.kI.required]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.org.person_Instance_ID>0&&this.getList(this.firstPage)}getList(r,d){this.dataSource=new v.by(null),this.isLoaded=!1,this.page.pageIndex=r,d&&(this.page.dialogSize=d),this.EmployeeAssignAsOrgManagerService.getList(this.org.core_Org?.id,{PageNumber:r,pageSize:this.page.dialogSize}).pipe(this.cancelRequest()).subscribe(h=>{h.message.messageType==M.u.Success?(this.dataSource=new v.by((0,U.GP)(h.data)),this.page.length=h.meta.totalItemCount,this.page.meta=h.meta,this.isLoaded=!0):this.errorList(h?.message?.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){const r={Person_Instance_ID:this.org.person_Instance_ID,Person_Instance_Org_ID:this.org.id,From_Date:$.M.mapDateReverse(this.form.value.from_Date)};this.create(r)}}create(r){this.showLoading("manager"),this.EmployeeAssignAsOrgManagerService.create(r).subscribe(d=>{d?.message?.messageType==M.u.Success?(this.clearForm(),this.addSuccessfullyMsg(d?.message?.messageTypeName),this.getList(this.firstPage)):this.errorList(d?.message?.messages),this.hideLoading("manager")})}onDelete(r){this.deleteDialog(`${r.employee} (${r.startDate} - ${r.endDate})`).subscribe(u=>{u&&this.delete(r)})}delete(r){let d={prtid:r.person_Instance_ID,orgperid:r.person_Instance_Org_ID,fromdate:$.M.mapDateReverse(r.from_Date)};this.showLoading("manager"),this.EmployeeAssignAsOrgManagerService.Delete(d).subscribe(u=>{u.message.messageType==M.u.Success?(this.deleteSuccessfullyMsg(u?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.dialogSize)):this.errorList(u?.message?.messages),this.hideLoading("manager")})}clearForm(){this.form.reset(),this.submitted=!1}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(ee),n.Y36(y.WI),n.Y36(y.so))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-assign-as-org-manager-dialog"]],features:[n.qOj],decls:15,vars:15,consts:[[3,"name"],["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","assignManager",1,"d-inline-block","mtop-5"],["mat-icon-button","","mat-dialog-close","",1,"float-right","mb-1","bg-light-danger","mr-1"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],[3,"formGroup"],[1,"row","ptop-20"],[1,"col-md-6","col-4"],["label","date",3,"control","submitted"],[1,"col-4"],["icon","fas fa-save",1,"btn-large","mt-1","line-height-3",3,"color","iconPositionBefore","onClick"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","isDialogSize","showFilter","showSpaceTop","onChangePage","deleteRow"]],template:function(r,d){1&r&&(n._UZ(0,"ngx-spinner",0),n.TgZ(1,"div",1)(2,"h4"),n._UZ(3,"page-title",2),n.qZA(),n.TgZ(4,"button",3),n._UZ(5,"i",4),n.qZA()(),n.TgZ(6,"mat-dialog-content",5)(7,"form",6)(8,"div",7)(9,"div",8),n._UZ(10,"app-datepicker",9),n.qZA(),n.TgZ(11,"div",10)(12,"submit-btn",11),n.NdJ("onClick",function(){return d.submit()}),n.qZA()()()(),n._UZ(13,"mat-divider"),n.TgZ(14,"app-material-table",12),n.NdJ("onChangePage",function(h){return d.getList(h.pageIndex+1,h.pageSize)})("deleteRow",function(h){return d.onDelete(h)}),n.qZA()()),2&r&&(n.Q6J("name","manager"),n.xp6(7),n.Q6J("formGroup",d.form),n.xp6(3),n.Q6J("control",d.formCtrls.from_Date)("submitted",d.submitted),n.xp6(2),n.Q6J("color",d.btn.darkBlue)("iconPositionBefore",!1),n.xp6(2),n.Q6J("isLoaded",d.isLoaded)("dataSource",d.dataSource)("mandatoryColomns",d.mandatoryColomns)("optionalColomns",d.optionalColomns)("page",d.page)("actions",d.rowFunctions)("isDialogSize",!0)("showFilter",!1)("showSpaceTop",!1))},dependencies:[O.Q,I.I,m.p,b.T,Z.lW,L.d,y.ZT,y.uh,y.xY,e.Ro,P._Y,P.JL,P.sg]}),p})();var C=c(36895),T=c(98814),A=c(58313),E=c(9615),z=c(73546),te=c(10266),pe=c(96308),oe=c(98739);function ne(p,_){1&p&&(n.TgZ(0,"th",18),n._uU(1,"Ser"),n.qZA())}function H(p,_){1&p&&(n.TgZ(0,"td",19),n._UZ(1,"i",20),n.qZA())}function ae(p,_){1&p&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"status")))}function x(p,_){if(1&p&&(n.TgZ(0,"td",19),n._uU(1),n.qZA()),2&p){const r=_.$implicit,d=n.oxw(3);n.xp6(1),n.hij(" ",d.msgTranslate(null==r.core_Status?null:r.core_Status.ar_Name,null==r.core_Status?null:r.core_Status.en_Name)," ")}}function be(p,_){1&p&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"from_Date")))}function J(p,_){if(1&p&&(n.TgZ(0,"td",19),n._uU(1),n.ALo(2,"date"),n.qZA()),2&p){const r=_.$implicit;n.xp6(1),n.hij(" ",n.xi3(2,1,null==r?null:r.from_Date,"dd-MM-yyyy")," ")}}function de(p,_){1&p&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"to_Date")))}function q(p,_){if(1&p&&(n.TgZ(0,"td",19),n._uU(1),n.ALo(2,"date"),n.qZA()),2&p){const r=_.$implicit;n.xp6(1),n.hij(" ",n.xi3(2,1,null==r?null:r.to_Date,"dd-MM-yyyy")," ")}}function me(p,_){1&p&&n._UZ(0,"th",18)}function Ce(p,_){1&p&&(n.TgZ(0,"th",25),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"org actions"),""))}function ye(p,_){if(1&p&&(n.TgZ(0,"thead")(1,"tr",24)(2,"th",25),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"th",25),n._uU(6),n.ALo(7,"translate"),n.qZA(),n.TgZ(8,"th",25),n._uU(9),n.ALo(10,"translate"),n.qZA(),n.TgZ(11,"th",25),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"th",25),n._uU(15),n.ALo(16,"translate"),n.qZA(),n.TgZ(17,"th",25),n._uU(18),n.ALo(19,"translate"),n.qZA(),n.YNc(20,Ce,3,3,"th",26),n.qZA()()),2&p){const r=n.oxw(5);n.xp6(3),n.hij(" ",n.lcZ(4,7,"organization"),""),n.xp6(3),n.hij(" ",n.lcZ(7,9,"from_Date"),""),n.xp6(3),n.hij(" ",n.lcZ(10,11,"job"),""),n.xp6(3),n.hij(" ",n.lcZ(13,13,"from_Date"),""),n.xp6(3),n.hij(" ",n.lcZ(16,15,"counted"),""),n.xp6(3),n.hij(" ",n.lcZ(19,17,"job actions"),""),n.xp6(2),n.Q6J("ngIf",!r.hideActions)}}function ge(p,_){if(1&p&&(n.TgZ(0,"td",35),n._uU(1),n.qZA()),2&p){const r=n.oxw(2).$implicit,d=n.oxw(5);n.Q6J("rowSpan",null==r.core_Person_Instance_Job_Title?null:r.core_Person_Instance_Job_Title.length),n.xp6(1),n.hij(" ",d.msgTranslate(null==r||null==r.core_Org?null:r.core_Org.ar_Name,null==r||null==r.core_Org?null:r.core_Org.en_Name)," ")}}function Te(p,_){if(1&p&&(n.TgZ(0,"td",36),n._uU(1),n.ALo(2,"date"),n.qZA()),2&p){const r=n.oxw(2).$implicit;n.Q6J("rowSpan",null==r.core_Person_Instance_Job_Title?null:r.core_Person_Instance_Job_Title.length),n.xp6(1),n.hij(" ",n.xi3(2,2,null==r?null:r.from_Date,"dd-MM-yyyy")," ")}}function ue(p,_){1&p&&(n.TgZ(0,"span",37),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"yes")," "))}function ve(p,_){1&p&&(n.TgZ(0,"span",38),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"no")," "))}function xe(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"td",35)(1,"app-row-functions",39),n.NdJ("onAction",function(u){n.CHM(r);const h=n.oxw(2).$implicit,j=n.oxw(2).$implicit,R=n.oxw(3);return n.KtG(R.orgOnAction(u,j,h))}),n.qZA()()}if(2&p){const r=n.oxw(2).$implicit,d=n.oxw(5);n.Q6J("rowSpan",null==r.core_Person_Instance_Job_Title?null:r.core_Person_Instance_Job_Title.length),n.xp6(1),n.Q6J("actions",d.orgRowFunctions)}}function Ie(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"tr",28),n.YNc(1,ge,2,2,"td",29),n.YNc(2,Te,3,5,"td",30),n.TgZ(3,"td",31),n._uU(4),n.qZA(),n.TgZ(5,"td",31),n._uU(6),n.ALo(7,"date"),n.qZA(),n.TgZ(8,"td",31),n.YNc(9,ue,3,3,"span",32),n.YNc(10,ve,3,3,"ng-template",null,33,n.W1O),n.qZA(),n.TgZ(12,"td",31)(13,"app-row-functions",34),n.NdJ("editRow",function(){const h=n.CHM(r).$implicit,j=n.oxw().$implicit,R=n.oxw(2).$implicit,ie=n.oxw(3);return ie.currentAction.emit(null),n.KtG(ie.toEdit(R,j,h))})("deleteRow",function(){const h=n.CHM(r).$implicit,j=n.oxw(3).$implicit,R=n.oxw(3);return n.KtG(R.onDeleteJob(j,h))})("onAction",function(u){const j=n.CHM(r).$implicit,R=n.oxw(6);return n.KtG(R.jobOnAction(u,j))}),n.qZA()(),n.YNc(14,xe,2,2,"td",29),n.qZA()}if(2&p){const r=_.$implicit,d=_.index,u=n.MAs(11),h=n.oxw(6);n.xp6(1),n.Q6J("ngIf",0==d),n.xp6(1),n.Q6J("ngIf",0==d),n.xp6(2),n.hij(" ",h.msgTranslate(null==r||null==r.core_Job_Title?null:r.core_Job_Title.ar_Name,null==r||null==r.core_Job_Title?null:r.core_Job_Title.en_Name)," "),n.xp6(2),n.hij(" ",n.xi3(7,8,null==r?null:r.from_Date,"dd-MM-yyyy")," "),n.xp6(3),n.Q6J("ngIf",null==r?null:r.is_Manpower_Affected)("ngIfElse",u),n.xp6(4),n.Q6J("actions",h.jobRowFunctions),n.xp6(1),n.Q6J("ngIf",0==d&&!h.hideActions)}}function De(p,_){if(1&p&&(n.ynx(0),n.YNc(1,Ie,15,11,"tr",27),n.BQk()),2&p){const r=_.$implicit;n.xp6(1),n.Q6J("ngForOf",r.core_Person_Instance_Job_Title)}}function Se(p,_){if(1&p&&(n.TgZ(0,"table",22),n.YNc(1,ye,21,19,"thead",0),n.TgZ(2,"tbody"),n.YNc(3,De,2,1,"ng-container",23),n.qZA()()),2&p){const r=n.oxw(),d=r.index,u=r.$implicit;n.ekj("nested-job-table",0===d),n.xp6(1),n.Q6J("ngIf",0===d),n.xp6(2),n.Q6J("ngForOf",null==u?null:u.core_Person_Instance_Org)}}function Oe(p,_){if(1&p&&(n.TgZ(0,"td",19),n.YNc(1,Se,4,4,"table",21),n.qZA()),2&p){const r=_.$implicit;n.xp6(1),n.Q6J("ngIf",(null==r||null==r.core_Person_Instance_Org?null:r.core_Person_Instance_Org.length)>0)}}function Ze(p,_){1&p&&(n.TgZ(0,"th",18),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&p&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"actions")))}function Ae(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"a",41),n.NdJ("click",function(){n.CHM(r);const u=n.oxw(2).$implicit,h=n.oxw(3);return n.KtG(h.onDeleteStatus(u))}),n.ALo(1,"translate"),n._UZ(2,"i",42),n.qZA()}if(2&p){const r=n.oxw().$implicit;n.Tol(r.color),n.Q6J("matTooltip",n.lcZ(1,5,r.name)),n.xp6(2),n.Tol(r.icon)}}function Je(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"a",41),n.NdJ("click",function(){n.CHM(r);const u=n.oxw(2).$implicit,h=n.oxw(3);return n.KtG(h.onAssign(u))}),n.ALo(1,"translate"),n._UZ(2,"i",42),n.qZA()}if(2&p){const r=n.oxw().$implicit;n.Tol(r.color),n.Q6J("matTooltip",n.lcZ(1,5,r.name)),n.xp6(2),n.Tol(r.icon)}}function Le(p,_){if(1&p&&(n.ynx(0),n.YNc(1,Ae,3,7,"a",40),n.YNc(2,Je,3,7,"a",40),n.BQk()),2&p){const r=_.$implicit,d=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf","delete"==r.name.toLowerCase()&&0==(null==d.core_Person_Instance_Org?null:d.core_Person_Instance_Org.length)),n.xp6(1),n.Q6J("ngIf","assign"==r.name.toLowerCase())}}function Ee(p,_){if(1&p&&(n.TgZ(0,"td",19),n.YNc(1,Le,3,2,"ng-container",23),n.qZA()),2&p){const r=n.oxw(3);n.xp6(1),n.Q6J("ngForOf",r.statusRowFunctions.basic)}}function le(p,_){1&p&&n._UZ(0,"tr",43)}function _e(p,_){1&p&&n._UZ(0,"tr",44)}function he(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"app-prime-paginator",45),n.NdJ("onChangePage",function(u){n.CHM(r);const h=n.oxw(3);return n.KtG(h.getList(u.pageIndex+1,u.pageSize))}),n.qZA()}if(2&p){const r=n.oxw(3);n.Q6J("page",r.page)("isDialogSize",!0)}}function Y(p,_){if(1&p){const r=n.EpF();n.TgZ(0,"mat-paginator",46),n.NdJ("page",function(u){n.CHM(r);const h=n.oxw(3);return n.KtG(h.getList(u.pageIndex+1,u.pageSize))}),n.qZA()}if(2&p){const r=n.oxw(3);n.Q6J("pageSizeOptions",r.page.pageSizeOptions)("length",r.page.length)("pageSize",r.page.dialogSize)("pageIndex",r.page.pageIndex-1)("hidePageSize",!0)("showFirstLastButtons",!1)}}function Ne(p,_){if(1&p&&(n.ynx(0),n.TgZ(1,"mat-card-content")(2,"div",4)(3,"table",5),n.ynx(4,6),n.YNc(5,ne,2,0,"th",7),n.YNc(6,H,2,0,"td",8),n.BQk(),n.ynx(7,9),n.YNc(8,ae,3,3,"th",7),n.YNc(9,x,2,1,"td",8),n.BQk(),n.ynx(10,10),n.YNc(11,be,3,3,"th",7),n.YNc(12,J,3,4,"td",8),n.BQk(),n.ynx(13,11),n.YNc(14,de,3,3,"th",7),n.YNc(15,q,3,4,"td",8),n.BQk(),n.ynx(16,12),n.YNc(17,me,1,0,"th",7),n.YNc(18,Oe,2,1,"td",8),n.BQk(),n.ynx(19,13),n.YNc(20,Ze,3,3,"th",7),n.YNc(21,Ee,2,1,"td",8),n.BQk(),n.YNc(22,le,1,0,"tr",14),n.YNc(23,_e,1,0,"tr",15),n.qZA()()(),n.YNc(24,he,1,2,"app-prime-paginator",16),n.YNc(25,Y,1,6,"mat-paginator",17),n.BQk()),2&p){const r=n.oxw(2);n.xp6(3),n.Q6J("dataSource",r.dataSource),n.xp6(19),n.Q6J("matHeaderRowDef",r.displayedColumns),n.xp6(1),n.Q6J("matRowDefColumns",r.displayedColumns),n.xp6(1),n.Q6J("ngIf",!r.hideActions&&r.page.length>r.page.dialogSize),n.xp6(1),n.Q6J("ngIf",r.hideActions&&r.page.length>r.page.dialogSize)}}function Pe(p,_){if(1&p&&(n.TgZ(0,"div",47),n._UZ(1,"app-table-skeleton",48),n.qZA()),2&p){const r=n.oxw(2);n.xp6(1),n.Q6J("displayedColumns",r.displayedColumns)}}function we(p,_){if(1&p&&(n.TgZ(0,"div",49),n._UZ(1,"img",50)(2,"br"),n._uU(3),n.ALo(4,"translate"),n.qZA()),2&p){const r=n.oxw(2);n.xp6(1),n.Q6J("src",r.assets.empty,n.LSH),n.xp6(2),n.hij(" ",n.lcZ(4,2,"emptytable")," ")}}function Me(p,_){if(1&p&&(n.ynx(0),n.YNc(1,Ne,26,5,"ng-container",0),n.YNc(2,Pe,2,1,"div",2),n.YNc(3,we,5,4,"div",3),n.BQk()),2&p){const r=n.oxw();n.xp6(1),n.Q6J("ngIf",(null==r.dataSource||null==r.dataSource.data?null:r.dataSource.data.length)>0),n.xp6(1),n.Q6J("ngIf",!(r.isLoaded||null!=r.dataSource&&r.dataSource.data)),n.xp6(1),n.Q6J("ngIf",0==(null==r.dataSource||null==r.dataSource.data?null:r.dataSource.data.length)&&r.isLoaded||!r.dataSource&&r.isLoaded)}}var w=(()=>{return(p=w||(w={})).assign="assign",p.append="append",p.edit="edit",p.delete="delete",p.close="close",p.assignManager="assignManager",w;var p})();let Ue=(()=>{class p extends g.U{constructor(r,d){super(),this.employeeJobInformationService=r,this.dialog=d,this.hideActions=!1,this.isMatPaginator=!1,this.rowToEdit=new n.vpe,this.afterDelete=new n.vpe,this.currentAction=new n.vpe,this.employeeId=0,this.employeeInstanceId=0,this.displayedColumns=["status","status_date","status_end_date","org","actions"],this.isLoaded=!1,this.jobRowFunctions={basic:[],dropdown:[]},this.orgRowFunctions={basic:[],dropdown:[]},this.statusRowFunctions={basic:[],dropdown:[]},this.employeeId=D.w.EmployeeId,this.employeeInstanceId=D.w.EmployeeInstanceId,D.w.employeeInstanceId$.subscribe(u=>this.employeeInstanceId=u),this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,N.S.emp_job_info_sec),this.jobRowFunctions.basic=this.rowFunctions.basic.filter(u=>{let h=u.name.toLocaleLowerCase();return h.includes(w.edit)||h.includes(w.delete)||h.includes(w.close)}),this.orgRowFunctions.basic=this.rowFunctions.basic.filter(u=>!this.jobRowFunctions.basic.map(h=>h.id).includes(u.id)),this.statusRowFunctions.basic=this.rowFunctions.dropdown}ngOnChanges(r){r.hasUpdate&&r.hasUpdate.currentValue&&this.employeeInstanceId>0&&this.getList(this.firstPage),this.hideActions&&(this.statusRowFunctions.basic=this.statusRowFunctions.basic.filter(d=>d.name.toLowerCase()===w.delete),this.jobRowFunctions.basic=this.jobRowFunctions.basic.filter(d=>d.name.toLowerCase()===w.delete))}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new v.by(null)),this.checkNoBusinessOrCompany()&&this.employeeId>0&&this.getList(this.firstPage)}getList(r,d){this.dataSource=new v.by(null),this.isLoaded=!1,this.page.pageIndex=r,this.isLoaded=!1,d&&(this.page.dialogSize=d),this.employeeJobInformationService.getList(this.employeeId,{PageNumber:r,pageSize:this.page.dialogSize}).pipe(this.cancelRequest()).subscribe(h=>{h.message.messageType==M.u.Success?(this.dataSource=new v.by(h.data),this.page.length=h.meta.totalItemCount,this.page.meta=h.meta,this.isLoaded=!0):this.errorList(h?.message?.messages)})}toEdit(r,d,u){this.rowToEdit.emit({status:r,org:d,job:u})}onDeleteJob(r,d){let u=this.msgTranslate(d.core_Job_Title.ar_Name,d.core_Job_Title.en_Name);this.deleteDialog(u).subscribe(h=>{h&&this.delete(r,d)})}onDeleteStatus(r){let d=this.msgTranslate(r.core_Status.ar_Name,r.core_Status.en_Name);this.deleteDialog(d).subscribe(u=>{u&&this.delete(r,null,!0)})}delete(r,d,u=!1){this.showLoading("table"),this.employeeJobInformationService.Delete({employeeStatusID:r.id,employeeJobTitleID:d?.id??0,DeleteStatusIfOrphan:u}).subscribe(j=>{j.message.messageType==M.u.Success?(this.deleteSuccessfullyMsg(j?.message?.messageTypeName),1==this.dataSource.data.length&&this.currentPage>1?this.getList(this.prevPage,this.page.dialogSize):(this.getList(this.currentPage,this.page.dialogSize),this.afterDelete.emit(r))):this.errorList(j?.message?.messages),this.hideLoading("table")})}openCloseDialog(r){this.dialog.open(k,{data:r,height:"auto",minWidth:"40%",autoFocus:!1,panelClass:"dialog-emp-form"}).afterClosed().subscribe(d=>{})}onAssign(r){this.currentAction.emit(w.assign),this.toEdit(r,null,null)}orgOnAction(r,d,u){r.fun.name==w.assignManager&&this.openAssignManagerDialog(u),r.fun.name==w.append&&(this.currentAction.emit(w.append),this.toEdit(d,u,null))}jobOnAction(r,d){"close"==r.fun.name&&this.openCloseDialog(d)}openAssignManagerDialog(r){this.dialog.open(S,{data:r,minWidth:"50%",height:"auto",autoFocus:!1,panelClass:"dialog-emp-form"}).afterClosed().subscribe(d=>{})}}return p.\u0275fac=function(r){return new(r||p)(n.Y36(K._),n.Y36(y.uw))},p.\u0275cmp=n.Xpm({type:p,selectors:[["app-emp-job-table"]],inputs:{hasUpdate:"hasUpdate",hideActions:"hideActions",isMatPaginator:"isMatPaginator"},outputs:{rowToEdit:"rowToEdit",afterDelete:"afterDelete",currentAction:"currentAction"},features:[n.qOj,n.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[3,"name"],["class","mtop-25",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"mat-elevation-z8","f-w","table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Ser"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","status_date"],["matColumnDef","status_end_date"],["matColumnDef","org"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","isDialogSize","onChangePage",4,"ngIf"],[3,"pageSizeOptions","length","pageSize","pageIndex","hidePageSize","showFirstLastButtons","page",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"fas","fa-bars"],["class","table table-responsive-sm",3,"nested-job-table",4,"ngIf"],[1,"table","table-responsive-sm"],[4,"ngFor","ngForOf"],[1,"border-0",2,"color","#5a5a5a"],[1,"border-top-0","padding-10"],["class","border-top-0 padding-10",4,"ngIf"],["style","color: #374761","class","border-top-0 border-bottom-1",4,"ngFor","ngForOf"],[1,"border-top-0","border-bottom-1",2,"color","#374761"],["class","padding-10 vertical-align-middle",3,"rowSpan",4,"ngIf"],["class","padding-10",3,"rowSpan",4,"ngIf"],[1,"padding-10"],["class","success",4,"ngIf","ngIfElse"],["no",""],["iconSize","font-small-3",3,"actions","editRow","deleteRow","onAction"],[1,"padding-10","vertical-align-middle",3,"rowSpan"],[1,"padding-10",3,"rowSpan"],[1,"success"],[1,"danger"],["iconSize","font-small-3",3,"actions","onAction"],[3,"class","matTooltip","click",4,"ngIf"],[3,"matTooltip","click"],[1,"font-medium-1","mr-2","p-0"],["mat-header-row",""],["mat-row",""],[3,"page","isDialogSize","onChangePage"],[3,"pageSizeOptions","length","pageSize","pageIndex","hidePageSize","showFirstLastButtons","page"],[1,"mtop-25"],[3,"displayedColumns"],[1,"text-center"],[3,"src"]],template:function(r,d){1&r&&(n.YNc(0,Me,4,3,"ng-container",0),n._UZ(1,"ngx-spinner",1)),2&r&&(n.Q6J("ngIf",d.employeeId>0),n.xp6(1),n.Q6J("name","table"))},dependencies:[C.sg,C.O5,T.I,A.h,E.m,z.dn,te.gM,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,pe.YE,pe.nU,oe.NW,e.Ro,C.uU,W.X$],styles:[".table-container[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]{padding:5px!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]{font-size:12px}.nested-job-table[_ngcontent-%COMP%]{margin:-50px 0 0}.nested-job-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:none;font-weight:400}.nested-job-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%], .table-responsive-sm[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%]{border:0}  .mat-paginator[ng-reflect-hide-page-size=true] .mat-paginator-range-label{display:none}"]}),p})()},45679:(se,Q,c)=>{c.d(Q,{U:()=>I}),c(95751),c(22699),c(33975),c(35478),c(89609),c(70137),c(12613),c(57566),c(29467),c(18183),c(68506),c(85443),c(15362),c(50260),c(99892),c(45390);var I=(()=>{return(S=I||(I={})).assign="assign",S.append="append",S.edit="edit",S.delete="delete",S.close="close",S.assignManager="assignManager",I;var S})()},61757:(se,Q,c)=>{c.d(Q,{GP:()=>K,JB:()=>$,M3:()=>N,PI:()=>P,hN:()=>D,i5:()=>v,kI:()=>M,zB:()=>y});var n=c(50046),g=c(35478);function v(O){return O.map(m=>({...m,custodies:(0,g._)(m.core_Covenant?.ar_Name,m.core_Covenant?.en_Name),froM_DATE:g.M.mapDate(m.fromDate),endDate:g.M.mapDate(m.toDate),date:g.M.mapDate(m?.fromDate)+(m?.toDate?" - "+g.M.mapDate(m?.toDate):"")}))}function D(O){return O.map(m=>({...m,plan:(0,g._)(m.att_Plan?.ar_Name,m.att_Plan?.en_Name),employee:(0,g._)(m.core_Person_Instance?.core_Person?.ar_Name,m.core_Person_Instance?.core_Person?.en_Name),startDate:g.M.mapDate(m.fromDate),toDateOriginal:m.toDate,toDate:g.M.mapDate(m.toDate)}))}function N(O){return O.map(m=>({...m,insuranceOffice:(0,g._)(m.core_Insurance_Office?.ar_Name,m.core_Insurance_Office?.en_Name),fromDate:g.M.mapDate(m.froM_DATE),endDate:g.M.mapDate(m.enD_DATE),date:g.M.mapDate(m?.froM_DATE)+(m?.enD_DATE?" - "+g.M.mapDate(m?.enD_DATE):"")}))}function M(O){let m=O.map(b=>({...b,country:(0,g._)(b.comm_Country?.ar_Name,b.comm_Country?.en_NAme),governorate:(0,g._)(b.comm_Governorate?.ar_Name,b.comm_Governorate?.en_Name),froM_DATE:g.M.mapDate(b.from_Date),tO_DATE:g.M.mapDate(b.to_Date)}));return m.map(b=>{b.allAddress=`${b.location??"-"}, ${b.governorate??"-"}`,b.date=b?.froM_DATE+(b?.to_Date?" - "+b?.tO_DATE:"")}),m}function y(O){return O.map(m=>({...m,documentName:(0,g._)(m.ar_Name_Type,m.en_Name_Type),attachmentType:n.g.getValue(m.is_Attached),attachment:m.attachmentFilePath?"/"+m.attachmentFilePath:""}))}function P(O){return O.map(m=>({...m,contractType:(0,g._)(m.core_Contract_Type?.ar_Name,m.core_Contract_Type?.en_Name),start_date:g.M.mapDate(m.starT_DATE),end_date:g.M.mapDate(m.enD_DATE),actual_End_Date:g.M.mapDate(m.actual_End_Date)}))}function $(O){return O.map(m=>({...m,supervisor:(0,g._)(m.manager?.core_Person?.ar_Name,m.manager?.core_Person?.en_Name),fromDate:g.M.mapDate(m.from_Date),toDate:g.M.mapDate(m.tO_Date)}))}function K(O){return O.map(m=>({...m,employee:(0,g._)(m.core_Person_Instance?.core_Person?.ar_Name,m.core_Person_Instance?.core_Person?.en_Name),startDate:g.M.mapDate(m.from_Date),endDate:g.M.mapDate(m.to_Date)}))}},89609:(se,Q,c)=>{c.d(Q,{_:()=>D});var n=c(1903),g=c(26315),v=c(94650);let D=(()=>{class N extends n.K{constructor(){super(),this.expand=`${g.db.Core_Person_Instance_Org}/${g.db.core_Person_Instance_Job_Title},\n    ${g.db.Core_Person_Instance_Org}.${g.db.core_Org},${g.db.Core_Person_Instance_Org}/${g.db.core_Person_Instance_Job_Title}.${g.db.Core_Job_Title},\n    ${g.db.core_Status}, ${g.db.core_Status_Properties}`}create(y){return this.post("Personnel/Employees/Create_EmployeeStatusPosition",y)}update(y){return this.post("Personnel/Employees/Edit_EmployeeStatusPosition",y)}appendJob(y){return this.post("Personnel/Employees/AppendJob",y)}assignOrgAndJob(y){return this.post("Personnel/Employees/AssignOrgAndJob",y)}getStatusPositionCard(y){return this.get("Personnel/Employees/Get_StatusPositionCard",{params:{Person_Instance_ID:y}})}getList(y,P){return this.get("Personnel/Employees/GetList_EmployeeStatusPosition",{params:{...P,$filter:`Person_Instance_ID  eq ${y}`,$expand:this.expand}})}getAll(y){return this.get("Personnel/Employees/GetAll_EmployeeStatusPosition",{params:{$filter:`Person_Instance_ID  eq ${y}`,$expand:this.expand}})}getAllCurrentJobsByEmployeeId(y){return this.get("personnel/Employees/GetAll_Current_Job_Emp",{params:{PerinsID:y}})}Delete(y){return this.delete("Personnel/Employees/Delete_EmployeeStatusPosition",{params:y})}close(y){return this.post("Personnel/Employees/Close_EmployeeStatusPosition",null,{params:y})}}return N.\u0275fac=function(y){return new(y||N)},N.\u0275prov=v.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},50046:(se,Q,c)=>{c.d(Q,{g:()=>n});var g,n=(()=>{return(g=n||(n={}))[g.attached=1]="attached",g[g.handDelivery=2]="handDelivery",g[g.notNeed=3]="notNeed",n;var g})();(g=n||(n={})).getValue=function v(D){switch(D){case g.attached:return"attachment";case g.handDelivery:return"isHandDelivered";case g.notNeed:return"notNeed";default:return""}}}}]);