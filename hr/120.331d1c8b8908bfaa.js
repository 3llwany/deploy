"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[120],{5120:(vt,w,l)=>{l.r(w),l.d(w,{OrgManagementModule:()=>Tt});var d=l(36895),E=l(80458),S=l(30671),m=l(15602),_=l(58385),e=l(94650),O=l(66949),j=l(56184),x=l(46896),h=l(73546),A=l(44850),y=l(86405);let K=(()=>{class n extends _.d{constructor(t){super(),this.orgStructureService=t,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","froM_DATE","tO_DATE","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new S.by(null)),this.CheckNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o);let i={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.orgStructureService.getList(i).subscribe(a=>{if(a.message.messageType==m.u.Success){if(0==a.data.length&&t>1)return void this.getList(this.prevPage);a.data.map(s=>{s.froM_DATE=this.mapDate(s.froM_DATE),s.tO_DATE=this.mapDate(s.tO_DATE)}),this.dataSource=new S.by(a.data),this.isLoaded=!0,this.page.length=a.meta.totalItemCount}else this.errorList(a.message.messages);this.hideLoading()})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleateDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.orgStructureService.Delete(t.id).subscribe(o=>{o.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o.message.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O._))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-org-structure-index"]],features:[e.qOj],decls:8,vars:7,consts:[[1,"row"],[1,"col-12"],["title","orgStructure",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.qZA(),e._UZ(6,"mat-divider"),e.TgZ(7,"app-material-table",3),e.NdJ("onChangePage",function(a){return o.getList(a.pageIndex+1,a.pageSize)})("deleteRow",function(a){return o.onDelete(a)}),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",o.globalFunctions),e.xp6(2),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("actions",o.rowFunctions))},dependencies:[j.I,x.T,h.a8,h.n5,A.d,y.Ro]}),n})();var g=l(24006),U=l(78937),X=l(32222),V=l(45471),D=l(7384),B=l(65959),ee=l(18825),te=l(22289),q=l(53026),b=l(10805),I=l(57772),c=l(65938),P=l(43851),F=l(44479),v=l(4859),C=l(49274);let oe=(()=>{class n extends _.d{constructor(t,o,i,a){super(),this.orgStructureService=t,this.organizationsService=o,this.dialogRef=i,this.data=a,this.submitted=!1,this.organizationList=[]}ngOnInit(){this.form=this.fb.group({org_Structure_ID:[null],parenT_ID:[null],orG_TYPE_ID:[null,[g.kI.required]],orG_ID:[null,[g.kI.required]]}),this.getFormValues()}onChangeBusinessAndCompanyId(){this.formCtrls.org_Structure_ID.value>0&&this.CheckNoBusinessOrCompany()&&this.getAllUnAssignedOrganizationsByStructureId()}getFormValues(){this.form.patchValue(this.data),setTimeout(()=>{this.form.value.parenT_ID||(this.formCtrls.orG_TYPE_ID.disable(),this.formCtrls.orG_TYPE_ID.setValue(1))},100)}get formCtrls(){return this.form.controls}submit(){this.submitted=!0,this.form.valid&&this.create({core_Org_Structure_Org:{org_Structure_ID:this.formCtrls.org_Structure_ID.value,orG_TYPE_ID:this.formCtrls.orG_TYPE_ID.value,orG_ID:this.formCtrls.orG_ID.value,parenT_ID:this.formCtrls.parenT_ID.value}})}create(t){this.showLoading(),this.orgStructureService.createNode(t).subscribe(o=>{o?.message?.messageType==m.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.dialogRef.close(!0)):this.errorList(o.message.messages),this.hideLoading()})}getAllUnAssignedOrganizationsByStructureId(){this.showLoading(),this.organizationsService.GetAllUnAssignedByStructureId(this.formCtrls.org_Structure_ID.value).subscribe(t=>{(t.message.messageType=m.u.Success)?this.organizationList=t.data:this.errorList(t.message.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O._),e.Y36(P.z),e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-org-structure-node"]],features:[e.qOj],decls:20,vars:15,consts:[[1,"row"],["dialogContainer",""],[1,"col-12"],["mat-dialog-title",""],["title","orgStructureNode"],[3,"formGroup"],[1,"col-md-6","col-12"],[3,"control","submitted","optionDisabled","appendTo","filter"],["label","organization",3,"control","submitted","List","appendTo"],["align","end"],[3,"id","onClick"],["mat-raised-button","","cdkFocusInitial","",1,"btn","btn-warning","mr-1","ml-1",3,"mat-dialog-close"]],template:function(t,o){if(1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0,1)(3,"div",2)(4,"div",3),e._UZ(5,"page-title",4),e.qZA(),e.TgZ(6,"mat-dialog-content")(7,"div",0)(8,"div",2)(9,"form",5)(10,"div",0)(11,"div",6),e._UZ(12,"app-org-types-dropdown",7),e.qZA(),e.TgZ(13,"div",6),e._UZ(14,"app-prime-dropdown",8),e.qZA()()()()()(),e.TgZ(15,"mat-dialog-actions",9)(16,"submit-btn",10),e.NdJ("onClick",function(){return o.submit()}),e.qZA(),e.TgZ(17,"button",11),e._uU(18),e.ALo(19,"translate"),e.qZA()()()()),2&t){const i=e.MAs(2);e.xp6(9),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.orG_TYPE_ID)("submitted",o.submitted)("optionDisabled",o.formCtrls.parenT_ID.value?"isCompany":null)("appendTo",i)("filter",!0),e.xp6(2),e.Q6J("control",o.formCtrls.orG_ID)("submitted",o.submitted)("List",o.organizationList)("appendTo",i),e.xp6(2),e.Q6J("id",0),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.hij(" ",e.lcZ(19,13,"General.close")," ")}},dependencies:[D.J,F.q,q.p,x.T,v.lW,c.ZT,c.uh,c.xY,c.H8,y.Ro,g._Y,g.JL,g.sg,C.X$]}),n})();var z=l(20408),ne=l(91365),k=l(25054);function ie(n,r){if(1&n&&(e._UZ(0,"p-image",17),e.ALo(1,"translate")),2&n){const t=e.oxw(2);e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",t.fileService.preview(t.employeeData.img))}}function ae(n,r){1&n&&(e.TgZ(0,"div",18),e._UZ(1,"i",19),e.qZA())}function re(n,r){if(1&n&&(e.TgZ(0,"p"),e._UZ(1,"i",20),e.TgZ(2,"span",21),e._uU(3),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.contact)}}function se(n,r){if(1&n&&(e.TgZ(0,"p"),e._UZ(1,"i",22),e.TgZ(2,"span",21),e._uU(3),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.employeeData.email)}}function le(n,r){1&n&&(e.TgZ(0,"span",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"active")," "))}function pe(n,r){1&n&&(e.TgZ(0,"span",24),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"notActive")," "))}function ce(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",7)(2,"div",8),e.YNc(3,ie,2,4,"p-image",9),e.YNc(4,ae,2,0,"ng-template",null,10,e.W1O),e.qZA(),e.TgZ(6,"div",11)(7,"p",12),e._uU(8),e.qZA(),e.YNc(9,re,4,1,"p",6),e.YNc(10,se,4,1,"p",6),e.qZA()(),e.TgZ(11,"div",13)(12,"div",14),e._uU(13),e.ALo(14,"titlecase"),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"p"),e._uU(17),e.ALo(18,"titlecase"),e.qZA(),e.TgZ(19,"p"),e._uU(20),e.ALo(21,"titlecase"),e.qZA(),e.TgZ(22,"p"),e.YNc(23,le,3,3,"span",15),e.YNc(24,pe,3,3,"ng-template",null,16,e.W1O),e.qZA()(),e.BQk()),2&n){const t=e.MAs(5),o=e.MAs(25),i=e.oxw();e.xp6(3),e.Q6J("ngIf",i.employeeData.img&&"/"!=i.employeeData.img)("ngIfElse",t),e.xp6(5),e.hij(" ",i.msgTranslate(i.employeeData.ar_Name,i.employeeData.en_Name)," "),e.xp6(1),e.Q6J("ngIf",i.employeeData.contact),e.xp6(1),e.Q6J("ngIf",i.employeeData.email),e.xp6(3),e.hij(" ",e.lcZ(14,10,e.lcZ(15,12,"employment"))," "),e.xp6(4),e.hij(" ",e.lcZ(18,14,i.msgTranslate(i.employeeData.jobTitleNameAr,i.employeeData.jobTitleName))," "),e.xp6(3),e.hij(" ",e.lcZ(21,16,i.msgTranslate(i.employeeData.organizationAr,i.employeeData.organization))," "),e.xp6(3),e.Q6J("ngIf",i.employeeData.isActive)("ngIfElse",o)}}function de(n,r){1&n&&(e.ynx(0),e._UZ(1,"app-structure-employee-card-skeleton"),e.BQk())}function ge(n,r){1&n&&(e._UZ(0,"span",27),e.TgZ(1,"div",28),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeData")," "))}const me=function(n){return{"ar-msg":n}};function ue(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"p-messages",25),e.YNc(2,ge,4,3,"ng-template",26),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(1,me,t.languageService.isArabic))}}let N=(()=>{class n extends _.d{constructor(t,o,i){super(),this.employeesService=t,this.dialogRef=o,this.data=i,this.loaded=!1,this.employeeId=i.employeeId}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}onChangeBusinessAndCompanyId(){this.CheckNoBusinessOrCompany()&&this.employeeId>0&&this.getEmployeeData()}getEmployeeData(){this.employeesService.getEmployeeCardById(this.employeeId).subscribe(t=>{t.message.messageType==m.u.Success?(t.data.length>0&&(t.data[0].contact=t.data[0]?.contacts.map(o=>o.value).join(", "),this.employeeData=t.data[0]),this.loaded=!0):this.errorList(t.message.messages)})}onWindowResize(t){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(z.M),e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-employee-card"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},features:[e.qOj],decls:10,vars:6,consts:[[1,"title"],[1,"type-name","info"],["title","employeeDetails"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"employee-card"],[4,"ngIf"],[1,"row"],[1,"col-md-4","col-12","img-container"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"col-md-8","col-12"],[1,"mtop-5"],[1,"mtop-20"],[1,"mbottom-15",2,"font-weight","bold"],["class","badge bg-light-success",4,"ngIf","ngIfElse"],["no",""],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"pi","pi-phone"],[1,"mx-1"],[1,"fa","fa-envelope"],[1,"badge","bg-light-success"],[1,"badge","bg-light-danger"],["severity","warn",3,"ngClass"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"h6",1),e._UZ(3,"page-title",2),e.qZA(),e.TgZ(4,"button",3),e._UZ(5,"i",4),e.qZA()(),e.TgZ(6,"mat-dialog-content",5),e.YNc(7,ce,26,18,"ng-container",6),e.YNc(8,de,2,0,"ng-container",6),e.YNc(9,ue,3,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(4),e.ekj("ar",o.languageService.isArabic),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.Q6J("ngIf",o.employeeData&&o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&!o.loaded),e.xp6(1),e.Q6J("ngIf",!o.employeeData&&o.loaded))},dependencies:[d.mk,d.O5,x.T,ne.v,b.jx,k.E,I.V,v.lW,c.ZT,c.xY,y.Ro,d.rS,C.X$],styles:[".title[_ngcontent-%COMP%]{background-color:#0000000a;margin:-24px;padding:24px 18px}.title[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{display:inline-block;margin-bottom:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:-10px;margin-right:-15px}.title[_ngcontent-%COMP%]   button.ar[_ngcontent-%COMP%]{margin-left:-15px!important}  .mat-dialog-content.employee-card{margin-top:40px}"]}),n})(),Q=(()=>{class n{constructor(){}groupBy(t,o){const i=t.reduce((a,s)=>(a[s[o]]?a[s[o]].push(s):a[s[o]]=[s],a),{});return Object.keys(i).map(a=>({key:a,List:i[a]}))}groupByPartOfProperty(t,o,i){const a=t.reduce((s,p)=>{let u=p[o].trim().slice(0,i).toUpperCase();return s[u]?s[u].push(p):s[u]=[p],s},{});return Object.keys(a).map(s=>({key:s,List:a[s]}))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Y=l(31534),T=l(37084);function _e(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p",16),e.NdJ("click",function(i){const s=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.openEmployeeCardDialog(i.target,s.id))}),e.TgZ(1,"span",17),e._UZ(2,"i",18),e.qZA(),e.TgZ(3,"span",19),e._uU(4),e.qZA()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function he(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14),e.YNc(4,_e,5,3,"p",15),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function fe(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",11),e.NdJ("keyup",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,he,5,2,"ng-container",12),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function ye(n,r){1&n&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function Ce(n,r){1&n&&(e._UZ(0,"span",22),e.TgZ(1,"div",23),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInOrg")," "))}const Te=function(n){return{"ar-msg":n}};function be(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"p-messages",20),e.YNc(2,Ce,4,3,"ng-template",21),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(1,Te,t.languageService.isArabic))}}let ve=(()=>{class n extends _.d{constructor(t,o,i,a,s){super(),this.employeesService=t,this.groupByService=o,this.dialogRef=i,this.data=a,this.dialog=s,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=a.expandedIndex,this.nodeData=a.nodeData}ngOnInit(){this.CheckNoBusinessOrCompany()&&this.nodeData.structureId>0&&this.nodeData.org.id>0&&this.getEmployeesByOrgId();const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}getEmployeesByOrgId(){this.employeesService.getAllByStructureAndOrgId(this.nodeData.structureId,this.nodeData.org.id).subscribe(t=>{t.message.messageType==m.u.Success?(this.employees=t.data,this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0):this.errorList(t.message.messages)})}sortAndGroupEmployees(){this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let a=this.getHeaderElement(t).getBoundingClientRect(),p={};return p.left=a.left+a.width/2+350<=window.innerWidth?`${a.left+a.width/2}px`:a.left-175-10>=0?a.left-175-10+"px":null,this.dialog.open(N,{data:{employeeId:o},position:p,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(u=>{})}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(z.M),e.Y36(Q),e.Y36(c.so),e.Y36(c.WI),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-org-details-employees"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},features:[e.qOj],decls:20,vars:13,consts:[[1,"details-dialog-title"],[1,"mb-2"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"org-name"],[1,"details-dialog","company"],["multi",""],[3,"expanded"],[1,"expantion-body"],[4,"ngIf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[4,"ngFor","ngForOf"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn",3,"ngClass"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){if(1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"h6",2),e._uU(4),e.qZA(),e.TgZ(5,"button",3),e._UZ(6,"i",4),e.qZA()(),e.TgZ(7,"p",5),e._uU(8),e.qZA()(),e.TgZ(9,"mat-dialog-content",6)(10,"mat-accordion",7)(11,"mat-expansion-panel",8)(12,"mat-expansion-panel-header")(13,"mat-panel-title"),e._uU(14),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9),e.YNc(17,fe,4,4,"ng-container",10),e.YNc(18,ye,2,0,"ng-container",10),e.YNc(19,be,3,3,"ng-container",10),e.qZA()()()()),2&t){let i;e.xp6(4),e.AsE(" ",o.nodeData.org.code," / ",o.msgTranslate(o.nodeData.org.ar_Name,o.nodeData.org.en_Name)," "),e.xp6(1),e.ekj("ar",o.languageService.isArabic),e.Q6J("mat-dialog-close",!1),e.xp6(3),e.hij(" ",null!==(i=o.msgTranslate(o.nodeData.orgType.ar_Name,o.nodeData.orgType.en_Name))&&void 0!==i?i:o.translate("orgTypeDeleted")," "),e.xp6(3),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(15,11,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded)}},dependencies:[d.mk,d.sg,d.O5,Y.b,b.jx,I.V,v.lW,c.ZT,c.xY,T.pp,T.ib,T.yz,T.yK,y.Ro,C.X$]}),n})();var xe=l(12453),L=l(86467),M=l(3848),Ze=l(10266);function Se(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=r.$implicit,o=e.oxw(2);let i;e.xp6(1),e.HOy(" ",o.msgTranslate(t.core_Org.ar_Name,t.core_Org.en_Name)," - ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," ",e.lcZ(2,4,"of")," ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ")}}function Oe(n,r){if(1&n&&(e.TgZ(0,"div",14),e.YNc(1,Se,3,6,"p",15),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.nodeData.core_Org_Job_Title)}}function De(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p",20),e.NdJ("click",function(i){const s=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.openEmployeeCardDialog(i.target,s.id))}),e.TgZ(1,"span",21),e._UZ(2,"i",22),e.qZA(),e.TgZ(3,"span",23),e._uU(4),e.qZA()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(3),e.hij(" ",o.msgTranslate(t.ar_Name,t.en_Name)," ")}}function Ie(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",17),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e.YNc(4,De,5,3,"p",19),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.key),e.xp6(2),e.Q6J("ngForOf",t.List)}}function Ae(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",16),e.NdJ("keyup",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.searchEmployees(i.target.value))}),e.ALo(2,"translate"),e.qZA(),e.YNc(3,Ie,5,2,"ng-container",15),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"search")),e.xp6(2),e.Q6J("ngForOf",t.employeesGroupsFiltered)}}function Ne(n,r){1&n&&(e.ynx(0),e._UZ(1,"app-org-details-employees-list-skeleton"),e.BQk())}function Le(n,r){1&n&&(e._UZ(0,"span",26),e.TgZ(1,"div",27),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"noEmployeeInJob")," "))}const Je=function(n){return{"ar-msg":n}};function we(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"p-messages",24),e.YNc(2,Le,4,3,"ng-template",25),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(1,Je,t.languageService.isArabic))}}let Ee=(()=>{class n extends _.d{constructor(t,o,i,a){super(),this.groupByService=t,this.dialogRef=o,this.data=i,this.dialog=a,this.expandedIndex=0,this.employees=[],this.loaded=!1,this.expandedIndex=i.expandedIndex,this.nodeData=i.nodeData,this.employees=this.nodeData.core_Person_Instance_Job_Title.map(s=>s.core_Person_Instance.core_Person),this.employees.length>0?this.sortAndGroupEmployees():this.loaded=!0}ngOnInit(){const t=document.querySelectorAll(".cdk-overlay-backdrop");t.length>0&&t[t.length-1].classList.add("no-overlay")}sortAndGroupEmployees(){this.employeesGroups=this.groupByService.groupByPartOfProperty(this.employees,this.languageService.isArabic?"ar_Name":"en_Name",1).sort((t,o)=>t.key<o.key?-1:t.key>o.key?1:0),this.employeesGroupsFiltered=this.employeesGroups.slice(),this.loaded=!0}openEmployeeCardDialog(t,o){let a=this.getHeaderElement(t).getBoundingClientRect(),p={};return p.left=a.left+a.width/2+350<=window.innerWidth?`${a.left+a.width/2}px`:a.left-175-10>=0?a.left-175-10+"px":null,this.dialog.open(N,{data:{employeeId:o},position:p,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(u=>{})}getHeaderElement(t){return t.classList.contains("mat-expansion-panel-body")?t:this.getHeaderElement(t.parentElement)}searchEmployees(t){this.employeesGroupsFiltered=this.employeesGroups.map(o=>({key:o.key,List:o.List.filter(i=>i.en_Name.toLowerCase().includes(t.toLowerCase())||i.ar_Name.toLowerCase().includes(t.toLowerCase()))})).filter(o=>o.List.length>0)}onWindowResize(t){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Q),e.Y36(c.so),e.Y36(c.WI),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-job-title-details-dialog"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},features:[e.qOj],decls:51,vars:34,consts:[[1,"details-dialog-title"],[1,"mb-2"],[1,"type-name","info"],["mat-icon-button","",1,"float-right","mb-1",3,"mat-dialog-close"],[1,"pi","pi-times"],[1,"code"],[1,"details-dialog","jobtitle"],["multi",""],[3,"expanded"],[1,"expantion-body"],[1,"table-container"],["class","no-employees",4,"ngIf"],[1,"expantion-body","employee-body"],[4,"ngIf"],[1,"no-employees"],[4,"ngFor","ngForOf"],[1,"form-control","mbottom-15",3,"placeholder","keyup"],[1,"key-emp"],["role","button"],["class","name-container",3,"click",4,"ngFor","ngForOf"],[1,"name-container",3,"click"],[1,"img-small-icon"],[1,"pi","pi-user"],[1,"emp-name"],["severity","warn",3,"ngClass"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"h6",2),e._uU(4),e.qZA(),e.TgZ(5,"button",3),e._UZ(6,"i",4),e.qZA()(),e._UZ(7,"p",5),e.qZA(),e.TgZ(8,"mat-dialog-content",6)(9,"mat-accordion",7)(10,"mat-expansion-panel",8)(11,"mat-expansion-panel-header")(12,"mat-panel-title"),e._uU(13),e.ALo(14,"translate"),e.qZA()(),e.TgZ(15,"div",9)(16,"div",10)(17,"table")(18,"tbody")(19,"tr")(20,"th"),e._uU(21),e.ALo(22,"titlecase"),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.qZA()(),e.TgZ(26,"tr")(27,"th"),e._uU(28),e.ALo(29,"titlecase"),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"td"),e._uU(32),e.qZA()(),e.TgZ(33,"tr")(34,"th"),e._uU(35),e.ALo(36,"titlecase"),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"td"),e._uU(39),e.qZA()()()()(),e._UZ(40,"mat-divider"),e.YNc(41,Oe,2,1,"div",11),e.qZA()(),e.TgZ(42,"mat-expansion-panel",8)(43,"mat-expansion-panel-header")(44,"mat-panel-title"),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"div",12),e.YNc(48,Ae,4,4,"ng-container",13),e.YNc(49,Ne,2,0,"ng-container",13),e.YNc(50,we,3,3,"ng-container",13),e.qZA()()()()),2&t&&(e.xp6(4),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(1),e.ekj("ar",o.languageService.isArabic),e.Q6J("mat-dialog-close",!1),e.xp6(5),e.Q6J("expanded",0==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(14,18,"details")),e.xp6(8),e.Oqu(e.lcZ(22,20,e.lcZ(23,22,"code"))),e.xp6(4),e.Oqu(o.nodeData.code),e.xp6(3),e.Oqu(e.lcZ(29,24,e.lcZ(30,26,"jobTitle"))),e.xp6(4),e.hij(" ",o.msgTranslate(o.nodeData.ar_Name,o.nodeData.en_Name)," "),e.xp6(3),e.Oqu(e.lcZ(36,28,e.lcZ(37,30,"jobFamily"))),e.xp6(4),e.hij(" ",o.msgTranslate(null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.ar_Name,null==o.nodeData.core_Job_Title_Family?null:o.nodeData.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",o.nodeData.core_Org_Job_Title.length>0),e.xp6(1),e.Q6J("expanded",1==o.expandedIndex),e.xp6(3),e.Oqu(e.lcZ(46,32,"employees")),e.xp6(3),e.Q6J("ngIf",o.employees.length>0&&o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&!o.loaded),e.xp6(1),e.Q6J("ngIf",0==o.employees.length&&o.loaded))},dependencies:[d.mk,d.sg,d.O5,Y.b,b.jx,I.V,v.lW,A.d,c.ZT,c.xY,T.pp,T.ib,T.yz,T.yK,y.Ro,d.rS,C.X$],styles:[".mat-dialog-content.details-dialog.jobtitle .mat-expansion-panel-body{padding:0}  .mat-dialog-content.details-dialog.jobtitle .table-container{padding:0 24px 16px}  .mat-dialog-content.details-dialog.jobtitle .no-employees,   .mat-dialog-content.details-dialog.jobtitle .employee-body{padding:16px 24px 0}"]}),n})();var Z=l(21854),J=l(18521);let je=(()=>{class n extends J.K{constructor(){super()}getJobTitleHierarchy(t){return this.get("OrgManagement/JobTitle/GetAll_Structure",{params:{$filter:`id eq ${t}`,$expand:`${Z.db.core_Org_Job_Title}/${Z.db.core_Org},${Z.db.Core_Person_Instance_Job_Title}.${Z.db.Core_Person_Instance}.${Z.db.Core_Person},${Z.db.Core_Job_Title_Family}`}})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ue=(()=>{class n extends J.K{constructor(){super()}getAllByEmployeeId(t){return this.get("Personnel/Employees/GetAll_jobs",{params:{$filter:`id eq ${t}`}})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Be=l(28548),R=l(99629);function qe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-job-title-dropdown",12),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)}}function Pe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-employee-dropdown",12),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getAllEmployeeJobTitles())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("control",t.formCtrls.employeeId)("filter",!0)}}function Fe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",3)(1,"app-prime-dropdown",13),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeSearchValue())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.jobTitleId)("filter",!0)("list",t.employeeJobTitles)}}function ze(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"i",21),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw();return e.KtG(s.openJobTitleDetailsDialog(i.target,a.data,1))}),e._uU(2),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.data.core_Person_Instance_Job_Title.length," ")}}function ke(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw(3);let i;e.xp6(1),e.lnq(" ",o.msgTranslate(null==t.core_Org?null:t.core_Org.ar_Name,null==t.core_Org?null:t.core_Org.en_Name)," - ",null!==(i=t.currentEmployeeNumber)&&void 0!==i?i:0," / ",0==t.max_Employee?o.translate("unlimited"):t.max_Employee," FTE ")}}function Qe(n,r){if(1&n&&(e.TgZ(0,"div",22),e.YNc(1,ke,2,3,"p",23),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.data.core_Org_Job_Title)}}function Ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.expandNode(i))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.children.length," ",e.lcZ(2,2,1==t.children.length?"jobTitleBelow":"jobTitlesBelow")," ")}}function Me(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e.NdJ("click",function(i){const s=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.openJobTitleDetailsDialog(i.target,s.data,0))}),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"div",15)(4,"p"),e._uU(5),e.qZA()()(),e.TgZ(6,"div",16),e.YNc(7,ze,3,1,"div",17),e.YNc(8,Qe,2,1,"div",18),e.YNc(9,Ye,3,4,"div",19),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw();e.Q6J("id",t.data.id),e.xp6(1),e.Tol(o.msgTranslate("mleft-10","mright-10")),e.xp6(1),e.AsE(" ",t.data.code," / ",o.msgTranslate(t.data.ar_Name,t.data.en_Name)," "),e.xp6(3),e.hij(" ",o.msgTranslate(null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.ar_Name,null==t.data.core_Job_Title_Family?null:t.data.core_Job_Title_Family.en_Name)," "),e.xp6(2),e.Q6J("ngIf",(null==t.data.core_Person_Instance_Job_Title?null:t.data.core_Person_Instance_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.core_Org_Job_Title?null:t.data.core_Org_Job_Title.length)>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}let Re=(()=>{class n extends _.d{constructor(t,o,i){super(),this.jobTitleChartService=t,this.employeeJobInformationService=o,this.dialog=i,this.searchTypeList=[{id:1,ar_Name:"\u0627\u0644\u0648\u0638\u0627\u0626\u0641",en_Name:"Job titles"},{id:2,ar_Name:"\u0627\u0644\u0645\u0648\u0638\u0641\u064a\u0646",en_Name:"Employees"}],this.employeeJobTitles=[],this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({searchTypeId:[null],jobTitleId:[null],employeeId:[null]})}onChangeBusinessAndCompanyId(){this.CheckNoBusinessOrCompany()&&this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}get formCtrls(){return this.form.controls}getJobTitleOrgChart(t){t>0&&(this.showLoading(),this.jobTitleChartService.getJobTitleHierarchy(t).subscribe(o=>{o.message.messageType==m.u.Success?(this.mapDataForChart(o.data),setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)):this.errorList(o.message.messages),this.hideLoading()}))}mapDataForChart(t){this.jobTitleOrgChart=[{label:t[0].code,type:"job-title",styleClass:"job-title-node",expanded:!0,data:t[0],children:[]}],this.mapChildrenData(this.jobTitleOrgChart[0])}mapChildrenData(t){t.data.chiledJobTitles?.map(o=>{let i={label:o.code,type:"job-title",styleClass:"job-title-node",expanded:!0,data:o,children:[]};t.children.push(i),this.mapChildrenData(i)})}onChangeSearchType(){this.formCtrls.jobTitleId.reset(),this.formCtrls.employeeId.reset()}onChangeSearchValue(){this.getJobTitleOrgChart(this.formCtrls.jobTitleId.value)}upOneLevel(){this.onChangeSearchType(),this.getJobTitleOrgChart(this.jobTitleOrgChart[0].data.parentJobTitleID)}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn").getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),i=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.left-i?.left+o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),o=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.left-o?.left+t?.width/2}openJobTitleDetailsDialog(t,o,i){let s=this.getHeaderElement(t).getBoundingClientRect(),u={};return u.left=s.left+s.width+10+350<=window.innerWidth?`${s.left+s.width+10}px`:s.left-350-10>=0?s.left-350-10+"px":null,this.dialog.open(Ee,{data:{nodeData:o,expandedIndex:i},position:u,width:"350px",maxHeight:"90hv",autoFocus:!1}).afterClosed().subscribe(bt=>{})}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}openEmployeeCardDialog(t,o){let a=this.getHeaderElement(t).getBoundingClientRect(),p={};return p.left=a.left+a.width/2+350<=window.innerWidth?`${a.left+a.width/2}px`:a.left-175-a.width/2+10>=0?a.left-175-a.width/2+10+"px":null,this.dialog.open(N,{data:{employeeId:o},position:p,width:"350px",maxHeight:"80hv",autoFocus:!1}).afterClosed().subscribe(u=>{})}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}getAllEmployeeJobTitles(){let t=this.formCtrls.employeeId.value;t>0&&(this.showLoading(),this.employeeJobInformationService.getAllByEmployeeId(t).subscribe(o=>{o.message.messageType==m.u.Success?this.employeeJobTitles=o.data:this.errorList(o.message.messages),this.hideLoading()}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(je),e.Y36(Ue),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-job-title-org-chart"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},features:[e.qOj],decls:17,vars:19,consts:[[1,"organizationchart-container","job-title-chart"],[3,"formGroup"],[1,"row","mx-0"],[1,"col-md-4","col-12"],["label","searchBy",3,"control","List","change"],[3,"control","filter","change",4,"ngIf"],["class","col-md-4 col-12",4,"ngIf"],[1,"upOneLevel-btn-container"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],["selectionMode","single",3,"value","preserveSpace"],["pTemplate","job-title"],[3,"control","filter","change"],["label","jobTitle",3,"control","filter","list","change"],[1,"node-header",3,"id","click"],[1,"node-content","main-data"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","fte-content",4,"ngIf"],["class","node-footer info",3,"click",4,"ngIf"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"fte-content"],[4,"ngFor","ngForOf"],[1,"node-footer","info",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-prime-dropdown",4),e.NdJ("change",function(){return o.onChangeSearchType()}),e.qZA()(),e.TgZ(5,"div",3),e.YNc(6,qe,1,2,"app-job-title-dropdown",5),e.YNc(7,Pe,1,2,"app-employee-dropdown",5),e.qZA(),e.YNc(8,Fe,2,3,"div",6),e.qZA()(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return o.upOneLevel()}),e._UZ(11,"i",9),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._UZ(14,"div"),e.qZA(),e.TgZ(15,"p-organizationChart",10),e.YNc(16,Me,10,9,"ng-template",11),e.qZA()()),2&t&&(e.ekj("ar",o.languageService.isArabic),e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.searchTypeId)("List",o.searchTypeList),e.xp6(2),e.Q6J("ngIf",1==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",2==o.formCtrls.searchTypeId.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.employeeId.value>0),e.xp6(1),e.ekj("hidden",!(o.jobTitleOrgChart&&(null==o.jobTitleOrgChart[0]?null:o.jobTitleOrgChart[0].data.parentJobTitleID)>0)),e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.hij(" ",e.lcZ(13,17,"upOneLevel")," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px"),e.xp6(1),e.Q6J("value",o.jobTitleOrgChart)("preserveSpace",!1))},dependencies:[d.sg,d.O5,D.J,Be.W,R.J,b.jx,L.OE,v.lW,g._Y,g.JL,g.sg,C.X$],styles:[".job-title-chart .p-organizationchart-node-content{border-radius:10px;width:280px!important}  .job-title-chart .main-data p{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}  .job-title-chart .node-header{border-top-left-radius:10px;border-top-right-radius:10px}  .job-title-chart .node-footer{background-color:inherit;border-bottom-left-radius:10px;border-bottom-right-radius:10px;padding-bottom:10px;padding-top:10px}  .job-title-chart .node-footer:hover{background-color:#e8f3f8;color:#525050!important}  .job-title-chart .p-organizationchart-node-content .node-header:hover{background:#e8f3f8!important}  .job-title-chart .no-employees{margin-top:1.8rem;text-align:start;color:#525050;padding-bottom:.3rem}  .job-title-chart .employees-no-section{border-bottom:1px solid #dee2e6!important}  .job-title-chart .fte-content{padding:15px .7rem 0;text-align:start}"]}),n})(),He=(()=>{class n extends J.K{constructor(){super()}getEmployeesChart(t){return this.get("OrgManagement/JobTitle/GetAll_ResoursesStructure",{params:{$filter:`id eq ${t}`}})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ge(n,r){if(1&n&&(e._UZ(0,"p-image",18),e.ALo(1,"translate")),2&n){const t=e.oxw().$implicit,o=e.oxw();e.s9C("alt",e.lcZ(1,2,"img")),e.Q6J("src",o.fileService.preview(t.data.img))}}function $e(n,r){1&n&&(e.TgZ(0,"div",19),e._UZ(1,"i",20),e.qZA())}function We(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw();return e.KtG(a.expandNode(i))}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function Ke(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(i){const s=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.openEmployeeDetailsDialog(i.target,s.data))}),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"div",11)(4,"div",12),e.YNc(5,Ge,2,4,"p-image",13),e.YNc(6,$e,2,0,"ng-template",null,14,e.W1O),e.qZA(),e.TgZ(8,"div",15)(9,"p"),e._uU(10),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.ALo(13,"date"),e.qZA()()()(),e.TgZ(14,"div",16),e.YNc(15,We,2,1,"div",17),e.qZA()}if(2&n){const t=r.$implicit,o=e.MAs(7),i=e.oxw();e.Q6J("id",t.data.id),e.xp6(1),e.Tol(i.msgTranslate("mleft-10","mright-10")),e.xp6(1),e.hij(" ",i.msgTranslate(t.data.ar_Name,t.data.en_Name)," "),e.xp6(3),e.Q6J("ngIf",t.data.img&&"/"!=t.data.img)("ngIfElse",o),e.xp6(5),e.hij(" ",i.msgTranslate(null==t.data.jobtitle?null:t.data.jobtitle.ar_Name,null==t.data.jobtitle?null:t.data.jobtitle.en_Name)," "),e.xp6(2),e.hij(" ",e.xi3(13,9,t.data.startDate,"dd-MM-yyyy")," "),e.xp6(3),e.Q6J("ngIf",t.children.length>0)}}let Xe=(()=>{class n extends _.d{constructor(t,o){super(),this.resourcesChartService=t,this.dialog=o,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({employeeId:[null]}),this.resourcesChart=[{type:"resources",expanded:!0,data:{id:1,ar_Name:"\u0641\u062f\u0648\u0649 \u0645\u062d\u0645\u062f",en_Name:"fadwa mohamed",img:"/",startDate:"02-3-2023",jobtitle:{id:2,ar_Name:"sdf aedfsae",en_Name:"adsa asd"},chiledEmployees:[],parentEmployeeId:5},children:[{type:"resources",expanded:!0,data:{id:1,ar_Name:"\u0641\u062f\u0648\u0649 \u0645\u062d\u0645\u062f",en_Name:"fadwa mohamed",img:"/",startDate:"02-3-2023",jobtitle:{id:2,ar_Name:"sdf aedfsae",en_Name:"adsa asd"},chiledEmployees:[],parentEmployeeId:5},children:[]}]}]}onChangeBusinessAndCompanyId(){this.CheckNoBusinessOrCompany()&&this.getResourcesChart(this.formCtrls.employeeId.value)}get formCtrls(){return this.form.controls}getResourcesChart(t){t>0&&(this.showLoading(),this.resourcesChartService.getEmployeesChart(t).subscribe(o=>{o.message.messageType==m.u.Success?(this.mapDataForChart(o.data),setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},100)):this.errorList(o.message.messages),this.hideLoading()}))}mapDataForChart(t){this.resourcesChart=[{label:this.msgTranslate(t[0].ar_Name,t[0].en_Name),type:"resources",styleClass:"resources-node",expanded:!0,data:t[0],children:[]}],this.mapChildrenData(this.resourcesChart[0])}mapChildrenData(t){t.data.chiledEmployees?.map(o=>{let i={label:this.msgTranslate(o.ar_Name,o.en_Name),type:"resources",styleClass:"resources-node",expanded:!0,data:o,children:[]};t.children.push(i),this.mapChildrenData(i)})}onChangeEmployee(){this.getResourcesChart(this.formCtrls.employeeId.value)}upOneLevel(){this.getResourcesChart(this.resourcesChart[0].data.parentEmployeeId)}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn").getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),i=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.left-i?.left+o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),o=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.left-o?.left+t?.width/2}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(He),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-resources-chart"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},features:[e.qOj],decls:13,vars:15,consts:[[1,"organizationchart-container","resources-chart"],[3,"formGroup"],[1,"row","mx-0"],[1,"col-md-4","col-12"],[3,"control","change"],[1,"upOneLevel-btn-container"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],["selectionMode","single",3,"value","preserveSpace"],["pTemplate","resources"],[1,"node-header",3,"id","click"],[1,"node-content","main-data"],[1,"img-container"],["preview","true",3,"src","alt",4,"ngIf","ngIfElse"],["noImg",""],[1,"emp-data"],[1,"node-content"],["class","node-footer",3,"click",4,"ngIf"],["preview","true",3,"src","alt"],[1,"alt-img-preview"],[1,"pi","pi-user"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"app-employee-dropdown",4),e.NdJ("change",function(){return o.onChangeEmployee()}),e.qZA()()()(),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){return o.upOneLevel()}),e._UZ(7,"i",7),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"div"),e.qZA(),e.TgZ(11,"p-organizationChart",8),e.YNc(12,Ke,16,12,"ng-template",9),e.qZA()()),2&t&&(e.ekj("ar",o.languageService.isArabic),e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.employeeId),e.xp6(1),e.ekj("hidden",!(o.resourcesChart&&(null==o.resourcesChart[0]?null:o.resourcesChart[0].data.parentJobTitleID)>0)),e.xp6(1),e.Udp("left",o.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.hij(" ",e.lcZ(9,13,"upOneLevel")," "),e.xp6(2),e.Udp("left",o.upOneLevelBtnPositions.lineLeft,"px"),e.xp6(1),e.Q6J("value",o.resourcesChart)("preserveSpace",!1))},dependencies:[d.O5,R.J,b.jx,L.OE,k.E,v.lW,g._Y,g.JL,g.sg,d.uU,C.X$],styles:[".resources-chart .p-organizationchart-node-content{border-radius:10px;width:250px!important}  .resources-chart .node-header{border-top-left-radius:10px;border-top-right-radius:10px}  .resources-chart .node-header span{display:flex;justify-content:center;align-items:center}  .resources-chart .img-container{margin:1rem}  .resources-chart .emp-data{display:flex;flex-direction:column;justify-content:center;align-items:center}"]}),n})();function Ve(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"i",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.onDelete(i))}),e.ALo(1,"translate"),e.qZA()}2&n&&e.s9C("matTooltip",e.lcZ(1,1,"General.delete"))}function et(n,r){if(1&n&&(e.TgZ(0,"div",23)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,o=e.oxw(2);let i;e.xp6(2),e.hij(" ",null!==(i=o.msgTranslate(null==t.data.orgType?null:t.data.orgType.ar_Name,null==t.data.orgType?null:t.data.orgType.en_Name))&&void 0!==i?i:o.translate("orgTypeDeleted")," ")}}function tt(n,r){if(1&n&&(e.TgZ(0,"div",23)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(2),e.hij(" ",o.msgTranslate(t.data.structure.ar_Name,t.data.structure.en_Name)," ")}}function ot(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24)(1,"i",25),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(2);return e.KtG(s.openOrgDetailsDialog(i.target,a.data,1))}),e._uU(2),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.data.numEmp," ")}}function nt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.expandNode(i))}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.children.length," ")}}function it(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",14)(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"div",15),e.YNc(4,Ve,2,3,"i",16),e.TgZ(5,"i",17),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.openAddEditDialog(a))}),e.ALo(6,"translate"),e.qZA()(),e.YNc(7,et,3,1,"div",18),e.YNc(8,tt,3,1,"div",18),e.qZA(),e.TgZ(9,"div",19),e.YNc(10,ot,3,1,"div",20),e.YNc(11,nt,2,1,"div",21),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(2);let i;e.Q6J("id",null!==(i=null==t.data.org?null:t.data.org.id)&&void 0!==i?i:null),e.xp6(1),e.Tol(o.msgTranslate("mleft-50","mright-50")),e.xp6(1),e.hij(" ",t.label," "),e.xp6(2),e.Q6J("ngIf",t.data.org),e.xp6(1),e.s9C("matTooltip",e.lcZ(6,10,"General.add")),e.xp6(2),e.Q6J("ngIf",t.data.org),e.xp6(1),e.Q6J("ngIf",t.data.structure),e.xp6(2),e.Q6J("ngIf",t.data.numEmp>0),e.xp6(1),e.Q6J("ngIf",t.children.length>0)}}function at(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-tab-group",1)(1,"mat-tab",2),e.ALo(2,"titlecase"),e.ALo(3,"translate"),e.TgZ(4,"div",3)(5,"form",4)(6,"div",5)(7,"div",6)(8,"app-org-types-dropdown",7),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getAllOrganizationsByOrgType())}),e.qZA()(),e.TgZ(9,"div",6),e._UZ(10,"app-prime-dropdown",8),e.qZA()()(),e.TgZ(11,"div",9)(12,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.upOneLevel())}),e._UZ(13,"i",11),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"div"),e.qZA(),e.TgZ(17,"p-organizationChart",12),e.YNc(18,it,12,12,"ng-template",13),e.qZA()()(),e.TgZ(19,"mat-tab",2),e.ALo(20,"titlecase"),e.ALo(21,"translate"),e._UZ(22,"app-job-title-org-chart"),e.qZA(),e.TgZ(23,"mat-tab",2),e.ALo(24,"titlecase"),e.ALo(25,"translate"),e._UZ(26,"app-resources-chart"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("label",e.lcZ(2,19,e.lcZ(3,21,"companyOrgStructure"))),e.xp6(3),e.ekj("ar",t.languageService.isArabic),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.organizationTypeId)("filter",!0),e.xp6(2),e.Q6J("control",t.formCtrls.organization_ID)("List",t.organizationList),e.xp6(1),e.ekj("hidden",t.orgStructureDetailsFiltered&&!(null!=t.orgStructureDetailsFiltered[0]&&t.orgStructureDetailsFiltered[0].data.org)),e.xp6(1),e.Udp("left",t.upOneLevelBtnPositions.btnLeft,"px"),e.xp6(2),e.hij(" ",e.lcZ(15,23,"upOneLevel")," "),e.xp6(2),e.Udp("left",t.upOneLevelBtnPositions.lineLeft,"px"),e.xp6(1),e.Q6J("value",t.orgStructureDetailsFiltered)("preserveSpace",!1),e.xp6(2),e.s9C("label",e.lcZ(20,25,e.lcZ(21,27,"jobtitleChart"))),e.xp6(4),e.s9C("label",e.lcZ(24,29,e.lcZ(25,31,"resources")))}}let H=(()=>{class n extends _.d{constructor(t,o,i){super(),this.orgStructureService=t,this.organizationsService=o,this.dialog=i,this.orgStructureDetailsFiltered=[],this.organizationList=[],this.firstOnChange=!0,this.upOneLevelBtnPositions={btnLeft:0,lineLeft:0}}ngOnInit(){this.form=this.fb.group({organizationTypeId:[null],organization_ID:[{value:null,disabled:!0}]}),this.formCtrls.organization_ID.valueChanges.subscribe(t=>{(null==t||t>0)&&this.onChangeOrg(t)})}ngOnChanges(t){t.orgStructureId&&(this.firstOnChange?this.firstOnChange=!1:this.onChangeBusinessAndCompanyId())}onChangeBusinessAndCompanyId(){this.orgStructureId>0&&this.CheckNoBusinessOrCompany()&&this.getStructureDetails()}get formCtrls(){return this.form.controls}getStructureDetails(){this.showLoading(),this.orgStructureService.getByIdWithHierarchy(this.orgStructureId).subscribe(t=>{t.message.messageType==m.u.Success?this.mapDataForChart(t.data[0]):this.errorList(t.message.messages),this.hideLoading()})}sortDataBeforeMap(t,o,i){t.forEach(a=>{(null==a.parenT_ID||i.includes(a.parenT_ID))&&!i.includes(a.orG_ID)&&(o.push(a),i.push(a.orG_ID))})}mapDataForChart(t){let o=[],i=[];for(;i.length<t.core_Org_Structure_Org.length;)this.sortDataBeforeMap(t.core_Org_Structure_Org,i,o);this.orgStructureDetails=[{label:this.translate("structure"),type:"org",styleClass:"structure-node",expanded:!0,expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder",data:{parentId:null,org:null,orgType:null,numEmp:0,structure:{id:null,ar_Name:t.ar_Name,en_Name:t.en_Name}},children:[]}],i.map(a=>{let s={label:`${a.core_Org?.code} / ${this.msgTranslate(a.core_Org?.ar_Name,a.core_Org?.en_Name)}`,type:"org",styleClass:"org-node",expanded:!0,data:{parentId:a.parenT_ID,org:a.core_Org,orgType:{id:a.core_Org_TYPE?.id,ar_Name:a.core_Org_TYPE?.ar_Name,en_Name:a.core_Org_TYPE?.en_Name},structure:null,structureId:this.orgStructureId,numEmp:a.numEmp},children:[]};a.parenT_ID?this.mapChildrenData(s,this.orgStructureDetails[0].children):this.orgStructureDetails[0].children.push(s)}),this.orgStructureDetailsFiltered=this.orgStructureDetails.slice()}mapChildrenData(t,o){o.map(i=>{i.data.org.id!=t.data.parentId||i.children.push(t)}),o.map(i=>{this.mapChildrenData(t,i.children)})}onChangeOrg(t){this.orgStructureDetailsFiltered=[],t>0?this.getChartDataByOrg(t,this.orgStructureDetails[0]):this.orgStructureDetailsFiltered=this.orgStructureDetails}getChartDataByOrg(t,o){o.children.map(i=>{if(i.data.org.id==t)return this.orgStructureDetailsFiltered=[i],void setTimeout(()=>{this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()},50)}),o.children.map(i=>this.getChartDataByOrg(t,i))}upOneLevel(){this.formCtrls.organization_ID.setValue(0);let t=this.orgStructureDetailsFiltered[0].data.parentId;t?this.getChartDataByOrg(t,this.orgStructureDetails[0]):this.orgStructureDetailsFiltered=this.orgStructureDetails}setPositionBtnUpOneLevel(){let t=document.querySelector(".upOneLevel-btn").getBoundingClientRect().width,o=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),i=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.btnLeft=o?.left-i?.left+o?.width/2-t/2}setPositionUpOneLevelLine(){let t=document.querySelector(".p-organizationchart-node-content")?.getBoundingClientRect(),o=document.querySelector(".p-organizationchart")?.getBoundingClientRect();this.upOneLevelBtnPositions.lineLeft=t?.left-o?.left+t?.width/2}onDelete(t){let o=this.msgTranslate(t.data.org.ar_Name,t.data.org.en_Name);this.deleateDialog(o).subscribe(i=>{i&&this.deleteNode(t)})}deleteNode(t){let o={StructureID:this.orgStructureId,OrgID:t.data.org.id};this.showLoading(),this.orgStructureService.DeleteNode(o).subscribe(i=>{i.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getStructureDetails(),this.getAllOrganizationsByOrgType()):this.errorList(i.message.messages),this.hideLoading()})}openAddEditDialog(t){return this.dialog.open(oe,{data:{org_Structure_ID:this.orgStructureId,parenT_ID:t.data.org?.id??null},minWidth:"50vw",autoFocus:!1}).afterClosed().subscribe(o=>{o&&(this.getStructureDetails(),this.getAllOrganizationsByOrgType())})}openOrgDetailsDialog(t,o,i){let s=this.getHeaderElement(t).getBoundingClientRect(),u={};return u.left=s.left+s.width+10+350<=window.innerWidth?`${s.left+s.width+10}px`:s.left-350-10>=0?s.left-350-10+"px":null,this.dialog.open(ve,{data:{org_Structure_ID:this.orgStructureId,nodeData:o,expandedIndex:i},position:u,width:"350px",maxHeight:"90hv",autoFocus:!1}).afterClosed().subscribe(bt=>{})}getHeaderElement(t){return t.classList.contains("p-organizationchart-node-content")?t:this.getHeaderElement(t.parentElement)}expandNode(t){t.expanded=!t.expanded}getAllOrganizationsByOrgType(){let t=this.formCtrls.organizationTypeId.value;this.formCtrls.organization_ID.setValue(null),t>0?(this.showLoading(),this.organizationsService.GetAllByOrgTypeAndStructure(t,this.orgStructureId).subscribe(o=>{(o.message.messageType=m.u.Success)?this.organizationList=o.data:this.errorList(o.message.messages),this.hideLoading()}),this.formCtrls.organization_ID.enable()):this.formCtrls.organization_ID.disable()}onWindowResize(t){this.setPositionBtnUpOneLevel(),this.setPositionUpOneLevelLine()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O._),e.Y36(P.z),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-org-structure-hierarchy-details"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(a){return o.onWindowResize(a)},!1,e.Jf7)},inputs:{orgStructureId:"orgStructureId",canNotEdit:"canNotEdit"},features:[e.qOj,e.TTD],decls:3,vars:1,consts:[["class","col-12 w-100",4,"ngIf"],[1,"col-12","w-100"],[3,"label"],[1,"organizationchart-container","company-chart"],[3,"formGroup"],[1,"row","mx-0"],[1,"col-md-4","col-12"],[3,"control","filter","change"],["label","organization",3,"control","List"],[1,"upOneLevel-btn-container"],["mat-button","",1,"btn","bg-light-info","upOneLevel-btn",3,"click"],[1,"pi","pi-angle-up"],["styleClass","company",3,"value","preserveSpace"],["pTemplate","org"],[1,"node-header",3,"id"],[1,"action-icons"],["mat-icon-button","","class","pi pi-trash info",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",1,"pi","pi-plus","info",3,"matTooltip","click"],["class","node-content main-data",4,"ngIf"],[1,"node-content"],["class","employees-no-section",4,"ngIf"],["class","node-footer",3,"click",4,"ngIf"],["mat-icon-button","",1,"pi","pi-trash","info",3,"matTooltip","click"],[1,"node-content","main-data"],[1,"employees-no-section"],[1,"pi","pi-users",3,"click"],[1,"node-footer",3,"click"]],template:function(t,o){1&t&&(e._UZ(0,"p-toast")(1,"ngx-spinner"),e.YNc(2,at,27,33,"mat-tab-group",0)),2&t&&(e.xp6(2),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[d.O5,D.J,F.q,b.jx,xe.FN,L.OE,v.lW,M.SP,M.uX,Ze.gM,y.Ro,g._Y,g.JL,g.sg,Re,Xe,d.rS,C.X$],styles:[".mat-tab-body-content{padding:0;overflow-y:auto!important}[_nghost-%COMP%]     .company-chart .node-header i{font-size:1.3rem;cursor:pointer}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header{position:relative}[_nghost-%COMP%]     .company-chart .p-organizationchart .node-header span{display:inline-block}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons{float:right;position:absolute;top:12px;right:0}[_nghost-%COMP%]     .company-chart .p-organizationchart .action-icons i{font-size:1rem;margin-right:10px}"]}),n})();function rt(n,r){if(1&n&&e._UZ(0,"app-add-new-btn",4),2&n){const t=e.oxw();e.MGl("url","/org-management/",t.moduleId,"/org-structure/add"),e.Q6J("params",t.parantParam)}}function st(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"app-prime-dropdown",17),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onChangeOldStructure())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("control",t.formCtrls.CopyStructureID)("submitted",t.submitted)("List",t.structureList)}}function lt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"reset-form-btn",18),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}function pt(n,r){1&n&&(e._UZ(0,"span",21),e.TgZ(1,"div",22),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"canNotEditOrgStructure")," "))}const ct=function(n){return{"ar-msg":n}};function dt(n,r){if(1&n&&(e.TgZ(0,"p-messages",19),e.YNc(1,pt,4,3,"ng-template",20),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,ct,t.languageService.isArabic))}}let G=(()=>{class n extends _.d{constructor(t){super(),this.orgStructureService=t,this.submitted=!1,this.todayDate=new Date,this.structureList=[],this.todayDate.setHours(0,0,0,0)}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],en_Name:[null,[g.kI.required,U.w.whiteSpace]],ar_Name:[null,[g.kI.required,U.w.whiteSpace]],froM_DATE:[null,[g.kI.required]],CopyStructureID:[null]}),this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}onChangeBusinessAndCompanyId(){this.CheckNoBusinessOrCompany()&&(0==this.orgStructureId?this.getAllStructures():this.getById())}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.orgStructureService.getById(this.orgStructureId).subscribe(t=>{t?.message?.messageType==m.u.Success?(this.orgStructure=t.data[0],this.orgStructureToEdit()):this.errorList(t.message.messages),this.hideLoading()})}orgStructureToEdit(){this.form.patchValue(this.orgStructure)}submit(){this.submitted=!0,this.form.valid&&(0==this.formCtrls.id.value?this.create():this.update())}create(){const t={Core_Org_Structure:{en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:this.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE)},CopyStructureID:this.formCtrls.CopyStructureID.value};this.showLoading(),this.orgStructureService.create(t).subscribe(o=>{o?.message?.messageType==m.u.Success?(this.addSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructureId=o.data.id,this.formCtrls.id.setValue(this.orgStructureId),this.navigateTo(`/org-management/${this.moduleId}/org-structure/edit/${this.orgStructureId}`),this.orgStructure=o.data,this.formCtrls.CopyStructureID.reset()):this.errorList(o.message.messages),this.hideLoading()})}update(){const t={id:this.form.value.id,en_Name:this.form.value.en_Name,ar_Name:this.form.value.ar_Name,froM_DATE:this.mapDateReverse(this.form.value.froM_DATE??this.orgStructure?.froM_DATE),to_DATE:this.mapDateReverse(this.orgStructure.tO_DATE)};this.showLoading(),this.orgStructureService.update(t).subscribe(o=>{o.message.messageType==m.u.Success?(this.updateSuccessfullyMsg(o?.message?.messageTypeName),this.orgStructure=o.data):this.errorList(o.message.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}canNotEdit(){return new Date(this.todayDate).getTime()>=new Date(this.orgStructure?.froM_DATE).getTime()}onChangeOldStructure(){}getAllStructures(){this.showLoading(),this.orgStructureService.getAll().subscribe(t=>{(t.message.messageType=m.u.Success)?this.structureList=[{id:null,ar_Name:"\u0627\u0646\u0634\u0627\u0621 \u062c\u062f\u064a\u062f",en_Name:"Create new"},...t.data]:this.errorList(t.message.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O._))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-org-structure"]],features:[e.qOj],decls:26,vars:19,consts:[[1,"row"],[1,"col-12"],["addTitle","orgStructure","editTitle","editOrgStructure",3,"id"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["label","froM_DATE",3,"control","submitted","minDate","disabled"],["label","copyFromPreviousStructure",3,"control","submitted","List","change",4,"ngIf"],["align","end"],[3,"id","onClick"],[3,"click",4,"ngIf"],["severity","warn",3,"ngClass",4,"ngIf"],[3,"orgStructureId","canNotEdit"],["label","copyFromPreviousStructure",3,"control","submitted","List","change"],[3,"click"],["severity","warn",3,"ngClass"],["pTemplate",""],[1,"p-message-icon","pi","pi-exclamation-triangle"],[1,"p-message-detail"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.YNc(6,rt,1,2,"app-add-new-btn",3),e._UZ(7,"app-back-btn",4),e.qZA(),e.TgZ(8,"mat-card-content",5)(9,"div",0)(10,"div",1)(11,"form",6)(12,"div",0)(13,"div",7),e._UZ(14,"app-input",8),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-input",9),e.qZA(),e.TgZ(17,"div",7),e._UZ(18,"app-datepicker",10),e.qZA(),e.TgZ(19,"div",7),e.YNc(20,st,1,3,"app-prime-dropdown",11),e.qZA()()()()()(),e.TgZ(21,"mat-card-actions",12)(22,"submit-btn",13),e.NdJ("onClick",function(){return o.submit()}),e.qZA(),e.YNc(23,lt,1,0,"reset-form-btn",14),e.qZA(),e.YNc(24,dt,2,3,"p-messages",15),e._UZ(25,"app-org-structure-hierarchy-details",16),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("control",o.formCtrls.en_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.ar_Name)("submitted",o.submitted),e.xp6(2),e.Q6J("control",o.formCtrls.froM_DATE)("submitted",o.submitted)("minDate",o.todayDate)("disabled",o.canNotEdit()),e.xp6(2),e.Q6J("ngIf",0==o.form.value.id),e.xp6(2),e.Q6J("id",o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",0==o.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",o.canNotEdit()),e.xp6(1),e.Q6J("orgStructureId",o.orgStructureId||o.formCtrls.CopyStructureID.value)("canNotEdit",0==o.orgStructureId||o.canNotEdit()))},dependencies:[d.mk,d.O5,X.Q,V.a,D.J,B.a,ee.J,te.J,q.p,x.T,b.jx,I.V,h.a8,h.dn,h.n5,h.hq,y.Ro,g._Y,g.JL,g.sg,H,C.X$]}),n})();var $=l(36162);function gt(n,r){if(1&n&&e._UZ(0,"app-org-structure-hierarchy-details",5),2&n){const t=e.oxw();e.Q6J("orgStructureId",t.orgStructureId)("canNotEdit",!0)}}let mt=(()=>{class n extends _.d{constructor(){super(),this.orgStructureId=0}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.orgStructureId=Number(t.get("orgStructureId"))??0})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-org-structure-details"]],features:[e.qOj],decls:8,vars:3,consts:[[1,"row"],[1,"col-12"],["title","orgStructureDetails"],[3,"url","params"],[3,"orgStructureId","canNotEdit",4,"ngIf"],[3,"orgStructureId","canNotEdit"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2)(6,"app-back-btn",3),e.qZA(),e.YNc(7,gt,1,2,"app-org-structure-hierarchy-details",4),e.qZA()()()),2&t&&(e.xp6(6),e.MGl("url","/org-management/",o.moduleId,"/org-structure/index"),e.Q6J("params",o.pageParams),e.xp6(1),e.Q6J("ngIf",o.orgStructureId>0))},dependencies:[d.O5,B.a,x.T,h.a8,h.n5,y.Ro,H]}),n})();var ut=l(92972);let _t=(()=>{class n extends _.d{constructor(t){super(),this.jobTitleService=t,this.mandatoryColomns=["Ser","id","code","en_Name","ar_Name","actions"],this.optionalColomns=["jobFamily"],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new S.by(null)),this.CheckNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}getList(t,o){this.removePageParams(),this.page.pageIndex=t,o&&(this.page.pageSize=o);let i={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.jobTitleService.getList(i).subscribe(a=>{if(a.message.messageType==m.u.Success){if(0==a.data.length&&t>1)return void this.getList(this.prevPage);a.data.map(s=>{s.jobFamily=this.msgTranslate(s.core_Job_Title_Family?.ar_Name,s.core_Job_Title_Family?.en_Name)}),this.dataSource=new S.by(a.data),this.isLoaded=!0,this.page.length=a.meta.totalItemCount}else this.errorList(a.message.messages);this.hideLoading()})}onDelete(t){let o=this.msgTranslate(t.ar_Name,t.en_Name);this.deleateDialog(o).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.jobTitleService.Delete(t.id).subscribe(o=>{o.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o.message.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ut._))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-jobs-profile-index"]],features:[e.qOj],decls:8,vars:7,consts:[[1,"row"],[1,"col-12"],["title","jobsProfile",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,o){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.qZA(),e._UZ(6,"mat-divider"),e.TgZ(7,"app-material-table",3),e.NdJ("onChangePage",function(a){return o.getList(a.pageIndex+1,a.pageSize)})("deleteRow",function(a){return o.onDelete(a)}),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",null==o.globalFunctions?null:o.globalFunctions.reverse()),e.xp6(2),e.Q6J("isLoaded",o.isLoaded)("dataSource",o.dataSource)("mandatoryColomns",o.mandatoryColomns)("optionalColomns",o.optionalColomns)("page",o.page)("actions",o.rowFunctions))},dependencies:[j.I,x.T,h.a8,h.n5,A.d,y.Ro]}),n})();var W=l(12385),ht=l(63581),f=l(74513);const ft=[{path:"org-structure",data:{view:f.S.org_structure},children:[{path:"",redirectTo:"index",pathMatch:$.U.full},{path:"index",component:K,data:{view:f.S.org_structure_index}},{path:"add",component:G,data:{view:f.S.add_org_structure}},{path:"edit/:orgStructureId",component:G,data:{view:f.S.add_org_structure}},{path:"details/:orgStructureId",component:mt,data:{view:f.S.org_structure_details}}]},{path:"job-profile",data:{view:f.S.job_profile},children:[{path:"",redirectTo:"index",pathMatch:$.U.full},{path:"index",component:_t,data:{view:f.S.job_profile_index}},{path:"add",component:W.g,data:{view:f.S.add_job_profile}},{path:"edit/:jobId",component:W.g,data:{view:f.S.add_job_profile}},{path:"assign-job-to-org",component:ht.A,data:{view:f.S.assign_job_to_org}}]}];let yt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[E.Bz.forChild(ft),E.Bz]}),n})();var Ct=l(78475);let Tt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,yt,Ct.m]}),n})()}}]);