"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[644],{3710:(J,C,o)=>{o.d(C,{r:()=>y});var u=o(94650),T=o(67579),p=o(24280);let y=(()=>{class c{constructor(m){this.viewsService=m,this.loadingService=(0,u.f3M)(T.b),this.UserModules=this.viewsService.UserModules$.getValue(),this.loading=document.getElementById("page-loading")}canActivate(m,f){return!0}showLoading(){this.loading.style.display="block",this.loading.style.opacity="1",this.loading.style.zIndex="998"}hideLoading(){this.loading.style.display="none",this.loading.style.opacity="0",this.loading.style.zIndex="0"}}return c.\u0275fac=function(m){return new(m||c)(u.LFG(p.Z))},c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},66644:(J,C,o)=>{o.r(C),o.d(C,{PayrollSetupModule:()=>ne});var u=o(36895),T=o(80458),p=o(30671),y=o(35478),m=o(15602),f=o(95751),e=o(94650),L=o(1903),v=o(26315);let E=(()=>{class s extends L.K{constructor(){super()}create(t){return this.post("PayrollElementSetup/Create",t)}update(t){return this.post("PayrollElementSetup/Edit",t)}getList(t){return this.get("PayrollElementSetup/GetList",{params:{...t,$expand:`${v.db.PAY_Element_Variable},${v.db.PAY_Element_Variable}/${v.db.PAY_Variable}`}})}getAll(){return this.get("PayrollElementSetup/GetAll")}getById(t){return this.get("PayrollElementSetup/GetAll",{params:{$expand:`${v.db.PAY_Element_Variable},${v.db.PAY_Element_Variable}/${v.db.PAY_Variable}`,$filter:`id eq ${t}`}})}Delete(t){return this.delete("PayrollElementSetup/Delete",{params:{Id:t}})}createUser(t){return this.post("PayrollElementSetup/Create_Element_Users_Details",t)}getAllUsersByPayrollElement(t){return this.get("PayrollElementSetup/GetAll_Element_Users_Details",{params:{Element_ID:t}})}DeleteUser(t){return this.delete("PayrollElementSetup/Delete_Element_Users_Details",{params:t})}exportExcel(){this.getAll()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var S=o(93410),_=o(46896),d=o(73546);let F=(()=>{class s extends f.U{constructor(t){super(),this.payrollElementsService=t,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","actions"],this.optionalColomns=["variableCode","display_In_Result"],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new p.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.currentPage)}getList(t,a){this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.payrollElementsService.getList({PageNumber:this.page.pageIndex,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(n=>{if(n.message.messageType==m.u.Success){if(0==n.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new p.by(function c(s){return s.map(l=>({...l,en_Name:l.name,variableCode:l.paY_Element_Variable[0].pay_Variable?.code,display_In_Result:l.paY_Element_Variable[0].pay_Variable?.display_In_Result}))}(n.data)),this.isLoaded=!0,this.page.length=n.meta.totalItemCount,this.page.meta=n.meta}else this.errorList(n?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(a).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.payrollElementsService.Delete(t.id).subscribe(a=>{a.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(E))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payroll-elements-index"]],features:[e.qOj],decls:6,vars:8,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","payrollElements",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"app-material-table",4),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(1),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("exportService",a.payrollElementsService)("actions",a.rowFunctions))},dependencies:[S.I,_.T,d.a8,d.n5]}),s})();var r=o(24006),M=o(33975),g=o(78937),A=o(25273),Q=o(12613),w=o(61064),G=o(52682),D=o(56500),I=o(57566),Z=o(44850),Y=o(18157),z=o(70137),B=o(16841);function V(s,l){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-material-table",13),e.NdJ("deleteRow",function(i){e.CHM(t);const n=e.oxw();return e.KtG(n.onDelete(i))}),e.qZA(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("showPaginator",!1)("showFilter",!1)}}let O=(()=>{class s extends f.U{constructor(t){super(),this.payrollElementsService=t,this.submitted=!1,this.mandatoryColomns=["Ser","name","dateFrom","dateTo","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({UserID:[null,[r.kI.required]],DateFrom:[null,[r.kI.required]],DateTo:[null,[r.kI.required]]},{validator:g.w.compareDates("DateFrom","DateTo")})}ngOnChanges(t){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new p.by(null)),this.payrollElementId&&this.checkNoBusinessOrCompany()&&this.getAll()}get formCtrls(){return this.form.controls}getAll(){this.payrollElementsService.getAllUsersByPayrollElement(this.payrollElementId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==m.u.Success?(this.dataSource=new p.by(function P(s){return s.map(l=>({...l,dateFrom:y.M.mapDate(l.dateFrom),dateTo:y.M.mapDate(l.dateTo),name:l.uM_Users?.name,id:l.userID}))}(t.data)),this.isLoaded=!0):this.errorList(t?.message?.messages)})}submit(){if(this.submitted=!0,this.form.valid){const t=[{ElementID:this.payrollElementId,UserID:this.form.value.UserID,DateFrom:y.M.mapDateReverse(this.form.value.DateFrom),DateTo:y.M.mapDateReverse(this.form.value.DateTo)}];this.create(t)}}create(t){this.showLoading(),this.payrollElementsService.createUser(t).subscribe(a=>{a?.message?.messageType==m.u.Success?(this.clearForm(),this.addSuccessfullyMsg(a?.message?.messageTypeName),this.getAll()):this.errorList(a?.message?.messages),this.hideLoading()})}onDelete(t){let a=this.msgTranslate(t.uM_Users.name);this.deleteDialog(a).subscribe(i=>{i&&this.delete(t)})}delete(t){let a={elementid:this.payrollElementId,userid:t.uM_Users.id,from:this.resetDateFormat(t.dateFrom),to:this.resetDateFormat(t.dateTo)};this.showLoading(),this.payrollElementsService.DeleteUser(a).subscribe(i=>{i.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(i?.message?.messageTypeName),this.getAll()):this.errorList(i?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1}resetDateFormat(t){return t.split("-").reverse().join("-").concat("T00:00:00")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(E))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payroll-element-users"]],inputs:{payrollElementId:"payrollElementId"},features:[e.qOj,e.TTD],decls:16,vars:10,consts:[[1,"pt-2"],["title","users"],[1,"container-fluid","mb-0"],[1,"row"],[1,"col-lg-11","col-md-10"],[3,"formGroup"],[1,"col-md-4","col-12"],[3,"control","submitted","filter"],["label","dateFrom",3,"control","submitted"],["label","dateTo",3,"control","submitted"],[1,"col-lg-1","col-md-2","p-0"],[1,"mtop-3","btn-sm","float-right","my-0",3,"disabled","onClick"],[4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","showPaginator","showFilter","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"mat-card-content",2)(3,"div",3)(4,"div",4)(5,"form",5)(6,"div",3)(7,"div",6),e._UZ(8,"app-users-dropdown",7),e.qZA(),e.TgZ(9,"div",6),e._UZ(10,"app-datepicker",8),e.qZA(),e.TgZ(11,"div",6),e._UZ(12,"app-datepicker",9),e.qZA()()()(),e.TgZ(13,"div",10)(14,"submit-btn",11),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()(),e.YNc(15,V,2,7,"ng-container",12)),2&t&&(e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.UserID)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.DateFrom)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.DateTo)("submitted",a.submitted),e.xp6(2),e.Q6J("disabled",!a.payrollElementId),e.xp6(1),e.Q6J("ngIf",a.payrollElementId))},dependencies:[u.O5,z.Q,S.I,I.p,_.T,d.dn,d.n5,B.$,r._Y,r.JL,r.sg]}),s})();function k(s,l){if(1&s&&e._UZ(0,"app-add-new-btn",5),2&s){const t=e.oxw();e.MGl("url","/payroll-setup/",t.moduleId,"/payroll-elements/add"),e.Q6J("params",t.parentParam)}}function x(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"reset-form-btn",20),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}let U=(()=>{class s extends f.U{constructor(t){super(),this.payrollElementsService=t,this.submitted=!1}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.payrollElementId=Number(t.get("payrollElementId"))??0}),this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,[r.kI.required,g.w.whiteSpace]],en_name:[null,[r.kI.required,g.w.whiteSpace]],variableCode:[null,[r.kI.required,g.w.whiteSpace,g.w.noSpace,r.kI.pattern(M.g.variableCode_pattern)]],element_Group_ID:[null,[r.kI.required]],display_In_Result:[null]})}onChangeBusinessAndCompanyId(){this.payrollElementId>0&&this.checkNoBusinessOrCompany()&&this.getById()}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.payrollElementsService.getById(this.payrollElementId).subscribe(t=>{t.message.messageType==m.u.Success?this.payrollElementToEdit(t.data[0]):this.errorList(t?.message?.messages),this.hideLoading()})}payrollElementToEdit(t){this.form.patchValue(t),this.formCtrls.en_name.setValue(t.name),this.formCtrls.variableCode.setValue(t.paY_Element_Variable[0].pay_Variable.code),this.formCtrls.display_In_Result.setValue(t.paY_Element_Variable[0].pay_Variable.display_In_Result)}submit(){if(this.submitted=!0,this.form.valid){const t={PAY_Element:{ID:this.form.value.id,ar_Name:this.form.value.ar_Name,name:this.form.value.en_name,element_Group_ID:this.form.value.element_Group_ID},variableCode:this.form.value.variableCode.trim(),display_In_Result:this.form.value.display_In_Result??!1};0==t.PAY_Element.ID?this.create(t):this.update(t)}}create(t){this.showLoading(),this.payrollElementsService.create(t).subscribe(a=>{a?.message?.messageType==m.u.Success?(this.payrollElementId=a.data.id,this.formCtrls.id.setValue(this.payrollElementId),this.navigateTo(`/payroll-setup/${this.moduleId}/payroll-elements/edit/${this.payrollElementId}`),this.addSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a?.message?.messages),this.hideLoading()})}update(t){this.showLoading(),this.payrollElementsService.update(t).subscribe(a=>{a.message.messageType==m.u.Success?this.updateSuccessfullyMsg(a?.message?.messageTypeName):this.errorList(a?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(E))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-payroll-element"]],features:[e.qOj],decls:27,vars:17,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","payrollElements","editTitle","editPayrollElement",3,"id"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["label","variableCode",3,"control","submitted"],[1,"col-md-6","col-12"],[3,"control","submitted"],[1,"col-md-6","col-12","ptop-15","pbottom-15"],["label","display_In_Result","color","primary",1,"mx-2",3,"control"],["align","end"],[3,"id","onClick"],[3,"click",4,"ngIf"],[3,"payrollElementId"],[3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.YNc(5,k,1,2,"app-add-new-btn",4),e._UZ(6,"app-back-btn",5),e.qZA(),e.TgZ(7,"mat-card-content",6)(8,"div",0)(9,"div",1)(10,"form",7)(11,"div",0)(12,"div",8),e._UZ(13,"app-input",9),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"app-input",10),e.qZA(),e.TgZ(16,"div",8),e._UZ(17,"app-input",11),e.qZA(),e.TgZ(18,"div",12),e._UZ(19,"app-element-groups-dropdown",13),e.qZA(),e.TgZ(20,"div",14),e._UZ(21,"app-check-box",15),e.qZA()()()()()(),e.TgZ(22,"mat-card-actions",16)(23,"submit-btn",17),e.NdJ("onClick",function(){return a.submit()}),e.qZA(),e.YNc(24,x,1,0,"reset-form-btn",18),e.qZA(),e._UZ(25,"mat-divider")(26,"app-payroll-element-users",19),e.qZA()()()),2&t&&(e.xp6(4),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/payroll-setup/",a.moduleId,"/payroll-elements/index"),e.Q6J("params",a.pageParams),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.en_name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ar_Name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.variableCode)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.element_Group_ID)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.display_In_Result),e.xp6(2),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",0==a.formCtrls.id.value),e.xp6(2),e.Q6J("payrollElementId",a.payrollElementId))},dependencies:[u.O5,A.a,Q.u,w.a,G.J,D.J,I.p,_.T,d.a8,d.dn,d.n5,d.hq,Z.d,Y.P,r._Y,r.JL,r.sg,O]}),s})(),q=(()=>{class s extends L.K{constructor(){super()}create(t){return this.post("PaymentTypeSetup/Create",t)}update(t){return this.post("PaymentTypeSetup/Edit",t)}getList(t){return this.get("PaymentTypeSetup/GetList",{params:t})}getAll(){return this.get("PaymentTypeSetup/GetAll")}Delete(t){return this.delete("PaymentTypeSetup/Delete",{params:{Id:t}})}exportExcel(){this.getAll()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function j(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"reset-form-btn",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}let $=(()=>{class s extends f.U{constructor(t){super(),this.paymentTypesService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","en_Name","ar_NAme","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_name:[null,[r.kI.required,g.w.whiteSpace]],en_name:[null,[r.kI.required,g.w.whiteSpace]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new p.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a),this.paymentTypesService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(n=>{n.message.messageType==m.u.Success?(this.dataSource=new p.by(n.data),this.isLoaded=!0,this.page.length=n.meta.totalItemCount,this.page.meta=n.meta):this.errorList(n?.message?.messages)})}submit(){if(this.submitted=!0,this.form.valid){const t={ID:this.form.value.id,Ar_Name:this.form.value.ar_name,En_Name:this.form.value.en_name};0==t.ID?this.create(t):this.update(t)}}create(t){this.showLoading(),this.paymentTypesService.create(t).subscribe(a=>{a?.message?.messageType==m.u.Success?(this.clearForm(),this.getList(this.lastPage,this.page.pageSize),this.addSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a?.message?.messages),this.hideLoading()})}update(t){this.showLoading(),this.paymentTypesService.update(t).subscribe(a=>{a.message.messageType==m.u.Success?(this.clearForm(),this.getList(this.currentPage,this.page.pageSize),this.updateSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a?.message?.messages),this.hideLoading()})}paymentTypeToEdit(t){this.form.patchValue(t),this.formCtrls.ar_name.setValue(t.ar_NAme),this.formCtrls.en_name.setValue(t.en_Name)}onDelete(t){let a=this.msgTranslate(t.ar_NAme,t.en_Name);this.deleteDialog(a).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.paymentTypesService.Delete(t.id).subscribe(a=>{a.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize),t.id==this.formCtrls.id.value&&this.clearForm()):this.errorList(a?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(q))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payment-types"]],features:[e.qOj],decls:19,vars:15,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","paymentTypes","editTitle","editPaymentType",3,"id"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-6","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["align","end"],[3,"id","onClick"],[3,"click",4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","editRow","deleteRow"],[3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"mat-card-content",4)(6,"div",0)(7,"div",1)(8,"form",5)(9,"div",0)(10,"div",6),e._UZ(11,"app-input",7),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"app-input",8),e.qZA()()()()()(),e.TgZ(14,"mat-card-actions",9)(15,"submit-btn",10),e.NdJ("onClick",function(){return a.submit()}),e.qZA(),e.YNc(16,j,1,0,"reset-form-btn",11),e.qZA(),e._UZ(17,"mat-divider"),e.TgZ(18,"app-material-table",12),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("editRow",function(n){return a.paymentTypeToEdit(n)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("id",a.formCtrls.id.value),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.en_name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ar_name)("submitted",a.submitted),e.xp6(2),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("exportService",a.paymentTypesService)("actions",a.rowFunctions))},dependencies:[u.O5,A.a,S.I,D.J,I.p,_.T,d.a8,d.dn,d.n5,d.hq,Z.d,r._Y,r.JL,r.sg]}),s})();var K=o(36575),N=o(43949);let X=(()=>{class s extends L.K{constructor(){super()}create(t){return this.post("LoanRules/Create",t)}getListByLoanTypeId(t,a){return this.get("LoanRules/GetList",{params:{...t,$filter:`loneTypeId eq ${a}`}})}getAll(){return this.get("LoanRules/GetAll")}Delete(t){return this.delete("LoanRules/Delete",{params:{Id:t}})}exportExcel(){this.getAll()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var W=o(62160),H=o(22334),ee=o(74884);let te=(()=>{class s extends f.U{constructor(t){super(),this.loanRulesService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","jobTitle","payment","variable","actions"],this.optionalColomns=["variablePercantage","monthlyInterval"],this.isLoaded=!1}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.loanTypeId=Number(t.get("loanTypeId"))??0}),this.form=this.fb.group({jobTitleId:[null,[r.kI.required]],paymentId:[null,[r.kI.required]],variableId:[null,[r.kI.required]],variablePercantage:[null,[N.dN.digits]],monthlyInterval:[null,[N.dN.digits]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new p.by(null)),this.loanTypeId&&this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a),this.loanRulesService.getListByLoanTypeId({PageNumber:t,pageSize:this.page.pageSize},this.loanTypeId).pipe(this.cancelRequest()).subscribe(n=>{n.message.messageType==m.u.Success?(this.dataSource=new p.by((0,K.r)(n.data)),this.isLoaded=!0,this.page.length=n.meta.totalItemCount,this.page.meta=n.meta):this.errorList(n?.message?.messages)})}submit(){if(this.submitted=!0,this.form.valid){if(!this.form.value.variablePercantage&&!this.form.value.monthlyInterval)return void this.warning("variablePercentageAndMonthlyIntervalMsg");this.create({loneTypeId:this.loanTypeId,jobTitleIdLst:this.form.value.jobTitleId,paymentId:this.form.value.paymentId,variableId:this.form.value.variableId,variablePercantage:this.form.value.variablePercantage,monthlyInterval:this.form.value.monthlyInterval})}}create(t){this.showLoading(),this.loanRulesService.create(t).subscribe(a=>{a?.message?.messageType==m.u.Success?(this.clearForm(),this.addSuccessfullyMsg(a?.message?.messageTypeName),this.getList(this.lastPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}onDelete(t){let a=this.msgTranslate(`${t.jobTitle} - ${t.variable}`);this.deleteDialog(a).subscribe(i=>{i&&this.delete(t)})}delete(t){this.showLoading(),this.loanRulesService.Delete(t.id).subscribe(a=>{a.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(X))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-loan-rules"]],features:[e.qOj],decls:25,vars:25,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["title","loanRules"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12","mbottom-10"],[3,"control","submitted","multi","filter"],[1,"col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","paymentControl","submitted","filter"],[1,"col-md-6","col-12"],["type","number","label","variablePercantage",3,"control","submitted"],["type","number","label","monthlyInterval",3,"control","submitted"],["align","end"],[3,"onClick"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3)(5,"app-back-btn",4),e.qZA(),e.TgZ(6,"mat-card-content",5)(7,"div",0)(8,"div",1)(9,"form",6)(10,"div",0)(11,"div",7),e._UZ(12,"app-job-title-dropdown",8),e.qZA(),e.TgZ(13,"div",9),e._UZ(14,"app-payment-dropdown",10),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"app-variable-by-payment-dropdown",11),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"app-input",13),e.qZA(),e.TgZ(19,"div",12),e._UZ(20,"app-input",14),e.qZA()()()()()(),e.TgZ(21,"mat-card-actions",15)(22,"submit-btn",16),e.NdJ("onClick",function(){return a.submit()}),e.qZA()(),e._UZ(23,"mat-divider"),e.TgZ(24,"app-material-table",17),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(5),e.MGl("url","/payroll-setup/",a.moduleId,"/loans/loan-types"),e.Q6J("params",a.pageParams),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.jobTitleId)("submitted",a.submitted)("multi",!0)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.paymentId)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.variableId)("paymentControl",a.formCtrls.paymentId)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.variablePercantage)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.monthlyInterval)("submitted",a.submitted),e.xp6(4),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("exportService",a.loanRulesService)("actions",a.rowFunctions))},dependencies:[A.a,S.I,w.a,I.p,_.T,d.a8,d.dn,d.n5,d.hq,Z.d,W.W,H.s,ee.Y,r._Y,r.JL,r.sg]}),s})();var ae=o(34486),R=o(36162),h=o(74513),b=o(3710);const se=[{path:"payroll-elements",data:{view:h.S.payroll_elements},children:[{path:"",redirectTo:"index",pathMatch:R.U.full},{path:"index",component:F,data:{view:h.S.payroll_elements_index},canActivate:[b.r]},{path:"add",component:U,data:{view:h.S.add_payroll_elements},canActivate:[b.r]},{path:"edit/:payrollElementId",component:U,data:{view:h.S.add_payroll_elements},canActivate:[b.r]}]},{path:"payment-types",component:$,data:{view:h.S.payment_types},canActivate:[b.r]},{path:"loans",data:{view:h.S.loans},children:[{path:"",redirectTo:"loan-types",pathMatch:R.U.full},{path:"loan-types",component:ae.P,data:{view:h.S.loan_types},canActivate:[b.r]},{path:"loan-rules/:loanTypeId",component:te,data:{view:h.S.loan_rules},canActivate:[b.r]}]}];let oe=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[T.Bz.forChild(se),T.Bz]}),s})();var le=o(66393);let ne=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[u.ez,oe,le.m]}),s})()}}]);