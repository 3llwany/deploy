"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[30],{3710:(J,b,r)=>{r.d(b,{r:()=>n});var u=r(94650),v=r(67579),y=r(24280),f=r(80458);let n=(()=>{class l{constructor(h,c){this.viewsService=h,this.router=c,this.loadingService=(0,u.f3M)(v.b),this.UserModules=this.viewsService.UserModules$.getValue(),this.loading=document.getElementById("page-loading")}canActivate(h,c){let g=h.data?.view;if(this.showLoading(),this.UserModules?.length>0){if(this.viewsService.isViewAllowed(g))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}else this.viewsService.UserModules$.subscribe(C=>{if(C?.length>0){if(this.viewsService.isViewAllowed(g))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}})}showLoading(){this.loading.style.display="block",this.loading.style.opacity="1",this.loading.style.zIndex="998"}hideLoading(){this.loading.style.display="none",this.loading.style.opacity="0",this.loading.style.zIndex="0"}}return l.\u0275fac=function(h){return new(h||l)(u.LFG(y.Z),u.LFG(f.F0))},l.\u0275prov=u.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},72030:(J,b,r)=>{r.r(b),r.d(b,{DashboardSetupModule:()=>se});var u=r(36895),v=r(80458),y=r(36162),f=r(74513),n=r(24006),l=r(30671),m=r(15602),h=r(95751),c=r(78937),g=r(43949),C=r(61894),T=r(35478),e=r(94650),P=r(94891),L=r(25273),_=r(93410),O=r(857),F=r(12613),A=r(56500),Z=r(57566),S=r(46896),U=r(31415),p=r(73546),w=r(44850),M=r(55833);function E(a,d){if(1&a&&(e.TgZ(0,"div",6),e._UZ(1,"app-input",20),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Q6J("control",s.formCtrls.home_Order)("submitted",s.submitted)("type",s.inputType.number)}}function R(a,d){if(1&a){const s=e.EpF();e.TgZ(0,"reset-form-btn",21),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}let z=(()=>{class a extends h.U{constructor(s){super(),this.dashboardService=s,this.submitted=!1,this.removeFiles=!1,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","module","link","actions"],this.isLoaded=!1}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,c.w.whiteSpace],en_Name:[null,[n.kI.required,c.w.whiteSpace]],link:[null,[n.kI.required,c.w.whiteSpace,g.dN.url]],module_Id:[null,n.kI.required],service_Id:[null],isExistInHome:[!1],home_Order:[null],file:[null,n.kI.required],dashboard_Order:[null,[n.kI.required,g.dN.gt(0)]]}),this.formCtrls.isExistInHome.valueChanges.subscribe(s=>{s?this.formCtrls.home_Order.setValidators([n.kI.required,g.dN.gt(0)]):this.formCtrls.home_Order.removeValidators([n.kI.required,g.dN.gt(0)]),this.formCtrls.home_Order.updateValueAndValidity()})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new l.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(s,t){this.page.pageIndex=s,t&&(this.page.pageSize=t),this.dashboardService.getList({PageNumber:s,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==m.u.Success?(this.dataSource=new l.by((0,C.KU)(o.data)),this.isLoaded=!0,this.page.length=o.meta.totalItemCount,this.page.meta=o.meta):this.errorList(o?.message?.messages)})}submit(){if(this.removeFiles=!1,this.submitted=!0,this.form.valid){const s={dash_dashboard:{ID:this.formCtrls.id.value,Ar_Name:this.formCtrls.ar_Name.value,En_Name:this.formCtrls.en_Name.value,Link:this.formCtrls.link.value,Home_Order:this.formCtrls.home_Order.value??0,IsExistInHome:this.formCtrls.isExistInHome.value},Module_ID:this.formCtrls.module_Id.value,Service_ID:this.formCtrls.service_Id.value??!1,Dashboard_Order:this.formCtrls.dashboard_Order.value,files:this.formCtrls.file.value};let t=T.M6.objectToFormData(s);0==s.dash_dashboard.ID?this.create(t):this.update(t)}}create(s){this.showLoading(),this.dashboardService.create(s).subscribe(t=>{t?.message?.messageType==m.u.Success?(this.clearForm(),this.getList(this.firstPage,this.page.pageSize),this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newDashboardAdded")):this.errorList(t?.message?.messages),this.hideLoading()})}update(s){this.showLoading(),this.dashboardService.update(s).subscribe(t=>{t?.message?.messageType==m.u.Success?(this.clearForm(),this.getList(this.currentPage,this.page.pageSize),this.updateSuccessfullyMsg("dashboardUpdated")):this.errorList(t?.message?.messages),this.hideLoading()})}itemToEdit(s){console.log("item",s),this.form.patchValue(s),this.formCtrls.isExistInHome.setValue(s.isExistInHome??!1),this.formCtrls.home_Order.setValue(0==s.home_Order?null:s.home_Order),this.formCtrls.file.setValue({id:s.id,name:s.en_Name,path:"/"+s?.file?.path,size:s.file?.size,type:s.file?.mime}),console.log("edit",this.formCtrls.file.value)}onDelete(s){let t=this.msgTranslate(s.ar_Name,s.en_Name);this.deleteDialog(t).subscribe(i=>{i&&this.delete(s)})}delete(s){this.showLoading(),this.dashboardService.Delete(s.id).subscribe(t=>{t.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg("dashboardRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize),s.id==this.formCtrls.id.value&&this.clearForm()):this.errorList(t?.message?.messages)})}deleteFile(){this.formCtrls.file.setValue(null)}clearForm(){this.form.reset({id:0}),this.submitted=!1,this.removeFiles=!0}changeHomeOrderValidation(){this.formCtrls.isExistInHome.value?this.formCtrls.home_Order.addValidators(n.kI.required):(this.formCtrls.home_Order.clearValidators(),this.formCtrls.home_Order.setValue(null))}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(P.s))},a.\u0275cmp=e.Xpm({type:a,selectors:[["add-dashboard"]],features:[e.qOj],decls:33,vars:36,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","dashboard","editTitle","editdDashboard",3,"id"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-3","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],[3,"control","submitted","filter"],[3,"moduleControl","control","submitted","filter","multi"],["label","DashboardOrder",3,"control","submitted","type"],["label","link",3,"control","submitted"],["label","IsExistInHome",1,"mtop-15","d-block",3,"control","onChange"],["class","col-md-3 col-12",4,"ngIf"],["accept","image/*",3,"control","submitted","multiple","isDragDrop","removeFiles","isFormValid","isEdit","ondelete"],["align","end"],[3,"click",4,"ngIf"],[3,"id","onClick"],[3,"isLoaded","dataSource","mandatoryColomns","page","actions","exportService","onChangePage","editRow","deleteRow"],["label","HomeOrder",3,"control","submitted","type"],[3,"click"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"mat-card-content",4)(6,"div",0)(7,"div",1)(8,"form",5)(9,"div",0)(10,"div",6),e._UZ(11,"app-input",7),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"app-input",8),e.qZA(),e.TgZ(14,"div",6),e._UZ(15,"app-module-dropdown",9),e.qZA(),e.TgZ(16,"div",6),e._UZ(17,"app-service-by-module-id-dropdown",10),e.qZA(),e.TgZ(18,"div",6),e._UZ(19,"app-input",11),e.qZA(),e.TgZ(20,"div",6),e._UZ(21,"app-input",12),e.qZA(),e.TgZ(22,"div",6)(23,"app-check-box",13),e.NdJ("onChange",function(){return t.changeHomeOrderValidation()}),e.qZA()(),e.YNc(24,E,2,3,"div",14),e.qZA(),e.TgZ(25,"div",0)(26,"div",6)(27,"primeng-file-upload",15),e.NdJ("ondelete",function(){return t.deleteFile()}),e.qZA()()()()()()(),e.TgZ(28,"mat-card-actions",16),e.YNc(29,R,1,0,"reset-form-btn",17),e.TgZ(30,"submit-btn",18),e.NdJ("onClick",function(){return t.submit()}),e.qZA()(),e._UZ(31,"mat-divider"),e.TgZ(32,"app-material-table",19),e.NdJ("onChangePage",function(o){return t.getList(o.pageIndex+1,o.pageSize)})("editRow",function(o){return t.itemToEdit(o)})("deleteRow",function(o){return t.onDelete(o)}),e.qZA()()()()),2&s&&(e.xp6(4),e.Q6J("id",t.formCtrls.id.value),e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.en_Name)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.ar_Name)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.module_Id)("submitted",t.submitted)("filter",!0),e.xp6(2),e.Q6J("moduleControl",t.formCtrls.module_Id)("control",t.formCtrls.service_Id)("submitted",t.submitted)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",t.formCtrls.dashboard_Order)("submitted",t.submitted)("type",t.inputType.number),e.xp6(2),e.Q6J("control",t.formCtrls.link)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.isExistInHome),e.xp6(1),e.Q6J("ngIf",t.formCtrls.isExistInHome.value),e.xp6(3),e.Q6J("control",t.formCtrls.file)("submitted",t.submitted)("multiple",!1)("isDragDrop",!0)("removeFiles",t.removeFiles)("isFormValid",t.form.valid)("isEdit",null!=t.formCtrls.file),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(1),e.Q6J("id",t.formCtrls.id.value),e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("page",t.page)("actions",t.rowFunctions)("exportService",t.dashboardService))},dependencies:[u.O5,L.a,_.I,O.J,F.u,A.J,Z.p,S.T,U.a,p.a8,p.dn,p.n5,p.hq,w.d,M.y,n._Y,n.JL,n.sg]}),a})();var I=r(3710),V=r(72446),Q=r(85070),B=r(29721);let H=(()=>{class a extends h.U{constructor(s){super(),this.propertiesService=s,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","type","actions"],this.optionalColomns=[],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new l.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(s,t){this.page.pageIndex=s,t&&(this.page.pageSize=t),this.propertiesService.getList({PageNumber:s,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==m.u.Success?(o.data.map(N=>N.type=this.translate(N.property_Type)),this.dataSource=new l.by(o.data),this.isLoaded=!0,this.page.length=o.meta.totalItemCount,this.page.meta=o.meta):this.errorList(o?.message?.messages)})}onDelete(s){let t=this.msgTranslate(s.ar_Name,s.en_Name);this.deleteDialog(t).subscribe(i=>{i&&this.delete(s)})}delete(s){this.showLoading(),this.propertiesService.Delete(s.id).subscribe(t=>{t.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg("deleteProperty","successfulDelete"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(t?.message?.messages),this.hideLoading()})}openAddPropertyDialog(s){this.dialogsService.addEditDialog(V.L,{data:s},{width:"25vw",minWidth:"400px",maxWidth:"500px",maxHeight:"98vh",disableClose:!0,panelClass:"setup-dialog"}).afterClosed().subscribe(t=>{t?.isUpdate&&this.getList(this.firstPage)})}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(Q.C))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-properity-index"]],features:[e.qOj],decls:6,vars:8,consts:[[1,"row"],[1,"col-12"],[1,"index-card"],["title","properties","TitleHasGlobalFunc","",3,"globalFunctions","action"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","actions","onChangePage","deleteRow","editRow"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title")(4,"page-title",3),e.NdJ("action",function(){return t.openAddPropertyDialog(null)}),e.qZA()(),e.TgZ(5,"app-material-table",4),e.NdJ("onChangePage",function(o){return t.getList(o.pageIndex+1,o.pageSize)})("deleteRow",function(o){return t.onDelete(o)})("editRow",function(o){return t.openAddPropertyDialog(o)}),e.qZA()()()()),2&s&&(e.xp6(4),e.Q6J("globalFunctions",t.globalFunctions),e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("exportService",t.propertiesService)("actions",t.rowFunctions))},dependencies:[_.I,S.T,B.X,p.a8,p.n5]}),a})();var D=r(7707),G=r(18521);let k=(()=>{class a extends G.K{constructor(){super()}create(s){return this.post("Dashboard/DashboardProperty/Create",s)}getList(s,t){return this.get("Dashboard/DashboardProperty/GetList",{params:t})}getAll(s){return this.get("Dashboard/DashboardProperty/GetAll",{params:{$filter:`dashboard_ID eq ${s}`}})}Delete(s){return this.delete("Dashboard/DashboardProperty/Delete",{params:{Id:s}})}}return a.\u0275fac=function(s){return new(s||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var Y=r(61064),K=r(58913);function j(a,d){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.hij(" - ",s.msgTranslate(null==s.currentDashboard?null:s.currentDashboard.ar_Name,null==s.currentDashboard?null:s.currentDashboard.en_Name)," ")}}function W(a,d){if(1&a){const s=e.EpF();e.TgZ(0,"reset-form-btn",15),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}const X=[{path:"dashboard",data:{view:f.S.dashboard_setup},children:[{path:"",pathMatch:y.U.full,component:z,data:{view:f.S.dashboard_setup},canActivate:[I.r]},{path:"dashboard-properties/:id",component:(()=>{class a extends h.U{constructor(s,t){super(),this.dashboardPropertiesService=s,this.dashboardService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","property","value","actions"],this.optionalColomns=[],this.isLoaded=!1,this.dashboardPropertiesType=D.U}ngOnInit(){this.activatedRoute.paramMap.subscribe(s=>{this.dashboardId=Number(s.get("id"))??0}),this.form=this.fb.group({id:[0,{nonNullable:!0}],propertyId:[null,[n.kI.required]],value:[null,[n.kI.required]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new l.by(null)),this.dashboardId&&this.checkNoBusinessOrCompany()&&(this.getCurrentDashboard(),this.getList(this.firstPage))}getCurrentDashboard(){this.dashboardService.getById(this.dashboardId).pipe(this.cancelRequest()).subscribe(s=>{s.message.messageType==m.u.Success?this.currentDashboard=(0,C.KU)(s.data)[0]:this.errorList(s?.message?.messages)})}getList(s,t){this.page.pageIndex=s,t&&(this.page.pageSize=t),this.dashboardPropertiesService.getList(this.dashboardId,{PageNumber:s,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==m.u.Success?(this.dataSource=new l.by(function x(a){return a.map(d=>({...d,property:(0,T._f)(d.properties?.ar_Name,d.properties?.en_Name)}))}(o.data)),this.isLoaded=!0,this.page.length=o.meta.totalItemCount,this.page.meta=o.meta):this.errorList(o?.message?.messages)})}submit(){if(this.submitted=!0,this.form.valid){const s={dashboard_ID:this.dashboardId,property_ID:this.form.value.propertyId,value:this.form.value.value};this.selectedPropertyType==D.U.number&&(s.value=JSON.stringify(s.value)),this.create(s)}}create(s){this.showLoading(),this.dashboardPropertiesService.create(s).subscribe(t=>{t?.message?.messageType==m.u.Success?(this.clearForm(),this.addSuccessfullyMsg("canRemoveFromIndex","newDashboardPropertyAdded"),this.getList(this.firstPage)):this.errorList(t?.message?.messages),this.hideLoading()})}onDelete(s){this.deleteDialog(s.property).subscribe(i=>{i&&this.delete(s)})}delete(s){this.showLoading(),this.dashboardPropertiesService.Delete(s.id).subscribe(t=>{t.message.messageType==m.u.Success?(this.deleteSuccessfullyMsg("dashboardPropertyRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(t?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}onChangeProperty(s){let t=s.length>0?s[0]?.property_Type:null;t!=this.selectedPropertyType&&(this.formCtrls.value.reset(),this.formCtrls.value.setValidators(t==D.U.number?[n.kI.required,g.dN.number]:[n.kI.required,c.w.whiteSpace,c.w.atLeastOneCharacter]),this.formCtrls.value.updateValueAndValidity(),this.selectedPropertyType=t)}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(k),e.Y36(P.s))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard-properties"]],features:[e.qOj],decls:21,vars:17,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["title","dashboardProperties"],[4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-6","col-12"],[3,"control","submitted","filter","change"],["label","value",3,"control","submitted","type"],["align","end"],[3,"click",4,"ngIf"],[3,"onClick"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"],[3,"click"]],template:function(s,t){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.YNc(5,j,2,1,"span",4),e._UZ(6,"app-back-btn",5),e.qZA(),e.TgZ(7,"mat-card-content",6)(8,"div",0)(9,"div",1)(10,"form",7)(11,"div",0)(12,"div",8)(13,"app-properties-dropdown",9),e.NdJ("change",function(o){return t.onChangeProperty(o)}),e.qZA()(),e.TgZ(14,"div",8),e._UZ(15,"app-input",10),e.qZA()()()()()(),e.TgZ(16,"mat-card-actions",11),e.YNc(17,W,1,0,"reset-form-btn",12),e.TgZ(18,"submit-btn",13),e.NdJ("onClick",function(){return t.submit()}),e.qZA()(),e._UZ(19,"mat-divider"),e.TgZ(20,"app-material-table",14),e.NdJ("onChangePage",function(o){return t.getList(o.pageIndex+1,o.pageSize)})("deleteRow",function(o){return t.onDelete(o)}),e.qZA()()()()),2&s){let i;e.xp6(5),e.Q6J("ngIf",t.currentDashboard),e.xp6(1),e.MGl("url","/dashboard-setup/",t.moduleId,"/dashboard"),e.Q6J("params",t.pageParams),e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.propertyId)("submitted",t.submitted)("filter",!0),e.xp6(2),e.Q6J("control",t.formCtrls.value)("submitted",t.submitted)("type",null!==(i=t.selectedPropertyType)&&void 0!==i?i:t.dashboardPropertiesType.text),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(3),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)}},dependencies:[u.O5,L.a,_.I,Y.a,A.J,Z.p,S.T,p.a8,p.dn,p.n5,p.hq,w.d,K.R,n._Y,n.JL,n.sg]}),a})(),data:{view:f.S.dashboard_properties},canActivate:[I.r]}]},{path:"properties",component:H,data:{view:f.S.properties},canActivate:[I.r]}];let $=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[v.Bz.forChild(X),v.Bz]}),a})();var ee=r(92634),te=r(59683);let se=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.ez,$,ee.m,te.Xg]}),a})()}}]);