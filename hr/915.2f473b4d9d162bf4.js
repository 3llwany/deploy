"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[915],{51915:(ot,ae,s)=>{s.r(ae),s.d(ae,{PayrollModule:()=>Ji});var u=s(36895),oe=s(80458),_=s(74513),E=s(36162),y=s(3710),m=s(35478);function k(o){return o.map(i=>({...i,code:i.person.code,ar_Name:i.person.ar_Name,en_Name:i.person.en_Name,countLocalVariables:i.localVariables?.length,countGlobalVariables:i.globalVariables?.length,localVariables:M(i.localVariables),globalVariables:M(i.globalVariables)}))}function M(o){return o.map(i=>({...i,variable_ID:i.variable_ID,variableDataTypeID:i.variable.variableDataTypeID,value:i.value,code:i.variable.code,ar_Name:i.variable.arName,en_Name:i.variable.name,variableName:(0,m._f)(i.variable.arName,i.variable.name),defaultValue:i.variable.defaultValue}))}function B(o){return o.map(i=>({...i,ar_Name:i.arName,en_Name:i.name,variableType:i.pay_VariableType?.name,variableDataType:i.pay_VariableDataType?.name,resultGroup:(0,m._f)(i.pay_Vraible_Result_Grouping?.ar_Name,i.pay_Vraible_Result_Grouping?.en_Name),order:i.orderVarible,variableSegment:i.isGlobal?"Global":"Local"}))}var f=s(30671),p=s(15602),h=s(95751),e=s(94650),O=s(99820),S=s(93410),b=s(46896),pe=s(29721),c=s(73546);let nt=(()=>{class o extends h.U{constructor(t){super(),this.paymentService=t,this.mandatoryColomns=["Ser","id","ar_Name","en_Name","start_From_Date","interval","interval_Type","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.paymentService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(l.message.messageType==p.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new f.by(function de(o){return o.map(i=>({...i,id:i.id,ar_Name:i.ar_Name,en_Name:i.en_Name,start_From_Date:m.M6.mapDate(i.start_From_Date),interval:i.interval,interval_Type:(0,m._f)(i.pay_Interval_Type.ar_Name,i.pay_Interval_Type.en_Name)}))}(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(a).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.paymentService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("paymentDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(O.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-index"]],features:[e.qOj],decls:4,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","payments","parentTitle","payroll","TitleHasGlobalFunc","",3,"globalFunctions"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","isRowClickable","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return a.onDelete(l)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0)("isRowClickable",!0))},dependencies:[S.I,b.T,pe.X,c.a8,c.n5]}),o})();var x=s(61064),Q=s(52682),ne=s(20957),v=s(44850),Z=s(86257),Ie=s(68574),r=s(24006),j=s(78937),P=s(43949),N=s(33975),g=s(65938);const it=[{name:"create",code:"create"},{name:"alter",code:"alter"},{name:"drop",code:"alter"},{name:"database",code:"database"},{name:"table",code:"table"},{name:"index",code:"index"},{name:"view",code:"view"},{name:"select",code:"select"},{name:"insert",code:"insert"},{name:"into",code:"into"},{name:"update",code:"update"},{name:"delete",code:"delete"},{name:"merge",code:"merge"},{name:"grant",code:"grant"},{name:"revoke",code:"revoke"},{name:"commit",code:"commit"},{name:"rollback",code:"rollback"},{name:"savepoint",code:"savepoint"},{name:"set",code:"set"},{name:"transaction",code:"transaction"},{name:"describe",code:"describe"},{name:"explain",code:"explain"},{name:"show",code:"show"},{name:"use",code:"use"},{name:"from",code:"from"},{name:"where",code:"where"},{name:"inner",code:"inner"},{name:"left",code:"left"},{name:"right",code:"right"},{name:"full",code:"full"},{name:"join",code:"join"},{name:"group",code:"group"},{name:"by",code:"by"},{name:"having",code:"having"},{name:"order",code:"order"},{name:"limit",code:"limit"},{name:"offset",code:"offset"},{name:"distinct",code:"distinct"},{name:"after",code:"after"},{name:"between",code:"between"},{name:"is",code:"is"},{name:"null",code:"null"},{name:"and",code:"and"},{name:"or",code:"or"},{name:"not",code:"not"},{name:"in",code:"in"},{name:"like",code:"like"}],lt=[{name:"+",code:"+"},{name:"-",code:"-"},{name:"*",code:"*"},{name:"/",code:"/"},{name:"%",code:"%"},{name:"(",code:"("},{name:")",code:")"},{name:"<",code:"<"},{name:">",code:">"},{name:":",code:":"},{name:"=",code:"="},{name:"^",code:"^"},{name:"!",code:"!"}];var o,w=(()=>{return(o=w||(w={}))[o.all=1]="all",o[o.attendance=2]="attendance",o[o.payroll=3]="payroll",o[o.system=4]="system",w;var o})();(o=w||(w={})).getValue=function i(t){switch(t){case o.all:return"all";case o.attendance:return"attendance";case o.payroll:return"payroll";case o.system:return"system";default:return""}};const st=[{name:w.getValue(w.all),value:w.all},{name:w.getValue(w.attendance),value:w.attendance},{name:w.getValue(w.payroll),value:w.payroll},{name:w.getValue(w.system),value:w.system}];var z=s(60422),me=s(98385),ue=s(88057),J=s(25273),Te=s(71510),T=s(57566),H=s(26873),rt=s(4309),V=s(4859),K=s(77331),ct=s(64425),dt=s(35593),pt=s(51740),I=s(49274);const mt=["chipInput"];function ut(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",32),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.storeVarAndOperator(l))}),e._uU(1),e.qZA()}if(2&o){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function _t(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",33),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(2);return d.currentVariableFilter=l.value,e.KtG(d.GetAll(l.value))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,a=e.oxw(2);e.xp6(1),e.MT6("btn ",a.btn.babyBlueOutline," round ",a.languageService.isArabic?"ml-2":"mr-2"," px-4 mb-1"),e.ekj("active",a.currentVariableFilter==t.value),e.xp6(1),e.hij(" ",e.lcZ(3,7,t.name)," ")}}function gt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",35),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(3);return e.KtG(d.storeVarAndOperator(l,!0))}),e._uU(1),e.qZA()}if(2&o){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ft(o,i){1&o&&(e.ynx(0),e.TgZ(1,"p",36),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"empty_variables_list")))}function ht(o,i){if(1&o&&(e.ynx(0),e.YNc(1,gt,2,1,"mat-chip",34),e.YNc(2,ft,4,3,"ng-container",7),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.filterVariables),e.xp6(1),e.Q6J("ngIf",0===t.filterVariables.length)}}function bt(o,i){1&o&&e._UZ(0,"mat-chip",38)}const Ct=function(){return[]};function vt(o,i){1&o&&e.YNc(0,bt,1,0,"mat-chip",37),2&o&&e.Q6J("ngForOf",e.DdM(1,Ct).constructor(20))}function yt(o,i){if(1&o){const t=e.EpF();e.ynx(0),e._UZ(1,"page-title",16),e.TgZ(2,"div",17)(3,"div",18)(4,"div",19)(5,"span",20),e._UZ(6,"i",21),e.TgZ(7,"input",22,23),e.NdJ("keyup.enter",function(){e.CHM(t);const n=e.MAs(8),l=e.oxw();return e.KtG(l.applyFilter(n.value))})("keyup",function(){e.CHM(t);const n=e.MAs(8),l=e.oxw();return e.KtG(l.applyFilter(n.value))}),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"button",24),e.NdJ("click",function(){e.CHM(t);const n=e.MAs(8),l=e.oxw();return e.KtG(l.applyFilter(n.value))}),e.qZA()()(),e.TgZ(11,"div",25)(12,"mat-chip-list",25),e.YNc(13,ut,2,1,"mat-chip",26),e.qZA()(),e.TgZ(14,"div",27),e.YNc(15,_t,4,9,"ng-container",28),e.qZA(),e.TgZ(16,"div",29)(17,"mat-chip-list"),e.YNc(18,ht,3,2,"ng-container",30),e.YNc(19,vt,1,2,"ng-template",null,31,e.W1O),e.qZA()()(),e.BQk()}if(2&o){const t=e.MAs(20),a=e.oxw();e.xp6(7),e.Q6J("placeholder",e.lcZ(9,5,"search")),e.xp6(6),e.Q6J("ngForOf",a.operators),e.xp6(2),e.Q6J("ngForOf",a.variablesGroups),e.xp6(3),e.Q6J("ngIf",a.isLoaded)("ngIfElse",t)}}function It(o,i){if(1&o){const t=e.EpF();e.ynx(0),e._UZ(1,"i",39),e.ALo(2,"translate"),e.TgZ(3,"a",40),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showFormulaAsText=!n.showFormulaAsText)}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"a",41),e._UZ(7,"i",42),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngbPopover",e.lcZ(2,4,"enterVarCodeIfWritingByHand")),e.xp6(3),e.hij(" ",e.lcZ(5,6,t.showFormulaAsText?"close":"edit")," "),e.xp6(2),e.Q6J("cdkCopyToClipboard",t.formulaCtrl.value),e.xp6(2),e.hij(" ",e.lcZ(9,8,"copy")," ")}}function Tt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-back-btn",33),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isTest=!1)}),e.qZA()}}function wt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-textarea",43),e.NdJ("focusout",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.onFocusout(n))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("control",t.formulaCtrl)("rows",3)("disabled",t.isTest)}}function St(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",46),e.NdJ("removed",function(){const n=e.CHM(t),l=n.$implicit,d=n.index,C=e.oxw(2);return e.KtG(C.remove(l,d))}),e._uU(1),e.TgZ(2,"button",47),e._UZ(3,"i",48),e.qZA()()}if(2&o){const t=i.$implicit,a=e.oxw(2);e.Tol(t.isVar?"variable":"operation"),e.Q6J("disabled",a.isTest),e.xp6(1),e.hij(" ",t.name," ")}}function Zt(o,i){if(1&o&&(e.TgZ(0,"div",44)(1,"mat-chip-list"),e.YNc(2,St,4,4,"mat-chip",45),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.formulaVariables)("ngForTrackBy",t.trackByCode)}}function At(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",51),e._UZ(2,"app-input",52),e.qZA(),e.BQk()),2&o){const t=i.$implicit,a=e.oxw(2);e.xp6(2),e.Q6J("control",a.form.get(t.code))("label",t.name)}}function xt(o,i){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"page-title",49),e.TgZ(2,"div",17)(3,"div",50),e.YNc(4,At,3,2,"ng-container",28),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.variablesInputs)}}function Pt(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"page-title",53),e.TgZ(2,"div",54),e._uU(3),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.hij(" ",t.testResult," ")}}function Lt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",55),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onClickTest())}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("disabled",0==(null==t.formulaVariables?null:t.formulaVariables.length))}}function Dt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",56),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onSubmit())}),e.qZA()}2&o&&e.Q6J("iconPositionBefore",!1)}function Vt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",57),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeDialog())}),e.qZA()}2&o&&e.Q6J("iconPositionBefore",!1)}let Nt=(()=>{class o extends h.U{constructor(t,a,n,l,d){super(),this.variablesService=t,this.localVariablesService=a,this.globalVariablesService=n,this.dialogRef=l,this.data=d,this.formulaVariables=[],this.variablesInputs=[],this.testFormulaVariables={},this.isTest=!1,this.isLoaded=!1,this.operators=lt,this.regex=/([ !@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?])/,this.variablesGroups=st,this.currentVariableFilter=w.all,this.horizontal="horizontal",this.vertical="vertical",this.showFormulaAsText=!1,this.formulaCtrl=new r.NI(null),d.paymentId>0&&this.GetAll(),this.formulaExpression=this.data.variable?.formulaExpression}ngOnInit(){this.form=this.fb.group({}),this.form.valueChanges.subscribe(t=>{this.testResult=null}),this.formulaExpression&&this.formulaCtrl.setValue(this.formulaExpression)}remove(t,a){const n=this.variablesInputs.findIndex(l=>l.name==t.name);a>=0&&this.formulaVariables.splice(a,1),n>=0&&this.variablesInputs.splice(n,1),this.formulaCtrl.setValue(this.formulaVariables.map(l=>l.code).join(""))}applyFilter(t){this.filterVariables=t.trim().length>0?this.variables.filter(a=>a.name.toLowerCase().includes(t.trim().toLowerCase())):this.variables}GetAll(t=this.currentVariableFilter){this.isLoaded=!1,this.variablesService.GetAll(this.data.paymentId,t,this.data.isGlobal).subscribe(a=>{a.message.messageType==p.u.Success?(this.variables=a.data,this.filterVariables=a.data,this.isLoaded=!0,this.data.variable?.formulaExpression&&0==this.formulaVariables?.length&&this.data.variable.formulaExpression.split(this.regex).filter(Boolean).forEach(l=>{let d=this.variables.find(A=>A.code==l);!this.regex.test(l)&&d?this.storeVarAndOperator(d,!0,!0):this.storeVarAndOperator({name:l,code:l},!1,!0)})):this.errorList(a?.message?.messages)})}onFocusout(t){let a=this.formulaCtrl.value.split(this.regex).filter(Boolean);this.formulaVariables=[],a.forEach(n=>{let l=this.variables.find(C=>C.code==n);!this.regex.test(n)&&l?this.storeVarAndOperator(l,!0,!0):this.storeVarAndOperator({name:n,code:n},!1,!0)})}storeVarAndOperator(t,a=!1,n=!1){console.log(this.formulaVariables),this.formulaVariables.push({name:t.name,code:t.code,variableDataTypeID:t.variableDataTypeID,isVar:a}),n||this.formulaCtrl.setValue(this.formulaCtrl.value?`${this.formulaCtrl.value}${t.code}`:this.formulaVariables.map(l=>l.code).join(""))}onSubmit(){this.testFormulaVariables=this.form.value,this.formulaExpression=this.formulaCtrl.value,delete this.data.variable.testFormulaVariables,delete this.data.variable.testFormulaVariables;let t={payment_ID:this.data.paymentId,variable:this.data.variable,testFormulaVariables:this.form.value};t.variable.formulaExpression=this.formulaExpression,t.variable.code?this.data.isGlobal?this.testGlobalFormula(t):this.testLocalFormula(t):this.error("varCodeIsRequiredFirst")}testLocalFormula(t){this.showLoading(),this.localVariablesService.testLocalFormula(t).subscribe(a=>{a?.message?.messageType==p.u.Success?this.testResult=a.data:this.errorList(a?.message?.messages),this.hideLoading()})}testGlobalFormula(t){this.showLoading(),this.globalVariablesService.testGlobalFormula(t).subscribe(a=>{a?.message?.messageType==p.u.Success?this.testResult=a.data:this.errorList(a?.message?.messages),this.hideLoading()})}onClickTest(){this.isTest=!0,this.formulaVariables.forEach(t=>{this.variables.find(n=>n.code==t.code)&&(this.variablesInputs.find(l=>l.code==t.code)||(this.variablesInputs.push(t),this.form.addControl(t.code,this.fb.control(""))))})}evaluateEquation(t){try{return new Function(`return ${t}`)()}catch(a){return console.error("Invalid equation:",a),NaN}}closeDialog(){this.dialogRef.close(this.testResult?{formulaExpression:this.formulaExpression,testFormulaVariables:this.testFormulaVariables}:null)}trackByCode(t,a){return a.code}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(z.a),e.Y36(me.P),e.Y36(ue.E),e.Y36(g.so),e.Y36(g.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-formula-dialog"]],viewQuery:function(t,a){if(1&t&&e.Gf(mt,5),2&t){let n;e.iGM(n=e.CRH())&&(a.chipInput=n.first)}},features:[e.qOj],decls:20,vars:10,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],[1,"d-inline-block"],["title","formula",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"click"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],["dialogContainer",""],[4,"ngIf"],["title","formula",1,"d-block","black-color","font-size-20","mtop-5"],[3,"click",4,"ngIf"],["placeholder","Enter Statement...",3,"control","rows","disabled","focusout",4,"ngIf"],["class","vars-box formula-box",4,"ngIf"],["styleClass","mb-1 px-md-4","label","close",3,"click"],["styleClass","px-md-5","label","next",3,"disabled","onClick",4,"ngIf"],["icon","fas fa-calculator","styleClass","px-md-5","label","test",3,"iconPositionBefore","onClick",4,"ngIf"],["label","done",3,"iconPositionBefore","onClick",4,"ngIf"],["title","variables",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"vars-box"],[1,"d-block","w-75","filter-container"],[1,"p-inputgroup"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["type","text","pInputText","",1,"filter-input",3,"placeholder","keyup.enter","keyup"],["filterInput",""],["type","button","pButton","","pRipple","","icon","pi pi-search","styleClass","p-button-warn",3,"click"],[1,"mb-2"],["class","operation",3,"click",4,"ngFor","ngForOf"],[1,"my-3"],[4,"ngFor","ngForOf"],[1,"variables-list"],[4,"ngIf","ngIfElse"],["loader",""],[1,"operation",3,"click"],[3,"click"],["class","variable",3,"click",4,"ngFor","ngForOf"],[1,"variable",3,"click"],[1,"p-2","dark"],["class","variable px-4","style","width: 30px",4,"ngFor","ngForOf"],[1,"variable","px-4",2,"width","30px"],["placement","right",1,"fas","fa-info-circle","font-size-20","main-color","pointer",3,"ngbPopover"],["title","Show Edit",1,"float-right","formula-action","mx-2",3,"click"],["title","Copy Formula",1,"float-right","formula-action",3,"cdkCopyToClipboard"],[1,"far","fa-copy"],["placeholder","Enter Statement...",3,"control","rows","disabled","focusout"],[1,"vars-box","formula-box"],["class","formula-chip",3,"class","disabled","removed",4,"ngFor","ngForOf","ngForTrackBy"],[1,"formula-chip",3,"disabled","removed"],["matChipRemove",""],[1,"far","fa-times-circle"],["title","test",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"row"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","label"],["title","result",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"vars-box","results"],["styleClass","px-md-5","label","next",3,"disabled","onClick"],["icon","fas fa-calculator","styleClass","px-md-5","label","test",3,"iconPositionBefore","onClick"],["label","done",3,"iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._UZ(2,"page-title",2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return a.closeDialog()}),e._UZ(4,"i",4),e.qZA()(),e.TgZ(5,"mat-dialog-content",5,6),e.YNc(7,yt,21,7,"ng-container",7),e.TgZ(8,"page-title",8),e.YNc(9,It,10,10,"ng-container",7),e.YNc(10,Tt,1,0,"app-back-btn",9),e.qZA(),e.YNc(11,wt,1,3,"app-textarea",10),e.YNc(12,Zt,3,2,"div",11),e.YNc(13,xt,5,1,"div",7),e.YNc(14,Pt,4,1,"ng-container",7),e.qZA(),e.TgZ(15,"mat-dialog-actions")(16,"discard-dialog-btn",12),e.NdJ("click",function(){return a.closeDialog()}),e.qZA(),e.YNc(17,Lt,1,1,"submit-btn",13),e.YNc(18,Dt,1,1,"submit-btn",14),e.YNc(19,Vt,1,1,"submit-btn",15),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",!a.isTest),e.xp6(2),e.Q6J("ngIf",!a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest),e.xp6(1),e.Q6J("ngIf",a.showFormulaAsText),e.xp6(1),e.Q6J("ngIf",!a.showFormulaAsText),e.xp6(1),e.Q6J("ngIf",a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest),e.xp6(3),e.Q6J("ngIf",!a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest&&!a.testResult),e.xp6(1),e.Q6J("ngIf",a.isTest&&a.testResult))},dependencies:[u.sg,u.O5,J.a,Te.R,x.a,T.p,b.T,H.E,rt.o8,V.lW,g.uh,g.xY,g.H8,K.qn,K.HS,K.qH,ct.i3,dt.Hq,pt.o,I.X$],styles:[".vars-box[_ngcontent-%COMP%]{padding:15px;border-radius:15px;border:solid 1px #cfdce5;margin:5px 0 30px}.mat-chip.operation[_ngcontent-%COMP%]{border-radius:8px;background-color:#374761;color:#fff;padding:6px 12px;cursor:pointer}.mat-chip.operation[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:#fff;opacity:.7}.mat-chip.operation[disabled=true][_ngcontent-%COMP%]{background-color:#8c8c8c;opacity:.9}.mat-chip.variable[_ngcontent-%COMP%], .mat-chip.variable[_ngcontent-%COMP%]:active, .mat-chip.variable[_ngcontent-%COMP%]:focus{border-radius:8px;background-color:#f7f7f7;color:#374761}.mat-chip.variable[disabled=true][_ngcontent-%COMP%]{background-color:#f7f7f7;color:#555;opacity:.9}.variables-list[_ngcontent-%COMP%]{max-height:23vh;overflow-y:scroll;overflow-x:hidden}.formula-box[_ngcontent-%COMP%]{min-height:65px}.results[_ngcontent-%COMP%]{min-height:50px}.formula-chip[_ngcontent-%COMP%]   button[matChipRemove][_ngcontent-%COMP%]{display:none}.formula-chip[_ngcontent-%COMP%]:hover   button[matChipRemove][_ngcontent-%COMP%]{display:block!important}mat-chip[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:14px}a.formula-action[_ngcontent-%COMP%]{font-size:14px;color:#77797d}a.formula-action[_ngcontent-%COMP%]:hover{color:#374761}"]}),o})();var we=s(29521),G=s(70137);const Jt=["chipInput"];function kt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",19),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.onClickChip(l))}),e._uU(1),e.qZA()}if(2&o){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Qt(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"page-title",15),e.TgZ(2,"div",16)(3,"div",17)(4,"mat-chip-list",17),e.YNc(5,kt,2,1,"mat-chip",18),e.qZA()()(),e.BQk()),2&o){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.sqlCommands)}}function Gt(o,i){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21),e._UZ(2,"app-datepicker",22),e.qZA(),e.TgZ(3,"div",21),e._UZ(4,"app-datepicker",23),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("control",t.form.get("FromDate"))("disable",t.isTest),e.xp6(2),e.Q6J("control",t.form.get("ToDate"))("disable",t.isTest)}}function qt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-back-btn",24),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isTest=!1)}),e.qZA()}}function Ft(o,i){if(1&o&&(e.TgZ(0,"div",20)(1,"div",21),e._UZ(2,"app-datepicker",22),e.qZA(),e.TgZ(3,"div",21),e._UZ(4,"app-datepicker",23),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("control",t.form.get("FromDate"))("disable",t.isTest),e.xp6(2),e.Q6J("control",t.form.get("ToDate"))("disable",t.isTest)}}const Ut=function(){return[]};function Rt(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"page-title",25),e.TgZ(2,"div",20)(3,"div",26),e._UZ(4,"app-material-table",27),e.qZA()(),e.BQk()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("showPaginator",!1)("showFilter",!1)("isLoaded",!0)("optionalColomns",e.DdM(6,Ut))}}function Yt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",28),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isTest=!0)}),e.qZA()}}function Et(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",29),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.testSql())}),e.qZA()}2&o&&e.Q6J("iconPositionBefore",!1)}function Mt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",30),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeDialog())}),e.qZA()}2&o&&e.Q6J("iconPositionBefore",!1)}let Bt=(()=>{class o extends h.U{constructor(t,a,n){super(),this.variablesService=t,this.dialogRef=a,this.data=n,this.SelectedStatementsList=[],this.isTest=!1,this.sqlCommands=it,this.testResult=null,this.regex=/([ !@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?])/,this.separatorKeysCodes=[we.K5,we.OC],this.mandatoryColomns=["person_Instance_Id","value"],this.Constants=N.g}ngOnInit(){this.form=this.fb.group({FromDate:[null],ToDate:[null],sql:[null]}),this.data.sqlStatement&&(this.sqlStatement=this.data.sqlStatement,this.sqlCtrl.setValue(this.data.sqlStatement)),this.form.valueChanges.subscribe(t=>{this.testResult=null}),this.sqlCtrl.valueChanges.subscribe(t=>{t!=this.sqlStatement&&(this.sqlStatement=t)})}get sqlCtrl(){return this.form.get("sql")}onClickChip(t){this.sqlCtrl.setValue(`${this.sqlCtrl.value} ${t.code}`)}testSql(){this.isTest=!0;const t=m.M6.mapDateReverse(this.form.value.FromDate),a=m.M6.mapDateReverse(this.form.value.ToDate);this.showLoading(),this.variablesService.testSql(this.sqlStatement.trim(),t,a).subscribe(n=>{n?.message?.messageType==p.u.Success?(this.testResult=n.data,this.dataSource=new f.by(n.data)):this.errorList(n?.message?.messages),this.hideLoading()})}closeDialog(){this.dialogRef.close(this.testResult||this.data.sqlStatement?{sqlStatement:this.sqlStatement}:null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(z.a),e.Y36(g.so),e.Y36(g.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-sql-dialog"]],viewQuery:function(t,a){if(1&t&&e.Gf(Jt,5),2&t){let n;e.iGM(n=e.CRH())&&(a.chipInput=n.first)}},features:[e.qOj],decls:19,vars:11,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],[1,"d-inline-block"],["title","SQL",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"click"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],[4,"ngIf"],["class","row",4,"ngIf"],["title","SQL",1,"d-block","black-color","font-size-20","mtop-5"],[3,"click",4,"ngIf"],["placeholder","Enter Statement...",3,"control","rows","disabled"],["styleClass","mb-1 px-md-4","label","close",3,"click"],["styleClass","px-md-5","label","next",3,"onClick",4,"ngIf"],["icon","fas fa-calculator","styleClass","px-md-5","label","test",3,"iconPositionBefore","onClick",4,"ngIf"],["label","done",3,"iconPositionBefore","onClick",4,"ngIf"],["title","statements",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"vars-box"],[1,"mb-2"],["class","operation",3,"click",4,"ngFor","ngForOf"],[1,"operation",3,"click"],[1,"row"],[1,"col-md-4","col-lg-3","col-12"],["label","from_Date",3,"control","disable"],["label","to_Date",3,"control","disable"],[3,"click"],["title","result",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"col-6"],[1,"table-in-forms","no-margin",3,"dataSource","mandatoryColomns","showPaginator","showFilter","isLoaded","optionalColomns"],["styleClass","px-md-5","label","next",3,"onClick"],["icon","fas fa-calculator","styleClass","px-md-5","label","test",3,"iconPositionBefore","onClick"],["label","done",3,"iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._UZ(2,"page-title",2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return a.closeDialog()}),e._UZ(4,"i",4),e.qZA()(),e.TgZ(5,"mat-dialog-content",5),e.YNc(6,Qt,6,1,"ng-container",6),e.YNc(7,Gt,5,4,"div",7),e.ynx(8),e.TgZ(9,"page-title",8),e.YNc(10,qt,1,0,"app-back-btn",9),e.qZA(),e._UZ(11,"app-textarea",10),e.BQk(),e.YNc(12,Ft,5,4,"div",7),e.YNc(13,Rt,5,7,"ng-container",6),e.qZA(),e.TgZ(14,"mat-dialog-actions")(15,"discard-dialog-btn",11),e.NdJ("click",function(){return a.closeDialog()}),e.qZA(),e.YNc(16,Yt,1,0,"submit-btn",12),e.YNc(17,Et,1,1,"submit-btn",13),e.YNc(18,Mt,1,1,"submit-btn",14),e.qZA()),2&t&&(e.xp6(6),e.Q6J("ngIf",!a.isTest),e.xp6(1),e.Q6J("ngIf",!a.isTest),e.xp6(3),e.Q6J("ngIf",a.isTest),e.xp6(1),e.Q6J("control",a.sqlCtrl)("rows",6)("disabled",a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest&&a.testResult),e.xp6(3),e.Q6J("ngIf",!a.isTest),e.xp6(1),e.Q6J("ngIf",a.isTest&&!a.testResult),e.xp6(1),e.Q6J("ngIf",a.isTest&&a.testResult))},dependencies:[u.sg,u.O5,G.Q,Te.R,S.I,x.a,T.p,b.T,H.E,V.lW,g.uh,g.xY,g.H8,K.qn,K.HS],styles:[".vars-box[_ngcontent-%COMP%]{padding:15px;border-radius:15px;border:solid 1px #cfdce5;margin:5px 0 20px}.mat-chip.operation[_ngcontent-%COMP%]{border-radius:8px;background-color:#374761;color:#fff;padding:6px 12px;cursor:pointer}.mat-chip.operation[_ngcontent-%COMP%]   .mat-chip-remove[_ngcontent-%COMP%]{color:#fff;opacity:.7}.mat-chip.operation[disabled=true][_ngcontent-%COMP%]{background-color:#8c8c8c;opacity:.9}.mat-chip.variable[_ngcontent-%COMP%], .mat-chip.variable[_ngcontent-%COMP%]:active, .mat-chip.variable[_ngcontent-%COMP%]:focus{border-radius:8px;background-color:#f7f7f7;color:#374761;cursor:pointer}.mat-chip.variable[disabled=true][_ngcontent-%COMP%]{background-color:#f7f7f7;color:#555;opacity:.9}.variables-list[_ngcontent-%COMP%]{max-height:23vh;overflow-y:scroll;overflow-x:hidden}.formula-box[_ngcontent-%COMP%]{min-height:100px}.formula-chip[_ngcontent-%COMP%]   button[matChipRemove][_ngcontent-%COMP%]{display:none}.formula-chip[ng-reflect-disabled=false][_ngcontent-%COMP%]:hover   button[matChipRemove][_ngcontent-%COMP%]{display:block}.textareaStyle[_ngcontent-%COMP%]{min-height:100px;overflow:auto}"]}),o})();var ie=s(12613),_e=s(56500),Ot=s(68506),jt=s(8810),zt=s(80420),Ht=s(91785);function Kt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-input",24),e.NdJ("clickSuffixIcon",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.openFormulaDialog())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("control",t.formCtrls.formulaExpression)("submitted",t.submitted)("disabled",t.formCtrls.variableTypeID.value!=t.constants.variable_type_formula)("suffixIcon",t.formCtrls.variableTypeID.value!=t.constants.variable_type_formula?t.svg.circle_grid:t.svg.circle_grid_main)("isSuffixSvg",!0)("readonly",!0)}}function $t(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-input",25),e.NdJ("clickSuffixIcon",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.openSqlDialog())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("control",t.formCtrls.sql)("submitted",t.submitted)("disabled",t.formCtrls.variableTypeID.value!=t.constants.variable_type_sql)("suffixIcon",t.formCtrls.variableTypeID.value!=t.constants.variable_type_sql?t.svg.circle_grid:t.svg.circle_grid_main)("isSuffixSvg",!0)("readonly",!0)}}function Xt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"reset-form-btn",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.clearForm())}),e.qZA()}}function Wt(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card-content",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",2)(6,"div",5),e._UZ(7,"app-input",6),e.qZA(),e.TgZ(8,"div",5),e._UZ(9,"app-input",7),e.qZA(),e.TgZ(10,"div",5)(11,"app-check-box",8),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onChangeDisplayResults())}),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"app-input",9),e.qZA(),e.TgZ(14,"div",5),e._UZ(15,"app-input",10),e.qZA(),e.TgZ(16,"div",5),e._UZ(17,"variable-data-type-dropdown",11),e.qZA(),e.TgZ(18,"div",5)(19,"variable-type-dropdown",12),e.NdJ("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onChangeVariableType())}),e.qZA()(),e.YNc(20,Kt,2,6,"div",13),e.YNc(21,$t,2,6,"div",13),e.TgZ(22,"div",5),e._UZ(23,"app-input",14),e.qZA(),e.TgZ(24,"div",5),e._UZ(25,"result-group-dropdown",15),e.qZA(),e.TgZ(26,"div",5)(27,"app-check-box",16),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onChangeGoalSeek())}),e.qZA()(),e.TgZ(28,"div",5),e._UZ(29,"app-prime-dropdown",17),e.qZA(),e.TgZ(30,"div",5),e._UZ(31,"app-prime-dropdown",18),e.qZA(),e.TgZ(32,"div",5),e._UZ(33,"app-input",19),e.qZA(),e.TgZ(34,"div",5)(35,"app-check-box",20),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.GetAll_GoalSeek_Formula(0))}),e.qZA()()()()()()(),e.TgZ(36,"mat-card-actions",21),e.YNc(37,Xt,1,0,"reset-form-btn",22),e.TgZ(38,"submit-btn",23),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.arName)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.name)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.display_In_Result),e.xp6(2),e.Q6J("control",t.formCtrls.orderVarible)("submitted",t.submitted)("type",t.inputType.number)("disabled",!t.formCtrls.display_In_Result.value),e.xp6(2),e.Q6J("control",t.formCtrls.code)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.variableDataTypeID)("submitted",t.submitted)("disable",t.formCtrls.isGoalSeek.value),e.xp6(2),e.Q6J("control",t.formCtrls.variableTypeID)("submitted",t.submitted)("disable",t.formCtrls.isGoalSeek.value),e.xp6(1),e.Q6J("ngIf",t.formCtrls.variableTypeID.value!=t.constants.variable_type_sql),e.xp6(1),e.Q6J("ngIf",t.formCtrls.variableTypeID.value==t.constants.variable_type_sql),e.xp6(2),e.Q6J("control",t.formCtrls.defaultValue)("submitted",t.submitted)("disabled",t.formCtrls.variableTypeID.value==t.constants.variable_type_formula||t.formCtrls.variableTypeID.value==t.constants.variable_type_sql),e.xp6(2),e.Q6J("control",t.formCtrls.result_Group_ID)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.isGoalSeek),e.xp6(2),e.Q6J("control",t.formCtrls.related_GoalSeek_Formula_Id)("multi",!1)("List",t.GoalSeekList)("submitted",t.submitted)("filter",!0)("disable",!t.formCtrls.isGoalSeek.value),e.xp6(2),e.Q6J("control",t.formCtrls.related_GoalSeek_Traget_Formula_Id)("multi",!1)("List",t.GoalSeekList)("submitted",t.submitted)("filter",!0)("disable",!t.formCtrls.isGoalSeek.value),e.xp6(2),e.Q6J("control",t.formCtrls.note)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.isGlobal),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(1),e.Q6J("id",t.formCtrls.id.value)("color",t.btn.darkBlue)("iconPositionBefore",!1)("disabled",0==t.paymentId)}}function ea(o,i){1&o&&e._UZ(0,"mat-divider",29)}function ta(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card-content"),e.YNc(2,ea,1,0,"mat-divider",27),e.TgZ(3,"app-material-table",28),e.NdJ("deleteRow",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.onDelete(n))})("editRow",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.toEdit(n))})("onChangePage",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getList(n.pageIndex+1,n.pageSize))})("selectSearchItem",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getSelectedFilterItem(n))}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showForm),e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("page",t.page)("showFilter",!0)("showSearchDropdown",!0)("searchDropdownList",t.searchDropdownList)("selectedValueInSearchDropdown",t.currentTypeInTable)("searchDropdownEnableClearValue",!1)("isCenterPaginator",!0)}}let Se=(()=>{class o extends h.U{constructor(t,a,n){super(),this.payVariablesService=t,this.globalVariablesService=a,this.variablesService=n,this.submitted=!1,this.paymentId=0,this.isView=!1,this.showForm=!0,this.updateIsViewUpdate=new e.vpe,this.completed=new e.vpe,this.searchDropdownList=[{id:"local",ar_Name:"Local",en_Name:"Local"},{id:"global",ar_Name:"Global",en_Name:"Global"}],this.mandatoryColomns=["en_Name","ar_Name","code","variableSegment","variableDataType","defaultValue","resultGroup","variableType","order","actions"],this.isLoaded=!1,this.optionalColomns=[],this.constants=N.g,this.currentTypeInTable="local"}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],arName:[null,[r.kI.required,j.w.whiteSpace]],name:[null,[r.kI.required,j.w.whiteSpace]],display_In_Result:[!1,[r.kI.required]],orderVarible:[null,[r.kI.required,P.dN.gte(0)]],code:[null,j.w.variableCodeValidators],variableDataTypeID:[null,[r.kI.required]],defaultValue:[null],result_Group_ID:[null,[r.kI.required]],variableTypeID:[null,[r.kI.required]],formulaExpression:[null],isGoalSeek:[!1,[r.kI.required]],related_GoalSeek_Formula_Id:[null],related_GoalSeek_Traget_Formula_Id:[null],isSystem:[!1,[r.kI.required]],isGlobal:[!1,[r.kI.required]],note:[null],sql:[null],testFormulaVariables:[{}]}),this.GetAll_Local_GoalSeek_Formula(0)}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.paymentId>0?this.getList(this.firstPage):this.isLoaded=!0}onModulesChanged(){this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,_.S.local_variables_formula)}get formCtrls(){return this.form.controls}submit(){if(this.submitted=!0,this.form.valid){let t={payment_ID:this.formCtrls.isSystem.value?0:this.paymentId,variable:{id:this.formCtrls.id.value,name:this.formCtrls.name.value,arName:this.formCtrls.arName.value,code:this.formCtrls.code.value,variableDataTypeID:this.formCtrls.variableDataTypeID.value,display_In_Result:this.formCtrls.display_In_Result.value,defaultValue:this.formCtrls.defaultValue.value,variableTypeID:this.formCtrls.variableTypeID.value,formulaExpression:this.formCtrls.formulaExpression.value,orderVarible:this.formCtrls.orderVarible.value,result_Group_ID:this.formCtrls.result_Group_ID.value,isGoalSeek:this.formCtrls.isGoalSeek.value,related_GoalSeek_Formula_Id:this.formCtrls.related_GoalSeek_Formula_Id.value,related_GoalSeek_Traget_Formula_Id:this.formCtrls.related_GoalSeek_Traget_Formula_Id.value,note:this.formCtrls.note.value,isSystem:this.formCtrls.isSystem.value,isGlobal:this.formCtrls.isGlobal.value,sql:this.formCtrls.sql.value},testFormulaVariables:this.formCtrls.testFormulaVariables.value};this.formCtrls.isGlobal.value?0==t.variable.id?this.createGlobalVariable(t):this.updateGlobalVariable(t):0==t.variable.id?this.createLocalVariable(t):this.updateLocalVariable(t)}}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a);let n={PageNumber:t,pageSize:this.page.pageSize};"global"==this.currentTypeInTable?this.getGlobalVariableList(n):this.getLocalVariableList(n)}getLocalVariableList(t){this.payVariablesService.getList(this.paymentId,t).pipe(this.cancelRequest()).subscribe(a=>{a.message.messageType==p.u.Success?(this.currentTypeInTable="local",this.isLoaded=!0,this.dataSource=new f.by(B(a.data)),this.page.length=a.meta.totalItemCount,this.page.meta=a.meta):this.errorList(a?.message?.messages)})}getGlobalVariableList(t){this.globalVariablesService.getList(t).pipe(this.cancelRequest()).subscribe(a=>{a.message.messageType==p.u.Success?(this.currentTypeInTable="global",this.isLoaded=!0,this.dataSource=new f.by(B(a.data)),this.page.length=a.meta.totalItemCount,this.page.meta=a.meta):this.errorList(a?.message?.messages)})}createLocalVariable(t){this.showLoading(),this.payVariablesService.create(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.currentTypeInTable="local",this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newPayLocalVariableAdded"),this.getList(this.lastPage),this.GetAll_GoalSeek_Formula(0),this.clearForm(),this.completed.emit(!0),this.isView&&(this.showForm=!1,this.updateIsViewUpdate.emit(!1))):this.errorList(a?.message?.messages),this.hideLoading()})}updateLocalVariable(t){this.showLoading(),this.payVariablesService.update(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.updateSuccessfullyMsg("payLocalVariableUpdated"),this.clearForm(),this.getList(this.currentPage),this.GetAll_GoalSeek_Formula(0),this.completed.emit(!0),this.isView&&(this.showForm=!1,this.updateIsViewUpdate.emit(!1))):this.errorList(a?.message?.messages),this.hideLoading()})}createGlobalVariable(t){this.showLoading(),this.globalVariablesService.create(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.currentTypeInTable="global",this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newPayGlobalVariableAdded"),this.getList(this.lastPage),this.GetAll_GoalSeek_Formula(0),this.clearForm(),this.completed.emit(!0),this.isView&&(this.showForm=!1,this.updateIsViewUpdate.emit(!1))):this.errorList(a?.message?.messages),this.hideLoading()})}updateGlobalVariable(t){this.showLoading(),this.globalVariablesService.update(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.updateSuccessfullyMsg("payGlobalVariableUpdated"),this.getList(this.currentPage),this.GetAll_GoalSeek_Formula(0),this.clearForm(),this.completed.emit(!0),this.isView&&(this.showForm=!1,this.updateIsViewUpdate.emit(!1))):this.errorList(a?.message?.messages),this.hideLoading()})}toEdit(t){this.isView&&(this.showForm=!0,this.updateIsViewUpdate.emit(!0)),this.GetAll_GoalSeek_Formula(t.id),this.form.patchValue(t),this.formCtrls.isGlobal.disable()}onDelete(t){let a=this.msgTranslate(t.arName,t.name);this.deleteDialog(a).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),t.isGlobal?this.deleteGlobalVariables(t):this.deleteLocalVariables(t)}deleteGlobalVariables(t){this.globalVariablesService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("payGlobalVariableDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}deleteLocalVariables(t){this.payVariablesService.Delete(t.id,this.paymentId).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("payLocalVariableDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}GetAll_GoalSeek_Formula(t=0){this.formCtrls.isGlobal.value?this.GetAll_Global_GoalSeek_Formula(t):this.GetAll_Local_GoalSeek_Formula(t)}GetAll_Local_GoalSeek_Formula(t=0){this.payVariablesService.GetAll_Local_GoalSeek_Formula(this.paymentId,t).subscribe(a=>{a.message.messageType==p.u.Success?this.GoalSeekList=a.data:this.errorList(a?.message?.messages)})}GetAll_Global_GoalSeek_Formula(t=0){this.globalVariablesService.GetAll_Global_GoalSeek_Formula(this.paymentId,t).subscribe(a=>{a.message.messageType==p.u.Success?this.GoalSeekList=a.data:this.errorList(a?.message?.messages)})}openFormulaDialog(){this.formCtrls.code.value&&this.formCtrls.code.valid?this.dialogsService.addEditDialog(Nt,{variable:this.form.value,paymentId:this.paymentId,isGlobal:this.formCtrls.isGlobal.value},{width:"80%",panelClass:"dialog-emp-form"}).afterClosed().subscribe(t=>{t&&(this.formCtrls.formulaExpression.setValue(t?.formulaExpression),this.formCtrls.testFormulaVariables.setValue(t?.testFormulaVariables))}):this.error("enterVarCode")}openSqlDialog(){this.dialogsService.addEditDialog(Bt,{sqlStatement:this.formCtrls.sql.value},{width:"80%",panelClass:"dialog-emp-form"}).afterClosed().subscribe(t=>{this.formCtrls.sql.setValue(t?.sqlStatement)})}clearForm(){this.form.reset({id:0,isSystem:!1,isGlobal:!1,isGoalSeek:!1,display_In_Result:!1,variableDataTypeID:1}),this.submitted=!1,this.formCtrls.isGlobal.enable(),this.isView&&(this.showForm=!1,this.updateIsViewUpdate.emit(!1))}onChangeDisplayResults(){this.formCtrls.display_In_Result.value||this.formCtrls.orderVarible.reset()}onChangeGoalSeek(){this.formCtrls.isGoalSeek.value?(this.formCtrls.variableDataTypeID.setValue(N.g.variable_dataTypeDouble),this.formCtrls.variableTypeID.setValue(N.g.variable_type_fixed)):(this.formCtrls.related_GoalSeek_Formula_Id.reset(),this.formCtrls.related_GoalSeek_Traget_Formula_Id.reset())}onChangeVariableType(){this.formCtrls.variableTypeID.value==N.g.variable_type_formula?(this.formCtrls.formulaExpression.setValidators([r.kI.required]),this.formCtrls.sql.removeValidators([r.kI.required]),this.formCtrls.sql.reset(),this.formCtrls.defaultValue.setValue(null)):this.formCtrls.variableTypeID.value==N.g.variable_type_sql?(this.formCtrls.sql.setValidators([r.kI.required]),this.formCtrls.formulaExpression.removeValidators([r.kI.required]),this.formCtrls.formulaExpression.reset(),this.formCtrls.defaultValue.setValue(null)):(this.formCtrls.formulaExpression.removeValidators([r.kI.required]),this.formCtrls.formulaExpression.reset(),this.formCtrls.sql.removeValidators([r.kI.required]),this.formCtrls.sql.reset()),this.formCtrls.formulaExpression.updateValueAndValidity(),this.formCtrls.sql.updateValueAndValidity()}getSelectedFilterItem(t){if("global"==t)this.variablesService.isGlobal$.next(!0),this.currentTypeInTable="global",this.formCtrls.isGlobal.setValue(!0);else{if("local"!=t)return;this.variablesService.isGlobal$.next(!1),this.currentTypeInTable="local",this.formCtrls.isGlobal.setValue(!1)}this.getList(this.firstPage)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(me.P),e.Y36(ue.E),e.Y36(z.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["add-variables"]],inputs:{paymentId:"paymentId",isView:"isView",showForm:"showForm"},outputs:{updateIsViewUpdate:"updateIsViewUpdate",completed:"completed"},features:[e.qOj],decls:2,vars:2,consts:[[4,"ngIf"],[1,"container-fluid","mtop-40"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-lg-3","col-12"],["label","ar_Name",3,"control","submitted"],["label","en_Name",3,"control","submitted"],["label","display_In_Result","color","primary","labelPosition","before","styleClass","margin-17",3,"control","onChange"],["label","order",3,"control","submitted","type","disabled"],["label","code",3,"control","submitted"],[3,"control","submitted","disable"],[3,"control","submitted","disable","change"],["class","col-md-4 col-lg-3 col-12",4,"ngIf"],["label","defaultValue",3,"control","submitted","disabled"],[3,"control","submitted"],["label","calculateGoalSeek","labelPosition","before","color","primary","styleClass","margin-17",3,"control","onChange"],["label","related_goal_seek_formula",3,"control","multi","List","submitted","filter","disable"],["label","related_goal_seek_target",3,"control","multi","List","submitted","filter","disable"],["label","notes",3,"control","submitted"],["label","MakeThisVariableGlobal","labelPosition","before","color","primary","styleClass","margin-17",3,"control","onChange"],["align","end",1,"mb-0"],[3,"click",4,"ngIf"],["icon","pi pi-plus-circle","addLabel","add","editLabel","update",3,"id","color","iconPositionBefore","disabled","onClick"],["label","formula",3,"control","submitted","disabled","suffixIcon","isSuffixSvg","readonly","clickSuffixIcon"],["label","SQL",3,"control","submitted","disabled","suffixIcon","isSuffixSvg","readonly","clickSuffixIcon"],[3,"click"],["class","m-auto",4,"ngIf"],[1,"table-in-forms","no-margin",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showFilter","showSearchDropdown","searchDropdownList","selectedValueInSearchDropdown","searchDropdownEnableClearValue","isCenterPaginator","deleteRow","editRow","onChangePage","selectSearchItem"],[1,"m-auto"]],template:function(t,a){1&t&&(e.YNc(0,Wt,39,46,"ng-container",0),e.YNc(1,ta,4,13,"ng-container",0)),2&t&&(e.Q6J("ngIf",a.showForm),e.xp6(1),e.Q6J("ngIf",a.paymentId>0))},dependencies:[u.O5,J.a,S.I,ie.u,_e.J,T.p,c.dn,c.hq,v.d,Ot.t,jt.K,zt.f,Ht.q,r._Y,r.JL,r.sg]}),o})();var le=s(69846),aa=s(30567),F=(()=>(function(o){o[o.double=1]="double",o[o.dateTime=2]="dateTime",o[o.string=3]="string",o[o.boolean=4]="boolean"}(F||(F={})),F))();function oa(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",13),e._UZ(2,"app-input",14),e.qZA(),e.BQk()),2&o){const t=i.$implicit,a=e.oxw();let n;e.xp6(2),e.Q6J("control",a.formLocal.get(t.code))("label",a.msgTranslate(null!==(n=t.arName)&&void 0!==n?n:t.ar_Name,null!==(n=t.name)&&void 0!==n?n:t.en_Name))}}function na(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",13),e._UZ(2,"app-input",14),e.qZA(),e.BQk()),2&o){const t=i.$implicit,a=e.oxw();let n;e.xp6(2),e.Q6J("control",a.formGlobal.get(t.code))("label",a.msgTranslate(null!==(n=t.arName)&&void 0!==n?n:t.ar_Name,null!==(n=t.name)&&void 0!==n?n:t.en_Name))}}!function(o){o.getValue=function i(t){switch(t){case o.double:return"number";case o.dateTime:return"date";case o.string:return"text";case o.boolean:return"boolean";default:return""}}}(F||(F={}));let ia=(()=>{class o extends h.U{constructor(t,a,n,l){super(),this.globalVariablesService=t,this.localVariablesService=a,this.dialogRef=n,this.data=l,this.isLoaded=!1,this.submitted=!1,this.isEdit=!1,this.EVariableDataType=F,this.isEdit=l.isEdit}ngOnInit(){if(this.formLocal=this.fb.group({}),this.formGlobal=this.fb.group({}),this.data.paymentId>0&&!this.isEdit){const t="VariableTypeID eq 1";this.showLoading(),(0,aa.D)(this.globalVariablesService.GetAll(t),this.localVariablesService.GetAll(this.data.paymentId,t)).subscribe(a=>{this.hideLoading(),a&&(this.globalVariable=a[0].data,this.localVariable=a[1].data),this.localVariable.forEach(n=>{this.formLocal.addControl(n.code,this.fb.control(Number(n.defaultValue)??0))}),this.globalVariable.forEach(n=>{this.formGlobal.addControl(n.code,this.fb.control(Number(n.defaultValue)??0))})})}this.data.isEdit&&(this.globalVariable=this.data.data.globalVariables,this.localVariable=this.data.data.localVariables,this.localVariable.forEach(t=>{this.formLocal.addControl(t.code,this.fb.control(t.value))}),this.globalVariable.forEach(t=>{this.formGlobal.addControl(t.code,this.fb.control(t.value))}))}submit(){let t=[],a=[];this.showLoading(),Object.entries(this.formLocal.value).forEach(([n,l])=>{let d=this.localVariable.find(C=>C.code==n);t.push({Variable_ID:d.id||d.variable_ID,Value:l?l.toString():d.defaultValue??"0"})}),Object.entries(this.formGlobal.value).forEach(([n,l])=>{let d=this.globalVariable.find(C=>C.code==n);a.push({Variable_ID:d.id||d.variable_ID,Value:l?l.toString():d.defaultValue??"0"})}),this.hideLoading(),this.dialogRef.close({local:t,global:a})}get formCtrls(){return this.form.controls}closeDialog(){this.dialogRef.close(null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ue.E),e.Y36(me.P),e.Y36(g.so),e.Y36(g.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-variable-dialog"]],features:[e.qOj],decls:22,vars:2,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],[1,"d-inline-block"],["title","setVariables",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"click"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],["dialogContainer",""],["title","localVariables",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"row"],[4,"ngFor","ngForOf"],["title","globalvariables",1,"d-inline-block","black-color","font-size-20","mtop-5"],["styleClass","mb-1 px-md-4",3,"click"],["styleClass","px-md-5",3,"onClick"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","label"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._UZ(2,"page-title",2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return a.closeDialog()}),e._UZ(4,"i",4),e.qZA()(),e.TgZ(5,"mat-dialog-content",5,6),e._UZ(7,"page-title",7)(8,"br")(9,"br"),e.TgZ(10,"form")(11,"div",8),e.YNc(12,oa,3,2,"ng-container",9),e.qZA()(),e._UZ(13,"page-title",10)(14,"br")(15,"br"),e.TgZ(16,"form")(17,"div",8),e.YNc(18,na,3,2,"ng-container",9),e.qZA()()(),e.TgZ(19,"mat-dialog-actions")(20,"discard-dialog-btn",11),e.NdJ("click",function(){return a.closeDialog()}),e.qZA(),e.TgZ(21,"submit-btn",12),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()),2&t&&(e.xp6(12),e.Q6J("ngForOf",a.localVariable),e.xp6(6),e.Q6J("ngForOf",a.globalVariable))},dependencies:[u.sg,J.a,T.p,b.T,H.E,V.lW,g.uh,g.xY,g.H8,r._Y,r.JL,r.F]}),o})(),la=(()=>{class o extends h.U{constructor(t,a){super(),this.dialogRef=t,this.data=a,this.mandatoryColomns=["variableName","value"],this.isLoaded=!1,this.optionalColomns=[],a&&(this.showLoading(),this.dataSourceLocal=new f.by(a.localVariables),this.dataSourceGlobal=new f.by(a.globalVariables),this.isLoaded=!0,this.hideLoading())}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.so),e.Y36(g.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-variable-details-dialog"]],features:[e.qOj],decls:17,vars:15,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],[1,"d-inline-block"],["title","variables",1,"d-inline-block","mtop-5"],["mat-icon-button","",1,"float-right","mb-1","mr-1",3,"click"],[1,"pi","pi-times"],[1,"container-fluid","mx-0"],["dialogContainer",""],[1,"row"],[1,"col-6"],["title","localVariables",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"table-in-forms","no-margin",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showSpaceTop","showFilter","showPaginator"],["title","globalvariables",1,"d-inline-block","black-color","font-size-20","mtop-5"],[1,"table-in-forms","no-margin",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showSpaceTop","showPaginator","showFilter"],["align","end",1,"long-btns"],["styleClass","mb-1 px-md-4","label","close",3,"click"],["label","edit","styleClass","px-md-5","icon","fa fa-pen",3,"iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4",1),e._UZ(2,"page-title",2),e.qZA(),e.TgZ(3,"button",3),e.NdJ("click",function(){return a.dialogRef.close(null)}),e._UZ(4,"i",4),e.qZA()(),e.TgZ(5,"mat-dialog-content",5,6)(7,"div",7)(8,"div",8),e._UZ(9,"page-title",9)(10,"app-material-table",10),e.qZA(),e.TgZ(11,"div",8),e._UZ(12,"page-title",11)(13,"app-material-table",12),e.qZA()()(),e.TgZ(14,"mat-dialog-actions",13)(15,"discard-dialog-btn",14),e.NdJ("click",function(){return a.dialogRef.close(null)}),e.qZA(),e.TgZ(16,"submit-btn",15),e.NdJ("onClick",function(){return a.dialogRef.close(!0)}),e.qZA()()),2&t&&(e.xp6(10),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSourceLocal)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("showSpaceTop",!1)("showFilter",!1)("showPaginator",!1),e.xp6(3),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSourceGlobal)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("showSpaceTop",!1)("showPaginator",!1)("showFilter",!1),e.xp6(3),e.Q6J("iconPositionBefore",!1))},dependencies:[S.I,T.p,b.T,H.E,V.lW,g.uh,g.xY,g.H8]}),o})();var sa=s(66827),ra=s(58291);function ca(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"reset-form-btn",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.clearForm())}),e.qZA()}}function da(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card-content",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",2)(6,"div",5),e._UZ(7,"app-unassigned-employees-to-payment-dropdown",6),e.qZA(),e.TgZ(8,"div",5)(9,"app-input",7),e.NdJ("clickSuffixIcon",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openCreateVariableDialog())}),e.qZA()(),e.TgZ(10,"div",8),e.YNc(11,ca,1,0,"reset-form-btn",9),e.TgZ(12,"submit-btn",10),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e.qZA()()()()()()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.person_Instance_ID)("submitted",t.submitted)("paymentId",t.paymentId)("reCall",t.reCallUNAssigned)("displayCodeWithName",!0),e.xp6(2),e.Q6J("control",t.formCtrls.test)("submitted",t.submitted)("suffixIcon",t.svg.circle_grid)("isSuffixSvg",!0)("disabled",!t.formCtrls.person_Instance_ID.value),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(1),e.Q6J("id",t.formCtrls.id.value)("color",t.btn.darkBlue)("iconPositionBefore",!1)("disabled",0==t.paymentId)}}function pa(o,i){1&o&&e._UZ(0,"mat-divider",14)}function ma(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card-content"),e.YNc(2,pa,1,0,"mat-divider",12),e.TgZ(3,"app-material-table",13),e.NdJ("editRow",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.toEdit(n))})("deleteRow",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.onDelete(n))})("clickCell",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getEditData(n.data.person_Instance_ID,!0,n.col))})("onChangePage",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getList(n.pageIndex+1,n.pageSize))}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showForm),e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("clickableCols",t.clickableCols)("actions",t.rowFunctions)("page",t.page)("showFilter",!1)("isCenterPaginator",!0)}}let Ze=(()=>{class o extends h.U{constructor(t,a){super(),this.assignEmployeesService=t,this.data=a,this.paymentId=0,this.isView=!1,this.showForm=!0,this.updateIsViewUpdate=new e.vpe,this.completed=new e.vpe,this.submitted=!1,this.mandatoryColomns=["code","ar_Name","en_Name","countLocalVariables","countGlobalVariables","actions"],this.isLoaded=!1,this.optionalColomns=[],this.clickableCols=["countLocalVariables","countGlobalVariables"],this.svg=new le.El,this.reCallUNAssigned=!1}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],person_Instance_ID:[null,r.kI.required],localVariables:[null,r.kI.required],globalVariables:[null,r.kI.required],test:[null]}),this.data.isDialog&&this.form.patchValue(this.data.data)}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.paymentId>0?this.getList(this.firstPage):this.isLoaded=!0}onModulesChanged(){this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,_.S.pay_assign_employees)}get formCtrls(){return this.form.controls}submit(){const t={payment_ID:this.paymentId,person_Instance_ID:this.formCtrls.person_Instance_ID.value,localVariables:this.formCtrls.localVariables.value,globalVariables:this.formCtrls.globalVariables.value};this.form.valid&&(this.showLoading(),this.assignEmployeesService.create(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newPayLocalVariableAdded"),this.clearForm(),this.reCallUNAssigned=!0,this.getList(this.currentPage),this.completed.emit(!0)):this.errorList(a?.message?.messages),this.hideLoading()}))}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a);let n={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.assignEmployeesService.getListActualAssignVariables(n,this.paymentId).pipe(this.cancelRequest()).subscribe(l=>{l.message.messageType==p.u.Success?(this.dataSource=new f.by(k(l.data)),this.page.length=l.meta.totalItemCount,this.page.meta=l.meta,this.isLoaded=!0):this.errorList(l?.message?.messages),this.hideLoading()})}getEditData(t,a=!1,n){this.showLoading(),this.assignEmployeesService.getById(this.paymentId,t).subscribe(l=>{if(l.message.messageType==p.u.Success){let d=k(l.data)[0];a?this.toView(n,d):this.openCreateVariableDialog(d,!0)}else this.errorList(l?.message?.messages);this.hideLoading()})}openCreateVariableDialog(t,a=!1){this.dialogsService.addEditDialog(ia,{paymentId:this.paymentId,data:t,isEdit:a},{width:"80%",panelClass:"dialog-emp-form"}).afterClosed().subscribe(n=>{n&&(this.formCtrls.localVariables.setValue(n?.local),this.formCtrls.globalVariables.setValue(n?.global),a&&this.submit())})}toEdit(t){this.formCtrls.person_Instance_ID.setValue(t.person_Instance_ID),this.getEditData(t.person_Instance_ID)}toView(t,a){("countLocalVariables"==t||"countGlobalVariables"==t)&&(this.formCtrls.person_Instance_ID.setValue(a.person_Instance_ID),this.showLoading(),this.dialogsService.addEditDialog(la,a,{width:"80%",panelClass:"dialog-emp-form"}).afterClosed().subscribe(n=>{n&&this.openCreateVariableDialog(a,!0),this.hideLoading()}))}clearForm(){this.form.reset({id:0,person_Instance_ID:null}),this.submitted=!1}onDelete(t){let a=this.msgTranslate(t.ar_Name,t.en_Name);this.deleteDialog(a).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.assignEmployeesService.Delete(t.payment_ID,t.person_Instance_ID).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("assignEmployeeDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(sa.e),e.Y36(g.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-assign-employees"]],inputs:{paymentId:"paymentId",isView:"isView",showForm:"showForm"},outputs:{updateIsViewUpdate:"updateIsViewUpdate",completed:"completed"},features:[e.qOj],decls:2,vars:2,consts:[[4,"ngIf"],[1,"container-fluid","mtop-40"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","submitted","paymentId","reCall","displayCodeWithName"],["label","Variables",3,"control","submitted","suffixIcon","isSuffixSvg","disabled","clickSuffixIcon"],[1,"col-md-4","col-lg-3","col-12","mt-1"],[3,"click",4,"ngIf"],["icon","pi pi-plus-circle","label","add",3,"id","color","iconPositionBefore","disabled","onClick"],[3,"click"],["class","w-75 m-auto",4,"ngIf"],[1,"table-in-forms","no-margin","mtop-10",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","clickableCols","actions","page","showFilter","isCenterPaginator","editRow","deleteRow","clickCell","onChangePage"],[1,"w-75","m-auto"]],template:function(t,a){1&t&&(e.YNc(0,da,13,16,"ng-container",0),e.YNc(1,ma,4,10,"ng-container",0)),2&t&&(e.Q6J("ngIf",a.showForm),e.xp6(1),e.Q6J("ngIf",a.paymentId>0))},dependencies:[u.O5,J.a,S.I,_e.J,T.p,c.dn,v.d,ra.b,r._Y,r.JL,r.sg]}),o})();const ua=["stepper"];function _a(o,i){if(1&o&&e._UZ(0,"app-add-new-btn",3),2&o){const t=e.oxw();e.MGl("url","/payroll/",t.moduleId,"/payments/add"),e.Q6J("params",t.paymentId)}}function ga(o,i){1&o&&e._UZ(0,"i",20)}function fa(o,i){1&o&&e._UZ(0,"i",20)}function ha(o,i){1&o&&e._UZ(0,"i",20)}let Ae=(()=>{class o extends h.U{constructor(){super(),this.isGeneraCompleted=!1,this.isLocalVarCompleted=!1,this.isAssignemployeeCompleted=!1,this.activatedRoute.params.subscribe(t=>{this.paymentId=Number(t.id??0)})}ngOnInit(){}stepChanged(){this.stepper.selected.interacted=!1}getPaymentId(t){this.paymentId=t}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-payment-core"]],viewQuery:function(t,a){if(1&t&&e.Gf(ua,5),2&t){let n;e.iGM(n=e.CRH())&&(a.stepper=n.first)}},features:[e.qOj],decls:47,vars:38,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addPayment","title","add",3,"id","parentTitle","parentTitleLink","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"has-fixed-title"],[3,"linear","disableRipple","selectionChange"],["stepper",""],[3,"label","completed"],["matStepperIcon","edit"],[1,"row"],[1,"col-12"],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],[1,"mt-2"],[1,"clearfix"],[3,"completed","changePaymentId"],["title","RecurringVariables",1,"stepper-section-title"],[3,"paymentId","completed"],["title","assignemployee",1,"stepper-section-title"],[3,"stepper","parentParam","url","pageParams"],[1,"fas","fa-check"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ynx(4),e.YNc(5,_a,1,2,"app-add-new-btn",2),e._UZ(6,"app-back-btn",3),e.BQk(),e.qZA(),e.TgZ(7,"mat-card-content",4)(8,"mat-stepper",5,6),e.NdJ("selectionChange",function(){return a.stepChanged()}),e.TgZ(10,"mat-step",7),e.ALo(11,"titlecase"),e.ALo(12,"translate"),e.YNc(13,ga,1,0,"ng-template",8),e.TgZ(14,"div",9)(15,"div",10)(16,"mat-card")(17,"mat-card-title",11),e._UZ(18,"page-title",12),e.qZA(),e._UZ(19,"mat-divider",13)(20,"div",14),e.TgZ(21,"app-payment-general-data",15),e.NdJ("completed",function(l){return a.isGeneraCompleted=l})("changePaymentId",function(l){return a.getPaymentId(l)}),e.qZA()()()()(),e.TgZ(22,"mat-step",7),e.ALo(23,"titlecase"),e.ALo(24,"translate"),e.YNc(25,fa,1,0,"ng-template",8),e.TgZ(26,"div",9)(27,"div",10)(28,"mat-card")(29,"mat-card-title",11),e._UZ(30,"page-title",16),e.qZA(),e._UZ(31,"mat-divider",13)(32,"div",14),e.TgZ(33,"add-variables",17),e.NdJ("completed",function(l){return a.isLocalVarCompleted=l}),e.qZA()()()()(),e.TgZ(34,"mat-step",7),e.ALo(35,"titlecase"),e.ALo(36,"translate"),e.YNc(37,ha,1,0,"ng-template",8),e.TgZ(38,"div",9)(39,"div",10)(40,"mat-card")(41,"mat-card-title",11),e._UZ(42,"page-title",18),e.qZA(),e._UZ(43,"mat-divider",13)(44,"div",14),e.TgZ(45,"app-assign-employees",17),e.NdJ("completed",function(l){return a.isAssignemployeeCompleted=l}),e.qZA()()()()()()(),e._UZ(46,"steps-footer",19)),2&t){const n=e.MAs(9);e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,22,"payroll")," / ",e.lcZ(3,24,"payments"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/payments"),e.Q6J("id",0)("parentLinkParams",a.pageParams),e.xp6(4),e.Q6J("ngIf",a.paymentId>0),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/payments"),e.Q6J("params",a.pageParams),e.xp6(2),e.Q6J("linear",!1)("disableRipple",!0),e.xp6(2),e.s9C("label",e.lcZ(11,26,e.lcZ(12,28,"generalInfo"))),e.Q6J("completed",a.isGeneraCompleted),e.xp6(12),e.s9C("label",e.lcZ(23,30,e.lcZ(24,32,"recurringVariables&formula"))),e.Q6J("completed",a.isLocalVarCompleted),e.xp6(11),e.Q6J("paymentId",a.paymentId),e.xp6(1),e.s9C("label",e.lcZ(35,34,e.lcZ(36,36,"assignemployee"))),e.Q6J("completed",a.isAssignemployeeCompleted),e.xp6(11),e.Q6J("paymentId",a.paymentId),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/payments"),e.Q6J("stepper",n)("parentParam",a.parentParam)("pageParams",a.pageParams)}},dependencies:[u.O5,x.a,Q.J,b.T,ne.j,c.a8,c.dn,c.n5,v.d,Z.C0,Z.Vq,Z.z9,Ie.K,Se,Ze,u.rS,I.X$]}),o})();var xe=s(74734),ba=s(48881),U=s(93665),$=s(38368);function Ca(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isView=!1)}),e._UZ(1,"i",10),e.qZA()}}function va(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isView=!0)}),e._UZ(1,"i",11),e.qZA()}}function ya(o,i){if(1&o&&(e.TgZ(0,"div",15),e._UZ(1,"app-view-data-row-item",16)(2,"app-view-data-row-item",17)(3,"app-view-data-row-item",18)(4,"app-view-data-row-item",19)(5,"app-view-data-row-item",20)(6,"app-view-data-row-item",21)(7,"app-view-data-row-item",22)(8,"app-view-data-row-item",23)(9,"app-view-data-row-item",24),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("value",null==t.payment||null==t.payment.payment?null:t.payment.payment.ar_Name),e.xp6(1),e.Q6J("value",null==t.payment||null==t.payment.payment?null:t.payment.payment.en_Name),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.payment||null==t.payment.payment||null==t.payment.payment.pay_Payment_Type?null:t.payment.payment.pay_Payment_Type.ar_NAme,null==t.payment||null==t.payment.payment||null==t.payment.payment.pay_Payment_Type?null:t.payment.payment.pay_Payment_Type.en_Name)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.payment||null==t.payment.payment||null==t.payment.payment.pay_Interval_Type?null:t.payment.payment.pay_Interval_Type.ar_Name,null==t.payment||null==t.payment.payment||null==t.payment.payment.pay_Interval_Type?null:t.payment.payment.pay_Interval_Type.en_Name)),e.xp6(1),e.Q6J("value",null==t.payment||null==t.payment.payment?null:t.payment.payment.interval),e.xp6(1),e.Q6J("value",null==t.payment||null==t.payment.payment?null:t.payment.payment.start_From_Date)("isDate",!0),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.payment||null==t.payment.currency||null==t.payment.currency.comm_Currency?null:t.payment.currency.comm_Currency.ar_Name,null==t.payment||null==t.payment.currency||null==t.payment.currency.comm_Currency?null:t.payment.currency.comm_Currency.en_NAme)),e.xp6(1),e.Q6J("value",t.getAllStatusAsString()),e.xp6(1),e.Q6J("value",null==t.payment||null==t.payment.payment?null:t.payment.payment.note)}}function Ia(o,i){1&o&&e._UZ(0,"app-view-card-row-skeleton")}function Ta(o,i){if(1&o&&(e.TgZ(0,"div",12),e.YNc(1,ya,10,10,"div",13),e.YNc(2,Ia,1,0,"app-view-card-row-skeleton",14),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}function wa(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-payment-general-data",25),e.NdJ("closeAfterUpdate",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.returnToView(n))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("payment",t.payment)}}let Sa=(()=>{class o extends h.U{constructor(t){super(),this.paymentService=t,this.paymentId=0,this.editAll=!1,this.getPaymentName=new e.vpe,this.isView=!0,this.isLoaded=!1}onChangeBusinessAndCompanyId(){this.paymentId>0&&this.checkNoBusinessOrCompany()&&this.getPaymentById()}ngOnInit(){}ngOnChanges(t){t?.editAll&&!t?.editAll?.firstChange&&(this.isView=!1)}getPaymentById(){this.isLoaded=!1,this.paymentService.GetAll_PaymentCard(this.paymentId).subscribe(t=>{t.message.messageType==p.u.Success?(this.payment=t.data,this.getPaymentName.emit(this.msgTranslate(this.payment?.payment?.ar_Name,this.payment?.payment?.en_Name)),this.isLoaded=!0):this.errorList(t?.message?.messages)})}returnToView(t){this.isView=!0,t&&this.getPaymentById()}getAllStatusAsString(){return this.payment.status.map(t=>this.msgTranslate(t.core_Status?.ar_Name,t.core_Status?.en_Name)).join(", ")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(O.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-general-info-view"]],inputs:{paymentId:"paymentId",editAll:"editAll"},outputs:{getPaymentName:"getPaymentName"},features:[e.qOj,e.TTD],decls:13,vars:6,consts:[[1,"row"],[1,"col-12"],["container",""],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],["mat-button","","class","float-right section-edit-btn pright-6 pleft-6 darkBlue",3,"click",4,"ngIf"],[1,"mt-2"],["class","mtop-30",4,"ngIf","ngIfElse"],["form",""],["mat-button","",1,"float-right","section-edit-btn","pright-6","pleft-6","darkBlue",3,"click"],[1,"fas","fa-pen","font-size-15"],[1,"ft-corner-up-left","font-size-18"],[1,"mtop-30"],["class","view-data-row-container",4,"ngIf"],[4,"ngIf"],[1,"view-data-row-container"],["label","ar_Name",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","en_Name",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","paymentType",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","interval_type",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","interval",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","fromDate",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value","isDate"],["label","currency",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","calculation_status",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","notes",1,"col-lg-8","col-md-12","col-sm-4","col-12","mbottom-20","p-0",3,"value"],[3,"payment","closeAfterUpdate"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",null,2)(4,"mat-card-title",3),e._UZ(5,"page-title",4),e.YNc(6,Ca,2,0,"button",5),e.YNc(7,va,2,0,"button",5),e.qZA(),e._UZ(8,"mat-divider",6),e.TgZ(9,"mat-card-content"),e.YNc(10,Ta,3,2,"div",7),e.YNc(11,wa,1,1,"ng-template",null,8,e.W1O),e.qZA()()()()),2&t){const n=e.MAs(12);e.xp6(2),e.ekj("pb-0",a.isLoaded),e.xp6(4),e.Q6J("ngIf",a.isView),e.xp6(1),e.Q6J("ngIf",!a.isView),e.xp6(3),e.Q6J("ngIf",a.isView)("ngIfElse",n)}},dependencies:[u.O5,b.T,U.l,$.I,V.lW,c.a8,c.dn,c.n5,v.d,Ie.K],styles:[".pb-0[_ngcontent-%COMP%]{padding-bottom:0!important}"]}),o})();function ge(o){return o.map(i=>({...i,id:i.id,paymentDate:m.M6.mapDate(i.payment_DATE),confirmation:i.is_Confirm,confirmationDate:m.M6.mapDate(i.confirmDate),Notes:i.notes,toDate:m.M6.mapDate(i.toDate),LastTransferToS4:m.M6.mapDate(i.lastDateS4),LastTransferToB1:m.M6.mapDate(i.lastDateB1),isTransfareToS4:null!=i.lastDateS4,isTransfareToB1:null!=i.lastDateB1}))}var R=s(74803),Pe=s(66520);function Za(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.navigatToAddRetroactiveComponent())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"addRetroactive")," "))}let Aa=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculationsService=t,this.mandatoryColomns=["id","paymentDate","toDate","confirmation","confirmationDate","LastTransferToS4","LastTransferTob1","notes","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(this.getParentViewName,_.S.period_calculation_index),this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,_.S.period_calculation_index)}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.dialogSize=a),this.removePageParams(),this.periodCalculationsService.getList({PageNumber:t,pageSize:this.page.pageSize},this.paymentId).subscribe(l=>{if(l.message.messageType==p.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new f.by(ge(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l.message.messages)})}onDelete(t){this.deleteDialog(t.id+" - "+t.paymentDate).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.periodCalculationsService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("periodCalculationtRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}navigatToAddComponent(){this.router.navigate([`payroll/${this.moduleId}/payments/period-calculation/add`,this.paymentId])}navigatToAddRetroactiveComponent(){this.router.navigate([`payroll/${this.moduleId}/payments/retro-active/add`,this.paymentId])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(R.b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-period-calculation-index"]],inputs:{hasRetroactive:"hasRetroactive",paymentId:"paymentId"},features:[e.qOj],decls:15,vars:11,consts:[[1,"title-no-margin"],[1,"d-flex","justify-content-between","align-items-center"],["title","periodCalculations",1,"periodCalculations"],["class","btn btn-gray",3,"click",4,"ngIf"],[3,"functions","action"],["type","file","id","fileInput",2,"display","none"],[1,"mt-2"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"table-in-forms","no-margin",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","isRowClickable","checkboxCols","isCenterPaginator","onChangePage","deleteRow"],[1,"btn","btn-gray",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0)(2,"div",1)(3,"div"),e._UZ(4,"page-title",2),e.qZA(),e.TgZ(5,"div"),e.YNc(6,Za,3,3,"button",3),e.qZA(),e.TgZ(7,"div")(8,"app-global-functions",4),e.NdJ("action",function(){return a.navigatToAddComponent()}),e.qZA(),e._UZ(9,"input",5),e.qZA()()(),e._UZ(10,"mat-divider",6),e.TgZ(11,"mat-card-content",7)(12,"div",8),e._UZ(13,"div",9),e.qZA(),e.TgZ(14,"app-material-table",10),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return a.onDelete(l)}),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("ngIf",!a.hasRetroactive),e.xp6(2),e.Q6J("functions",a.subGlobalFunctions),e.xp6(6),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("isRowClickable",!0)("checkboxCols","confirmation")("isCenterPaginator",!0))},dependencies:[u.O5,S.I,Pe.H,b.T,c.a8,c.dn,c.n5,v.d,I.X$]}),o})();var Le=s(857);let xa=(()=>{class o extends h.U{constructor(t,a,n){super(),this.data=t,this.dialogRef=a,this.variablesService=n,this.file=new r.NI(null,r.kI.required),this.submitted=!1,this.isGlobal=n.isGlobal$.getValue()}ngOnInit(){this.variablesService.isGlobal$.subscribe(t=>{this.isGlobal=t})}uploadVariable(){this.submitted=!0;let a=m.M6.objectToFormData({PaymentID:this.data.PaymentID,IsGlobal:this.isGlobal,file:this.file.value});this.file.valid&&(this.showLoading(),this.variablesService.upload(a).subscribe(n=>{n.message.messageType==p.u.Success?(this.success("successfulUpload"),this.submitted=!1):this.errorList(n?.message?.messages),this.hideLoading()}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.WI),e.Y36(g.so),e.Y36(z.a))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-upload-variables-dialog"]],features:[e.qOj],decls:12,vars:9,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","uploadVariables",1,"d-inline-block","mtop-10"],[1,"container-fluid","mx-0"],[1,"row"],[1,"col-12"],[3,"control","submitted","multiple","isDragDrop"],["align","end",1,"mb-0","mt-2"],["icon","pi pi-upload","label","upload",1,"w-95","m-auto","d-block",3,"styleClass","iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2)(4,"mat-card-subtitle"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",3)(8,"div",4),e._UZ(9,"primeng-file-upload",5),e.qZA()(),e.TgZ(10,"mat-card-actions",6)(11,"submit-btn",7),e.NdJ("onClick",function(){return a.uploadVariable()}),e.qZA()()()),2&t&&(e.xp6(5),e.hij(" ",e.lcZ(6,7,"downloadTemplateAndFillItWithData")," "),e.xp6(4),e.Q6J("control",a.file)("submitted",a.submitted)("multiple",!1)("isDragDrop",!0),e.xp6(2),e.MGl("styleClass","",a.btn.block," m-auto"),e.Q6J("iconPositionBefore",!1))},dependencies:[Le.J,T.p,b.T,c.$j,c.hq,g.uh,g.xY,I.X$]}),o})();function se(o){return o.map(i=>({...i,id:i?.id,paymentDate:m.M6.mapDate(i.payment_DATE),confirmation:i.is_Confirm,confirmationDate:m.M6.mapDate(i.confirmDate),Notes:i.notes,toDate:m.M6.mapDate(i.toDate),LastTransferToS4:m.M6.mapDate(i.lastDateS4),LastTransferToB1:m.M6.mapDate(i.lastDateB1),isTransfareToS4:null!=i.lastDateS4,isTransfareToB1:null!=i.lastDateB1,paymentId:i.pay_Payment?.id}))}function De(o){return o.map(i=>({isSelected:!1,id:i.id,code:i.core_Person.code,employee:(0,m._f)(i.core_Person.ar_Name,i.core_Person.en_Name)}))}var X=s(44389),Ve=s(62160),Da=s(72090),Va=s(15362),Na=s(83041),Ne=s(90926),Je=s(91508);function Ja(o,i){1&o&&(e.TgZ(0,"div",10)(1,"h4"),e._UZ(2,"page-title",11),e.qZA()())}function ka(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-policy-groups-dropdown",17),e.NdJ("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.GetAll_EmployeeAssignedToPayment())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("control",t.formCtrls.groupId)("submitted",t.submitted)("filter",!0)("disable",t.formCtrls.isEmpty.value)}}function Qa(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"policy-groups-by-company-dropdown",22),e.NdJ("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.GetAll_EmployeeAssignedToPayment())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("control",t.formCtrls.groupId)("submitted",t.submitted)("companyCtrl",t.formCtrls.organizationId)("filter",!0)("disable",t.formCtrls.isEmpty.value)}}function Ga(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-job-title-dropdown",17),e.NdJ("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.GetAll_EmployeeAssignedToPayment())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("control",t.formCtrls.jobTitleId)("submitted",t.submitted)("filter",!0)("disable",t.formCtrls.isEmpty.value)}}function qa(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-job-title-by-org-dropdown",23),e.NdJ("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.GetAll_EmployeeAssignedToPayment())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("control",t.formCtrls.jobTitleId)("organizationControl",t.formCtrls.organizationId)("submitted",t.submitted)("filter",!0)("disable",t.formCtrls.isEmpty.value)}}function Fa(o,i){1&o&&e._UZ(0,"mat-divider",24)}function Ua(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",12)(2,"div",3)(3,"div",13)(4,"variable-dropdown",14),e.NdJ("selectedVariableCodes",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getVarableCodes(n))}),e.qZA()(),e.TgZ(5,"div",13)(6,"app-check-box",15),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.changeIsEmptyTemplate())}),e.qZA()(),e.TgZ(7,"div",16)(8,"app-organization-current-structure-dropdown",17),e.NdJ("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.GetAll_EmployeeAssignedToPayment())}),e.qZA()(),e.TgZ(9,"div",16),e.YNc(10,ka,1,4,"app-policy-groups-dropdown",18),e.YNc(11,Qa,1,5,"policy-groups-by-company-dropdown",19),e.qZA(),e.TgZ(12,"div",16),e.YNc(13,Ga,1,4,"app-job-title-dropdown",18),e.YNc(14,qa,1,5,"app-job-title-by-org-dropdown",20),e.qZA()()(),e.YNc(15,Fa,1,0,"mat-divider",21),e.BQk()}if(2&o){const t=e.oxw(),a=e.MAs(2);e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngClass",t.isDialog&&t.formCtrls.isEmpty.value?"col-lg-8":"col-lg-6"),e.xp6(1),e.Q6J("control",t.formCtrls.variableIds)("submitted",t.submitted)("filter",!0)("multi",!0)("useCustomFilter",!0)("isGlobal",t.isGlobal)("paymentControl",t.formCtrls.paymentId)("appendTo",a),e.xp6(1),e.Q6J("ngClass",t.isDialog&&t.formCtrls.isEmpty.value?"col-lg-4":"col-lg-6"),e.xp6(1),e.Q6J("control",t.formCtrls.isEmpty),e.xp6(1),e.Q6J("ngClass",t.isDialog&&t.formCtrls.isEmpty.value?"col-lg-4":"col-lg-3"),e.xp6(1),e.Q6J("control",t.formCtrls.organizationId)("submitted",t.submitted)("filter",!0)("disable",t.formCtrls.isEmpty.value),e.xp6(1),e.Q6J("ngClass",t.isDialog&&t.formCtrls.isEmpty.value?"col-lg-4":"col-lg-3"),e.xp6(1),e.Q6J("ngIf",null==t.formCtrls.organizationId.value),e.xp6(1),e.Q6J("ngIf",null!=t.formCtrls.organizationId.value),e.xp6(1),e.Q6J("ngClass",t.isDialog&&t.formCtrls.isEmpty.value?"col-lg-4":"col-lg-3"),e.xp6(1),e.Q6J("ngIf",null==t.formCtrls.organizationId.value),e.xp6(1),e.Q6J("ngIf",null!=t.formCtrls.organizationId.value),e.xp6(1),e.Q6J("ngIf",!t.formCtrls.isEmpty.value)}}function Ra(o,i){if(1&o){const t=e.EpF();e.ynx(0,25),e.TgZ(1,"app-split-table",26),e.NdJ("selectedItems",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getSelectedItem(n))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("displayedColumns",t.displayedColumns)("showFilter",!!t.isDialog)("showSearchDropdown",!1)("hasPaginator",!0)("isCenterPaginator",!0)("pageSize",t.isDialog?15:30)}}function Ya(o,i){1&o&&e._UZ(0,"discard-dialog-btn",27)}let ke=(()=>{class o extends h.U{constructor(t,a,n,l,d){super(),this.variablesService=t,this.paymentService=a,this.periodCalculationsService=n,this.data=l,this.dialogRef=d,this.paymentId=0,this.selectedVariable=[],this.hasOutSideVariable=!1,this.variables=[],this.isLoaded=!1,this.submitted=!1,this.displayedColumns=["code","employee","isSelected"],this.assetsManager=new le.Sp,this.isGlobal=!1,this.isDialog=!1,this.isGlobal=t.isGlobal$.getValue(),l?.paymentId>0&&(this.paymentId=l.paymentId,this.isDialog=!0)}ngOnInit(){this.form=this.fb.group({variableIds:[[],r.kI.required],isEmpty:[!1],jobTitleId:[],organizationId:[],groupId:[],paymentId:[this.isGlobal?0:this.paymentId],employees:[[]]}),this.hasOutSideVariable||this.GetAll_EmployeeAssignedToPayment(),this.label=0!=this.hasOutSideVariable||this.isDialog?"DownloadVariables":"download",this.variablesService.isGlobal$.subscribe(t=>{this.isGlobal=t})}ngOnChanges(){this.hasOutSideVariable?this.GetAll_EmployeeAssignedtoPeriodCalculation(this.firstPage):this.GetAll_EmployeeAssignedToPayment()}get formCtrls(){return this.form?.controls}GetAll_EmployeeAssignedToPayment(){this.paymentService.GetAll_EmployeeAssignedPayment({JobId:this.formCtrls?.jobTitleId.value??"",OrgID:this.formCtrls?.organizationId.value??"",PolicyGroupId:this.formCtrls?.groupId.value??"",PaymentID:this.paymentId}).subscribe(a=>{a.message.messageType==p.u.Success?(this.dataSource=new f.by(De(a.data)),this.isLoaded=!0):this.errorList(a.message.messages)})}GetAll_EmployeeAssignedtoPeriodCalculation(t,a){this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.dialogSize=a),this.periodCalculationsService.GetAll_EmployeeAssignedtoPeriodCalculation({PageNumber:t,pageSize:this.page.pageSize},this.periodCalculationIds).subscribe(l=>{l.message.messageType==p.u.Success?(this.dataSource=new f.by(De(l.data)),this.isLoaded=!0):this.errorList(l.message.messages)})}download(){let t=[];if(this.hasOutSideVariable){if(0==this.selectedVariable.length)return void this.error("mustChooseVariables");this.selectedVariable.map(n=>{t.push(n.code)})}else this.formCtrls.variableIds.value.map(n=>{t.push(this.variables.filter(l=>l.id==n).map(l=>l.code).toString())});this.variablesService.download({personinstanceList:this.formCtrls.employees.value,variablesCodes:t,paymentId:this.formCtrls.paymentId.value,isglobalScreen:this.isGlobal,isEmptyTemplate:this.formCtrls.isEmpty.value}).subscribe(n=>{this.fileService.downloadBufferFile(n,"variable.xlsx")})}getSelectedItem(t){this.formCtrls.employees.setValue(t.map(a=>a.id))}getVarableCodes(t){this.variables=t}changeIsEmptyTemplate(){this.formCtrls.isEmpty.value&&this.formCtrls.employees.setValue(null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(z.a),e.Y36(O.t),e.Y36(R.b),e.Y36(g.WI),e.Y36(g.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-download-variables"]],inputs:{paymentId:"paymentId",selectedVariable:"selectedVariable",hasOutSideVariable:"hasOutSideVariable",periodCalculationIds:"periodCalculationIds",variables:"variables"},features:[e.qOj,e.TTD],decls:10,vars:10,consts:[["mat-dialog-title","","class","primary-color font-size-20 m-0",4,"ngIf"],[1,"container-fluid","m-0",3,"ngClass"],["dialogContainer",""],[1,"row"],[1,"col-12"],[4,"ngIf"],["class","mt-3",4,"ngIf"],["align","end"],["label","close","mat-dialog-close","",4,"ngIf"],["icon","pi pi-arrow-down","styleClass","float-right",3,"color","iconPositionBefore","label","onClick"],["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","DownloadVariables",1,"d-inline-block","mtop-10"],[3,"formGroup"],[1,"col-md-6","col-12",3,"ngClass"],[3,"control","submitted","filter","multi","useCustomFilter","isGlobal","paymentControl","appendTo","selectedVariableCodes"],["label","emptyTemplate","color","primary","labelPosition","before","styleClass","mt-2",3,"control","onChange"],[1,"col-md-4","col-12",3,"ngClass"],[3,"control","submitted","filter","disable","change"],[3,"control","submitted","filter","disable","change",4,"ngIf"],[3,"control","submitted","companyCtrl","filter","disable","change",4,"ngIf"],[3,"control","organizationControl","submitted","filter","disable","change",4,"ngIf"],["class","mt-3 mb-3",4,"ngIf"],[3,"control","submitted","companyCtrl","filter","disable","change"],[3,"control","organizationControl","submitted","filter","disable","change"],[1,"mt-3","mb-3"],[1,"mt-3"],[3,"isLoaded","dataSource","displayedColumns","showFilter","showSearchDropdown","hasPaginator","isCenterPaginator","pageSize","selectedItems"],["label","close","mat-dialog-close",""]],template:function(t,a){1&t&&(e.YNc(0,Ja,3,0,"div",0),e.TgZ(1,"mat-dialog-content",1,2)(3,"div",3)(4,"div",4),e.YNc(5,Ua,16,24,"ng-container",5),e.YNc(6,Ra,2,8,"ng-container",6),e.qZA()()(),e.TgZ(7,"mat-dialog-actions",7),e.YNc(8,Ya,1,0,"discard-dialog-btn",8),e.TgZ(9,"submit-btn",9),e.NdJ("onClick",function(){return a.download()}),e.qZA()()),2&t&&(e.Q6J("ngIf",a.isDialog),e.xp6(1),e.Q6J("ngClass",a.isDialog?"mtop-10 pright-20 pleft-20":"mtop-40"),e.xp6(4),e.Q6J("ngIf",!a.hasOutSideVariable),e.xp6(1),e.Q6J("ngIf",!a.formCtrls.isEmpty.value),e.xp6(1),e.ekj("download-dialog-action",a.isDialog),e.xp6(1),e.Q6J("ngIf",a.isDialog),e.xp6(1),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1)("label",a.label))},dependencies:[u.mk,u.O5,ie.u,T.p,b.T,H.E,X.M,v.d,g.ZT,g.uh,g.xY,g.H8,Ve.W,Da.n,Va.s,Na.$,Ne.P,Je.a,r._Y,r.JL,r.sg],styles:[".download-dialog-action{position:sticky;background:white;bottom:2vh;border-top:none!important;padding:10px 20px!important;gap:25px}  .download-dialog-action #submit_btn{margin-bottom:0!important}"]}),o})();function Ea(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isViewUpdate=!0)}),e._UZ(1,"i",11),e.qZA()}}function Ma(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isViewUpdate=!1)}),e._UZ(1,"i",12),e.qZA()}}let Ba=(()=>{class o extends h.U{constructor(){super(),this.isViewUpdate=!1,this.editAll=!1}ngOnInit(){}ngOnChanges(t){t?.editAll&&!t?.editAll?.firstChange&&(this.isViewUpdate=!0)}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(this.getParentViewName,_.S.local_variables_formula)}globalFunctionActions(t){t.viewName==_.S.upload_variables&&this.openUploadDialog(),t.viewName==_.S.download_variables&&this.openDownloadDialog()}openUploadDialog(){this.dialogsService.addEditDialog(xa,{PaymentID:this.paymentId},{panelClass:"dialog-emp-form",width:"25%"}).afterClosed().subscribe(t=>{})}openDownloadDialog(){this.dialogsService.addEditDialog(ke,{paymentId:this.paymentId}).afterClosed().subscribe(t=>{})}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-local-variables-view"]],inputs:{paymentId:"paymentId",editAll:"editAll"},features:[e.qOj,e.TTD],decls:14,vars:6,consts:[[1,"title-no-margin"],[1,"d-flex","justify-content-between","align-items-center"],[1,"col"],["title","RecurringVariables",1,"stepper-section-title"],[3,"functions","action"],["type","file","id","fileInput",2,"display","none"],["mat-button","","class","float-right section-edit-btn pright-6 pleft-6 darkBlue",3,"click",4,"ngIf"],[1,"mt-2"],[1,"clearfix"],[3,"showForm","paymentId","isView","updateIsViewUpdate"],["mat-button","",1,"float-right","section-edit-btn","pright-6","pleft-6","darkBlue",3,"click"],[1,"fas","fa-pen","font-size-15"],[1,"ft-corner-up-left","font-size-18"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0)(2,"div",1)(3,"div",2),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"div",2)(6,"app-global-functions",4),e.NdJ("action",function(l){return a.globalFunctionActions(l)}),e.qZA(),e._UZ(7,"input",5),e.qZA(),e.TgZ(8,"div",2),e.YNc(9,Ea,2,0,"button",6),e.YNc(10,Ma,2,0,"button",6),e.qZA()()(),e._UZ(11,"mat-divider",7)(12,"div",8),e.TgZ(13,"add-variables",9),e.NdJ("updateIsViewUpdate",function(l){return a.isViewUpdate=l}),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("functions",a.subGlobalFunctions),e.xp6(3),e.Q6J("ngIf",!a.isViewUpdate),e.xp6(1),e.Q6J("ngIf",a.isViewUpdate),e.xp6(3),e.Q6J("showForm",a.isViewUpdate)("paymentId",a.paymentId)("isView",!0))},dependencies:[u.O5,Pe.H,b.T,V.lW,c.a8,c.n5,v.d,Se]}),o})();function Oa(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isViewUpdate=!0)}),e._UZ(1,"i",7),e.qZA()}}function ja(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isViewUpdate=!1)}),e._UZ(1,"i",8),e.qZA()}}let za=(()=>{class o extends h.U{constructor(){super(),this.isViewUpdate=!1,this.editAll=!1}ngOnInit(){}ngOnChanges(t){t?.editAll&&!t?.editAll?.firstChange&&(this.isViewUpdate=!0)}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(this.getParentViewName,_.S.pay_assign_employees)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-assign-employee-view"]],inputs:{paymentId:"paymentId",editAll:"editAll"},features:[e.qOj,e.TTD],decls:8,vars:5,consts:[[1,"title-no-margin"],["title","assignemployee",1,"stepper-section-title"],["mat-button","","class","float-right section-edit-btn pright-6 pleft-6 darkBlue",3,"click",4,"ngIf"],[1,"mt-2"],[1,"clearfix"],[3,"showForm","paymentId","isView","updateIsViewUpdate"],["mat-button","",1,"float-right","section-edit-btn","pright-6","pleft-6","darkBlue",3,"click"],[1,"fas","fa-pen","font-size-15"],[1,"ft-corner-up-left","font-size-18"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0),e._UZ(2,"page-title",1),e.YNc(3,Oa,2,0,"button",2),e.YNc(4,ja,2,0,"button",2),e.qZA(),e._UZ(5,"mat-divider",3)(6,"div",4),e.TgZ(7,"app-assign-employees",5),e.NdJ("updateIsViewUpdate",function(l){return a.isViewUpdate=l}),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngIf",!a.isViewUpdate),e.xp6(1),e.Q6J("ngIf",a.isViewUpdate),e.xp6(3),e.Q6J("showForm",a.isViewUpdate)("paymentId",a.paymentId)("isView",!0))},dependencies:[u.O5,b.T,V.lW,c.a8,c.n5,v.d,Ze]}),o})();var Ha=s(26315),Y=s(18521),fe=s(591);let q=(()=>{class o extends Y.K{constructor(){super(),this.retroactive$=new fe.X(null)}getList(t,a){return this.get("payroll/RetroActivePeriodCalculation/GetList",{params:{...t,$filter:`Payment_ID eq ${a}`}})}getById(t){return this.get("payroll/RetroActivePeriodCalculation/GetAll",{params:{$filter:`id eq ${t}`,$expand:Ha.db.pay_Payment}})}getCalculationResult(t,a){return this.get("payroll/RetroActivePeriodCalculation/GetCalculationResultsList",{params:{...t,RetroActiveID:a}})}create(t){return this.post("Payroll/RetroActivePeriodCalculation/Create",t)}getVariables(t){return this.get("payroll/RetroActivePeriodCalculation/GetVariables",{params:{PeriodCalculationIDs:t}})}confirm(t){return this.post("Payroll/RetroActivePeriodCalculation/Confirm",null,{params:{RetroActiveID:t}})}reCalculate(t){return this.post("Payroll/RetroActivePeriodCalculation/ReCalculate",t)}Delete(t){return this.delete("Payroll/RetroActivePeriodCalculation/Delete",{params:{RetroActiveID:t}})}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ka=(()=>{class o extends h.U{constructor(t){super(),this.retroactiveService=t,this.hasRetroactive=new e.vpe,this.mandatoryColomns=["id","paymentDate","toDate","confirmation","confirmationDate","LastTransferToS4","LastTransferTob1","notes","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(this.getParentViewName,_.S.retroactive_index),this.rowFunctions=this.getSubRowFunctions(this.getParentViewName,_.S.retroactive_index)}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.dialogSize=a),this.removePageParams(),this.retroactiveService.getList({PageNumber:t,pageSize:this.page.pageSize},this.paymentId).subscribe(l=>{if(l.message.messageType==p.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new f.by(se(l.data)),this.hasRetroactive.emit(0!=l.data.length),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l.message.messages)})}onDelete(t){this.deleteDialog(t.id+" - "+t.paymentDate).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.retroactiveService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("retroactiveRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}navigatToAddComponent(t){this.router.navigate([`payroll/${this.moduleId}/payments/retro-active/add`,this.paymentId])}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-retroactive-index"]],inputs:{paymentId:"paymentId"},outputs:{hasRetroactive:"hasRetroactive"},features:[e.qOj],decls:8,vars:10,consts:[[1,"mt-2"],["title","retroactive",3,"globalFunctions","action"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"table-in-forms","no-margin",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","isRowClickable","checkboxCols","isCenterPaginator","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0)(2,"page-title",1),e.NdJ("action",function(l){return a.navigatToAddComponent(l)}),e.qZA()(),e._UZ(3,"mat-divider",0),e.TgZ(4,"mat-card-content",2)(5,"div",3),e._UZ(6,"div",4),e.qZA(),e.TgZ(7,"app-material-table",5),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return a.onDelete(l)}),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("globalFunctions",a.subGlobalFunctions),e.xp6(5),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("isRowClickable",!0)("checkboxCols","confirmation")("isCenterPaginator",!0))},dependencies:[S.I,b.T,c.a8,c.dn,c.n5,v.d]}),o})();function $a(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",14)(1,"app-retroactive-index",12),e.NdJ("hasRetroactive",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.checkHasRetroactive(n))}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("paymentId",t.paymentId)}}let Xa=(()=>{class o extends h.U{constructor(){super(),this.tabsToView=["generalInfo","RecurringVariables","assignedEmployee","periodCalculations","retroactive"],this.editAll=!1,this.hasRetroactive=!0}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.paymentId=Number(t.id)??0})}editAllSections(){this.editAll=!this.editAll}checkHasRetroactive(t){this.hasRetroactive=t}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-view-core"]],features:[e.qOj],decls:18,vars:25,consts:[[1,"title-no-margin","title-section","fixed-title",2,"box-shadow","none"],[3,"title","parentTitle","parentTitleLink","parentLinkParams"],[3,"click"],[3,"url","params"],[3,"tabsToView","noOfLoadingItems","viewsFromBackEnd"],["id","top-tools"],["id","generalInfo",1,"mtop-18"],[3,"paymentId","editAll","getPaymentName"],["id","RecurringVariables",1,"mtop-18"],[3,"paymentId","editAll"],["id","assignedEmployee",1,"mtop-18"],["id","periodCalculations",1,"mtop-18"],[3,"paymentId","hasRetroactive"],["class","mtop-18","id","retroactive",4,"ngIf"],["id","retroactive",1,"mtop-18"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.TgZ(4,"edit-all-btn",2),e.NdJ("click",function(){return a.editAllSections()}),e.qZA(),e._UZ(5,"app-add-new-btn",3)(6,"app-back-btn",3),e.qZA(),e._UZ(7,"app-fixed-header-tabs",4),e.TgZ(8,"div",5)(9,"div",6)(10,"app-payment-general-info-view",7),e.NdJ("getPaymentName",function(l){return a.currentPaymentName=l}),e.qZA()(),e.TgZ(11,"div",8),e._UZ(12,"app-payment-local-variables-view",9),e.qZA(),e.TgZ(13,"div",10),e._UZ(14,"app-payment-assign-employee-view",9),e.qZA(),e.TgZ(15,"div",11),e._UZ(16,"app-period-calculation-index",12),e.qZA(),e.YNc(17,$a,2,1,"div",13),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,21,"payroll")," / ",e.lcZ(3,23,"payments"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/payments"),e.Q6J("title",a.currentPaymentName)("parentLinkParams",a.pageParams),e.xp6(4),e.MGl("url","/payroll/",a.moduleId,"/payments/add"),e.Q6J("params",a.parentParam),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/payments/index"),e.Q6J("params",a.pageParams),e.xp6(1),e.Q6J("tabsToView",a.tabsToView)("noOfLoadingItems",5)("viewsFromBackEnd",!1),e.xp6(3),e.Q6J("paymentId",a.paymentId)("editAll",!a.editAll),e.xp6(2),e.Q6J("paymentId",a.paymentId)("editAll",a.editAll),e.xp6(2),e.Q6J("paymentId",a.paymentId)("editAll",a.editAll),e.xp6(2),e.Q6J("paymentId",a.paymentId)("hasRetroactive",a.hasRetroactive),e.xp6(1),e.Q6J("ngIf",a.hasRetroactive))},dependencies:[u.O5,x.a,Q.J,b.T,xe.Q,ba.H,c.n5,Sa,Aa,Ba,za,Ka,I.X$]}),o})();function he(o){return o.map(i=>(i.lstVariableValue?.forEach(t=>{i[(0,m._f)(t.variable?.arName,t.variable?.name)]=t.value}),{...i,code:i.employee?.code,ar_Name:i.employee?.ar_Name}))}var re=s(24850);let Wa=(()=>{class o extends Y.K{constructor(){super()}getList(t,a){return this.get("payroll/PeriodCalculation/GetCalculationResultsList",{params:{...t,ID:a}})}getAll(t){return this.get("payroll/PeriodCalculation/GetCalculationResults",{params:{ID:t}})}reCalculate(t){return this.post("payroll/PeriodCalculation/Calculate",null,{params:{ID:t}})}exportExcel(t){return this.getAll(t).pipe((0,re.U)(a=>(a.data=he(a.data),a)))}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const eo=function(){return["code","ar_Name"]};let Qe=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculationResultsService=t,this.isConfirmed=!1,this.mandatoryColomns=["code","ar_Name"],this.isLoaded=!1,this.optionalColomns=[],this.getListBefore=!1}ngOnInit(){}ngOnChanges(t){t.calculationId?.currentValue!=t.calculationId?.previousValue&&!t.calculationId.firstChange&&this.getList(this.firstPage)}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&(this.getListBefore=!0,this.calculationId>0?this.getList(this.firstPage):this.isLoaded=!0)}getList(t,a){this.mandatoryColomns=["code","ar_Name"],this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.dialogSize=a),this.periodCalculationResultsService.getList({PageNumber:t,pageSize:this.page.pageSize},this.calculationId).subscribe(l=>{if(l.message.messageType==p.u.Success){this.dataSource=new f.by(he(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta;let d=[];l.data[0]?.lstVariableValue.forEach(C=>{d.push(this.msgTranslate(C.variable.arName,C.variable.name))}),this.mandatoryColomns=[...this.mandatoryColomns,...d]}else this.errorList(l.message.messages)})}reCalculate(){this.showLoading(),this.periodCalculationResultsService.reCalculate(this.calculationId).subscribe(t=>{t.message.messageType==p.u.Success?(this.success(this.dataSource?.data?.length>0?"reCalcSuccessfully":"calcSuccessfully"),this.hideLoading(),this.getList(this.firstPage)):this.errorList(t?.message?.messages)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Wa))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-period-calc-results"]],inputs:{calculationId:"calculationId",isConfirmed:"isConfirmed"},features:[e.qOj,e.TTD],decls:7,vars:13,consts:[[1,"mt-2"],["title","calculationResults",1,"stepper-section-title","d-inline-block"],["icon","pi pi-sync",1,"float-right","mbottom-20",3,"iconPositionBefore","label","disabled","onClick"],[1,"container-fluid","mtop-40"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","exportService","isCenterPaginator","stickyCols","exportId","onChangePage"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0),e._UZ(2,"page-title",1),e.TgZ(3,"submit-btn",2),e.NdJ("onClick",function(){return a.reCalculate()}),e.qZA()(),e._UZ(4,"mat-divider",0),e.TgZ(5,"mat-card-content",3)(6,"app-material-table",4),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)}),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("iconPositionBefore",!1)("label",(null==a.dataSource||null==a.dataSource.data?null:a.dataSource.data.length)>0||a.isConfirmed?"reCalculate":"calculate")("disabled",0==a.calculationId||a.isConfirmed),e.xp6(3),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("exportService",a.periodCalculationResultsService)("isCenterPaginator",!0)("stickyCols",e.DdM(12,eo))("exportId",a.calculationId))},dependencies:[S.I,T.p,b.T,c.a8,c.dn,c.n5,v.d]}),o})();function Ge(o){return o.map(i=>({...i,projectCode:i.proj_Code,Remarks:i.remarks,debit:i.is_Debit,variableName:i.varName,credit:i.total}))}let to=(()=>{class o extends Y.K{constructor(){super()}transfareToB1(t){return this.post("payroll/PeriodCalculationSAPB1GLIntegration/TranfareToSAPB1GL",null,{params:t})}getSAPB1GL(t){return this.get("payroll/PeriodCalculationSAPB1GLIntegration/GenerateSAPB1GL",{params:{PeriodCalculation_ID:t?.PeriodCalculation_ID,SystemInstance_ID:t?.SystemInstance_ID,integrationPurpose_ID:t?.integrationPurpose_ID}})}exportExcel(t){return this.getSAPB1GL(t).pipe((0,re.U)(a=>(a.data=Ge(a.data),a)))}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ao=s(37034),oo=s(38982),no=s(49676);function io(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"mat-divider",1)(2,"app-material-table",15),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("showPaginator",!1)("exportService",t.periodCalculattionSapB1Service)("exportId",t.modelRequest)}}let be=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculattionSapB1Service=t,this.submitted=!1,this.mandatoryColomns=["accountOrPartnerCode","variableName","Remarks","ocrCode1","ocrCode2","ocrCode3","ocrCode4","ocrCode5","projectCode","debit","credit"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({PeriodCalculation_ID:[this.periodCalculationId,r.kI.required],integrationPurpose_ID:[null,r.kI.required],SapB1JournalType_ID:[null,r.kI.required],SystemInstance_ID:[null,r.kI.required],gl_Date:[null,r.kI.required],Remark:[]})}get formCtrls(){return this.form.controls}submit(){let t={PeriodCalculation_ID:this.formCtrls.PeriodCalculation_ID.value,integrationPurpose_ID:this.formCtrls.integrationPurpose_ID.value,SapB1JournalType_ID:this.formCtrls.SapB1JournalType_ID.value,SystemInstance_ID:this.formCtrls.SystemInstance_ID.value,Remark:this.formCtrls.Remark.value,Gl_Date:m.M6.mapDate(this.formCtrls.gl_Date.value)};this.submitted=!0,this.periodCalculattionSapB1Service.transfareToB1(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.addSuccessfullyMsg("PeriodCalcTransferToB1"),this.submitted=!1):this.errorList(a?.message?.messages)})}getSAPB1GLList(){this.isLoaded=!1,this.modelRequest={PeriodCalculation_ID:this.formCtrls.PeriodCalculation_ID.value,integrationPurpose_ID:this.formCtrls.integrationPurpose_ID.value,SystemInstance_ID:this.formCtrls.SystemInstance_ID.value},console.log(this.modelRequest),this.dataSource=null,this.periodCalculattionSapB1Service.getSAPB1GL(this.modelRequest).subscribe(t=>{t.message.messageType==p.u.Success?(this.dataSource=new f.by(Ge(t.data)),this.isLoaded=!0):this.errorList(t.message.messages)})}getAllSAPB1GL(){this.formCtrls.PeriodCalculation_ID.value&&this.formCtrls.integrationPurpose_ID.value&&this.getSAPB1GLList()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(to))},o.\u0275cmp=e.Xpm({type:o,selectors:[["transfer-to-b1"]],inputs:{periodCalculationId:"periodCalculationId"},features:[e.qOj],decls:20,vars:17,consts:[[1,"mt-3"],[1,"mt-2"],["title","SAPB1J/ETransfer",1,"stepper-section-title"],[1,"container-fluid","mt-5"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","systemInstanceControl","submitted","filter","change"],["label","GLDate",3,"control","submitted"],[3,"control","submitted"],["label","Remark",3,"control","submitted"],[4,"ngIf"],["align","end",1,"mb-0"],["label","transfer","svgIcon","assets/svg/send.svg",3,"color","iconPositionBefore","onClick"],[1,"table-in-forms","mt-2",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","showPaginator","exportService","exportId"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title",1),e._UZ(2,"page-title",2),e.qZA(),e._UZ(3,"mat-divider",1),e.TgZ(4,"mat-card-content",3)(5,"form",4)(6,"div",5)(7,"div",6),e._UZ(8,"app-sap-system-instance-dropdown",7),e.qZA(),e.TgZ(9,"div",6)(10,"app-sap-integration-purpose-by-system-instance-dropdown",8),e.NdJ("change",function(){return a.getAllSAPB1GL()}),e.qZA()(),e.TgZ(11,"div",6),e._UZ(12,"app-datepicker",9),e.qZA(),e.TgZ(13,"div",6),e._UZ(14,"app-journal-type-draft-journal",10),e.qZA(),e.TgZ(15,"div",6),e._UZ(16,"app-input",11),e.qZA()()(),e.YNc(17,io,3,8,"ng-container",12),e.qZA(),e.TgZ(18,"mat-card-actions",13)(19,"submit-btn",14),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.SystemInstance_ID)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.integrationPurpose_ID)("systemInstanceControl",a.formCtrls.SystemInstance_ID)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.gl_Date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.SapB1JournalType_ID)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.Remark)("submitted",a.submitted),e.xp6(1),e.Q6J("ngIf",a.formCtrls.PeriodCalculation_ID.value&&a.formCtrls.integrationPurpose_ID.value),e.xp6(2),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1))},dependencies:[u.O5,G.Q,J.a,S.I,T.p,b.T,c.a8,c.dn,c.n5,c.hq,v.d,ao.K,oo._,no.k,r._Y,r.JL,r.sg]}),o})();function qe(o){return o.map(i=>({...i,LGAccountCode:i.s4_LG_AccountCode,LGAccountText:i.s4_LG_Account_Text,debit:i.is_Debit,variableName:i.varName,credit:i.total}))}let lo=(()=>{class o extends Y.K{constructor(){super()}transfareToS4(t){return this.post("payroll/PeriodCalculationS4GLIntegration/TranfareToS4GL",null,{params:t})}getSAPS4GL(t){return this.get("payroll/PeriodCalculationS4GLIntegration/GenerateS4GL",{params:{PeriodCalculation_ID:t.PeriodCalculation_ID,SystemInstance_ID:t.SystemInstance_ID,integrationPurpose_ID:t.integrationPurpose_ID}})}exportExcel(t){return this.getSAPS4GL(t).pipe((0,re.U)(a=>(a.data=qe(a.data),a)))}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var so=s(44423),ro=s(94422);function co(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"mat-divider",1)(2,"app-material-table",14),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("showPaginator",!1)("exportService",t.periodCalculattionSapS4Service)("exportId",t.modelRequest)}}let Ce=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculattionSapS4Service=t,this.submitted=!1,this.mandatoryColomns=["variableName","LGAccountCode","LGAccountText","CostCenter","CostCenter_Text","Remarks","debit","credit"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({PeriodCalculation_ID:[this.periodCalculationId,r.kI.required],integrationPurpose_ID:[null,r.kI.required],SystemInstance_ID:[null,r.kI.required],gl_Date:[null,r.kI.required],Remark:[]})}get formCtrls(){return this.form.controls}submit(){let t={PeriodCalculation_ID:this.formCtrls.PeriodCalculation_ID.value,integrationPurpose_ID:this.formCtrls.integrationPurpose_ID.value,SystemInstance_ID:this.formCtrls.SystemInstance_ID.value,Remark:this.formCtrls.Remark.value,Gl_Date:m.M6.mapDate(this.formCtrls.gl_Date.value)};this.submitted=!0,this.periodCalculattionSapS4Service.transfareToS4(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.addSuccessfullyMsg("PeriodCalcTransferToS4"),this.submitted=!1):this.errorList(a?.message?.messages)})}getS4GLList(){this.isLoaded=!1,this.modelRequest={PeriodCalculation_ID:this.formCtrls.PeriodCalculation_ID.value,integrationPurpose_ID:this.formCtrls.integrationPurpose_ID.value,SystemInstance_ID:this.formCtrls.SystemInstance_ID.value},this.dataSource=null,this.periodCalculattionSapS4Service.getSAPS4GL(this.modelRequest).subscribe(t=>{t.message.messageType==p.u.Success?(this.dataSource=new f.by(qe(t.data)),this.isLoaded=!0):this.errorList(t.message.messages)})}getAllS4GL(){this.formCtrls.PeriodCalculation_ID.value&&this.formCtrls.integrationPurpose_ID.value&&this.getS4GLList()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(lo))},o.\u0275cmp=e.Xpm({type:o,selectors:[["transfer-to-s4"]],inputs:{periodCalculationId:"periodCalculationId"},features:[e.qOj],decls:18,vars:15,consts:[[1,"mt-3"],[1,"mt-2"],["title","SAPS4J/ETransfer",1,"stepper-section-title"],[1,"container-fluid","mt-5"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","s4SystemInstanceControl","submitted","filter","change"],["label","GLDate",3,"control","submitted"],["label","Remark",3,"control","submitted"],[4,"ngIf"],["align","end",1,"mb-0"],["svgIcon","assets/svg/send.svg","label","transfer",3,"color","iconPositionBefore","onClick"],[1,"table-in-forms","mt-2",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showPaginator","exportService","exportId"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title",1),e._UZ(2,"page-title",2),e.qZA(),e._UZ(3,"mat-divider",1),e.TgZ(4,"mat-card-content",3)(5,"form",4)(6,"div",5)(7,"div",6),e._UZ(8,"app-s4-system-instance-dropdown",7),e.qZA(),e.TgZ(9,"div",6)(10,"app-s4-integration-purpose-by-system-instance-dropdown",8),e.NdJ("change",function(){return a.getAllS4GL()}),e.qZA()(),e.TgZ(11,"div",6),e._UZ(12,"app-datepicker",9),e.qZA(),e.TgZ(13,"div",6),e._UZ(14,"app-input",10),e.qZA()()(),e.YNc(15,co,3,7,"ng-container",11),e.qZA(),e.TgZ(16,"mat-card-actions",12)(17,"submit-btn",13),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.SystemInstance_ID)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.integrationPurpose_ID)("s4SystemInstanceControl",a.formCtrls.SystemInstance_ID)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.gl_Date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.Remark)("submitted",a.submitted),e.xp6(1),e.Q6J("ngIf",a.formCtrls.PeriodCalculation_ID.value&&a.formCtrls.integrationPurpose_ID.value),e.xp6(2),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1))},dependencies:[u.O5,G.Q,J.a,S.I,T.p,b.T,c.a8,c.dn,c.n5,c.hq,v.d,so.z,ro.C,r._Y,r.JL,r.sg]}),o})();function po(o,i){if(1&o&&e._UZ(0,"app-view-data-row-item",23),2&o){const t=e.oxw(2);e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",t.isCofirm)("isBool",!0)}}function mo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"submit-btn",25),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.confirm())}),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("iconPositionBefore",!1))}const uo=function(o){return{"col-lg-9":o}};function _o(o,i){if(1&o&&(e.TgZ(0,"div",13)(1,"div",14)(2,"div",15),e._UZ(3,"app-view-data-row-item",16)(4,"app-view-data-row-item",17),e.YNc(5,po,1,3,"app-view-data-row-item",18),e._UZ(6,"app-view-data-row-item",19)(7,"app-view-data-row-item",20)(8,"app-view-data-row-item",21),e.qZA()(),e.YNc(9,mo,2,1,"div",22),e.qZA()),2&o){const t=e.oxw();let a,n;e.xp6(1),e.Q6J("ngClass",e.VKq(18,uo,!t.isCofirm)),e.xp6(2),e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",null==t.period_calculation?null:t.period_calculation.paymentDate),e.xp6(1),e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",null==t.period_calculation?null:t.period_calculation.toDate)("isDate",!0),e.xp6(1),e.Q6J("ngIf",t.isCofirm),e.xp6(1),e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",null!==(a=null==t.period_calculation?null:t.period_calculation.LastTransferToB1)&&void 0!==a&&a)("isDate",null==t.period_calculation?null:t.period_calculation.isTransfareToB1)("isBool",!(null!=t.period_calculation&&t.period_calculation.isTransfareToB1)),e.xp6(1),e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",null!==(n=null==t.period_calculation?null:t.period_calculation.LastTransferToS4)&&void 0!==n&&n)("isDate",null==t.period_calculation?null:t.period_calculation.isTransfareToS4)("isBool",!(null!=t.period_calculation&&t.period_calculation.isTransfareToS4)),e.xp6(1),e.Q6J("ngClass",t.isCofirm?"col-lg-2 col-md-3 col-sm-4 col-6":"w-md-20")("value",null==t.period_calculation?null:t.period_calculation.Notes),e.xp6(1),e.Q6J("ngIf",!t.isCofirm)}}function go(o,i){1&o&&e._UZ(0,"app-view-card-row-skeleton")}function fo(o,i){if(1&o&&e._UZ(0,"transfer-to-b1",27),2&o){const t=e.oxw(2);e.Q6J("periodCalculationId",t.periodCalculationId)}}function ho(o,i){if(1&o&&e._UZ(0,"transfer-to-s4",27),2&o){const t=e.oxw(2);e.Q6J("periodCalculationId",t.periodCalculationId)}}function bo(o,i){if(1&o&&(e.TgZ(0,"div",10),e.YNc(1,fo,1,1,"transfer-to-b1",26),e.YNc(2,ho,1,1,"transfer-to-s4",26),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.transfareToB1),e.xp6(1),e.Q6J("ngIf",t.transfareToS4)}}let Co=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculationsService=t,this.isLoaded=!1,this.periodCalculationId=0,this.isCofirm=!1,this.transfareToB1=!1,this.transfareToS4=!1,this.backParams={...this.pageParams,parentView:_.S.payment_index}}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.periodCalculationId=Number(t.id)??0})}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(_.S.payment_index,_.S.add_period_calculation)}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getAll()}getAll(){this.periodCalculationsService.getById(this.periodCalculationId).subscribe(t=>{t.message.messageType==p.u.Success?(this.period_calculation=ge(t.data)[0],this.isCofirm=ge(t.data)[0].confirmation,this.isLoaded=!0):this.errorList(t?.message?.messages)})}confirm(){this.showLoading(),this.periodCalculationsService.confirm(this.periodCalculationId).subscribe(t=>{t.message.messageType==p.u.Success?(this.isCofirm=!0,this.hideLoading()):this.errorList(t?.message?.messages)})}globalFunctionActions(t){t.viewName==_.S.transfare_to_b1&&(this.transfareToB1=!this.transfareToB1),t.viewName==_.S.transfare_to_s4&&(this.transfareToS4=!this.transfareToS4)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(R.b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-period-calculation-view"]],features:[e.qOj],decls:17,vars:23,consts:[[1,"title-no-margin","title-section","fixed-title"],[1,"d-inline-block",2,"width","93%",3,"title","parentTitle","parentTitleLink","parentLinkParams","globalFunctions","action"],[1,"d-block",2,"margin-top","-50px",3,"url","params"],[1,"clearfix"],[1,"mt-3"],[1,"mt-2"],["title","generalInfo",1,"stepper-section-title"],[1,"container-fluid","mt-5"],["class","view-data-row-container",4,"ngIf"],[4,"ngIf"],[1,"mtop-15"],[3,"calculationId","isConfirmed"],["class","mtop-15",4,"ngIf"],[1,"view-data-row-container"],[1,"col-12",3,"ngClass"],[1,"row"],["label","paymentDate",1,"mbottom-20","p-0",3,"ngClass","value"],["label","toDate",1,"mbottom-20","p-0",3,"ngClass","value","isDate"],["class","mbottom-20 p-0","label","status","customValue","confirmed",3,"ngClass","value","isBool",4,"ngIf"],["label","LastTransferTob1",1,"mbottom-20","p-0",3,"ngClass","value","isDate","isBool"],["label","LastTransferToS4",1,"mbottom-20","p-0",3,"ngClass","value","isDate","isBool"],["label","notes",1,"mbottom-20","p-0",3,"ngClass","value"],["class","col-lg-3 col-12 mbottom-20 p-0",4,"ngIf"],["label","status","customValue","confirmed",1,"mbottom-20","p-0",3,"ngClass","value","isBool"],[1,"col-lg-3","col-12","mbottom-20","p-0"],["icon","far fa-check-circle","label","calculateAndConfirm",3,"iconPositionBefore","onClick"],[3,"periodCalculationId",4,"ngIf"],[3,"periodCalculationId"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(l){return a.globalFunctionActions(l)}),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"app-back-btn",2),e.qZA(),e._UZ(6,"div",3),e.TgZ(7,"mat-card",4)(8,"mat-card-title",5),e._UZ(9,"page-title",6),e.qZA(),e._UZ(10,"mat-divider",5),e.TgZ(11,"mat-card-content",7),e.YNc(12,_o,10,20,"div",8),e.YNc(13,go,1,0,"app-view-card-row-skeleton",9),e.qZA()(),e.TgZ(14,"div",10),e._UZ(15,"app-add-period-calc-results",11),e.qZA(),e.YNc(16,bo,3,2,"div",12)),2&t&&(e.xp6(1),e.hYB("title","",e.lcZ(2,17,"periodCalculation")," ",null==a.period_calculation?null:a.period_calculation.paymentDate,""),e.cQ8("parentTitle","",e.lcZ(3,19,"payroll")," / ",e.lcZ(4,21,"payments")," / ",a.msgTranslate(null==a.period_calculation||null==a.period_calculation.pay_Payment?null:a.period_calculation.pay_Payment.ar_Name,null==a.period_calculation||null==a.period_calculation.pay_Payment?null:a.period_calculation.pay_Payment.en_Name),""),e.hYB("parentTitleLink","/payroll/",a.moduleId,"/payments/view/",null==a.period_calculation?null:a.period_calculation.payment_ID,""),e.Q6J("parentLinkParams",a.backParams)("globalFunctions",a.subGlobalFunctions),e.xp6(4),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",null==a.period_calculation?null:a.period_calculation.payment_ID,""),e.Q6J("params",a.backParams),e.xp6(7),e.Q6J("ngIf",a.isLoaded),e.xp6(1),e.Q6J("ngIf",!a.isLoaded),e.xp6(2),e.Q6J("calculationId",a.periodCalculationId)("isConfirmed",a.isCofirm),e.xp6(1),e.Q6J("ngIf",a.isCofirm))},dependencies:[u.mk,u.O5,x.a,T.p,b.T,U.l,$.I,c.a8,c.dn,c.n5,v.d,Qe,be,Ce,I.X$],styles:[".fixed-title[_ngcontent-%COMP%]{padding-bottom:20px!important}"]}),o})();var vo=s(25785),Fe=s(92393);function yo(o,i){if(1&o&&(e.TgZ(0,"div",13),e._UZ(1,"app-radio-button",14),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.transferType)("radioList",t.radioList)("submitted",t.submitted)}}function Io(o,i){if(1&o&&e._UZ(0,"transfer-to-b1",15),2&o){const t=e.oxw();e.Q6J("periodCalculationId",t.calculationId)}}function To(o,i){if(1&o&&e._UZ(0,"transfer-to-s4",15),2&o){const t=e.oxw();e.Q6J("periodCalculationId",t.calculationId)}}let wo=(()=>{class o extends h.U{constructor(t){super(),this.periodCalculationsService=t,this.completed=new e.vpe,this.confirmed=new e.vpe,this.submitted=!1,this.isConfirmed=!1,this.isResultsSended=!1}ngOnInit(){this.form=this.fb.group({id:[this.calculationId,{nonNullable:!0}],confirmed:[!1],sendResults:[null],transferType:[null]})}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(_.S.payment_index,_.S.add_period_calculation),this.changeRadioList()}get formCtrls(){return this.form.controls}confirm(){this.calculationId>0?this.isConfirmed?this.formCtrls.confirmed.setValue(!0):(this.showLoading(),this.periodCalculationsService.confirm(this.calculationId).subscribe(t=>{t.message.messageType==p.u.Success?(this.isConfirmed=!0,this.changeRadioList(),this.hideLoading(),this.addSuccessfullyMsg("calculationResultsConfirmed"),this.completed.emit(!0),this.confirmed.emit(!0)):(this.errorList(t?.message?.messages),this.formCtrls.confirmed.setValue(!1))})):this.formCtrls.confirmed.setValue(!1)}sendResultsToSuccessFactor(){if(this.calculationId>0)if(this.isResultsSended)this.formCtrls.sendResults.setValue(!0);else{let t={PeriodCalculation_ID:this.calculationId};this.showLoading(),this.periodCalculationsService.SendPeriodCalculationToSuccessFactor(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.hideLoading(),this.isResultsSended=!0,this.addSuccessfullyMsg("resultsSentToSuccessFactors")):(this.errorList(a?.message?.messages),this.formCtrls.sendResults.setValue(!1))})}else this.formCtrls.sendResults.setValue(!1)}clearForm(){this.form.reset(),this.submitted=!1}changeRadioList(){this.radioList=[],this.subGlobalFunctions?.findIndex(t=>t.viewName==_.S.transfare_to_b1)>-1&&this.radioList.push({value:1,label:"SAPB1J/ETransfer",disabled:!this.isConfirmed}),this.subGlobalFunctions?.findIndex(t=>t.viewName==_.S.transfare_to_s4)>-1&&this.radioList.push({value:2,label:"SAPS4J/ETransfer",disabled:!this.isConfirmed}),1==this.radioList.length&&this.formCtrls.transferType.setValue(this.radioList[0].value)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(R.b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-period-calc-transfer-to-b1-or-s4"]],inputs:{calculationId:"calculationId"},outputs:{completed:"completed",confirmed:"confirmed"},features:[e.qOj],decls:15,vars:9,consts:[[1,"transfer-actions-card"],[1,"title-no-margin"],["title","actions",1,"stepper-section-title"],[1,"mt-2"],[1,"clearfix"],[1,"mtop-40"],[3,"formGroup"],[1,"row"],[1,"col-12","mtop-10",3,"ngClass"],["labelPosition","before","label","confirmCalculationResults",3,"control","onChange"],["class","col-lg-6 col-md-8 col-12",4,"ngIf"],["labelPosition","before","label","sendResultsToSuccessFactors",3,"control","disable","onChange"],[3,"periodCalculationId",4,"ngIf"],[1,"col-lg-6","col-md-8","col-12"],["label","integrationType",3,"control","radioList","submitted"],[3,"periodCalculationId"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title",1),e._UZ(2,"page-title",2),e.qZA(),e._UZ(3,"mat-divider",3)(4,"div",4),e.TgZ(5,"mat-card-content",5)(6,"form",6)(7,"div",7)(8,"div",8)(9,"app-check-box",9),e.NdJ("onChange",function(){return a.confirm()}),e.qZA()(),e.YNc(10,yo,2,3,"div",10),e.TgZ(11,"div",8)(12,"app-check-box",11),e.NdJ("onChange",function(){return a.sendResultsToSuccessFactor()}),e.qZA()()()()()(),e.YNc(13,Io,1,1,"transfer-to-b1",12),e.YNc(14,To,1,1,"transfer-to-s4",12)),2&t&&(e.xp6(6),e.Q6J("formGroup",a.form),e.xp6(2),e.Q6J("ngClass",(null==a.radioList?null:a.radioList.length)>0?"col-lg-3 col-md-4":"col-md-6"),e.xp6(1),e.Q6J("control",a.formCtrls.confirmed),e.xp6(1),e.Q6J("ngIf",(null==a.radioList?null:a.radioList.length)>0),e.xp6(1),e.Q6J("ngClass",(null==a.radioList?null:a.radioList.length)>0?"col-lg-3 col-md-4":"col-md-6"),e.xp6(1),e.Q6J("control",a.formCtrls.sendResults)("disable",!a.isConfirmed),e.xp6(1),e.Q6J("ngIf",1==a.formCtrls.transferType.value&&a.isConfirmed),e.xp6(1),e.Q6J("ngIf",2==a.formCtrls.transferType.value&&a.isConfirmed))},dependencies:[u.mk,u.O5,Fe._,ie.u,b.T,c.a8,c.dn,c.n5,v.d,r._Y,r.JL,r.sg,be,Ce]}),o})();const So=["stepper"];function Zo(o,i){if(1&o&&e._UZ(0,"app-add-new-btn",3),2&o){const t=e.oxw();e.hYB("url","/payroll/",t.moduleId,"/payments/period-calculation/add/",t.paymentId,""),e.Q6J("params",t.parentParam)}}function Ao(o,i){1&o&&e._UZ(0,"i",17)}function xo(o,i){1&o&&e._UZ(0,"i",17)}function Po(o,i){1&o&&e._UZ(0,"i",17)}let Ue=(()=>{class o extends h.U{constructor(t,a){super(),this.periodCalculationsService=t,this.paymentService=a,this.calculationId=0,this.paymentId=0,this.isGeneraCompleted=!1,this.isCalculationResultsCompleted=!1,this.isTransferCompleted=!1,this.isConfirmed=!1}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.calculationId=Number(t.id??0),this.paymentId=Number(t.paymentId??0)}),this.backParams={parentView:this.viewsManager.payment_index,...this.parentModuleIdParam}}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&(this.paymentId>0&&this.getPaymentName(),this.calculationId>0&&this.getById())}getById(){this.periodCalculationsService.getById(this.calculationId).subscribe(t=>{t.message.messageType==p.u.Success?(this.periodCalculation=t.data[0],this.periodCalculation?.is_Confirm?this.router.navigate([`payroll/${this.moduleId}/payments/period-calculation/view`,this.calculationId]):this.paymentId=t.data[0].pay_Payment.id,this.payment=this.periodCalculation.pay_Payment):this.errorList(t?.message?.messages)})}getPaymentName(){this.paymentService.getById(this.paymentId).subscribe(t=>{t.message.messageType==p.u.Success?this.payment=t.data[0]:this.errorList(t?.message?.messages)})}stepChanged(){this.stepper.selected.interacted=!1,1==this.stepper.selectedIndex&&this.calculationId>0&&(this.isCalculationResultsCompleted=!0)}getCalculationId(t){this.calculationId=t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(R.b),e.Y36(O.t))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-period-calculation-core"]],viewQuery:function(t,a){if(1&t&&e.Gf(So,5),2&t){let n;e.iGM(n=e.CRH())&&(a.stepper=n.first)}},features:[e.qOj],decls:33,vars:48,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addpPeriodCalculation","title","add",3,"id","parentTitle","parentTitleLink","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"has-fixed-title"],[3,"linear","disableRipple","selectionChange"],["stepper",""],[3,"label","completed"],["matStepperIcon","edit"],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],[1,"mt-2"],[1,"clearfix"],[3,"paymentId","periodCalculation","completed","changeCalculationId"],[3,"calculationId","isConfirmed"],[3,"calculationId","completed","confirmed"],[3,"stepper","parentParam","url","pageParams"],[1,"fas","fa-check"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ALo(4,"translate"),e.ynx(5),e.YNc(6,Zo,1,3,"app-add-new-btn",2),e._UZ(7,"app-back-btn",3),e.BQk(),e.qZA(),e.ynx(8),e.TgZ(9,"mat-card-content",4)(10,"mat-stepper",5,6),e.NdJ("selectionChange",function(){return a.stepChanged()}),e.TgZ(12,"mat-step",7),e.ALo(13,"titlecase"),e.ALo(14,"translate"),e.YNc(15,Ao,1,0,"ng-template",8),e.TgZ(16,"mat-card")(17,"mat-card-title",9),e._UZ(18,"page-title",10),e.qZA(),e._UZ(19,"mat-divider",11)(20,"div",12),e.TgZ(21,"app-add-period-calc-general-info",13),e.NdJ("completed",function(l){return a.isGeneraCompleted=l})("changeCalculationId",function(l){return a.getCalculationId(l)}),e.qZA()()(),e.TgZ(22,"mat-step",7),e.ALo(23,"titlecase"),e.ALo(24,"translate"),e.YNc(25,xo,1,0,"ng-template",8),e._UZ(26,"app-add-period-calc-results",14),e.qZA(),e.TgZ(27,"mat-step",7),e.ALo(28,"titlecase"),e.ALo(29,"translate"),e.YNc(30,Po,1,0,"ng-template",8),e.TgZ(31,"app-add-period-calc-transfer-to-b1-or-s4",15),e.NdJ("completed",function(l){return a.isTransferCompleted=l})("confirmed",function(){return a.isConfirmed=!0}),e.qZA()()()(),e._UZ(32,"steps-footer",16),e.BQk()),2&t){const n=e.MAs(11);e.xp6(1),e.FAE("parentTitle","",e.lcZ(2,30,"payroll")," / ",e.lcZ(3,32,"payments")," / ",a.msgTranslate(null==a.payment?null:a.payment.ar_Name,null==a.payment?null:a.payment.en_Name)," / ",e.lcZ(4,34,"periodCalculations"),""),e.hYB("parentTitleLink","/payroll/",a.moduleId,"/payments/view/",null==a.payment?null:a.payment.id,""),e.Q6J("id",0)("parentLinkParams",a.backParams),e.xp6(5),e.Q6J("ngIf",a.calculationId>0),e.xp6(1),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",a.paymentId,""),e.Q6J("params",a.backParams),e.xp6(3),e.Q6J("linear",!1)("disableRipple",!0),e.xp6(2),e.s9C("label",e.lcZ(13,36,e.lcZ(14,38,"generalInfo"))),e.Q6J("completed",a.isGeneraCompleted),e.xp6(9),e.Q6J("paymentId",a.paymentId)("periodCalculation",a.periodCalculation),e.xp6(1),e.s9C("label",e.lcZ(23,40,e.lcZ(24,42,"calculationResults"))),e.Q6J("completed",a.isCalculationResultsCompleted),e.xp6(4),e.Q6J("calculationId",a.calculationId)("isConfirmed",a.isConfirmed),e.xp6(1),e.s9C("label",e.lcZ(28,44,e.lcZ(29,46,"transferToB1OrS4"))),e.Q6J("completed",a.isTransferCompleted),e.xp6(4),e.Q6J("calculationId",a.calculationId),e.xp6(1),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",a.paymentId,""),e.Q6J("stepper",n)("parentParam",a.parentParam)("pageParams",a.backParams)}},dependencies:[u.O5,x.a,Q.J,b.T,ne.j,c.a8,c.dn,c.n5,v.d,Z.C0,Z.Vq,Z.z9,vo.P,Qe,wo,u.rS,I.X$]}),o})();function W(o){return o.map(i=>{const t=i?.paY_loan?.paY_Loan_Detail.filter(n=>null===n.periodCalculation_ID&&!n.isPostponed).length,a=i?.paY_loan?.paY_Loan_Detail?.filter(n=>!n.isPostponed).length;return{...i,id:i?.loan_ID,employeeCode:i?.core_Person_Instance?.core_Person?.code,employeeName:(0,m._f)(i?.core_Person_Instance?.core_Person?.ar_Name,i?.core_Person_Instance?.core_Person?.en_Name),loanType:(0,m._f)(i?.paY_loan?.paY_Loan_TYPE?.ar_Name,i?.paY_loan?.paY_Loan_TYPE?.en_Name),payment:(0,m._f)(i?.paY_loan?.paY_Payment?.ar_Name,i?.paY_loan?.paY_Payment?.en_Name),dueDate:m.M6.mapDate(i?.paY_loan?.dueDate,"dd/MM/yyyy"),issueDate:m.M6.mapDate(i?.paY_loan?.issueDate,"dd/MM/yyyy"),loan_Value:i?.paY_loan?.loan_Value,installmentNO:a,RemInstallments:t,balance:Math.round(i?.paY_loan?.paY_Loan_Detail?.filter(n=>null===n.periodCalculation_ID).reduce((n,l)=>n+l.installment_Value,0)),statusRemInstallments:i?.paY_loan?.isCanceled?'<span class="badge-danger">canceled</span>':t>0?t:'<span class="badge-danger">completed</span>',variable:(0,m._f)(i?.paY_loan?.paY_Variable?.arName,i?.paY_loan?.paY_Variable?.name),interval_type:(0,m._f)(i?.paY_loan?.installmentInterval?.ar_Name,i?.paY_loan?.installmentInterval?.en_Name),canEdit:i?.paY_loan?.paY_Loan_Detail.filter(n=>null!=n.periodCalculation_ID)?.length<=0||!i}})}var ee=s(10629);let Do=(()=>{class o extends h.U{constructor(t){super(),this.loansService=t,this.isLoaded=!1,this.mandatoryColomns=["Ser","id","employeeCode","employeeName","loanType","dueDate","loan_Value","balance","statusRemInstallments","actions"],this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a),this.removePageParams(),this.loansService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(l.message.messageType==p.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);const d=W(l.data);d.map(C=>{C.statusRemInstallments=C?.paY_loan?.isCanceled?`<span class="badge-danger">${this.languageService.translate("canceled")}</span>`:C.RemInstallments>0?C.RemInstallments:`<span class="badge-secondary"> ${this.languageService.translate("completed")}</span>`}),this.dataSource=new f.by(d),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.core_Person_Instance?.core_Person?.ar_Name,t.core_Person_Instance?.core_Person?.en_Name);this.deleteDialog(a).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.loansService.Delete(t.loan_ID).subscribe(a=>{a.message.messageType==p.u.Success?(this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize),this.deleteSuccessfullyMsg("loanRemoved")):this.errorList(a?.message?.messages),this.hideLoading()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ee.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-loans-index"]],features:[e.qOj],decls:5,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","loans","parentTitle","payroll","TitleHasGlobalFunc","",3,"globalFunctions"],[1,"index-card"],[3,"isRowClickable","isLoaded","mandatoryColomns","optionalColomns","page","actions","dataSource","exportService","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"mat-card",2)(3,"mat-card-content")(4,"app-material-table",3),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return a.onDelete(l)}),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(3),e.Q6J("isRowClickable",!0)("isLoaded",a.isLoaded)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("actions",a.rowFunctions)("dataSource",a.dataSource)("exportService",a.loansService))},dependencies:[S.I,b.T,pe.X,c.a8,c.dn,c.n5]}),o})();var Vo=s(37350),Re=s(70502),Ye=s(11526),No=s(33394),Jo=s(79033),ko=s(66860);function Qo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"h4"),e._UZ(1,"page-title",15),e.TgZ(2,"close-dialog-btn",16),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.dialogRef.close())}),e.qZA()()}}function Go(o,i){if(1&o&&e._UZ(0,"due-dates-dropdown",17),2&o){const t=e.oxw();e.Q6J("control",t.formCtrls.dueDate)("paymentControl",t.formCtrls.payment_ID)("issueDateControl",t.formCtrls.issueDate)("submitted",t.submitted)("disable",!t.canEdit)}}function qo(o,i){if(1&o&&e._UZ(0,"app-input",18),2&o){const t=e.oxw();e.Q6J("control",t.formCtrls.dueDate)("disabled",!0)}}function Fo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"reset-form-btn",22),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.clearForm())}),e.qZA()}}function Uo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-card-actions",19),e.YNc(1,Fo,1,0,"reset-form-btn",20),e.TgZ(2,"submit-btn",21),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0==t.formCtrls.id.value),e.xp6(1),e.Q6J("id",t.formCtrls.id.value)("color",t.btn.darkBlue)("iconPositionBefore",!1)}}let Ee=(()=>{class o extends h.U{constructor(t,a,n){super(),this.loansService=t,this.data=a,this.dialogRef=n,this.isView=!1,this.completed=new e.vpe,this.closeAfterUpdate=new e.vpe,this.changeLoanId=new e.vpe,this.submitted=!1,this.loanId=0,this.canEdit=!0,this.activatedRoute.params.subscribe(l=>{this.loanId=Number(l.id??0)})}ngOnInit(){this.loan=this.loansService.getLoan(),this.form=this.fb.group({id:[this.loanId,{nonNullable:!0}],personInstantID:[null,r.kI.required],payment_ID:[null,[r.kI.required]],issueDate:[null,[r.kI.required,P.dN.date]],dueDate:[null,[r.kI.required,P.dN.date]],interval_Type_ID:[null,[r.kI.required]],loan_Type_ID:[null,[r.kI.required]],variableId:[null],selectedIntervalType:[null]},{validators:j.w.compareDates("issueDate","dueDate")}),this.loansService.loan$.subscribe(t=>{t&&t!=this.loan&&this.putDataInForm(t)})}onChangeBusinessAndCompanyId(){this.loanId>0&&this.checkNoBusinessOrCompany()&&this.GetById()}get formCtrls(){return this.form.controls}submit(){if(this.submitted=!0,this.form.valid){let t={personInstantID:this.formCtrls.personInstantID.value,pAY_loan:{id:this.formCtrls.id.value,payment_ID:this.formCtrls.payment_ID.value,issueDate:m.M6.mapDateReverse(this.formCtrls.issueDate.value),dueDate:m.M6.mapDateReverse(this.formCtrls.dueDate.value),interval_Type_ID:this.formCtrls.interval_Type_ID.value,loan_Type_ID:this.formCtrls.loan_Type_ID.value,variableId:this.formCtrls.variableId.value}};0==t.pAY_loan?.id?this.create(t):this.update(t)}}GetById(t=!1){this.loan&&!t?this.putDataInForm(this.loan):(this.showLoading(),this.loansService.getById(this.loanId).subscribe(a=>{if(a.message.messageType==p.u.Success){let n=W(a.data)[0];this.putDataInForm(n),this.loansService.setLoan(n)}else this.errorList(a?.message?.messages);this.hideLoading()}))}putDataInForm(t){this.form.patchValue(t?.paY_loan),this.formCtrls.personInstantID.setValue(t?.person_Instance_ID),this.formCtrls.loan_Type_ID.setValue(t?.paY_loan?.paY_Loan_TYPE?.id),this.formCtrls.payment_ID.setValue(t?.paY_loan?.payment_ID),this.formCtrls.issueDate.setValue(t?.paY_loan?.issueDate),this.canEdit=t?.canEdit,this.formCtrls.variableId.setValue(t?.paY_loan?.variableId),setTimeout(()=>{this.formCtrls.dueDate.setValue(this.datePipe.transform(t?.paY_loan?.dueDate,"M/d/yyyy h:mm:ss a"))},500)}create(t){this.showLoading(),this.loansService.create(t).subscribe(a=>{if(a?.message?.messageType==p.u.Success){this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newLoanAdded"),this.loanId=a.data.id,this.formCtrls.id.setValue(this.loanId),this.changeLoanId.emit(this.loanId);let n=`/payroll/${this.moduleId}/loans/edit/${this.loanId}`;this.data.isDialog||(this.navigateTo(n),this.GetById(!0)),this.data.isDialog&&this.dialogRef.close(),this.completed.emit(!0)}else this.errorList(a?.message?.messages);this.hideLoading()})}update(t){this.showLoading(),this.loansService.update(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.updateSuccessfullyMsg("loanUpdated"),this.completed.emit(!0),this.closeAfterUpdate.emit(!0),this.GetById(!0)):this.errorList(a?.message?.messages),this.hideLoading()})}getIntervalType(t){if(t?.length>0){let a=t[0];this.formCtrls.interval_Type_ID.setValue(a.intervaL_TYPE_ID),this.formCtrls.selectedIntervalType.setValue((0,m._f)(a.pay_Interval_Type.ar_Name,a.pay_Interval_Type.en_Name))}}clearForm(){this.form.reset(),this.submitted=!1}ngOnDestroy(){this.isView||this.loansService.setLoan(null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ee.x),e.Y36(g.WI),e.Y36(g.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-loan-general-data"]],inputs:{isView:"isView"},outputs:{completed:"completed",closeAfterUpdate:"closeAfterUpdate",changeLoanId:"changeLoanId"},features:[e.qOj],decls:22,vars:26,consts:[[4,"ngIf"],[1,"container-fluid","mtop-40"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","submitted","disabled"],[3,"control","employeeControl","submitted","disable","change"],[3,"control","submitted","disable"],["label","issueDate",3,"control","submitted","disable"],[3,"control","paymentControl","issueDateControl","submitted","disable",4,"ngIf"],["label","dueDate",3,"control","disabled",4,"ngIf"],["label","interval_type",3,"control","disabled"],[3,"control","paymentControl","LoneTypeControl","PersonInstanceControl","submitted","disable"],["align","end","class","mb-0",4,"ngIf"],["title","loans","styleClass","main-color"],[1,"main-color","float-right",3,"click"],[3,"control","paymentControl","issueDateControl","submitted","disable"],["label","dueDate",3,"control","disabled"],["align","end",1,"mb-0"],[3,"click",4,"ngIf"],["icon","pi pi-plus-circle",3,"id","color","iconPositionBefore","onClick"],[3,"click"]],template:function(t,a){1&t&&(e.YNc(0,Qo,3,0,"h4",0),e.TgZ(1,"mat-card-content",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",2)(6,"div",5),e._UZ(7,"app-employee-dropdown",6),e.qZA(),e.TgZ(8,"div",5)(9,"employee-payments-dropdown",7),e.NdJ("change",function(l){return a.getIntervalType(l)}),e.qZA()(),e.TgZ(10,"div",5),e._UZ(11,"app-loan-types-dropdown",8),e.qZA(),e.TgZ(12,"div",5),e._UZ(13,"app-datepicker",9),e.qZA(),e.TgZ(14,"div",5),e.YNc(15,Go,1,5,"due-dates-dropdown",10),e.YNc(16,qo,1,2,"app-input",11),e.qZA(),e.TgZ(17,"div",5),e._UZ(18,"app-input",12),e.qZA(),e.TgZ(19,"div",5),e._UZ(20,"variable-by-employee-an-payment",13),e.qZA()()()()()(),e.YNc(21,Uo,3,4,"mat-card-actions",14)),2&t&&(e.Q6J("ngIf",a.data.isDialog),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.personInstantID)("submitted",a.submitted)("disabled",!a.canEdit),e.xp6(2),e.Q6J("control",a.formCtrls.payment_ID)("employeeControl",a.formCtrls.personInstantID)("submitted",a.submitted)("disable",!a.canEdit),e.xp6(2),e.Q6J("control",a.formCtrls.loan_Type_ID)("submitted",a.submitted)("disable",!a.canEdit),e.xp6(2),e.Q6J("control",a.formCtrls.issueDate)("submitted",a.submitted)("disable",!a.canEdit),e.xp6(2),e.Q6J("ngIf",a.canEdit),e.xp6(1),e.Q6J("ngIf",!a.canEdit),e.xp6(2),e.Q6J("control",a.formCtrls.selectedIntervalType)("disabled",!0),e.xp6(2),e.Q6J("control",a.formCtrls.variableId)("paymentControl",a.formCtrls.payment_ID)("LoneTypeControl",a.formCtrls.loan_Type_ID)("PersonInstanceControl",a.formCtrls.personInstantID)("submitted",a.submitted)("disable",!a.canEdit),e.xp6(1),e.Q6J("ngIf",a.canEdit))},dependencies:[u.O5,G.Q,J.a,_e.J,T.p,b.T,Vo._,Re.J,c.dn,c.hq,Ye.r,No.n,Jo.J,ko.E,r._Y,r.JL,r.sg]}),o})();function Me(o){if(null===o||!0===o||!1===o)return NaN;var i=Number(o);return isNaN(i)?i:i<0?Math.ceil(i):Math.floor(i)}var Ro=s(80953),Be=s(40833);function Oe(o,i){(0,Be.Z)(2,arguments);var t=(0,Ro.Z)(o),a=Me(i);if(isNaN(a))return new Date(NaN);if(!a)return t;var n=t.getDate(),l=new Date(t.getTime());l.setMonth(t.getMonth()+a+1,0);var d=l.getDate();return n>=d?l:(t.setFullYear(l.getFullYear(),l.getMonth(),n),t)}var Eo=s(74596),Mo=s(71812);function Bo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"slide-toggle",15),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.toggleAll(n.formCtrls.closeAll.value))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("control",t.formCtrls.closeAll)("withSmallBall",!0)}}function Oo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.isViewUpdate=!0)}),e._UZ(1,"i",18),e.qZA()}}function jo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.isViewUpdate=!1,e.KtG(n.putDataInForm())}),e._UZ(1,"i",19),e.qZA()}}function zo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Oo,2,0,"button",16),e.YNc(2,jo,2,0,"button",16),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isViewUpdate),e.xp6(1),e.Q6J("ngIf",t.isViewUpdate)}}function Ho(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-button",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.generateNewInstallmentDate())}),e.qZA(),e.TgZ(2,"app-button",21),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteLastInstallmentForm())}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("color",t.btn.darkBlue)("iconPositionBefore",!1)("isRaisedBtn",!0),e.xp6(1),e.Q6J("color",t.btn.darkRed)("iconPositionBefore",!1)("isRaisedBtn",!0)}}function Ko(o,i){if(1&o&&(e.TgZ(0,"div",24),e._UZ(1,"app-view-data-row-item",25)(2,"app-view-data-row-item",26)(3,"app-view-data-row-item",27),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("value",null==t.loan||null==t.loan.paY_loan?null:t.loan.paY_loan.loan_Value),e.xp6(1),e.Q6J("value",null==t.loan?null:t.loan.installmentNO),e.xp6(1),e.Q6J("value",t.loan.balance)}}function $o(o,i){1&o&&e._UZ(0,"app-view-card-row-skeleton")}function Xo(o,i){if(1&o&&(e.TgZ(0,"div",22),e.YNc(1,Ko,4,3,"div",23),e.YNc(2,$o,1,0,"app-view-card-row-skeleton",4),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}function Wo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",29)(2,"app-input",30),e.NdJ("Focus",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.onFocusLoanValue(n))})("Blur",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.generateInstallments())}),e.qZA()(),e.TgZ(3,"div",29)(4,"app-input",31),e.NdJ("Focus",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.onFocusInstallmentNo(n))})("Blur",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.generateInstallments())}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("control",t.formCtrls.loan_value)("submitted",t.submitted)("readonly",t.loan&&!t.loan.canEdit),e.xp6(2),e.Q6J("control",t.formCtrls.installmentNO)("submitted",t.submitted)("readonly",!t.isGenerateMode)}}function en(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"slide-toggle",41),e.NdJ("onChange",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.changeCloseAllToggle())}),e.qZA()}if(2&o){const t=e.oxw(2).$implicit;e.Q6J("control",t.controls.isClosed)("withSmallBall",!0)("label",t.controls.isClosed.value?"locked":"lock")("isLabelTop",!0)}}function tn(o,i){if(1&o&&(e.TgZ(0,"div",42),e._UZ(1,"img",43),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.svg.check_green,e.LSH),e.xp6(1),e.hij(" ",e.lcZ(3,2,"paid")," ")}}function an(o,i){if(1&o&&(e.TgZ(0,"div",44),e._UZ(1,"img",45),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("src",t.svg.time_history_yellow,e.LSH),e.xp6(1),e.hij(" ",e.lcZ(3,2,"postponed")," ")}}function on(o,i){if(1&o&&(e.TgZ(0,"div",34),e.YNc(1,en,1,4,"slide-toggle",38),e.YNc(2,tn,4,4,"div",39),e.YNc(3,an,4,4,"div",40),e.qZA()),2&o){const t=e.oxw().$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",(!a.isView||a.isViewUpdate)&&!t.controls.isPaid.value&&!t.controls.isPostponed.value&&!a.isAdjust),e.xp6(1),e.Q6J("ngIf",t.controls.isPaid.value),e.xp6(1),e.Q6J("ngIf",t.controls.isPostponed.value)}}function nn(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",32)(2,"form",33)(3,"div",28)(4,"div",34),e._UZ(5,"app-datepicker",35),e.qZA(),e.TgZ(6,"div",34),e._UZ(7,"app-input",36),e.qZA(),e.YNc(8,on,4,3,"div",37),e.qZA()()(),e.BQk()),2&o){const t=i.$implicit,a=i.index,n=e.oxw();e.xp6(2),e.Q6J("formGroupName",a),e.xp6(1),e.ekj("justify-content-end",!t.controls.isPaid.value&&n.isAdjust),e.xp6(2),e.Q6J("control",t.controls.date)("submitted",n.submitted)("disable",t.controls.isClosed.value)("readonly",!0),e.xp6(2),e.Q6J("control",t.controls.value)("submitted",n.submitted)("disabled",t.controls.isClosed.value),e.xp6(1),e.Q6J("ngIf",t.controls.isPaid.value||!n.isAdjust)}}function ln(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-card-actions",46)(1,"submit-btn",47),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submit())}),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("color",t.btn.darkBlue)("icon",t.isAdjust?"far fa-check-circle":"fas fa-sync-alt")("iconPositionBefore",!1)("label",t.isAdjust?"adjust":"updateInsValues")("disabled",0==t.installmentsArr.length)}}let je=(()=>{class o extends h.U{constructor(t){super(),this.loansService=t,this.completed=new e.vpe,this.submitted=!1,this.isView=!1,this.isAdjust=!1,this.changeIsAdjust=new e.vpe,this.isViewUpdate=!1,this.isLoaded=!1,this.isGenerateMode=!0,this.svg=new le.El,this.constants=N.g}ngOnInit(){this.form=this.fb.group({id:[this.loanId,{nonNullable:!0}],installmentNO:[null,[r.kI.required,P.dN.gt(0)]],loan_value:[null,[r.kI.required,P.dN.gt(0)]],closeAll:[!0],installments:this.fb.array([])}),this.loan=this.loansService.getLoan(),this.loansService.loan$.subscribe(t=>{this.isGenerateMode=!(t?.installmentNO>0),this.loan=t,t&&(this.isLoaded=!0,this.putDataInForm())})}get formCtrls(){return this.form.controls}get installmentsArr(){return this.form.controls.installments}installmentFormCtrls(t){return this.installmentsArr.controls[t].controls}putDataInForm(){this.formCtrls.installmentNO.setValue(0==this.loan?.installmentNO?null:this.loan?.installmentNO),this.formCtrls.loan_value.setValue(this.loan?.paY_loan?.loan_Value),this.formCtrls.installmentNO.value||this.clearForm(),this.putInstallmentsInForm(this.loan.paY_loan?.paY_Loan_Detail)}putInstallmentsInForm(t){t.sort((a,n)=>new Date(a.due_Date).getTime()-new Date(n.due_Date).getTime()),this.installmentsArr.clear(),t.forEach(a=>{this.addInstallmentForm(a)})}toggleAll(t){this.filterUnPaidArrControls().forEach(a=>{a.controls.isClosed.setValue(t)})}filterUnPaidArrControls(){return this.installmentsArr.controls.filter(t=>!t.controls.isPaid.value&&!t.controls.isPostponed.value)}changeCloseAllToggle(){let t=!0;t=this.filterUnPaidArrControls().some(a=>a.controls.isClosed.value),this.formCtrls.closeAll.setValue(t)}currentTotalAmount(){return this.installmentsArr.getRawValue().reduce((a,{value:n})=>a+Number(n),0)}generateNewInstallmentDate(){let t;this.loan?.paY_loan?.paY_Payment?.intervaL_TYPE_ID==this.constants.interval_type_monthly?t=Oe(new Date(this.loan?.paY_loan?.dueDate),this.installmentsArr.length*this.loan?.paY_loan?.paY_Payment?.interval):this.loan?.paY_loan?.paY_Payment?.intervaL_TYPE_ID==this.constants.interval_type_yearly&&(t=function Yo(o,i){(0,Be.Z)(2,arguments);var t=Me(i);return Oe(o,12*t)}(new Date(this.loan?.paY_loan?.dueDate),this.installmentsArr.length*this.loan?.paY_loan?.paY_Payment?.interval));let a=this.fb.group({date:[t,[r.kI.required]],value:[0,[r.kI.required,P.dN.gte(0)]],isClosed:[!1],isPaid:[!1],periodCalculation_ID:[null],isPostponed:[!1]});this.installmentsArr.push(a),this.formCtrls.installmentNO.setValue(this.getCurrentInstallmentsNo())}getCurrentInstallmentsNo(){return this.installmentsArr.controls.filter(t=>!t.controls.isPostponed.value).length}addInstallmentForm(t){let a=this.fb.group({date:[t.due_Date,[r.kI.required]],value:[t.installment_Value,[r.kI.required,P.dN.gte(0)]],isClosed:[!t.isOpened],isPaid:[t.periodCalculation_ID>0],periodCalculation_ID:[t.periodCalculation_ID],isPostponed:[t.isPostponed]});this.installmentsArr.push(a)}deleteLastInstallmentForm(){if(this.installmentsArr.length>1){let t=!1;for(let a=this.installmentsArr.length-1;a>=0;a--)if(!this.installmentsArr.at(a).get("isPaid")?.value&&!this.installmentsArr.at(a).get("isPostponed")?.value){this.installmentsArr.removeAt(a),this.formCtrls.installmentNO.setValue(this.getCurrentInstallmentsNo()),t=!0;break}t||this.warning("thereIsNoUnPaidInstallmentsToDelete")}else this.warning("mustHaveAtLeastOneInstallment")}submit(){if(this.submitted=!0,this.form.valid){if(this.currentTotalAmount()!=this.formCtrls.loan_value.value){let a=this.installmentsArr.controls.filter(d=>!d.controls.isClosed.value);if(0==a.length)return void this.warning("openAtLeastOneInstallmentFormOrAddNewOne");let n=this.formCtrls.loan_value.value-this.currentTotalAmount(),l=n/a.length;if(n>0)a.forEach(d=>{d.controls.value.setValue(d.controls.value.value+l)});else{if(l=Math.abs(l),n=Math.abs(n),a.reduce((A,te)=>A+Number(te.controls.value.value),0)<n)return void this.warning("openMoreInstallmentForm");let C=a.length;for(;n>0&&C>0;)l=n/C,a.forEach(A=>{let te=A.controls.value.value;te<=l?(n-=te,A.controls.value.setValue(0),C--):(A.controls.value.setValue(te-l),n-=l)})}}let t={pAY_loan:{id:this.loanId,Loan_Value:this.formCtrls.loan_value.value},pAY_Loan_Details:[]};this.installmentsArr.controls.map(a=>{let n=a.getRawValue();n.isPostponed||t.pAY_Loan_Details.push({installment_Value:n.value??0,due_Date:m.M6.mapDateReverse(n.date),periodCalculation_ID:n.periodCalculation_ID})}),this.showLoading(),this.loansService.updateInstallments(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.updateSuccessfullyMsg("installmentUpdated"),this.isViewUpdate=!1,this.completed.emit(!0),this.isGenerateMode=!1,this.toggleAll(!0),this.loan.paY_loan.loan_Value=a.data?.loan_Value,this.loan.paY_loan.paY_Loan_Detail=a.data?.paY_Loan_Detail,this.loan.installmentNO=this.getCurrentInstallmentsNo(),this.loan.balance=Math.round(a.data?.paY_Loan_Detail?.filter(n=>null===n.periodCalculation_ID).reduce((n,l)=>n+l.installment_Value,0)),this.loansService.setLoan(this.loan)):this.errorList(a?.message?.messages),this.hideLoading()})}}generateInstallments(){if(this.isGenerateMode&&this.formCtrls.loan_value.value&&this.formCtrls.installmentNO.value&&this.loanId>0&&(this.formCtrls.loan_value.value!=this.lastLoanValue||this.formCtrls.installmentNO.value!=this.lastInstallmentNo)){let t={InstallmentNO:this.formCtrls.installmentNO.value,pAY_loan:{id:this.loanId,Loan_Value:this.formCtrls.loan_value.value}};this.showLoading(),this.loansService.generateInstallments(t).subscribe(a=>{this.putInstallmentsInForm(a.data),this.hideLoading()})}}clearForm(){this.form.reset(),this.submitted=!1}onFocusLoanValue(t){this.lastLoanValue=t}onFocusInstallmentNo(t){this.lastInstallmentNo=t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ee.x))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-loan-installments"]],inputs:{loanId:"loanId",isView:"isView",isAdjust:"isAdjust"},outputs:{completed:"completed",changeIsAdjust:"changeIsAdjust"},features:[e.qOj],decls:17,vars:8,consts:[[1,"add-loan-installments"],[1,"title-no-margin"],["title","installments",1,"stepper-section-title"],[3,"control","withSmallBall","onChange",4,"ngIf"],[4,"ngIf"],[1,"mt-2"],[1,"clearfix"],[1,"container-fluid","mtop-40","mb-0"],[3,"formGroup"],["class","mtop-30 mbottom-20",4,"ngIf","ngIfElse"],["inputs",""],[1,"row","justify-content-between"],["formArrayName","installments"],[4,"ngFor","ngForOf"],["align","end","class","mb-0 mx-0 pt-0",4,"ngIf"],[3,"control","withSmallBall","onChange"],["mat-button","","class","float-right section-edit-btn pright-6 pleft-6 darkBlue",3,"click",4,"ngIf"],["mat-button","",1,"float-right","section-edit-btn","pright-6","pleft-6","darkBlue",3,"click"],[1,"fas","fa-pen","font-size-15"],[1,"ft-corner-up-left","font-size-18"],["label","addInstallment","icon","pi pi-plus-circle","styleClass","btn-block float-right installment-btn",3,"color","iconPositionBefore","isRaisedBtn","click"],["label","deleteInstallment","icon","pi pi-trash white","styleClass","btn-block float-right installment-btn",3,"color","iconPositionBefore","isRaisedBtn","click"],[1,"mtop-30","mbottom-20"],["class","view-data-row-container",4,"ngIf"],[1,"view-data-row-container"],["label","loan_value",1,"col-md-4","col-lg-3","col-12","mbottom-20","p-0",3,"value"],["label","installmentNO",1,"col-md-4","col-lg-3","col-12","mbottom-20","p-0",3,"value"],["label","balance",1,"col-md-4","col-lg-3","col-12","mbottom-20","p-0",3,"value"],[1,"row"],[1,"col-md-4","col-lg-3","col-12"],["label","loan_value","type","number",3,"control","submitted","readonly","Focus","Blur"],["label","installmentNO","type","number",3,"control","submitted","readonly","Focus","Blur"],[1,"col-lg-6","col-md-6","col-md-6","col-12"],[3,"formGroupName"],[1,"col-md-4","col-12"],["label","date",3,"control","submitted","disable","readonly"],["label","value","type","number",3,"control","submitted","disabled"],["class","col-md-4 col-12",4,"ngIf"],[3,"control","withSmallBall","label","isLabelTop","onChange",4,"ngIf"],["class","status-label paid",4,"ngIf"],["class","status-label postponed",4,"ngIf"],[3,"control","withSmallBall","label","isLabelTop","onChange"],[1,"status-label","paid"],["width","22",3,"src"],[1,"status-label","postponed"],["width","20",3,"src"],["align","end",1,"mb-0","mx-0","pt-0"],[3,"color","icon","iconPositionBefore","label","disabled","onClick"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title",1),e._UZ(2,"page-title",2),e.YNc(3,Bo,1,2,"slide-toggle",3),e.YNc(4,zo,3,2,"ng-container",4),e.YNc(5,Ho,3,6,"ng-container",4),e.qZA(),e._UZ(6,"mat-divider",5)(7,"div",6),e.TgZ(8,"mat-card-content",7)(9,"form",8),e.YNc(10,Xo,3,2,"div",9),e.YNc(11,Wo,5,6,"ng-template",null,10,e.W1O),e.TgZ(13,"div",11),e.ynx(14,12),e.YNc(15,nn,9,11,"ng-container",13),e.BQk(),e.qZA()()(),e.YNc(16,ln,2,5,"mat-card-actions",14),e.qZA()),2&t){const n=e.MAs(12);e.xp6(3),e.Q6J("ngIf",a.installmentsArr.length>0&&(!a.isView||a.isViewUpdate)&&!a.isAdjust),e.xp6(1),e.Q6J("ngIf",a.isView),e.xp6(1),e.Q6J("ngIf",a.installmentsArr.length>0&&(!a.isView||a.isViewUpdate)&&!a.isAdjust),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("ngIf",a.isView&&!a.isViewUpdate||a.isAdjust)("ngIfElse",n),e.xp6(5),e.Q6J("ngForOf",a.installmentsArr.controls),e.xp6(1),e.Q6J("ngIf",!a.isView||a.isViewUpdate)}},dependencies:[u.sg,u.O5,G.Q,J.a,T.p,b.T,Eo.w,Mo.r,U.l,$.I,V.lW,c.a8,c.dn,c.n5,c.hq,v.d,r._Y,r.JL,r.sg,r.x0,r.CE,r.F,I.X$],styles:[".add-loan-installments .mat-slide-toggle{margin:0 8px}  .add-loan-installments .mat-slide-toggle .mat-slide-toggle-bar{top:2px}  .add-loan-installments .installment-btn{border-radius:5px;width:-moz-fit-content;width:fit-content;padding:0 25px}  .add-loan-installments .status-label{display:flex;align-items:center;flex-wrap:wrap;gap:10px;font-size:16px;min-height:40px;justify-content:flex-start;margin-top:8px}  .add-loan-installments .status-label.paid{color:#258f6e}  .add-loan-installments .status-label.postponed{color:#c7b300}  .add-loan-installments .pi.pi-trash.white{font-weight:400}"]}),o})();const sn=["stepper"];function rn(o,i){if(1&o&&e._UZ(0,"app-add-new-btn",3),2&o){const t=e.oxw();e.MGl("url","/payroll/",t.moduleId,"/loans/add"),e.Q6J("params",t.parentParam)}}function cn(o,i){1&o&&e._UZ(0,"i",18)}function dn(o,i){1&o&&e._UZ(0,"i",18)}let ze=(()=>{class o extends h.U{constructor(){super(),this.isGeneraCompleted=!1,this.isInstallmentsCompleted=!1,this.isTransferCompleted=!1,this.activatedRoute.params.subscribe(t=>{this.loanId=Number(t.id??0)})}ngOnInit(){}stepChanged(){this.stepper.selected.interacted=!1}getLoanId(t){this.loanId=t}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-loan-core"]],viewQuery:function(t,a){if(1&t&&e.Gf(sn,5),2&t){let n;e.iGM(n=e.CRH())&&(a.stepper=n.first)}},features:[e.qOj],decls:28,vars:31,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addLoan","title","add",3,"id","parentTitle","parentTitleLink","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"has-fixed-title"],[3,"linear","disableRipple","selectionChange"],["stepper",""],[3,"label","completed"],["matStepperIcon","edit"],[1,"row"],[1,"col-12"],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],[1,"mt-2"],[1,"clearfix"],[3,"completed","changeLoanId"],[3,"loanId","completed"],[3,"stepper","parentParam","url","pageParams"],[1,"fas","fa-check"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ynx(4),e.YNc(5,rn,1,2,"app-add-new-btn",2),e._UZ(6,"app-back-btn",3),e.BQk(),e.qZA(),e.TgZ(7,"mat-card-content",4)(8,"mat-stepper",5,6),e.NdJ("selectionChange",function(){return a.stepChanged()}),e.TgZ(10,"mat-step",7),e.ALo(11,"titlecase"),e.ALo(12,"translate"),e.YNc(13,cn,1,0,"ng-template",8),e.TgZ(14,"div",9)(15,"div",10)(16,"mat-card")(17,"mat-card-title",11),e._UZ(18,"page-title",12),e.qZA(),e._UZ(19,"mat-divider",13)(20,"div",14),e.TgZ(21,"app-loan-general-data",15),e.NdJ("completed",function(l){return a.isGeneraCompleted=l})("changeLoanId",function(l){return a.getLoanId(l)}),e.qZA()()()()(),e.TgZ(22,"mat-step",7),e.ALo(23,"titlecase"),e.ALo(24,"translate"),e.YNc(25,dn,1,0,"ng-template",8),e.TgZ(26,"app-add-loan-installments",16),e.NdJ("completed",function(l){return a.isInstallmentsCompleted=l}),e.qZA()()()(),e._UZ(27,"steps-footer",17)),2&t){const n=e.MAs(9);e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,19,"payroll")," / ",e.lcZ(3,21,"loans"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/loans"),e.Q6J("id",0)("parentLinkParams",a.pageParams),e.xp6(4),e.Q6J("ngIf",a.loanId>0),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/loans"),e.Q6J("params",a.pageParams),e.xp6(2),e.Q6J("linear",!1)("disableRipple",!0),e.xp6(2),e.s9C("label",e.lcZ(11,23,e.lcZ(12,25,"generalInfo"))),e.Q6J("completed",a.isGeneraCompleted),e.xp6(12),e.s9C("label",e.lcZ(23,27,e.lcZ(24,29,"installments"))),e.Q6J("completed",a.isInstallmentsCompleted),e.xp6(4),e.Q6J("loanId",a.loanId),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/loans"),e.Q6J("stepper",n)("parentParam",a.parentParam)("pageParams",a.pageParams)}},dependencies:[u.O5,x.a,Q.J,b.T,ne.j,c.a8,c.dn,c.n5,v.d,Z.C0,Z.Vq,Z.z9,Ee,je,u.rS,I.X$]}),o})();var pn=s(1421);let mn=(()=>{class o{constructor(t,a){this.data=t,this.languageService=a}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.WI),e.Y36(pn.T))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-cancel-loan-dialog"]],decls:22,vars:26,consts:[["mat-dialog-container","",1,"cancel-dialog"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"interMedium"],["mat-dialog-actions","","align","end"],["mat-raised-button","",1,"btn","btn-grey-border",3,"mat-dialog-close"],["mat-raised-button","",1,"btn","btn-darkRed","m-0",3,"mat-dialog-close"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"p",3),e._uU(7),e.ALo(8,"titlecase"),e.ALo(9,"translate"),e.TgZ(10,"span"),e._uU(11),e.qZA(),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",4)(15,"button",5),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"button",6),e._uU(19),e.ALo(20,"titlecase"),e.ALo(21,"translate"),e.qZA()()()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,10,e.lcZ(4,12,"cancelLoan"))," "),e.xp6(5),e.hij(" ",e.lcZ(8,14,e.lcZ(9,16,"cancel"))," "),e.xp6(4),e.hij(' "',a.data,'"'),e.xp6(1),e.hij("",e.lcZ(13,18,"?")," "),e.xp6(2),e.ekj("flex-row-reverse",a.languageService.isArabic),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.hij(" ",e.lcZ(17,20,"return")," "),e.xp6(2),e.Q6J("mat-dialog-close",!0),e.xp6(1),e.hij(" ",e.lcZ(20,22,e.lcZ(21,24,"cancelLoan"))," "))},dependencies:[V.lW,g.ZT,g.uh,g.xY,g.H8,u.rS,I.X$],styles:[".cancel-dialog[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]:after{width:150%}.cancel-dialog[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-right:30px}"]}),o})();function un(o,i){if(1&o&&(e._UZ(0,"page-title",8),e.ALo(1,"translate"),e.ALo(2,"translate")),2&o){const t=e.oxw();e.hYB("parentTitle","",e.lcZ(1,5,"payroll")," / ",e.lcZ(2,7,"loans"),""),e.MGl("parentTitleLink","/payroll/",t.moduleId,"/loans"),e.Q6J("title",t.msgTranslate(null==t.loan||null==t.loan.core_Person_Instance||null==t.loan.core_Person_Instance.core_Person?null:t.loan.core_Person_Instance.core_Person.ar_Name,null==t.loan||null==t.loan.core_Person_Instance||null==t.loan.core_Person_Instance.core_Person?null:t.loan.core_Person_Instance.core_Person.en_Name)+" - "+t.msgTranslate(null==t.loan||null==t.loan.paY_loan||null==t.loan.paY_loan.paY_Loan_TYPE?null:t.loan.paY_loan.paY_Loan_TYPE.ar_Name,null==t.loan||null==t.loan.paY_loan||null==t.loan.paY_loan.paY_Loan_TYPE?null:t.loan.paY_loan.paY_Loan_TYPE.en_Name))("parentLinkParams",t.pageParams)}}function _n(o,i){if(1&o&&(e._UZ(0,"page-title",9),e.ALo(1,"translate")),2&o){const t=e.oxw();e.Q6J("title",e.lcZ(1,1,"adjust")+" \u201d"+t.msgTranslate(null==t.loan||null==t.loan.core_Person_Instance||null==t.loan.core_Person_Instance.core_Person?null:t.loan.core_Person_Instance.core_Person.ar_Name,null==t.loan||null==t.loan.core_Person_Instance||null==t.loan.core_Person_Instance.core_Person?null:t.loan.core_Person_Instance.core_Person.en_Name)+" - "+t.msgTranslate(null==t.loan?null:t.loan.paY_loan.paY_Loan_TYPE.ar_Name,null==t.loan?null:t.loan.paY_loan.paY_Loan_TYPE.en_Name)+"\u201d")}}function gn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div")(2,"edit-all-btn",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.editAllSections())}),e.qZA(),e._UZ(3,"app-add-new-btn",11)(4,"app-back-btn",11),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(3),e.MGl("url","/payroll/",t.moduleId,"/loans/add"),e.Q6J("params",t.parentParam),e.xp6(1),e.MGl("url","/payroll/",t.moduleId,"/loans/index"),e.Q6J("params",t.pageParams)}}let ve=(()=>{class o extends h.U{constructor(t,a){super(),this.loansService=t,this.dialog=a,this.editAll=!1,this.isAdjust=!1,this.activatedRoute.params.subscribe(n=>{this.loanId=Number(n.id??0)}),this.loanId>0&&this.GetById()}ngOnInit(){}editAllSections(){this.editAll=!this.editAll}globalFunctionActions(t){t.viewName==_.S.cancel_loan?this.openCancelLoanDialog():t.viewName==_.S.loan_adjustment&&(this.isAdjust=!0)}GetById(){this.showLoading(),this.loansService.getById(this.loanId).subscribe(t=>{if(t.message.messageType==p.u.Success){let a=W(t.data)[0];this.loansService.setLoan(a),this.loan=this.loansService.getLoan()}else this.errorList(t?.message?.messages);this.hideLoading()})}openCancelLoanDialog(){this.dialog.open(mn,{data:this.msgTranslate(this.loan?.core_Person_Instance?.core_Person?.ar_Name,this.loan?.core_Person_Instance?.core_Person?.en_Name)+" - "+this.msgTranslate(this.loan?.paY_loan.paY_Loan_TYPE.ar_Name,this.loan?.paY_loan.paY_Loan_TYPE.en_Name),autoFocus:!1,panelClass:"loan-dialog"}).afterClosed().subscribe(t=>{t&&this.loansService.cancel(this.loanId).subscribe()})}ngOnDestroy(){this.loansService.setLoan(null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ee.x),e.Y36(g.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-loan-view"]],features:[e.qOj],decls:10,vars:7,consts:[[1,"title-no-margin","title-section","fixed-title","loan-view"],[1,"d-flex","justify-content-between","align-items-center"],[3,"title","parentTitle","parentTitleLink","parentLinkParams",4,"ngIf"],[3,"title",4,"ngIf"],[4,"ngIf"],[1,"mtop-15"],[3,"isView"],[3,"loanId","isView","isAdjust","changeIsAdjust"],[3,"title","parentTitle","parentTitleLink","parentLinkParams"],[3,"title"],[3,"click"],[3,"url","params"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"div",1)(2,"div"),e.YNc(3,un,3,9,"page-title",2),e.YNc(4,_n,2,3,"page-title",3),e.qZA(),e.YNc(5,gn,5,4,"ng-container",4),e.qZA()(),e.TgZ(6,"div",5),e._UZ(7,"app-loan-general-data-view",6),e.qZA(),e.TgZ(8,"div",5)(9,"app-add-loan-installments",7),e.NdJ("changeIsAdjust",function(l){return a.isAdjust=l}),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngIf",!a.isAdjust),e.xp6(1),e.Q6J("ngIf",a.isAdjust),e.xp6(1),e.Q6J("ngIf",!a.isAdjust),e.xp6(2),e.Q6J("isView",!0),e.xp6(2),e.Q6J("loanId",a.loanId)("isView",!0)("isAdjust",a.isAdjust))},styles:[".loan-view.title-no-margin #back_btn,   .loan-view.title-no-margin #add_new_btn,   .loan-view .edit-all-btn{margin-top:8px!important}"]}),o})();var ce=s(87379);let hn=(()=>{class o extends h.U{constructor(t){super(),this.elementTransactionsService=t,this.mandatoryColomns=["Ser","id","person_code","person_name","element_transaction","transactionDate","value","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new f.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new f.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.elementTransactionsService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(l=>{if(l.message.messageType==p.u.Success){if(0==l.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new f.by(function fn(o){return o.map(i=>({...i,id:i.id,person_code:i.core_Person_Instance.core_Person.code,person_name:(0,m._f)(i.core_Person_Instance.core_Person.ar_Name,i.core_Person_Instance.core_Person.en_Name),element_transaction:i.paY_Element.name,transactionDate:m.M6.mapDate(i.transactionDate),value:i.value}))}(l.data)),this.isLoaded=!0,this.page.length=l.meta.totalItemCount,this.page.meta=l.meta}else this.errorList(l?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.paY_Element.ar_Name,t.paY_Element.en_Name);this.deleteDialog(a).subscribe(n=>{n&&this.delete(t)})}delete(t){this.showLoading(),this.elementTransactionsService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg("transactionDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ce.f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-element-transactions-index"]],features:[e.qOj],decls:5,vars:8,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","nonRecurringVariables","parentTitle","payroll","TitleHasGlobalFunc","",3,"globalFunctions"],[1,"index-card"],[3,"isLoaded","mandatoryColomns","optionalColomns","page","actions","dataSource","showFilter","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"mat-card",2)(3,"mat-card-content")(4,"app-material-table",3),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)})("deleteRow",function(l){return a.onDelete(l)}),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(3),e.Q6J("isLoaded",a.isLoaded)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("actions",a.rowFunctions)("dataSource",a.dataSource)("showFilter",!0))},dependencies:[S.I,b.T,pe.X,c.a8,c.dn,c.n5]}),o})(),He=(()=>{class o extends Y.K{constructor(){super(),this.selectedEmployee$=new fe.X(null),this.form$=new fe.X(null)}GetEmployees(t){return this.get("payroll/Loan/GetEmployeesLoansInstallments",{params:t}).pipe((0,re.U)(a=>(a.data=function Lo(o){if(o)return o.map(i=>({...i,employeeName:(0,m._f)(i?.empNameAR,i?.empNameEn),loan_type:(0,m._f)(i?.loanType?.ar_Name,i?.loanType?.en_Name),paymentName:(0,m._f)(i?.payment?.ar_Name,i?.payment?.en_Name),code:i?.empCode,loan_Value:Math.round(i.loanValue),balance:Math.round(i.balance),dueDate:m.M6.mapDate(i.dueDate,"dd/MM/yyyy"),currentDueDate:m.M6.mapDate(i.currentDueDate,"dd/MM/yyyy"),isSelected:!1}))}(a.data),a)))}GetEmployeesGrouped(t){return this.get("payroll/Loan/GetGroupBypaymentAndLoanType",{params:t})}confirmPostpone(t,a,n){return this.post("payroll/Loan/CollectivePostpone",t,{params:{FromDate:a,ToDate:n}})}setSelectedEmployee(t){this.selectedEmployee$.next(t)}getSelectedEmployee(){return this.selectedEmployee$.value}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ye=s(78192),bn=s(21194);const Cn=function(){return[]};function vn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card-content"),e._UZ(2,"mat-divider",12),e.TgZ(3,"app-material-table",13),e.NdJ("onChangePage",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.GetEmployees(n.pageIndex+1,n.pageSize))})("selectedItems",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedItems(n))}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(3),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",e.DdM(9,Cn))("page",t.page)("showSpaceTop",!1)("isDialogSize",!0)("isCenterPaginator",!0)("isSelectedColName",t.checkboxColumnName)}}let yn=(()=>{class o extends h.U{constructor(t){super(),this.postponeService=t,this.completed=new e.vpe,this.submitted=!1,this.checkboxColumnName=N.g.isSelectedColumnName,this.mandatoryColomns=["code","employeeName","paymentName","loan_type","loan_Value","balance","dueDate","remInstallments",N.g.selectAllColumnName],this.isLoaded=!1,this.selectedItemsList=[]}ngOnInit(){this.form=this.fb.group({id:["",{nonNullable:!0}],loanTypeIds:[null],paymentIds:[null],from_date:[null,[r.kI.required,P.dN.date]],to_date:[null,[r.kI.required,P.dN.date]]},{validators:j.w.compareDates("from_date","to_date")})}get formCtrls(){return this.form.controls}GetEmployees(t,a){this.isLoaded=!1,this.submitted=!0,this.page.pageIndex=t,a&&(this.page.pageSize=a);let n={LoanTypeIds:this.formCtrls.loanTypeIds.value?.join()??"",PaymentIds:this.formCtrls.paymentIds.value?.join()??"",FromDate:m.M6.mapDateReverse(this.formCtrls.from_date.value),ToDate:m.M6.mapDateReverse(this.formCtrls.to_date.value),PageNumber:t,pageSize:this.page.dialogSize};this.postponeService.form$.next(this.form),this.form.valid&&(this.showLoading(),this.postponeService.GetEmployees(n).pipe(this.cancelRequest()).subscribe(l=>{this.isLoaded=!0,this.submitted=!1,l.data&&(this.dataSource=new f.by(l.data),this.page.length=l.meta.totalItemCount,this.page.meta=l.meta,this.selectedItemsList.forEach(d=>{let C=this.dataSource.data.find(A=>A.empCode==d.code);C&&(C.isSelected=!0)})),this.hideLoading()}))}selectedItems(t){this.dataSource.data.map((a,n)=>{let l=this.selectedItemsList.findIndex(d=>d===a);a.isSelected?l<0&&this.selectedItemsList.push(a):l>=0&&(this.selectedItemsList.splice(l,1),a.isSelected=!1)})}saveSelected(){this.postponeService.setSelectedEmployee(this.selectedItemsList),this.stepper.selectedIndex<this.stepper.steps.length-1&&this.stepper.next()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(He))},o.\u0275cmp=e.Xpm({type:o,selectors:[["postpone-select-employees"]],inputs:{stepper:"stepper"},outputs:{completed:"completed"},features:[e.qOj],decls:17,vars:16,consts:[[1,"container-fluid","mtop-40"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","multi","submitted"],["label","from_Date",3,"control","submitted"],["label","to_Date",3,"control","submitted"],["align","end",1,"mb-0"],["icon","fas fa-search","label","search",3,"color","iconPositionBefore","onClick"],[4,"ngIf"],["saveLabel","next",3,"url","disabledSave","submit"],[1,"m-auto"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","showSpaceTop","isDialogSize","isCenterPaginator","isSelectedColName","onChangePage","selectedItems"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-content",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",1)(5,"div",4),e._UZ(6,"app-payment-dropdown",5),e.qZA(),e.TgZ(7,"div",4),e._UZ(8,"app-loan-types-dropdown",5),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"app-datepicker",6),e.qZA(),e.TgZ(11,"div",4),e._UZ(12,"app-datepicker",7),e.qZA()()()()()(),e.TgZ(13,"mat-card-actions",8)(14,"submit-btn",9),e.NdJ("onClick",function(){return a.GetEmployees(a.currentPage)}),e.qZA()(),e.YNc(15,vn,4,10,"ng-container",10),e.TgZ(16,"app-fixed-card-actions",11),e.NdJ("submit",function(){return a.saveSelected()}),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.paymentIds)("multi",!0)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.loanTypeIds)("multi",!0)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.from_date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.to_date)("submitted",a.submitted),e.xp6(2),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1),e.xp6(1),e.Q6J("ngIf",a.isLoaded),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/payments"),e.Q6J("disabledSave",0==(null==a.selectedItemsList?null:a.selectedItemsList.length)))},dependencies:[u.O5,G.Q,S.I,T.p,ye.C,c.dn,c.hq,v.d,bn.s,Ye.r,r._Y,r.JL,r.sg]}),o})();const Ke=function(){return[]};let In=(()=>{class o extends h.U{constructor(t){super(),this.postponeService=t,this.completed=new e.vpe,this.mandatoryColomns=["code","employeeName","paymentName","loan_type","loan_Value","balance","currentDueDate","remInstallments","new_dueDate"],this.isLoaded=!1,this.mandatoryColomnsGroups=["loan_type","paymentName","interval_type","countOfPersons","countOfInstallments","sumOfInstallmentsValue","fromDate","toDate"],this.selectedItemsList=[]}ngOnInit(){this.selectedItemsList=this.postponeService.getSelectedEmployee(),this.postponeService.selectedEmployee$.subscribe(t=>{t&&(t.map(a=>{a.new_dueDate=a.dueDate}),this.selectedItemsList=t,this.dataSource=new f.by(this.selectedItemsList),this.GetEmployeesGrouped(this.currentPage))}),this.postponeService.form$.subscribe(t=>this.form=t)}get formCtrls(){return this.form.controls}GetEmployeesGrouped(t,a){this.isLoaded=!1,this.dataSourceGroup=new f.by(null),this.page.pageIndex=t,a&&(this.page.pageSize=a);let n={LoanTypeIds:this.selectedItemsList.map(l=>l.loanType?.id)?.join()??"",PaymentIds:this.selectedItemsList.map(l=>l.payment?.id)?.join()??"",FromDate:m.M6.mapDateReverse(this.formCtrls.from_date.value),ToDate:m.M6.mapDateReverse(this.formCtrls.to_date.value),EmployIds:this.selectedItemsList.map(l=>l.employeeId)?.join()??"",PageNumber:t,pageSize:this.page.dialogSize};this.form.valid&&(this.showLoading(),this.postponeService.GetEmployeesGrouped(n).pipe(this.cancelRequest()).subscribe(l=>{this.isLoaded=!0,l.data&&(l.data.map(d=>{d.paymentName=(0,m._f)(d.paymentNameAR,d.paymentNameEN),d.loan_type=(0,m._f)(d.loanTypeNameAR,d.loanTypeNameEN),d.interval_type=(0,m._f)(d.interval_TypeAr,d.interval_TypeEn),d.fromDate=m.M6.mapDate(d.fromDate,"dd/MM/yyyy"),d.toDate=m.M6.mapDate(d.toDate,"dd/MM/yyyy"),d.sumOfInstallmentsValue=Math.round(d.sumOfInstallmentsValue)}),this.dataSourceGroup=new f.by(l.data),this.page.length=l.meta.totalItemCount,this.page.meta=l.meta),this.hideLoading()}))}confirmPostpone(){let t=[];const a=m.M6.mapDateReverse(this.formCtrls.from_date.value),n=m.M6.mapDateReverse(this.formCtrls.to_date.value);this.selectedItemsList.map(l=>{t.push({pAY_Loan:{id:l.pAY_Loan.id}})}),this.showLoading(),this.postponeService.confirmPostpone(t,a,n).subscribe(l=>{l?.message?.messageType==p.u.Success?(this.addSuccessfullyMsg("postponeConfirmedSuccessfully"),this.completed.emit(!0),this.onCancel()):this.errorList(l?.message?.messages),this.hideLoading()})}onCancel(){this.router.navigate([`/payroll/${this.moduleId}/loans`],{queryParams:this.pageParams})}onBack(){this.stepper.selectedIndex>0&&this.stepper.previous()}ngOnDestroy(){this.postponeService.form$.next(null),this.postponeService.selectedEmployee$.next(null)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(He))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-postpone-preview"]],inputs:{stepper:"stepper"},outputs:{completed:"completed"},features:[e.qOj],decls:12,vars:16,consts:[[1,"index-card"],[1,"title-no-margin"],["title","postpone_preview",1,"stepper-section-title"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showSpaceTop","showPaginator"],[1,"mt-4","index-card"],[1,"title-no-margin","border-bottom"],["title","selectedEmployees","styleClass","d-inline-block"],["saveLabel","confirmPostpone","cancelLabel","back",3,"disabledSave","submit","cancel"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title",1),e._UZ(2,"page-title",2),e.qZA(),e.TgZ(3,"mat-card-content"),e._UZ(4,"app-material-table",3),e.qZA()(),e.TgZ(5,"mat-card",4)(6,"mat-card-title",5)(7,"page-title",6),e._uU(8),e.qZA()(),e.TgZ(9,"mat-card-content"),e._UZ(10,"app-material-table",3),e.qZA()(),e.TgZ(11,"app-fixed-card-actions",7),e.NdJ("submit",function(){return a.confirmPostpone()})("cancel",function(){return a.onBack()}),e.qZA()),2&t){let n;e.xp6(4),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSourceGroup)("mandatoryColomns",a.mandatoryColomnsGroups)("optionalColomns",e.DdM(14,Ke))("showSpaceTop",!1)("showPaginator",!1),e.xp6(4),e.hij(" (",null!==(n=null==a.selectedItemsList?null:a.selectedItemsList.length)&&void 0!==n?n:0,") "),e.xp6(2),e.Q6J("isLoaded",!0)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",e.DdM(15,Ke))("showSpaceTop",!1)("showPaginator",!1),e.xp6(1),e.Q6J("disabledSave",0==(null==a.selectedItemsList?null:a.selectedItemsList.length))}},dependencies:[S.I,b.T,ye.C,c.a8,c.dn,c.n5]}),o})();const Tn=["stepper"];function wn(o,i){1&o&&e._UZ(0,"i",15)}function Sn(o,i){1&o&&e._UZ(0,"i",15)}let Zn=(()=>{class o extends h.U{constructor(){super(),this.isStep1Completed=!1,this.isPreviewCompleted=!1}stepChanged(){this.stepper.selected.interacted=!1}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-collective-postpone"]],viewQuery:function(t,a){if(1&t&&e.Gf(Tn,5),2&t){let n;e.iGM(n=e.CRH())&&(a.stepper=n.first)}},features:[e.qOj],decls:28,vars:25,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","postpone",3,"parentTitle","parentTitleLink"],[3,"url","params"],[1,"has-fixed-title"],[3,"linear","disableRipple","selectionChange"],["stepper",""],[3,"label","completed"],["matStepperIcon","edit"],[1,"row"],[1,"col-12"],[1,"title-no-margin"],["title","select_employees",1,"stepper-section-title"],[1,"mt-2"],[1,"clearfix"],[3,"stepper","completed"],[1,"fas","fa-check"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ynx(4),e._UZ(5,"app-back-btn",2),e.BQk(),e.qZA(),e.TgZ(6,"mat-card-content",3)(7,"mat-stepper",4,5),e.NdJ("selectionChange",function(){return a.stepChanged()}),e.TgZ(9,"mat-step",6),e.ALo(10,"titlecase"),e.ALo(11,"translate"),e.YNc(12,wn,1,0,"ng-template",7),e.TgZ(13,"div",8)(14,"div",9)(15,"mat-card")(16,"mat-card-title",10),e._UZ(17,"page-title",11),e.qZA(),e._UZ(18,"mat-divider",12)(19,"div",13),e.TgZ(20,"postpone-select-employees",14),e.NdJ("completed",function(l){return a.isStep1Completed=l}),e.qZA()()()()(),e.TgZ(21,"mat-step",6),e.ALo(22,"titlecase"),e.ALo(23,"translate"),e.YNc(24,Sn,1,0,"ng-template",7),e.TgZ(25,"div",8)(26,"div",9)(27,"app-postpone-preview",14),e.NdJ("completed",function(l){return a.isPreviewCompleted=l}),e.qZA()()()()()()),2&t){const n=e.MAs(8);e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,13,"payroll")," / ",e.lcZ(3,15,"loans"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/loans"),e.xp6(4),e.MGl("url","/payroll/",a.moduleId,"/loans"),e.Q6J("params",a.pageParams),e.xp6(2),e.Q6J("linear",!1)("disableRipple",!0),e.xp6(2),e.s9C("label",e.lcZ(10,17,e.lcZ(11,19,"select_employees"))),e.Q6J("completed",a.isStep1Completed),e.xp6(11),e.Q6J("stepper",n),e.xp6(1),e.s9C("label",e.lcZ(22,21,e.lcZ(23,23,"preview"))),e.Q6J("completed",a.isPreviewCompleted),e.xp6(6),e.Q6J("stepper",n)}},dependencies:[x.a,b.T,c.a8,c.dn,c.n5,v.d,Z.C0,Z.Vq,Z.z9,yn,In,u.rS,I.X$]}),o})(),An=(()=>{class o extends h.U{constructor(t,a){super(),this.elementService=t,this.dialogRef=a,this.file=new r.NI(null,r.kI.required),this.submitted=!1}ngOnInit(){}upload(){this.submitted=!0;const t=new FormData;t.append("file",this.file.value),this.file.valid&&(this.showLoading(),this.elementService.upload(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.success(a.message.messageTypeName),this.dialogRef.close()):this.errorList(a.message?.messages),this.hideLoading()}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ce.f),e.Y36(g.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-upload-elements-dialog"]],features:[e.qOj],decls:12,vars:9,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","uploadVariables",1,"d-inline-block","mtop-10"],[1,"container-fluid","mx-0"],[1,"row"],[1,"col-12"],[3,"control","submitted","multiple","isDragDrop"],["align","end",1,"mb-0"],["icon","pi pi-upload","label","upload",1,"w-95","m-auto","d-block",3,"styleClass","iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2)(4,"mat-card-subtitle"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",3)(8,"div",4),e._UZ(9,"primeng-file-upload",5),e.qZA()(),e.TgZ(10,"mat-card-actions",6)(11,"submit-btn",7),e.NdJ("onClick",function(){return a.upload()}),e.qZA()()()),2&t&&(e.xp6(5),e.hij(" ",e.lcZ(6,7,"downloadTemplateAndFillItWithData")," "),e.xp6(4),e.Q6J("control",a.file)("submitted",a.submitted)("multiple",!1)("isDragDrop",!0),e.xp6(2),e.MGl("styleClass","",a.btn.block," m-auto"),e.Q6J("iconPositionBefore",!1))},dependencies:[Le.J,T.p,b.T,c.$j,c.hq,g.uh,g.xY,I.X$]}),o})();var $e=s(20408),Xe=s(35288);function xn(o,i){if(1&o){const t=e.EpF();e.ynx(0,3),e.TgZ(1,"app-split-table",21),e.NdJ("selectedItems",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getSelectedItem(n))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("displayedColumns",t.displayedColumns)("hasPaginator",!0)("isCenterPaginator",!0)("pageSize",30)}}let Pn=(()=>{class o extends h.U{constructor(t,a){super(),this.employeesService=t,this.elementService=a,this.isLoaded=!1,this.submitted=!1,this.displayedColumns=["employee","isSelected"],this.assetsManager=new le.Sp,this.orgId=null,this.jobId=null,this.policyGroupId=null}ngOnInit(){this.form=this.fb.group({elementIds:[null,r.kI.required],isEmpty:[!1,r.kI.required],orgId:[null],jobId:[null],policyGroupId:[null],employeeIds:[null]}),this.GetAll_ByOrgJobOrPolicy(),this.formCtrls.orgId.valueChanges.subscribe(t=>{t!=this.orgId&&this.GetAll_ByOrgJobOrPolicy(),this.orgId=t}),this.formCtrls.jobId.valueChanges.subscribe(t=>{t!=this.jobId&&this.GetAll_ByOrgJobOrPolicy(),this.jobId=t}),this.formCtrls.policyGroupId.valueChanges.subscribe(t=>{t!=this.policyGroupId&&this.GetAll_ByOrgJobOrPolicy(),this.policyGroupId=t})}get formCtrls(){return this.form.controls}GetAll_ByOrgJobOrPolicy(){this.isLoaded=!1,this.dataSource=new f.by(null),this.employeesService.GetAll_ByOrgJobOrPolicy(this.formCtrls.orgId.value,this.formCtrls.jobId.value,this.formCtrls.policyGroupId.value).pipe(this.cancelRequest()).subscribe(t=>{if(t.message.messageType==p.u.Success){let a=t.data.map(n=>({id:n?.core_Person.id,employee:this.msgTranslate(n?.core_Person.ar_Name,n?.core_Person.en_Name),isSelected:!1}));this.dataSource=new f.by(a)}else this.errorList(t.message?.messages);this.isLoaded=!0})}download(){let t={PersoninstanceList:this.formCtrls.employeeIds.value,VariablesCodes:this.formCtrls.elementIds.value,IsEmptyTemplate:this.formCtrls.isEmpty.value};console.log(t),this.elementService.download(t).pipe(this.cancelRequest()).subscribe(a=>{this.fileService.downloadBufferFile(a,"payroll elements.xlsx")})}changeIsEmpty(t){t||(this.formCtrls.employeeIds.setValue(null),this.dataSource.data.map(a=>{a.isSelected=!1}))}getSelectedItem(t){this.formCtrls.employeeIds.setValue(t.map(a=>a.id))}openUploadDialog(){this.dialogsService.addEditDialog(An,{},{panelClass:"dialog-emp-form",width:"25%"}).afterClosed().subscribe(t=>{})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36($e.M),e.Y36(ce.f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-download-elements"]],features:[e.qOj],decls:31,vars:36,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","DownloadNonRecurringVariable","title","download",3,"id","parentTitle","parentTitleLink"],[3,"url","params"],[1,"mt-3"],[1,"title-no-margin","d-flex","justify-content-between"],["title","generalInfo"],[3,"click"],[1,"font-size-14","m-0","pi","pi-upload"],[1,"mt-2"],[1,"container-fluid","mtop-40"],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-6","col-lg-6","col-12"],["optionValue","name","multi","true",3,"control","submitted","filter"],["label","emptyTemplate","color","primary","labelPosition","before","styleClass","mt-2",3,"control","onChange"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","submitted","filter","disable"],["class","mt-3",4,"ngIf"],["align","end"],["icon","pi pi-arrow-down","label","download",3,"color","iconPositionBefore","onClick"],[3,"isLoaded","dataSource","displayedColumns","hasPaginator","isCenterPaginator","pageSize","selectedItems"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e._UZ(4,"app-back-btn",2),e.qZA(),e.TgZ(5,"mat-card",3)(6,"mat-card-title",4),e._UZ(7,"page-title",5),e.TgZ(8,"button",6),e.NdJ("click",function(){return a.openUploadDialog()}),e._uU(9),e.ALo(10,"translate"),e._UZ(11,"i",7),e.qZA()(),e._UZ(12,"mat-divider",8),e.TgZ(13,"mat-card-content",9)(14,"div",10)(15,"div",11)(16,"form",12)(17,"div",10)(18,"div",13),e._UZ(19,"app-payroll-element-by-user-dropdown",14),e.qZA(),e.TgZ(20,"div",13)(21,"app-check-box",15),e.NdJ("onChange",function(l){return a.changeIsEmpty(l)}),e.qZA()(),e.TgZ(22,"div",16),e._UZ(23,"app-organization-current-structure-dropdown",17),e.qZA(),e.TgZ(24,"div",16),e._UZ(25,"app-policy-groups-dropdown",17),e.qZA(),e.TgZ(26,"div",16),e._UZ(27,"app-job-title-dropdown",17),e.qZA()()(),e.YNc(28,xn,2,6,"ng-container",18),e.qZA()()(),e.TgZ(29,"mat-card-actions",19)(30,"submit-btn",20),e.NdJ("onClick",function(){return a.download()}),e.qZA()()()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,30,"payroll")," / ",e.lcZ(3,32,"nonRecurringVariables"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/non-recurring-variables"),e.Q6J("id",0),e.xp6(3),e.MGl("url","/payroll/",a.moduleId,"/non-recurring-variables/index"),e.Q6J("params",a.pageParams),e.xp6(4),e.Gre("btn ",a.btn.blue,""),e.xp6(1),e.hij(" ",e.lcZ(10,34,"upload")," "),e.xp6(7),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.elementIds)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.isEmpty),e.xp6(2),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("filter",!0)("disable",a.formCtrls.isEmpty.value),e.xp6(2),e.Q6J("control",a.formCtrls.policyGroupId)("submitted",a.submitted)("filter",!0)("disable",a.formCtrls.isEmpty.value),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("submitted",a.submitted)("filter",!0)("disable",a.formCtrls.isEmpty.value),e.xp6(1),e.Q6J("ngIf",!a.formCtrls.isEmpty.value),e.xp6(2),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1))},dependencies:[u.O5,ie.u,x.a,T.p,b.T,X.M,c.a8,c.dn,c.n5,c.hq,v.d,Ve.W,Ne.P,Je.a,Xe.T,r._Y,r.JL,r.sg,I.X$]}),o})();var L=s(37084),Ln=s(91347),Dn=s(92665);let Vn=(()=>{class o extends h.U{constructor(t){super(),this.retroactiveService=t,this.selectedVaraiableList=new e.vpe,this.PeriodCalculationIDs=[],this.displayedColumns=["variable","isSelected"],this.isLoaded=!1,this.submitted=!1,this.varaiableList=[]}ngOnInit(){}ngOnChanges(){this.PeriodCalculationIDs.length>0&&this.getAllVariables()}getAllVariables(){this.retroactiveService.getVariables(this.PeriodCalculationIDs).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==p.u.Success?(this.dataSource=new f.by(function La(o){return o.map(i=>({id:i.id,isSelected:!1,variable:(0,m._f)(i.arName,i.name),code:i.code}))}(t.data)),this.isLoaded=!0):this.errorList(t?.message?.messages)})}getSelectedItem(t){this.selectedVaraiableList.emit(t.map(a=>a))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-selected-variable"]],inputs:{PeriodCalculationIDs:"PeriodCalculationIDs"},outputs:{selectedVaraiableList:"selectedVaraiableList"},features:[e.qOj,e.TTD],decls:7,vars:8,consts:[["expanded",""],["splitTableNumber","4",3,"isLoaded","dataSource","displayedColumns","selectedItems"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.ALo(4,"titlecase"),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"app-split-table",1),e.NdJ("selectedItems",function(l){return a.getSelectedItem(l)}),e.qZA()()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,4,e.lcZ(5,6,"SelectVariables"))," "),e.xp6(3),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("displayedColumns",a.displayedColumns))},dependencies:[X.M,L.ib,L.yz,L.yK,u.rS,I.X$]}),o})();function Nn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"submit-btn",7),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.save())}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color",t.btn.darkBlue)("iconPositionBefore",!1)}}function Jn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",2)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.ALo(4,"titlecase"),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"app-split-table",3),e.NdJ("selectedItems",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getSelectedPaymentDates(n))}),e.qZA(),e._UZ(10,"app-radio-button",4),e.YNc(11,Nn,2,2,"div",5),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,9,e.lcZ(5,11,"generalInfo"))," "),e.xp6(4),e.Oqu(e.lcZ(8,13,"SelectPaymentDates")),e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("displayedColumns",t.displayedColumns),e.xp6(1),e.Q6J("control",t.formCtrls.calculateFromType)("radioList",t.radioList)("submitted",t.submitted),e.xp6(1),e.Q6J("ngIf",2!=t.formCtrls.calculateFromType.value)}}function kn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-selected-variable",17),e.NdJ("selectedVaraiableList",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.getSelectedVariable(n))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("PeriodCalculationIDs",t.periodCalculationIds)}}function Qn(o,i){if(1&o&&e._UZ(0,"app-download-variables",18),2&o){const t=e.oxw(2);e.Q6J("selectedVariable",t.variableList)("hasOutSideVariable",!0)("paymentId",t.paymentId)("periodCalculationIds",t.periodCalculationIds)}}function Gn(o,i){1&o&&(e._UZ(0,"p-message",19),e.ALo(1,"translate")),2&o&&e.s9C("text",e.lcZ(1,1,"selectAtLeastPeriodCalculation"))}function qn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",20),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.save())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("color",t.btn.darkBlue)("iconPositionBefore",!1)}}function Fn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",21),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.reCalculate())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("iconPositionBefore",!1)("disabled",null==t.formCtrls.file.value)}}function Un(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",8),e.YNc(2,kn,1,1,"app-selected-variable",9),e.qZA(),e.TgZ(3,"div",8)(4,"mat-expansion-panel",2)(5,"mat-expansion-panel-header")(6,"mat-panel-title"),e._uU(7),e.ALo(8,"titlecase"),e.ALo(9,"translate"),e.qZA()(),e.YNc(10,Qn,1,4,"app-download-variables",10),e.YNc(11,Gn,2,3,"ng-template",null,11,e.W1O),e.qZA()(),e.TgZ(13,"div",8)(14,"mat-expansion-panel",2)(15,"mat-expansion-panel-header")(16,"mat-panel-title"),e._uU(17),e.ALo(18,"titlecase"),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",12)(21,"div",13),e._UZ(22,"app-file-input",14),e.qZA(),e.TgZ(23,"div",13),e.YNc(24,qn,1,2,"submit-btn",15),e.YNc(25,Fn,1,2,"submit-btn",16),e.qZA()()()(),e.BQk()),2&o){const t=e.MAs(12),a=e.oxw();e.xp6(2),e.Q6J("ngIf",a.periodCalculationIds.length>0),e.xp6(5),e.hij(" ",e.lcZ(8,9,e.lcZ(9,11,"selectEmployees&DownloadVariablesSheet"))," "),e.xp6(3),e.Q6J("ngIf",a.periodCalculationIds.length>0)("ngIfElse",t),e.xp6(7),e.hij(" ",e.lcZ(18,13,e.lcZ(19,15,"uploadNewVariables"))," "),e.xp6(5),e.Q6J("control",a.formCtrls.file)("submitted",a.submitted),e.xp6(2),e.Q6J("ngIf",!a.isDialog),e.xp6(1),e.Q6J("ngIf",a.isDialog)}}let Rn=(()=>{class o extends h.U{constructor(t,a){super(),this.retroactiveService=t,this.periodCalculationsService=a,this.paymentId=0,this.completed=new e.vpe,this.changeRetroActiveId=new e.vpe,this.retroactiveId=0,this.displayedColumns=["paymentDate","isSelected"],this.isLoaded=!1,this.submitted=!1,this.variableList=[],this.periodCalculationIds=[],this.isDialog=!1,this.radioList=[{value:1,label:"currentValue",cssClass:"col-12 col-md-6 col-lg-2 mt-1"},{value:2,label:"newValue",cssClass:"col-12 col-md-6 col-lg-2  mt-1"}]}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.retroactiveId=Number(t.id??0)}),this.form=this.fb.group({calculateFromType:[1],file:[]}),this.activatedRoute.queryParamMap.subscribe(t=>{this.isDialog=Boolean(t.get("isFromDialog")),this.retroactiveId=Number(t.get("retroactiveId"))}),this.isDialog?(this.getById(),this.formCtrls.calculateFromType.setValue(2)):this.getAllPaymentDates()}get formCtrls(){return this.form.controls}getAllPaymentDates(){console.log("payment"),this.periodCalculationsService.getAllConfirmed(this.paymentId).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==p.u.Success&&(this.dataSource=new f.by(function Pa(o){return o.map(i=>({id:i.id,isSelected:!1,paymentDate:m.M6.mapDate(i.payment_DATE)}))}(t.data)),this.isLoaded=!0)})}save(){if(this.submitted=!0,0==this.periodCalculationIds.length)return void this.error("mustChoosePaymentDates");this.showLoading();let a=m.M6.objectToFormData({PAY_PeriodCalculation:{Payment_ID:this.paymentId},PeriodCalculationIDs:this.periodCalculationIds,CalculateFromCurrentFixedVariables:1==this.formCtrls.calculateFromType.value,file:this.formCtrls.file.value});this.retroactiveService.create(a).subscribe(n=>{n.message.messageType==p.u.Success?(this.addSuccessfullyMsg("newRetroactiveAdded"),console.log("res",n.data),this.retroactiveService.retroactive$.next(se(n.data)),this.retroactiveId=n.data[0].id,this.navigateTo(`/payroll/${this.moduleId}/payments/retro-active/edit/${this.retroactiveId}`),this.changeRetroActiveId.emit(this.retroactiveId),this.completed.emit(!0),this.submitted=!1,this.hideLoading()):this.errorList(n?.message?.messages)})}getSelectedVariable(t){this.variableList=t}getSelectedPaymentDates(t){this.periodCalculationIds=[],t.map(a=>{this.periodCalculationIds.push(a.id)})}getById(){this.retroactiveService.getById(this.retroactiveId).subscribe(t=>{t.message.messageType==p.u.Success?t.data.map(a=>{this.periodCalculationIds.push(a.retroActiveParent_ID)}):this.errorList(t?.message?.messages)})}reCalculate(){let t={CalculateFromCurrentFixedVariables:!1,RetroActiveID:this.retroactiveId,file:this.formCtrls.file.value};this.showLoading();let a=m.M6.objectToFormData(t);this.retroactiveService.reCalculate(a).subscribe(n=>{n.message.messageType==p.u.Success?(this.success("reCalcSuccessfully"),this.hideLoading(),this.router.navigate([`/payroll/${this.moduleId}/payments/retro-active/view/${this.retroactiveId}`,{queryParams:{parentView:this.viewsManager.payment_add}}])):this.errorList(n?.message?.messages)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q),e.Y36(R.b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["add-retro-selected-employee"]],inputs:{paymentId:"paymentId"},outputs:{completed:"completed",changeRetroActiveId:"changeRetroActiveId"},features:[e.qOj],decls:2,vars:2,consts:[["expanded","",4,"ngIf"],[4,"ngIf"],["expanded",""],["splitTableNumber","4",3,"isLoaded","dataSource","displayedColumns","selectedItems"],["label","calculateFrom","titleClass","col-12 col-md-3 col-lg-1",1,"mt-2",3,"control","radioList","submitted"],["class","mt-2 buttons-no-margin",4,"ngIf"],[1,"mt-2","buttons-no-margin"],["styleClass","float-right","label","save",3,"color","iconPositionBefore","onClick"],[1,"mt-2"],[3,"PeriodCalculationIDs","selectedVaraiableList",4,"ngIf"],[3,"selectedVariable","hasOutSideVariable","paymentId","periodCalculationIds",4,"ngIf","ngIfElse"],["selectPeriodCalculation",""],[1,"row"],[1,"col-12","col-md-6","col-lg-4"],[3,"control","submitted"],["label","save",3,"color","iconPositionBefore","onClick",4,"ngIf"],["icon","pi pi-sync","label","reCalculate","class","float-right mbottom-20",3,"iconPositionBefore","disabled","onClick",4,"ngIf"],[3,"PeriodCalculationIDs","selectedVaraiableList"],[3,"selectedVariable","hasOutSideVariable","paymentId","periodCalculationIds"],["severity","warn",3,"text"],["label","save",3,"color","iconPositionBefore","onClick"],["icon","pi pi-sync","label","reCalculate",1,"float-right","mbottom-20",3,"iconPositionBefore","disabled","onClick"]],template:function(t,a){1&t&&(e.YNc(0,Jn,12,15,"mat-expansion-panel",0),e.YNc(1,Un,26,17,"ng-container",1)),2&t&&(e.Q6J("ngIf",!a.isDialog),e.xp6(1),e.Q6J("ngIf",2==a.formCtrls.calculateFromType.value))},dependencies:[u.O5,Ln.Y,Fe._,T.p,X.M,L.ib,L.yz,L.yK,Dn.q,ke,Vn,u.rS,I.X$],styles:["p[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#323232!important}"]}),o})();const We=function(o){return{"mat-card-active":o}};let Yn=(()=>{class o extends h.U{constructor(t,a,n){super(),this.retroactiveService=t,this.data=a,this.dialogRef=n}ngOnInit(){0==this.data.isCurrentActive&&(this.isCurrentActive=!1)}reCalculate(){if(null==this.isCurrentActive)return void this.error("mustChoosevalue");let t={CalculateFromCurrentFixedVariables:this.isCurrentActive,RetroActiveID:this.data?.retroactiveId,file:this.data.file};this.showLoading();let a=m.M6.objectToFormData(t);this.retroactiveService.reCalculate(a).subscribe(n=>{n.message.messageType==p.u.Success?(this.success("reCalcSuccessfully"),this.hideLoading(),this.dialogRef.close(!0)):this.errorList(n?.message?.messages)})}recalculateWithNewValue(){this.isCurrentActive=!1,this.router.navigate([`/payroll/${this.data.moduleId}/payments/retro-active/add/${this.data.paymentId}`],{queryParams:{parentView:this.viewsManager.payment_index,isFromDialog:!0,retroactiveId:this.data.retroactiveId}}),this.dialogRef.close()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q),e.Y36(g.WI),e.Y36(g.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-re-calculate-dialog"]],features:[e.qOj],decls:21,vars:19,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","calculateFrom",1,"d-inline-block","mtop-5","mbottom-10"],[1,"container-fluid","mx-0","h-100"],["dialogContainer",""],[3,"ngClass","click"],[1,"full-width-action-dialog"],["label","process",3,"iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2,3)(5,"mat-card",4),e.NdJ("click",function(){return a.isCurrentActive=!0}),e.TgZ(6,"p"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"mat-card",4),e.NdJ("click",function(){return a.recalculateWithNewValue()}),e.TgZ(13,"p"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"span"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"mat-dialog-actions",5)(20,"submit-btn",6),e.NdJ("onClick",function(){return a.reCalculate()}),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngClass",e.VKq(15,We,a.isCurrentActive)),e.xp6(2),e.Oqu(e.lcZ(8,7,"currentValue")),e.xp6(3),e.Oqu(e.lcZ(11,9,"directCalculation")),e.xp6(2),e.Q6J("ngClass",e.VKq(17,We,0==a.isCurrentActive)),e.xp6(2),e.Oqu(e.lcZ(15,11,"newValue")),e.xp6(3),e.Oqu(e.lcZ(18,13,"SubmitRequiredDataBeforeCalculation")),e.xp6(3),e.Q6J("iconPositionBefore",!1))},dependencies:[u.mk,T.p,b.T,c.a8,g.uh,g.xY,g.H8,I.X$],styles:[".mat-card[_ngcontent-%COMP%]{align-items:center;border-radius:8.9px!important;box-shadow:0 1.2px 7.5px #305d7c33!important;background-color:#e2eaf033!important;margin-top:10px}p[_ngcontent-%COMP%]{font-size:16px;font-weight:600;letter-spacing:.36px;color:#169ed9;margin-bottom:0}span[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.3px;color:#7b809a}.mat-card-active[_ngcontent-%COMP%]{box-shadow:0 1.2px 7.5px #305d7c33;border:solid 2px #169ed9}"]}),o})();function En(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"submit-btn",5),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.reCalculate())}),e.qZA()}2&o&&e.Q6J("iconPositionBefore",!1)}function Mn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",8),e.NdJ("click",function(){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.getList(d.firstPage,null,l.id))}),e._uU(2),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(2),e.hij(" ",null==t?null:t.paymentDate," ")}}function Bn(o,i){if(1&o&&(e.TgZ(0,"section",6),e.YNc(1,Mn,3,1,"ng-container",7),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.retroActiveList)}}let et=(()=>{class o extends h.U{constructor(t,a){super(),this.retroactiveService=t,this.dialog=a,this.mandatoryColomns=["code","ar_Name"],this.stickyCols=["code","ar_Name"],this.isLoaded=!1,this.optionalColomns=[],this.retroActiveList=[]}ngOnInit(){}ngOnChanges(t){(t.retroactiveId?.currentValue!=t.retroactiveId?.previousValue&&!t.retroactiveId.firstChange||this.retroactiveId>0)&&(this.retroActiveList=[]),this.getList(this.firstPage),this.retroactiveService.retroactive$.subscribe(a=>{this.retroActiveList=a})}getList(t,a,n){this.mandatoryColomns=["code","ar_Name"],this.dataSource=new f.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.dialogSize=a),this.removePageParams(),this.retroactiveService.getCalculationResult({PageNumber:t,pageSize:this.page.pageSize},n??this.retroactiveId).subscribe(d=>{if(d.message.messageType==p.u.Success){this.dataSource=new f.by(he(d.data));let C=[];d.data[0]?.lstVariableValue.forEach(A=>{C.push(this.msgTranslate(A.variable.arName,A.variable.name))}),this.mandatoryColomns=[...this.mandatoryColomns,...C],this.isLoaded=!0,this.page.length=d.meta.totalItemCount,this.page.meta=d.meta}else this.errorList(d.message.messages)})}reCalculate(){this.dialog.open(Yn,{data:{retroactiveId:this.retroactiveId,moduleId:this.moduleId,paymentId:this.paymentId},panelClass:"setup-dialog"}).afterClosed().subscribe(t=>{t&&this.getList(this.firstPage)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q),e.Y36(g.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["add-retro-preview-calc-results"]],inputs:{retroactiveId:"retroactiveId",paymentId:"paymentId",isConfirmed:"isConfirmed"},features:[e.qOj,e.TTD],decls:7,vars:10,consts:[[1,"title-no-margin"],["title","previewCalculationResults",1,"stepper-section-title"],["icon","pi pi-sync","label","reCalculate","class","float-right mbottom-20",3,"iconPositionBefore","onClick",4,"ngIf"],["class","mt-3",4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","isCenterPaginator","stickyCols","onChangePage"],["icon","pi pi-sync","label","reCalculate",1,"float-right","mbottom-20",3,"iconPositionBefore","onClick"],[1,"mt-3"],[4,"ngFor","ngForOf"],[1,"btn-babyBlue-outline","m-1",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card")(1,"mat-card-title",0),e._UZ(2,"page-title",1),e.YNc(3,En,1,1,"submit-btn",2),e.qZA(),e.TgZ(4,"mat-card-content"),e.YNc(5,Bn,2,1,"section",3),e.TgZ(6,"app-material-table",4),e.NdJ("onChangePage",function(l){return a.getList(l.pageIndex+1,l.pageSize)}),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",0==a.isConfirmed),e.xp6(2),e.Q6J("ngIf",0!=a.isConfirmed&&(null==a.retroActiveList?null:a.retroActiveList.length)>0),e.xp6(1),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("isCenterPaginator",!0)("stickyCols",a.stickyCols))},dependencies:[u.sg,u.O5,S.I,T.p,b.T,c.a8,c.dn,c.n5]}),o})();const On=["stepper"];function jn(o,i){if(1&o&&e._UZ(0,"app-add-new-btn",3),2&o){const t=e.oxw();e.hYB("url","/payroll/",t.moduleId,"/payments/retro-active/add/",t.paymentId,""),e.Q6J("params",t.parentParam)}}function zn(o,i){1&o&&e._UZ(0,"i",13)}function Hn(o,i){1&o&&e._UZ(0,"i",13)}let tt=(()=>{class o extends h.U{constructor(t,a){super(),this.paymentService=t,this.retroactiveService=a,this.retroActiveId=0,this.paymentId=0,this.isSelectEmployeeCompleted=!1,this.isPreviewCompleted=!1,this.activatedRoute.params.subscribe(n=>{this.paymentId=Number(n.paymentId??0),this.retroActiveId=Number(n.id??0)})}ngOnInit(){this.subparentView={parentView:this.viewsManager.payment_index,...this.parentModuleIdParam}}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&(this.paymentId>0&&this.getPaymentName(),this.retroActiveId>0&&this.getById())}getchangeRetroActiveIdId(t){this.retroActiveId=t}stepChanged(){this.stepper.selected.interacted=!1,1==this.stepper.selectedIndex&&this.retroActiveId>0&&(this.isSelectEmployeeCompleted=!0)}getById(){this.retroactiveService.getById(this.retroActiveId).subscribe(t=>{t.message.messageType==p.u.Success?this.paymentId=t.data[0].payment_ID:this.errorList(t?.message?.messages)})}getPaymentName(){this.paymentService.getById(this.paymentId).subscribe(t=>{t.message.messageType==p.u.Success?this.payment=t.data[0]:this.errorList(t?.message?.messages)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(O.t),e.Y36(q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-retroactive-core"]],viewQuery:function(t,a){if(1&t&&e.Gf(On,5),2&t){let n;e.iGM(n=e.CRH())&&(a.stepper=n.first)}},features:[e.qOj],decls:23,vars:36,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addRetroactiveCalculations","title","add",3,"id","parentTitle","parentTitleLink","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"add-retroactive","mt-2","has-fixed-title","has-cards-with-shadow"],[3,"linear","disableRipple","selectionChange"],["stepper",""],[3,"label","completed"],["matStepperIcon","edit"],["multi","",1,"expantion-add-forms"],[3,"paymentId","completed","changeRetroActiveId"],[3,"retroactiveId","completed"],[3,"stepper","parentParam","url","pageParams"],[1,"fas","fa-check"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ynx(4),e.YNc(5,jn,1,3,"app-add-new-btn",2),e._UZ(6,"app-back-btn",3),e.BQk(),e.qZA(),e.ynx(7),e.TgZ(8,"mat-card-content",4)(9,"mat-stepper",5,6),e.NdJ("selectionChange",function(){return a.stepChanged()}),e.TgZ(11,"mat-step",7),e.ALo(12,"titlecase"),e.ALo(13,"translate"),e.YNc(14,zn,1,0,"ng-template",8),e.TgZ(15,"mat-accordion",9)(16,"add-retro-selected-employee",10),e.NdJ("completed",function(l){return a.isSelectEmployeeCompleted=l})("changeRetroActiveId",function(l){return a.getchangeRetroActiveIdId(l)}),e.qZA()()(),e.TgZ(17,"mat-step",7),e.ALo(18,"titlecase"),e.ALo(19,"translate"),e.YNc(20,Hn,1,0,"ng-template",8),e.TgZ(21,"add-retro-preview-calc-results",11),e.NdJ("completed",function(l){return a.isPreviewCompleted=l}),e.qZA()()()(),e._UZ(22,"steps-footer",12),e.BQk()),2&t){const n=e.MAs(10);e.xp6(1),e.cQ8("parentTitle","",e.lcZ(2,24,"payroll")," / ",a.msgTranslate(null==a.payment?null:a.payment.ar_Name,null==a.payment?null:a.payment.en_Name)," / ",e.lcZ(3,26,"retroactiveCalculations"),""),e.hYB("parentTitleLink","/payroll/",a.moduleId,"/payments/view/",null==a.payment?null:a.payment.id,""),e.Q6J("id",0)("parentLinkParams",a.subparentView),e.xp6(4),e.Q6J("ngIf",a.retroActiveId>0),e.xp6(1),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",a.paymentId,""),e.Q6J("params",a.subparentView),e.xp6(3),e.Q6J("linear",!1)("disableRipple",!0),e.xp6(2),e.s9C("label",e.lcZ(12,28,e.lcZ(13,30,"select_employees"))),e.Q6J("completed",a.isSelectEmployeeCompleted),e.xp6(5),e.Q6J("paymentId",a.paymentId),e.xp6(1),e.s9C("label",e.lcZ(18,32,e.lcZ(19,34,"preview"))),e.Q6J("completed",a.isPreviewCompleted),e.xp6(4),e.Q6J("retroactiveId",a.retroActiveId),e.xp6(1),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",a.paymentId,""),e.Q6J("stepper",n)("parentParam",a.parentParam)("pageParams",a.subparentView)}},dependencies:[u.O5,x.a,Q.J,b.T,ne.j,c.dn,c.n5,Z.C0,Z.Vq,Z.z9,L.pp,Rn,et,u.rS,I.X$]}),o})();function Kn(o,i){if(1&o&&e._UZ(0,"app-add-new-btn",3),2&o){const t=e.oxw();e.MGl("url","/payroll/",t.moduleId,"/non-recurring-variables/add"),e.Q6J("params",t.parentParam)}}function $n(o,i){if(1&o&&e._UZ(0,"app-employee-dropdown",22),2&o){const t=e.oxw();e.Q6J("control",t.formCtrls.userIDs)("submitted",t.submitted)("filter",!0)("disabled",!0)}}function Xn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-split-table",23),e.NdJ("selectedItems",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.getSelectedItem(n))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("displayedColumns",t.displayedColumns)("hasPaginator",!0)("isCenterPaginator",!0)("pageSize",30)}}let at=(()=>{class o extends h.U{constructor(t,a){super(),this.elementTransactionsService=t,this.employeesService=a,this.elementTransactionId=0,this.submitted=!1,this.isLoaded=!1,this.displayedColumns=["employee","isSelected"],this.activatedRoute.params.subscribe(n=>{this.elementTransactionId=Number(n.id??0)})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&(this.elementTransactionId>0?this.getById():0==this.elementTransactionId&&this.getAllEmployees())}ngOnInit(){this.form=this.fb.group({id:[this.elementTransactionId,{nonNullable:!0}],element_ID:[null,[r.kI.required]],transactionDate:[null,[r.kI.required,P.dN.date]],value:[null,[r.kI.required,P.dN.gt(0)]],notes:[null],userIDs:[null,[r.kI.required]]})}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.elementTransactionsService.getById(this.elementTransactionId).subscribe(t=>{t.message.messageType==p.u.Success&&(this.form.patchValue(t.data[0]),this.formCtrls.userIDs.setValue(t.data[0].person_Instance_ID)),this.errorList(t?.message?.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){let t={element_ID:this.formCtrls.element_ID.value,transactionDate:m.M6.mapDateReverse(this.formCtrls.transactionDate.value),value:this.formCtrls.value.value,notes:this.formCtrls.notes.value};this.elementTransactionId>0?this.update(t):this.create(t)}}create(t){let a={persons:this.formCtrls.userIDs.value,elemetPerson:t};this.showLoading(),this.elementTransactionsService.create(a).subscribe(n=>{n?.message?.messageType==p.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newNonRecurringVariable"),this.router.navigate([`/payroll/${this.moduleId}/non-recurring-variables`],{queryParams:this.pageParams})):this.errorList(n?.message?.messages),this.hideLoading()})}update(t){let a={person_Instance_ID:this.formCtrls.userIDs.value,id:this.elementTransactionId,...t};this.showLoading(),this.elementTransactionsService.update(a).subscribe(n=>{n?.message?.messageType==p.u.Success?this.updateSuccessfullyMsg("nonRecurringVariableUpdated"):this.errorList(n?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1}getAllEmployees(){this.employeesService.getAll().pipe(this.cancelRequest()).subscribe(t=>{if(t.message.messageType==p.u.Success){let a=t.data.map(n=>({id:n.id,employee:this.msgTranslate(n.ar_Name,n.en_Name),isSelected:!1}));this.dataSource=new f.by(a)}else this.errorList(t.message?.messages);this.isLoaded=!0})}getSelectedItem(t){this.formCtrls.userIDs.setValue(t.map(a=>a.id))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ce.f),e.Y36($e.M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-element-transactions"]],features:[e.qOj],decls:34,vars:31,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addNonRecurringVariable","editTitle","editNonRecurringVariable",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card"],["container",""],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","submitted","multi","filter"],["label","transactionDate",3,"control","submitted"],["label","value/Money","type","number",3,"control","submitted","isDecimalNumber"],["label","notes",3,"control","submitted"],[1,"form-card","mbottom-35"],["title","select_employees"],[3,"control","submitted","multi","filter","disabled",4,"ngIf"],[3,"isLoaded","dataSource","displayedColumns","hasPaginator","isCenterPaginator","pageSize","selectedItems",4,"ngIf"],[3,"id","url","pageParams","submit"],[3,"control","submitted","multi","filter","disabled"],[3,"isLoaded","dataSource","displayedColumns","hasPaginator","isCenterPaginator","pageSize","selectedItems"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,Kn,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4,5)(8,"mat-card-title",6),e._UZ(9,"page-title",7),e.qZA(),e._UZ(10,"mat-divider")(11,"div",8),e.TgZ(12,"mat-card-content",9)(13,"form",10)(14,"div",11)(15,"div",12),e._UZ(16,"app-payroll-element-by-user-dropdown",13),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"app-datepicker",14),e.qZA(),e.TgZ(19,"div",12),e._UZ(20,"app-input",15),e.qZA(),e.TgZ(21,"div",12),e._UZ(22,"app-input",16),e.qZA()()()()(),e.TgZ(23,"mat-card",17,5)(25,"mat-card-title",6),e._UZ(26,"page-title",18),e.qZA(),e._UZ(27,"mat-divider")(28,"div",8),e.TgZ(29,"mat-card-content",9)(30,"form",10),e.YNc(31,$n,1,4,"app-employee-dropdown",19),e.YNc(32,Xn,1,6,"app-split-table",20),e.qZA()()(),e.TgZ(33,"app-fixed-card-actions",21),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,27,"payroll")," / ",e.lcZ(3,29,"nonRecurringVariables"),""),e.MGl("parentTitleLink","/payroll/",a.moduleId,"/non-recurring-variables"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.elementTransactionId>0),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/non-recurring-variables/index"),e.Q6J("params",a.pageParams),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.element_ID)("submitted",a.submitted)("multi",!1)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.transactionDate)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.value)("submitted",a.submitted)("isDecimalNumber",!0),e.xp6(2),e.Q6J("control",a.formCtrls.notes)("submitted",a.submitted),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("ngIf",a.elementTransactionId>0),e.xp6(1),e.Q6J("ngIf",0==a.elementTransactionId),e.xp6(1),e.MGl("url","/payroll/",a.moduleId,"/non-recurring-variables"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.pageParams))},dependencies:[u.O5,G.Q,J.a,x.a,Q.J,b.T,Re.J,X.M,ye.C,c.a8,c.dn,c.n5,v.d,Xe.T,r._Y,r.JL,r.sg,I.X$]}),o})();function Wn(o,i){if(1&o&&e._UZ(0,"app-view-data-row-item",20),2&o){const t=e.oxw(2);e.Q6J("value",t.isCofirm)("isBool",!0)}}function ei(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",21)(1,"submit-btn",22),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.confirm())}),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("iconPositionBefore",!1))}function ti(o,i){if(1&o&&(e.TgZ(0,"div",12),e._UZ(1,"app-view-data-row-item",13)(2,"app-view-data-row-item",14),e.YNc(3,Wn,1,2,"app-view-data-row-item",15),e._UZ(4,"app-view-data-row-item",16)(5,"app-view-data-row-item",17)(6,"app-view-data-row-item",18),e.YNc(7,ei,2,1,"div",19),e.qZA()),2&o){const t=e.oxw();let a,n;e.xp6(1),e.Q6J("value",null==t.retroactive?null:t.retroactive.paymentDate),e.xp6(1),e.Q6J("value",null==t.retroactive?null:t.retroactive.toDate)("isDate",!0),e.xp6(1),e.Q6J("ngIf",t.isCofirm),e.xp6(1),e.Q6J("value",null!==(a=null==t.retroactive?null:t.retroactive.LastTransferToB1)&&void 0!==a&&a)("isDate",null==t.retroactive?null:t.retroactive.isTransfareToB1)("isBool",!(null!=t.retroactive&&t.retroactive.isTransfareToB1)),e.xp6(1),e.Q6J("value",null!==(n=null==t.retroactive?null:t.retroactive.LastTransferToS4)&&void 0!==n&&n)("isDate",null==t.retroactive?null:t.retroactive.isTransfareToS4)("isBool",!(null!=t.retroactive&&t.retroactive.isTransfareToS4)),e.xp6(1),e.Q6J("value",null==t.retroactive?null:t.retroactive.Notes),e.xp6(1),e.Q6J("ngIf",!t.isCofirm)}}function ai(o,i){1&o&&e._UZ(0,"app-view-card-row-skeleton")}function oi(o,i){if(1&o&&e._UZ(0,"add-retro-preview-calc-results",23),2&o){const t=e.oxw();e.Q6J("retroactiveId",t.retroactiveId)("paymentId",t.retroactive.paymentId)("isConfirmed",t.isCofirm)}}function ni(o,i){if(1&o&&e._UZ(0,"transfer-to-b1",24),2&o){const t=e.oxw();e.Q6J("periodCalculationId",t.retroactiveId)}}function ii(o,i){if(1&o&&e._UZ(0,"transfer-to-s4",24),2&o){const t=e.oxw();e.Q6J("periodCalculationId",t.retroactiveId)}}let li=(()=>{class o extends h.U{constructor(t){super(),this.retroactiveService=t,this.isLoaded=!1,this.retroactiveId=0,this.isCofirm=!1,this.transfareToB1=!1,this.transfareToS4=!1,this.backParams={...this.pageParams,parentView:_.S.payment_index}}ngOnInit(){this.activatedRoute.params.subscribe(t=>{this.retroactiveId=Number(t.id)??0})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getAll()}onModulesChanged(){this.subGlobalFunctions=this.getSubGlobalFunctions(_.S.payment_index,_.S.retroactive_add)}getAll(){this.retroactiveService.getById(this.retroactiveId).subscribe(t=>{t.message.messageType==p.u.Success?(this.retroactive=se(t.data)[0],this.isCofirm=se(t.data)[0].confirmation,this.isLoaded=!0):this.errorList(t?.message?.messages)})}globalFunctionActions(t){t.viewName==_.S.transfare_to_b1&&(this.transfareToB1=!this.transfareToB1),t.viewName==_.S.transfare_to_s4&&(this.transfareToS4=!this.transfareToS4)}confirm(){this.retroactiveService.confirm(this.retroactiveId).subscribe(t=>{t.message.messageType==p.u.Success?(this.isCofirm=!0,this.hideLoading()):this.errorList(t?.message?.messages)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-retroactive-view"]],features:[e.qOj],decls:17,vars:23,consts:[[1,"title-no-margin","title-section","fixed-title"],[3,"title","parentTitle","parentTitleLink","parentLinkParams","globalFunctions","action"],[3,"url","params"],[1,"clearfix"],[1,"mt-3","mbottom-20"],[1,"mt-2"],["title","generalInfo",1,"stepper-section-title"],[1,"container-fluid","mt-5"],["class","view-data-row-container",4,"ngIf"],[4,"ngIf"],[3,"retroactiveId","paymentId","isConfirmed",4,"ngIf"],[3,"periodCalculationId",4,"ngIf"],[1,"view-data-row-container"],["label","paymentDate",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","toDate",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value","isDate"],["class","col-lg-2 col-md-3 col-sm-4 col-6 mbottom-20 p-0","label","status","customValue","confirmed",3,"value","isBool",4,"ngIf"],["label","LastTransferTob1",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value","isDate","isBool"],["label","LastTransferToS4",1,"col-lg-2","col-md-12","col-sm-4","col-12","mbottom-20","p-0",3,"value","isDate","isBool"],["label","notes",1,"col-lg-2","col-md-12","col-sm-4","col-12","mbottom-20","p-0",3,"value"],["class","col-lg-2 col-md-12 col-sm-4 col-12 mbottom-20 p-0",4,"ngIf"],["label","status","customValue","confirmed",1,"col-lg-2","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value","isBool"],[1,"col-lg-2","col-md-12","col-sm-4","col-12","mbottom-20","p-0"],["icon","far fa-check-circle","label","confirm",3,"iconPositionBefore","onClick"],[3,"retroactiveId","paymentId","isConfirmed"],[3,"periodCalculationId"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(l){return a.globalFunctionActions(l)}),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"app-back-btn",2),e.qZA(),e._UZ(6,"div",3),e.TgZ(7,"mat-card",4)(8,"mat-card-title",5),e._UZ(9,"page-title",6),e.qZA(),e._UZ(10,"mat-divider",5),e.TgZ(11,"mat-card-content",7),e.YNc(12,ti,8,12,"div",8),e.YNc(13,ai,1,0,"app-view-card-row-skeleton",9),e.qZA()(),e.YNc(14,oi,1,3,"add-retro-preview-calc-results",10),e.YNc(15,ni,1,1,"transfer-to-b1",11),e.YNc(16,ii,1,1,"transfer-to-s4",11)),2&t&&(e.xp6(1),e.hYB("title","",e.lcZ(2,17,"retroactive")," ",null==a.retroactive?null:a.retroactive.paymentDate,""),e.cQ8("parentTitle","",e.lcZ(3,19,"payroll")," / ",e.lcZ(4,21,"payments")," / ",a.msgTranslate(null==a.retroactive||null==a.retroactive.pay_Payment?null:a.retroactive.pay_Payment.ar_Name,null==a.retroactive||null==a.retroactive.pay_Payment?null:a.retroactive.pay_Payment.en_Name),""),e.hYB("parentTitleLink","/payroll/",a.moduleId,"/payments/view/",null==a.retroactive?null:a.retroactive.payment_ID,""),e.Q6J("parentLinkParams",a.backParams)("globalFunctions",a.subGlobalFunctions),e.xp6(4),e.hYB("url","/payroll/",a.moduleId,"/payments/view/",null==a.retroactive?null:a.retroactive.payment_ID,""),e.Q6J("params",a.backParams),e.xp6(7),e.Q6J("ngIf",a.isLoaded),e.xp6(1),e.Q6J("ngIf",!a.isLoaded),e.xp6(1),e.Q6J("ngIf",a.retroactive),e.xp6(1),e.Q6J("ngIf",a.transfareToB1),e.xp6(1),e.Q6J("ngIf",a.transfareToS4))},dependencies:[u.O5,x.a,T.p,b.T,U.l,$.I,c.a8,c.dn,c.n5,v.d,be,Ce,et,I.X$]}),o})();var D=s(78512);let si=(()=>{class o extends Y.K{constructor(){super()}getPaySlipLst(t){return this.post("payroll/RptPaySlip/GetPaySlipList",t)}getPaySlip(t){return this.post("payroll/RptPaySlip/GetPaySlipData",t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ri=s(98814),ci=s(9615),di=s(79417),pi=s(99515);function mi(o,i){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.date,"MMM yyyy")," ")}}function ui(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"th"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.BQk()),2&o){const t=e.oxw(5);e.xp6(1),e.uIk("rowspan",t.personTable.length),e.xp6(1),e.hij(" ",e.lcZ(3,4,"month")," "),e.xp6(2),e.uIk("rowspan",t.personTable.length),e.xp6(1),e.hij(" ",t.person.payment_DATE," ")}}function _i(o,i){if(1&o&&(e.TgZ(0,"tr"),e.YNc(1,ui,6,6,"ng-container",9),e.TgZ(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA()()),2&o){const t=i.$implicit,a=i.index,n=e.oxw(4);e.xp6(1),e.Q6J("ngIf",0==a),e.xp6(2),e.hij(" ",n.msgTranslate(t.ar_PayVar,t.en_PayVar)," "),e.xp6(2),e.hij(" ",t.variable_Value," ")}}function gi(o,i){if(1&o&&(e.TgZ(0,"table",15)(1,"thead",16)(2,"tr")(3,"th",17),e._uU(4),e.ALo(5,"titlecase"),e.ALo(6,"translate"),e.qZA()()(),e.TgZ(7,"tbody")(8,"tr")(9,"th"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"td",18),e._uU(13),e.qZA()(),e.TgZ(14,"tr")(15,"th"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"td",18),e._uU(19),e.qZA()(),e.YNc(20,_i,6,3,"tr",19),e.TgZ(21,"tr")(22,"th",20),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"td",20),e.qZA()(),e.TgZ(26,"tfoot")(27,"tr")(28,"td",17),e._UZ(29,"app-view-data-row-item",21)(30,"app-view-data-row-item",22),e.qZA()()()()),2&o){const t=e.oxw(3);e.xp6(4),e.hij(" ",e.lcZ(5,11,e.lcZ(6,13,"paySlip"))," "),e.xp6(6),e.hij(" ",e.lcZ(11,15,"name")," "),e.xp6(3),e.hij(" ",t.msgTranslate(t.person.ar_Person,t.person.en_Person)," "),e.xp6(3),e.hij(" ",e.lcZ(17,17,"code")," "),e.xp6(3),e.hij(" ",t.person.code," "),e.xp6(1),e.Q6J("ngForOf",t.personTable),e.xp6(3),e.hij(" ",e.lcZ(24,19,"receiverSign")," "),e.xp6(6),e.Q6J("value",t.userName)("isViewOneLine",!0),e.xp6(1),e.Q6J("value",t.transactionTime)("isViewOneLine",!0)}}function fi(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.YNc(1,gi,31,21,"table",13),e.TgZ(2,"app-prime-paginator",14),e.NdJ("onChangePage",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.GetPaySlipForEmp(n.pageIndex+1))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.person),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const hi=function(){return["","","",""]};function bi(o,i){1&o&&(e.TgZ(0,"div",23),e._UZ(1,"app-table-skeleton",24),e.qZA()),2&o&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,hi)))}function Ci(o,i){if(1&o&&(e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,mi,3,4,"div",9),e._UZ(6,"div"),e.qZA(),e.TgZ(7,"mat-card-content",10,11),e.YNc(9,fi,3,4,"ng-container",9),e.YNc(10,bi,2,2,"div",12),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"results")),e.xp6(2),e.Q6J("ngIf",t.date),e.xp6(4),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let vi=(()=>{class o extends h.U{constructor(t){super(),this.payrollReportsService=t,this.submitted=!1,this.isLoaded=!1,this.reportId=0,this.paramsList=[{name:"Structure_id",id:D.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:D.A.StructureType_Id},{name:"Org_IDs",id:D.A.Org_IDs},{name:"WithChilds",id:D.A.WithChilds,isRequired:!0},{name:"Status_IDs",id:D.A.Status_IDs},{name:"Person_Instance_ID",id:D.A.Person_Instance_ID},{name:"PaymentId",id:D.A.PaymentId,isRequired:!0},{name:"PeriodCalculationId",id:D.A.PeriodCalculationId,isRequired:!0},{name:"IsConfirm",id:D.A.IsConfirm},{name:"IsRetroactive",id:D.A.IsRetroactive},{name:"Financial_Company_IDs",id:D.A.Financial_Company_IDs}]}onModulesChanged(){this.reportId=this.getReportGUIid(this.getViewName)}ngOnInit(){this.page.pageSize=1,this.page.numberOfNavs=10,this.userName=this.authService.getUsername}submit(t){this.params={Structure_ID:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_IDs:t.Org_IDs,Status_IDs:t.Status_IDs,Person_Instance_ID:t.Person_Instance_ID?.toString(),Financial_Company_IDs:t.Financial_Company_IDs,WithChilds:t.WithChilds,PaymentId:t.PaymentId.toString(),PeriodCalculationId:t.PeriodCalculationId.toString()},this.GetPaySlipLst()}GetPaySlipLst(){this.isLoaded=!1,this.page.length=0,this.PaySlipLst=null,this.transactionTime=null,this.payrollReportsService.getPaySlipLst(this.params).pipe(this.cancelRequest()).subscribe(t=>{if(t.message.messageType==p.u.Success){const a=String(this.params.Person_Instance_ID).split(",");this.PaySlipLst=null!=this.params.Person_Instance_ID?t.data.filter(n=>a.includes(n.person_Instance_ID.toString())):t.data,this.page.length=this.PaySlipLst.length,this.submitted=!0,this.PaySlipLst.length>0?(this.transactionTime=this.datePipe.transform(new Date,"dd/MM/yyyy, hh:mm:ss a"),this.GetPaySlipForEmp(1)):(this.personTable=null,this.person=null,this.isLoaded=!0)}else this.errorList(t?.message?.messages)})}GetPaySlipForEmp(t){this.personTable=null,this.page.pageIndex=t,this.person=this.PaySlipLst[t-1];let a=this.params;a.Person_Instance_ID=this.person?.person_Instance_ID.toString();const[n,l]=this.person.payment_DATE.split("/").map(Number);this.date=new Date(l,n-1,1),this.payrollReportsService.getPaySlip(a).pipe(this.cancelRequest()).subscribe(d=>{d.message.messageType==p.u.Success?(d.data.sort((C,A)=>C.variable_Order-A.variable_Order),this.personTable=d.data,this.isLoaded=!0):this.errorList(d?.message?.messages)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(si))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-pay-slip-rep"]],features:[e.qOj],decls:11,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","paySlip",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"paramsList","reportId","onSubmit"],["class","form-card pay-slip-rep",4,"ngIf"],[1,"form-card","pay-slip-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["id","rpt_att_card",1,"container-fluid"],["rpt_att_card",""],["class","mtop-25",4,"ngIf"],["class","table rpt-table mt-3 d-block overflow-scroll","id","rpt-table","appScrollableHorizontal","",4,"ngIf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],["id","rpt-table","appScrollableHorizontal","",1,"table","rpt-table","mt-3","d-block","overflow-scroll"],[1,"thead-light"],["colspan","4"],["colspan","3"],[4,"ngFor","ngForOf"],["colspan","2"],["label","userName","containerStyleClass","p-0",3,"value","isViewOneLine"],["label","transactionTime","containerStyleClass","p-0",3,"value","isViewOneLine"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(l){return a.submit(l)}),e.qZA()()(),e.YNc(10,Ci,11,6,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,5,"payrollReports")),e.xp6(6),e.hij(" ",e.lcZ(8,7,"filter_options")," "),e.xp6(2),e.Q6J("paramsList",a.paramsList)("reportId",a.reportId),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[u.sg,u.O5,b.T,ri.I,ci.m,U.l,di.c,pi.n,c.a8,c.dn,c.n5,L.pp,L.ib,L.yz,L.yK,u.rS,u.uU,I.X$],styles:[".pay-slip-rep thead th:first-child{font-size:20px}  .pay-slip-rep td,   .pay-slip-rep th{width:25%}"]}),o})();const yi=[{path:"payments",data:{view:_.S.payments},children:[{path:"",redirectTo:"index",pathMatch:E.U.full},{path:"index",component:nt,data:{view:_.S.payment_index},canActivate:[y.r]},{path:"add",component:Ae,data:{view:_.S.payment_add},canActivate:[y.r]},{path:"edit/:id",component:Ae,data:{view:_.S.payment_add},canActivate:[y.r]},{path:"view/:id",component:Xa,data:{view:_.S.payment_add},canActivate:[y.r]},{path:"period-calculation",data:{view:_.S.add_period_calculation},children:[{path:"add/:paymentId",component:Ue,data:{view:_.S.add_period_calculation},canActivate:[y.r]},{path:"edit/:id",component:Ue,data:{view:_.S.add_period_calculation},canActivate:[y.r]},{path:"view/:id",component:Co,data:{view:_.S.add_period_calculation},canActivate:[y.r]}]},{path:"retro-active",data:{view:_.S.retroactive_index},children:[{path:"add/:paymentId",component:tt,data:{view:_.S.retroactive_add},canActivate:[y.r]},{path:"view/:id",component:li,data:{view:_.S.retroactive_add},canActivate:[y.r]},{path:"edit/:id",component:tt,data:{view:_.S.retroactive_add},canActivate:[y.r]}]}]},{path:"loans",data:{view:_.S.loans},children:[{path:"",redirectTo:"index",pathMatch:E.U.full},{path:"index",component:Do,data:{view:_.S.loans_index},canActivate:[y.r]},{path:"add",component:ze,data:{view:_.S.loans_add},canActivate:[y.r]},{path:"edit/:id",component:ze,data:{view:_.S.loans_add},canActivate:[y.r]},{path:"view/:id",component:ve,data:{view:_.S.loans_add},canActivate:[y.r]},{path:"postpone",component:Zn,data:{view:_.S.loans_postpone},canActivate:[y.r]}]},{path:"non-recurring-variables",data:{view:_.S.non_recurring_variables},children:[{path:"",redirectTo:"index",pathMatch:E.U.full},{path:"index",component:hn,data:{view:_.S.non_recurring_variables_index},canActivate:[y.r]},{path:"add",component:at,data:{view:_.S.non_recurring_variable_add},canActivate:[y.r]},{path:"edit/:id",component:at,data:{view:_.S.non_recurring_variable_add},canActivate:[y.r]},{path:"download",component:Pn,data:{view:_.S.download_non_recurring_variables},canActivate:[y.r]}]},{path:"reports",data:{view:_.S.payroll_reports},children:[{path:"pay-slip",component:vi,data:{view:_.S.pay_slip_report},canActivate:[y.r]}]}];let Ii=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[oe.Bz.forChild(yi),oe.Bz]}),o})();var Ti=s(86128);function wi(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isView=!1)}),e._UZ(1,"i",10),e.qZA()}}function Si(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isView=!0)}),e._UZ(1,"i",11),e.qZA()}}function Zi(o,i){1&o&&(e.TgZ(0,"div",27)(1,"span",28),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"canceled")))}function Ai(o,i){if(1&o&&(e.TgZ(0,"div",27)(1,"span",29),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4),e.ALo(5,"translate"),e.qZA()),2&o){const t=e.oxw(4);e.xp6(2),e.Oqu(e.lcZ(3,3,"active")),e.xp6(2),e.AsE(" - ",t.loan.RemInstallments," ",e.lcZ(5,5,"installmentsRemaining")," ")}}function xi(o,i){if(1&o&&(e.ynx(0,25),e.YNc(1,Zi,4,3,"div",26),e.YNc(2,Ai,6,7,"div",26),e.BQk()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",null==t.loan||null==t.loan.paY_loan?null:t.loan.paY_loan.isCanceled),e.xp6(1),e.Q6J("ngIf",!(null!=t.loan&&null!=t.loan.paY_loan&&t.loan.paY_loan.isCanceled))}}function Pi(o,i){if(1&o&&(e.TgZ(0,"div")(1,"div",14),e._UZ(2,"app-view-data-row-item",15)(3,"app-view-data-row-item",16)(4,"app-view-data-row-item",17)(5,"app-view-data-row-item",18)(6,"app-view-data-row-item",19),e.qZA(),e.TgZ(7,"div",14)(8,"div",20)(9,"div",0)(10,"app-view-data-row-item",21),e.YNc(11,xi,3,2,"ng-container",22),e.qZA(),e._UZ(12,"app-view-data-row-item",23)(13,"app-view-data-row-item",24),e.qZA()()()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("value",null==t.loan?null:t.loan.employeeName),e.xp6(1),e.Q6J("value",null==t.loan?null:t.loan.payment),e.xp6(1),e.Q6J("value",t.loan.loanType),e.xp6(1),e.Q6J("value",null==t.loan?null:t.loan.issueDate),e.xp6(1),e.Q6J("value",null==t.loan?null:t.loan.dueDate),e.xp6(5),e.Q6J("ngIf",null==t.loan?null:t.loan.paY_loan),e.xp6(1),e.Q6J("value",t.loan.interval_type),e.xp6(1),e.Q6J("value",t.loan.variable)}}function Li(o,i){1&o&&e._UZ(0,"app-view-card-row-skeleton")}function Di(o,i){if(1&o&&(e.TgZ(0,"div",12),e.YNc(1,Pi,14,8,"div",13),e.YNc(2,Li,1,0,"app-view-card-row-skeleton",13),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}function Vi(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"app-loan-general-data",30),e.NdJ("closeAfterUpdate",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.returnToView(n))}),e.qZA()}2&o&&e.Q6J("isView",!0)}let Ni=(()=>{class o extends h.U{constructor(t,a){super(),this.loansService=t,this.loanViewComponent=a,this.editAll=!1,this.isView=!0,this.loan=null,this.isLoaded=!1}ngOnInit(){this.loan=W([this.loansService.getLoan()??null])[0],this.isLoaded=!!this.loan?.paY_loan,this.loansService.loan$.subscribe(t=>{t?.paY_loan&&(this.loan=W([t])[0],this.isLoaded=!0)})}ngOnChanges(t){t?.editAll&&!t?.editAll?.firstChange&&(this.isView=!1)}returnToView(t){this.isView=!0,t&&this.loanViewComponent.GetById()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ee.x),e.Y36(ve))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-loan-general-data-view"]],inputs:{editAll:"editAll",isView:"isView"},features:[e.qOj,e.TTD],decls:13,vars:6,consts:[[1,"row"],[1,"col-12"],["container",""],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],["mat-button","","class","float-right section-edit-btn pright-6 pleft-6 darkBlue",3,"click",4,"ngIf"],[1,"mt-2"],["class","mtop-30",4,"ngIf","ngIfElse"],["form",""],["mat-button","",1,"float-right","section-edit-btn","pright-6","pleft-6","darkBlue",3,"click"],[1,"fas","fa-pen","font-size-15"],[1,"ft-corner-up-left","font-size-18"],[1,"mtop-30"],[4,"ngIf"],[1,"view-data-row-container"],["label","employeename",1,"col-md-3","col-xs-6","mbottom-20","p-0",3,"value"],["label","payment",1,"col-md","col-xs-6","mbottom-20","p-0",3,"value"],["label","loanType",1,"col-md","col-xs-6","mbottom-20","p-0",3,"value"],["label","issueDate",1,"col-md","col-xs-6","mbottom-20","p-0",3,"value"],["label","dueDate",1,"col-md","col-xs-6","mbottom-20","p-0",3,"value"],[1,"col-md-9","col-sm-12"],["label","status","value"," ",1,"col-lg-4","col-md-3","col-sm-4","col-6","mbottom-20","p-0"],["class","content",4,"ngIf"],["label","interval_type",1,"col-lg-3","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],["label","variable",1,"col-lg-3","col-md-3","col-sm-4","col-6","mbottom-20","p-0",3,"value"],[1,"content"],["class","interMedium",4,"ngIf"],[1,"interMedium"],[1,"badge-danger"],[1,"success"],[3,"isView","closeAfterUpdate"]],template:function(t,a){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",null,2)(4,"mat-card-title",3),e._UZ(5,"page-title",4),e.YNc(6,wi,2,0,"button",5),e.YNc(7,Si,2,0,"button",5),e.qZA(),e._UZ(8,"mat-divider",6),e.TgZ(9,"mat-card-content"),e.YNc(10,Di,3,2,"div",7),e.YNc(11,Vi,1,1,"ng-template",null,8,e.W1O),e.qZA()()()()),2&t){const n=e.MAs(12);e.xp6(2),e.ekj("pb-0",a.isLoaded),e.xp6(4),e.Q6J("ngIf",a.isView),e.xp6(1),e.Q6J("ngIf",!a.isView),e.xp6(3),e.Q6J("ngIf",a.isView)("ngIfElse",n)}},dependencies:[u.O5,b.T,U.l,$.I,V.lW,c.a8,c.dn,c.n5,v.d,Ee,I.X$]}),o})(),Ji=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,Ii,Ti.m]}),o})();e.B6R(ve,[u.O5,x.a,Q.J,b.T,xe.Q,c.n5,je,Ni],[I.X$])},3710:(ot,ae,s)=>{s.d(ae,{r:()=>y});var u=s(94650),oe=s(67579),_=s(24280),E=s(80458);let y=(()=>{class m{constructor(k,M){this.viewsService=k,this.router=M,this.loadingService=(0,u.f3M)(oe.b),this.UserModules=this.viewsService.UserModules$.getValue(),this.loading=document.getElementById("page-loading")}canActivate(k,M){let B=k.data?.view;if(this.showLoading(),this.UserModules?.length>0){if(this.viewsService.isViewAllowed(B))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}else this.viewsService.UserModules$.subscribe(f=>{if(f?.length>0){if(this.viewsService.isViewAllowed(B))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}})}showLoading(){this.loading.style.display="block",this.loading.style.opacity="1",this.loading.style.zIndex="998"}hideLoading(){this.loading.style.display="none",this.loading.style.opacity="0",this.loading.style.zIndex="0"}}return m.\u0275fac=function(k){return new(k||m)(u.LFG(_.Z),u.LFG(E.F0))},m.\u0275prov=u.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);