"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[159],{51159:(se,L,l)=>{l.r(L),l.d(L,{PayrollSetupModule:()=>ae});var b=l(36895),Z=l(80458),u=l(30671),p=l(15602),y=l(58385),e=l(94650),I=l(18521),g=l(21854);let S=(()=>{class s extends I.K{constructor(){super()}create(t){return this.post("PayrollElementSetup/Create",t)}update(t){return this.post("PayrollElementSetup/Edit",t)}getList(t){return this.get("PayrollElementSetup/GetList",{params:{...t,$expand:`${g.db.PAY_Element_Variable},${g.db.PAY_Element_Variable}/${g.db.PAY_Variable}`}})}getAll(){return this.get("PayrollElementSetup/GetAll")}getById(t){return this.get("PayrollElementSetup/GetAll",{params:{$expand:`${g.db.PAY_Element_Variable},${g.db.PAY_Element_Variable}/${g.db.PAY_Variable}`,$filter:`id eq ${t}`}})}Delete(t){return this.delete("PayrollElementSetup/Delete",{params:{Id:t}})}createUser(t){return this.post("PayrollElementSetup/Create_Element_Users_Details",t)}getAllUsersByPayrollElement(t){return this.get("PayrollElementSetup/GetAll_Element_Users_Details",{params:{Element_ID:t}})}DeleteUser(t){return this.delete("PayrollElementSetup/Delete_Element_Users_Details",{params:t})}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var v=l(56184),f=l(46896),m=l(73546),_=l(44850),C=l(86405);let J=(()=>{class s extends y.d{constructor(t){super(),this.payrollElementsService=t,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","actions"],this.optionalColomns=["variableCode","display_In_Result"],this.isLoaded=!1}ngOnInit(){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.CheckNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.currentPage)}getList(t,a){this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:this.page.pageIndex,pageSize:this.page.pageSize};this.showLoading(),this.payrollElementsService.getList(o).subscribe(n=>{if(n.message.messageType==p.u.Success){if(0==n.data.length&&t>1)return void this.getList(this.prevPage);n.data.map(d=>{d.en_Name=d.name,d.variableCode=d.paY_Element_Variable[0].pay_Variable.code,d.display_In_Result=d.paY_Element_Variable[0].pay_Variable.display_In_Result}),this.dataSource=new u.by(n.data),this.isLoaded=!0,this.page.length=n.meta.totalItemCount}else this.errorList(n.message.messages);this.hideLoading()})}onDelete(t){let a=this.msgTranslate(t.ar_Name,t.en_Name);this.deleateDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.payrollElementsService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a.message.messages),this.hideLoading()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(S))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payroll-elements-index"]],features:[e.qOj],decls:8,vars:7,consts:[[1,"row"],[1,"col-12"],["title","payrollElements",3,"globalFunctions"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.qZA(),e._UZ(6,"mat-divider"),e.TgZ(7,"app-material-table",3),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("actions",a.rowFunctions))},dependencies:[v.I,f.T,m.a8,m.n5,_.d,C.Ro]}),s})();var r=l(24006),U=l(50617),c=l(78937),P=l(45471),R=l(37167),E=l(65959),F=l(19366),Q=l(18825),A=l(22289),T=l(53026),M=l(32222),Y=l(39672);function G(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-material-table",13),e.NdJ("deleteRow",function(o){e.CHM(t);const n=e.oxw();return e.KtG(n.onDelete(o))}),e.qZA(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("actions",t.rowFunctions)("showPaginator",!1)("showFilter",!1)}}let z=(()=>{class s extends y.d{constructor(t){super(),this.payrollElementsService=t,this.submitted=!1,this.mandatoryColomns=["Ser","name","dateFrom","dateTo","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({UserID:[null,[r.kI.required]],DateFrom:[null,[r.kI.required]],DateTo:[null,[r.kI.required]]},{validator:c.w.compareDates("DateFrom","DateTo")})}ngOnChanges(t){}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.payrollElementId&&this.CheckNoBusinessOrCompany()&&this.getAll()}get formCtrls(){return this.form.controls}getAll(){this.showLoading(),this.payrollElementsService.getAllUsersByPayrollElement(this.payrollElementId).subscribe(t=>{t.message.messageType==p.u.Success?(t.data.map(a=>{a.dateFrom=this.mapDate(a.dateFrom),a.dateTo=this.mapDate(a.dateTo),a.name=a.uM_Users.name,a.id=a.userID}),this.dataSource=new u.by(t.data),this.isLoaded=!0):this.errorList(t.message.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){const t=[{ElementID:this.payrollElementId,UserID:this.form.value.UserID,DateFrom:this.mapDateReverse(this.form.value.DateFrom),DateTo:this.mapDateReverse(this.form.value.DateTo)}];this.create(t)}}create(t){this.showLoading(),this.payrollElementsService.createUser(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.clearForm(),this.addSuccessfullyMsg(a?.message?.messageTypeName),this.getAll()):this.errorList(a.message.messages),this.hideLoading()})}onDelete(t){let a=this.msgTranslate(t.uM_Users.name);this.deleateDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){let a={elementid:this.payrollElementId,userid:t.uM_Users.id,from:this.resetDateFormat(t.dateFrom),to:this.resetDateFormat(t.dateTo)};this.showLoading(),this.payrollElementsService.DeleteUser(a).subscribe(o=>{o.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg(o?.message?.messageTypeName),this.getAll()):this.errorList(o.message.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1}resetDateFormat(t){return t.split("-").reverse().join("-").concat("T00:00:00")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(S))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payroll-element-users"]],inputs:{payrollElementId:"payrollElementId"},features:[e.qOj,e.TTD],decls:16,vars:9,consts:[[1,"pt-2"],["title","users"],[1,"container-fluid","mb-0"],[1,"row"],[1,"col-lg-11","col-md-10"],[3,"formGroup"],[1,"col-md-4","col-12"],[3,"control","submitted"],["label","dateFrom",3,"control","submitted"],["label","dateTo",3,"control","submitted"],[1,"col-lg-1","col-md-2","p-0"],[1,"mtop-3","btn-sm","float-right","my-0",3,"disabled","onClick"],[4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","showPaginator","showFilter","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"mat-card-content",2)(3,"div",3)(4,"div",4)(5,"form",5)(6,"div",3)(7,"div",6),e._UZ(8,"app-users-dropdown",7),e.qZA(),e.TgZ(9,"div",6),e._UZ(10,"app-datepicker",8),e.qZA(),e.TgZ(11,"div",6),e._UZ(12,"app-datepicker",9),e.qZA()()()(),e.TgZ(13,"div",10)(14,"submit-btn",11),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()(),e.YNc(15,G,2,7,"ng-container",12)),2&t&&(e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.UserID)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.DateFrom)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.DateTo)("submitted",a.submitted),e.xp6(2),e.Q6J("disabled",!a.payrollElementId),e.xp6(1),e.Q6J("ngIf",a.payrollElementId))},dependencies:[b.O5,M.Q,v.I,Y.$,T.p,f.T,m.dn,m.n5,r._Y,r.JL,r.sg]}),s})();function V(s,i){if(1&s&&e._UZ(0,"app-add-new-btn",4),2&s){const t=e.oxw();e.MGl("url","/payroll-setup/",t.moduleId,"/payroll-elements/add"),e.Q6J("params",t.parantParam)}}function B(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"reset-form-btn",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.clearForm())}),e.qZA()}}let w=(()=>{class s extends y.d{constructor(t){super(),this.payrollElementsService=t,this.submitted=!1}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.payrollElementId=Number(t.get("payrollElementId"))??0}),this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,[r.kI.required,c.w.whiteSpace]],en_name:[null,[r.kI.required,c.w.whiteSpace]],variableCode:[null,[r.kI.required,c.w.whiteSpace,c.w.noSpace,r.kI.pattern(U.g.variableCode_pattern)]],element_Group_ID:[null,[r.kI.required]],display_In_Result:[null]})}onChangeBusinessAndCompanyId(){this.payrollElementId>0&&this.CheckNoBusinessOrCompany()&&this.getById()}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.payrollElementsService.getById(this.payrollElementId).subscribe(t=>{t.message.messageType==p.u.Success?this.payrollElementToEdit(t.data[0]):this.errorList(t.message.messages),this.hideLoading()})}payrollElementToEdit(t){this.form.patchValue(t),this.formCtrls.en_name.setValue(t.name),this.formCtrls.variableCode.setValue(t.paY_Element_Variable[0].pay_Variable.code),this.formCtrls.display_In_Result.setValue(t.paY_Element_Variable[0].pay_Variable.display_In_Result)}submit(){if(this.submitted=!0,this.form.valid){const t={PAY_Element:{ID:this.form.value.id,ar_Name:this.form.value.ar_Name,name:this.form.value.en_name,element_Group_ID:this.form.value.element_Group_ID},variableCode:this.form.value.variableCode.trim(),display_In_Result:this.form.value.display_In_Result??!1};0==t.PAY_Element.ID?this.create(t):this.update(t)}}create(t){this.showLoading(),this.payrollElementsService.create(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.payrollElementId=a.data.id,this.formCtrls.id.setValue(this.payrollElementId),this.navigateTo(`/payroll-setup/${this.moduleId}/payroll-elements/edit/${this.payrollElementId}`),this.addSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a.message.messages),this.hideLoading()})}update(t){this.showLoading(),this.payrollElementsService.update(t).subscribe(a=>{a.message.messageType==p.u.Success?this.updateSuccessfullyMsg(a?.message?.messageTypeName):this.errorList(a.message.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(S))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-payroll-element"]],features:[e.qOj],decls:28,vars:17,consts:[[1,"row"],[1,"col-12"],["addTitle","payrollElements","editTitle","editPayrollElement",3,"id"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["label","variableCode",3,"control","submitted"],[1,"col-md-6","col-12"],[3,"control","submitted"],[1,"col-md-6","col-12","ptop-15","pbottom-15"],["label","display_In_Result","color","primary",1,"mx-2",3,"control"],["align","end"],[3,"id","onClick"],[3,"click",4,"ngIf"],[3,"payrollElementId"],[3,"click"]],template:function(t,a){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.YNc(6,V,1,2,"app-add-new-btn",3),e._UZ(7,"app-back-btn",4),e.qZA(),e.TgZ(8,"mat-card-content",5)(9,"div",0)(10,"div",1)(11,"form",6)(12,"div",0)(13,"div",7),e._UZ(14,"app-input",8),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-input",9),e.qZA(),e.TgZ(17,"div",7),e._UZ(18,"app-input",10),e.qZA(),e.TgZ(19,"div",11),e._UZ(20,"app-element-groups-dropdown",12),e.qZA(),e.TgZ(21,"div",13),e._UZ(22,"app-check-box",14),e.qZA()()()()()(),e.TgZ(23,"mat-card-actions",15)(24,"submit-btn",16),e.NdJ("onClick",function(){return a.submit()}),e.qZA(),e.YNc(25,B,1,0,"reset-form-btn",17),e.qZA(),e._UZ(26,"mat-divider")(27,"app-payroll-element-users",18),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/payroll-setup/",a.moduleId,"/payroll-elements/index"),e.Q6J("params",a.pageParams),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.en_name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ar_Name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.variableCode)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.element_Group_ID)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.display_In_Result),e.xp6(2),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",0==a.formCtrls.id.value),e.xp6(2),e.Q6J("payrollElementId",a.payrollElementId))},dependencies:[b.O5,P.a,R.u,E.a,F.P,Q.J,A.J,T.p,f.T,m.a8,m.dn,m.n5,m.hq,_.d,C.Ro,r._Y,r.JL,r.sg,z]}),s})(),q=(()=>{class s extends I.K{constructor(){super()}create(t){return this.post("PaymentTypeSetup/Create",t)}update(t){return this.post("PaymentTypeSetup/Edit",t)}getList(t){return this.get("PaymentTypeSetup/GetList",{params:t})}getAll(){return this.get("PaymentTypeSetup/GetAll")}Delete(t){return this.delete("PaymentTypeSetup/Delete",{params:{Id:t}})}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function k(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"reset-form-btn",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.clearForm())}),e.qZA()}}let O=(()=>{class s extends y.d{constructor(t){super(),this.paymentTypesService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","en_Name","ar_NAme","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_name:[null,[r.kI.required,c.w.whiteSpace]],en_name:[null,[r.kI.required,c.w.whiteSpace]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.CheckNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.paymentTypesService.getList(o).subscribe(n=>{n.message.messageType==p.u.Success?(this.dataSource=new u.by(n.data),this.isLoaded=!0,this.page.length=n.meta.totalItemCount):this.errorList(n.message.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){const t={ID:this.form.value.id,Ar_Name:this.form.value.ar_name,En_Name:this.form.value.en_name};0==t.ID?this.create(t):this.update(t)}}create(t){this.showLoading(),this.paymentTypesService.create(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.clearForm(),this.getList(this.lastPage,this.page.pageSize),this.addSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a.message.messages),this.hideLoading()})}update(t){this.showLoading(),this.paymentTypesService.update(t).subscribe(a=>{a.message.messageType==p.u.Success?(this.clearForm(),this.getList(this.currentPage,this.page.pageSize),this.updateSuccessfullyMsg(a?.message?.messageTypeName)):this.errorList(a.message.messages),this.hideLoading()})}paymentTypeToEdit(t){this.form.patchValue(t),this.formCtrls.ar_name.setValue(t.ar_NAme),this.formCtrls.en_name.setValue(t.en_Name)}onDelete(t){let a=this.msgTranslate(t.ar_NAme,t.en_Name);this.deleateDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.paymentTypesService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize),t.id==this.formCtrls.id.value&&this.clearForm()):this.errorList(a.message.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(q))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-payment-types"]],features:[e.qOj],decls:20,vars:14,consts:[[1,"row"],[1,"col-12"],["addTitle","paymentTypes","editTitle","editPaymentType",3,"id"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-6","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],["align","end"],[3,"id","onClick"],[3,"click",4,"ngIf"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","editRow","deleteRow"],[3,"click"]],template:function(t,a){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2),e.qZA(),e.TgZ(6,"mat-card-content",3)(7,"div",0)(8,"div",1)(9,"form",4)(10,"div",0)(11,"div",5),e._UZ(12,"app-input",6),e.qZA(),e.TgZ(13,"div",5),e._UZ(14,"app-input",7),e.qZA()()()()()(),e.TgZ(15,"mat-card-actions",8)(16,"submit-btn",9),e.NdJ("onClick",function(){return a.submit()}),e.qZA(),e.YNc(17,k,1,0,"reset-form-btn",10),e.qZA(),e._UZ(18,"mat-divider"),e.TgZ(19,"app-material-table",11),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("editRow",function(n){return a.paymentTypeToEdit(n)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("id",a.formCtrls.id.value),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.en_name)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ar_name)("submitted",a.submitted),e.xp6(2),e.Q6J("id",a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("actions",a.rowFunctions))},dependencies:[b.O5,P.a,v.I,A.J,T.p,f.T,m.a8,m.dn,m.n5,m.hq,_.d,C.Ro,r._Y,r.JL,r.sg]}),s})();var N=l(43949);let j=(()=>{class s extends I.K{constructor(){super()}create(t){return this.post("LoanRules/Create",t)}getListByLoanTypeId(t,a){return this.get("LoanRules/GetList",{params:{...t,$filter:`loneTypeId eq ${a}`}})}getAll(){return this.get("LoanRules/GetAll")}Delete(t){return this.delete("LoanRules/Delete",{params:{Id:t}})}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var x=l(28548),$=l(90823),K=l(2430);let X=(()=>{class s extends y.d{constructor(t){super(),this.loanRulesService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","jobTitle","payment","variable","actions"],this.optionalColomns=["variablePercantage","monthlyInterval"],this.isLoaded=!1}ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.loanTypeId=Number(t.get("loanTypeId"))??0}),this.form=this.fb.group({jobTitleId:[null,[r.kI.required]],paymentId:[null,[r.kI.required]],variableId:[null,[r.kI.required]],variablePercantage:[null,[N.dN.digits]],monthlyInterval:[null,[N.dN.digits]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.loanTypeId&&this.CheckNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(t,a){this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.loanRulesService.getListByLoanTypeId(o,this.loanTypeId).subscribe(n=>{n.message.messageType==p.u.Success?(n.data.map(d=>{d.jobTitle=this.msgTranslate(d.core_Job_Title.ar_Name,d.core_Job_Title.en_Name),d.payment=this.msgTranslate(d.pay_Payment.ar_Name,d.pay_Payment.en_Name),d.variable=this.msgTranslate(d.pay_Variable.arName,d.pay_Variable.name)}),this.dataSource=new u.by(n.data),this.isLoaded=!0,this.page.length=n.meta.totalItemCount):this.errorList(n.message.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){if(!this.form.value.variablePercantage&&!this.form.value.monthlyInterval)return void this.warning("variablePercentageAndMonthlyIntervalMsg");this.create({loneTypeId:this.loanTypeId,jobTitleIdLst:this.form.value.jobTitleId,paymentId:this.form.value.paymentId,variableId:this.form.value.variableId,variablePercantage:this.form.value.variablePercantage,monthlyInterval:this.form.value.monthlyInterval})}}create(t){this.showLoading(),this.loanRulesService.create(t).subscribe(a=>{a?.message?.messageType==p.u.Success?(this.clearForm(),this.addSuccessfullyMsg(a?.message?.messageTypeName),this.getList(this.lastPage,this.page.pageSize)):this.errorList(a.message.messages),this.hideLoading()})}onDelete(t){let a=this.msgTranslate(`${t.jobTitle} - ${t.variable}`);this.deleateDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.loanRulesService.Delete(t.id).subscribe(a=>{a.message.messageType==p.u.Success?(this.deleteSuccessfullyMsg(a?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a.message.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(j))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-loan-rules"]],features:[e.qOj],decls:26,vars:24,consts:[[1,"row"],[1,"col-12"],["title","loanRules"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12","mbottom-10"],[3,"control","submitted","multi","filter"],[1,"col-md-4","col-12"],[3,"control","submitted","filter"],[3,"control","paymentControl","submitted","filter"],[1,"col-md-6","col-12"],["type","number","label","variablePercantage",3,"control","submitted"],["type","number","label","monthlyInterval",3,"control","submitted"],["align","end"],[3,"onClick"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e._UZ(0,"ngx-spinner"),e.TgZ(1,"div",0)(2,"div",1)(3,"mat-card")(4,"mat-card-title"),e._UZ(5,"page-title",2)(6,"app-back-btn",3),e.qZA(),e.TgZ(7,"mat-card-content",4)(8,"div",0)(9,"div",1)(10,"form",5)(11,"div",0)(12,"div",6),e._UZ(13,"app-job-title-dropdown",7),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"app-payment-dropdown",9),e.qZA(),e.TgZ(16,"div",8),e._UZ(17,"app-variable-by-payment-dropdown",10),e.qZA(),e.TgZ(18,"div",11),e._UZ(19,"app-input",12),e.qZA(),e.TgZ(20,"div",11),e._UZ(21,"app-input",13),e.qZA()()()()()(),e.TgZ(22,"mat-card-actions",14)(23,"submit-btn",15),e.NdJ("onClick",function(){return a.submit()}),e.qZA()(),e._UZ(24,"mat-divider"),e.TgZ(25,"app-material-table",16),e.NdJ("onChangePage",function(n){return a.getList(n.pageIndex+1,n.pageSize)})("deleteRow",function(n){return a.onDelete(n)}),e.qZA()()()()),2&t&&(e.xp6(6),e.MGl("url","/payroll-setup/",a.moduleId,"/loans/loan-types"),e.Q6J("params",a.pageParams),e.xp6(4),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.jobTitleId)("submitted",a.submitted)("multi",!0)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.paymentId)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.variableId)("paymentControl",a.formCtrls.paymentId)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.variablePercantage)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.monthlyInterval)("submitted",a.submitted),e.xp6(4),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("page",a.page)("actions",a.rowFunctions))},dependencies:[P.a,v.I,x.W,E.a,$.s,K.Y,T.p,f.T,m.a8,m.dn,m.n5,m.hq,_.d,C.Ro,r._Y,r.JL,r.sg]}),s})();var H=l(62195),D=l(36162),h=l(74513);const W=[{path:"payroll-elements",data:{view:h.S.payroll_elements},children:[{path:"",redirectTo:"index",pathMatch:D.U.full},{path:"index",component:J,data:{view:h.S.payroll_elements_index}},{path:"add",component:w,data:{view:h.S.add_payroll_elements}},{path:"edit/:payrollElementId",component:w,data:{view:h.S.add_payroll_elements}}]},{path:"payment-types",component:O,data:{view:h.S.payment_types}},{path:"loans",data:{view:h.S.loans},children:[{path:"",redirectTo:"loan-types",pathMatch:D.U.full},{path:"loan-types",component:H.P,data:{view:h.S.loan_types}},{path:"loan-rules/:loanTypeId",component:X,data:{view:h.S.loan_rules}}]}];let ee=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Z.Bz.forChild(W),Z.Bz]}),s})();var te=l(78475);let ae=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[b.ez,ee,te.m]}),s})()}}]);