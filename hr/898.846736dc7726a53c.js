"use strict";(self.webpackChunkhr=self.webpackChunkhr||[]).push([[898],{3710:(J,g,o)=>{o.d(g,{r:()=>h});var p=o(94650),f=o(67579),C=o(24280);let h=(()=>{class d{constructor(l){this.viewsService=l,this.loadingService=(0,p.f3M)(f.b),this.UserModules=this.viewsService.UserModules$.getValue(),this.loading=document.getElementById("page-loading")}canActivate(l,y){return!0}showLoading(){this.loading.style.display="block",this.loading.style.opacity="1",this.loading.style.zIndex="998"}hideLoading(){this.loading.style.display="none",this.loading.style.opacity="0",this.loading.style.zIndex="0"}}return d.\u0275fac=function(l){return new(l||d)(p.LFG(C.Z))},d.\u0275prov=p.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},68898:(J,g,o)=>{o.r(g),o.d(g,{DashboardSetupModule:()=>$});var p=o(36895),f=o(80458),C=o(36162),h=o(74513),d=o(24006),u=o(30671),l=o(15602),y=o(95751),_=o(35478),b=o(43949),c=o(78937),S=o(7707),D=o(61894),e=o(94650),O=o(1903);let F=(()=>{class a extends O.K{constructor(){super()}create(s){return this.post("Dashboard/DashboardProperty/Create",s)}getList(s,t){return this.get("Dashboard/DashboardProperty/GetList",{params:t})}getAll(s){return this.get("Dashboard/DashboardProperty/GetAll",{params:{$filter:`dashboard_ID eq ${s}`}})}Delete(s){return this.delete("Dashboard/DashboardProperty/Delete",{params:{Id:s}})}}return a.\u0275fac=function(s){return new(s||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var I=o(94891),T=o(25273),P=o(93410),M=o(61064),Z=o(56500),L=o(57566),N=o(46896),m=o(73546),A=o(44850),U=o(58913);function E(a,n){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.hij(" - ",s.msgTranslate(null==s.currentDashboard?null:s.currentDashboard.ar_Name,null==s.currentDashboard?null:s.currentDashboard.en_Name)," ")}}function Q(a,n){if(1&a){const s=e.EpF();e.TgZ(0,"reset-form-btn",15),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}let z=(()=>{class a extends y.U{constructor(s,t){super(),this.dashboardPropertiesService=s,this.dashboardService=t,this.submitted=!1,this.mandatoryColomns=["Ser","id","property","value","actions"],this.optionalColomns=[],this.isLoaded=!1,this.dashboardPropertiesType=S.U}ngOnInit(){this.activatedRoute.paramMap.subscribe(s=>{this.dashboardId=Number(s.get("id"))??0}),this.form=this.fb.group({id:[0,{nonNullable:!0}],propertyId:[null,[d.kI.required]],value:[null,[d.kI.required]]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.dashboardId&&this.checkNoBusinessOrCompany()&&(this.getCurrentDashboard(),this.getList(this.firstPage))}getCurrentDashboard(){this.dashboardService.getById(this.dashboardId).pipe(this.cancelRequest()).subscribe(s=>{s.message.messageType==l.u.Success?this.currentDashboard=(0,D.K)(s.data)[0]:this.errorList(s?.message?.messages)})}getList(s,t){this.page.pageIndex=s,t&&(this.page.pageSize=t),this.dashboardPropertiesService.getList(this.dashboardId,{PageNumber:s,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{r.message.messageType==l.u.Success?(this.dataSource=new u.by(function w(a){return a.map(n=>({...n,property:(0,_._)(n.properties?.ar_Name,n.properties?.en_Name)}))}(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta):this.errorList(r?.message?.messages)})}submit(){if(this.submitted=!0,this.form.valid){const s={dashboard_ID:this.dashboardId,property_ID:this.form.value.propertyId,value:this.form.value.value};this.selectedPropertyType==S.U.number&&(s.value=JSON.stringify(s.value)),this.create(s)}}create(s){this.showLoading(),this.dashboardPropertiesService.create(s).subscribe(t=>{t?.message?.messageType==l.u.Success?(this.clearForm(),this.addSuccessfullyMsg(t?.message?.messageTypeName),this.getList(this.firstPage)):this.errorList(t?.message?.messages),this.hideLoading()})}onDelete(s){this.deleteDialog(s.property).subscribe(i=>{i&&this.delete(s)})}delete(s){this.showLoading(),this.dashboardPropertiesService.Delete(s.id).subscribe(t=>{t.message.messageType==l.u.Success?(this.deleteSuccessfullyMsg(t?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(t?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset({id:0}),this.submitted=!1}onChangeProperty(s){let t=s.length>0?s[0]?.property_Type:null;t!=this.selectedPropertyType&&(this.formCtrls.value.reset(),this.formCtrls.value.setValidators(t==S.U.number?[d.kI.required,b.dN.number]:[d.kI.required,c.w.whiteSpace,c.w.atLeastOneCharacter]),this.formCtrls.value.updateValueAndValidity(),this.selectedPropertyType=t)}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(F),e.Y36(I.s))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard-properties"]],features:[e.qOj],decls:21,vars:17,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["title","dashboardProperties"],[4,"ngIf"],[3,"url","params"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-6","col-12"],[3,"control","submitted","filter","change"],["label","value",3,"control","submitted","type"],["align","end"],[3,"click",4,"ngIf"],[3,"onClick"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","onChangePage","deleteRow"],[3,"click"]],template:function(s,t){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.YNc(5,E,2,1,"span",4),e._UZ(6,"app-back-btn",5),e.qZA(),e.TgZ(7,"mat-card-content",6)(8,"div",0)(9,"div",1)(10,"form",7)(11,"div",0)(12,"div",8)(13,"app-properties-dropdown",9),e.NdJ("change",function(r){return t.onChangeProperty(r)}),e.qZA()(),e.TgZ(14,"div",8),e._UZ(15,"app-input",10),e.qZA()()()()()(),e.TgZ(16,"mat-card-actions",11),e.YNc(17,Q,1,0,"reset-form-btn",12),e.TgZ(18,"submit-btn",13),e.NdJ("onClick",function(){return t.submit()}),e.qZA()(),e._UZ(19,"mat-divider"),e.TgZ(20,"app-material-table",14),e.NdJ("onChangePage",function(r){return t.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return t.onDelete(r)}),e.qZA()()()()),2&s){let i;e.xp6(5),e.Q6J("ngIf",t.currentDashboard),e.xp6(1),e.MGl("url","/dashboard-setup/",t.moduleId,"/dashboard"),e.Q6J("params",t.pageParams),e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.propertyId)("submitted",t.submitted)("filter",!0),e.xp6(2),e.Q6J("control",t.formCtrls.value)("submitted",t.submitted)("type",null!==(i=t.selectedPropertyType)&&void 0!==i?i:t.dashboardPropertiesType.text),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(3),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)}},dependencies:[p.O5,T.a,P.I,M.a,Z.J,L.p,N.T,m.a8,m.dn,m.n5,m.hq,A.d,U.R,d._Y,d.JL,d.sg]}),a})();var R=o(34292),V=o(12613),B=o(31415),G=o(55833);function H(a,n){if(1&a&&(e.TgZ(0,"div",6),e._UZ(1,"app-input",22),e.qZA()),2&a){const s=e.oxw();e.xp6(1),e.Q6J("control",s.formCtrls.home_Order)("submitted",s.submitted)}}function Y(a,n){if(1&a){const s=e.EpF();e.TgZ(0,"reset-form-btn",23),e.NdJ("click",function(){e.CHM(s);const i=e.oxw();return e.KtG(i.clearForm())}),e.qZA()}}let k=(()=>{class a extends y.U{constructor(s){super(),this.dashboardService=s,this.submitted=!1,this.removeFiles=!1,this.mandatoryColomns=["Ser","id","en_Name","ar_Name","module","link","actions"],this.isLoaded=!1,this.optionalColomns=[]}ngOnInit(){this.form=this.fb.group({id:[0,{nonNullable:!0}],ar_Name:[null,c.w.whiteSpace],en_Name:[null,[d.kI.required,c.w.whiteSpace]],link:[null,[d.kI.required,c.w.whiteSpace,b.dN.url]],module_Id:[null,d.kI.required],service_Id:[null],isExistInHome:[!1],home_Order:[null,b.dN.gt(0)],file:[null,d.kI.required],dashboard_Order:[null,b.dN.gt(0)]})}get formCtrls(){return this.form.controls}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new u.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}getList(s,t){this.page.pageIndex=s,t&&(this.page.pageSize=t),this.dashboardService.getList({PageNumber:s,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{r.message.messageType==l.u.Success?(this.dataSource=new u.by((0,D.K)(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta):this.errorList(r?.message?.messages)})}submit(){if(this.removeFiles=!1,this.submitted=!0,this.form.valid){const s={dash_dashboard:{ID:this.formCtrls.id.value,Ar_Name:this.formCtrls.ar_Name.value,En_Name:this.formCtrls.en_Name.value,Link:this.formCtrls.link.value,Home_Order:this.formCtrls.home_Order.value??0,IsExistInHome:this.formCtrls.isExistInHome.value},Module_ID:this.formCtrls.module_Id.value,Service_ID:this.formCtrls.service_Id.value??0,Dashboard_Order:this.formCtrls.dashboard_Order.value,file:this.formCtrls.file.value};let t=_.M.objectToFormData(s);0==s.dash_dashboard.ID?this.create(t):this.update(t)}}create(s){this.showLoading(),this.dashboardService.create(s).subscribe(t=>{t?.message?.messageType==l.u.Success?(this.clearForm(),this.getList(this.firstPage,this.page.pageSize),this.addSuccessfullyMsg(t?.message?.messageTypeName)):this.errorList(t?.message?.messages),this.hideLoading()})}update(s){this.showLoading(),this.dashboardService.update(s).subscribe(t=>{t?.message?.messageType==l.u.Success?(this.clearForm(),this.getList(this.currentPage,this.page.pageSize),this.updateSuccessfullyMsg(t?.message?.messageTypeName)):this.errorList(t?.message?.messages),this.hideLoading()})}itemToEdit(s){this.form.patchValue(s),this.formCtrls.file.setValue({id:s.id,name:s.en_Name,path:"/"+s?.file?.path,size:s.file?.size,type:s.file?.mime}),console.log("edit",this.formCtrls.file.value)}onDelete(s){let t=this.msgTranslate(s.ar_Name,s.en_Name);this.deleteDialog(t).subscribe(i=>{i&&this.delete(s)})}delete(s){this.showLoading(),this.dashboardService.Delete(s.id).subscribe(t=>{t.message.messageType==l.u.Success?(this.deleteSuccessfullyMsg(t?.message?.messageTypeName),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize),s.id==this.formCtrls.id.value&&this.clearForm()):this.errorList(t?.message?.messages)})}clearForm(){this.form.reset({id:0}),this.submitted=!1,this.removeFiles=!0}changeHomeOrderValidation(){this.formCtrls.isExistInHome.value?this.formCtrls.home_Order.addValidators(d.kI.required):(this.formCtrls.home_Order.clearValidators(),this.formCtrls.home_Order.setValue(null))}}return a.\u0275fac=function(s){return new(s||a)(e.Y36(I.s))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard"]],features:[e.qOj],decls:32,vars:35,consts:[[1,"row"],[1,"col-12"],[1,"form-card"],["addTitle","dashboard","editTitle","editdDashboard",3,"id"],[1,"container-fluid"],[3,"formGroup"],[1,"col-md-4","col-12"],["label","en_Name",3,"control","submitted"],["label","ar_Name",3,"control","submitted"],[3,"control","submitted","filter"],[3,"moduleControl","control","submitted","filter","multi"],["type","number","label","DashboardOrder",3,"control","submitted"],["label","link",3,"control","submitted"],[1,"col-md-2","col-12"],["label","IsExistInHome",3,"control","onChange"],["class","col-md-4 col-12",4,"ngIf"],[1,"col-md-6","col-12"],["accept","image/*",3,"control","submitted","multiple","removeFiles","isFormValid","isEdit"],["align","end"],[3,"click",4,"ngIf"],[3,"id","onClick"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","actions","exportService","onChangePage","editRow","deleteRow"],["type","number","label","HomeOrder",3,"control","submitted"],[3,"click"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-card",2)(3,"mat-card-title"),e._UZ(4,"page-title",3),e.qZA(),e.TgZ(5,"mat-card-content",4)(6,"div",0)(7,"div",1)(8,"form",5)(9,"div",0)(10,"div",6),e._UZ(11,"app-input",7),e.qZA(),e.TgZ(12,"div",6),e._UZ(13,"app-input",8),e.qZA(),e.TgZ(14,"div",6),e._UZ(15,"app-module-dropdown",9),e.qZA(),e.TgZ(16,"div",6),e._UZ(17,"app-service-by-module-id-dropdown",10),e.qZA(),e.TgZ(18,"div",6),e._UZ(19,"app-input",11),e.qZA(),e.TgZ(20,"div",6),e._UZ(21,"app-input",12),e.qZA(),e.TgZ(22,"div",13)(23,"app-check-box",14),e.NdJ("onChange",function(){return t.changeHomeOrderValidation()}),e.qZA()(),e.YNc(24,H,2,2,"div",15),e.TgZ(25,"div",16),e._UZ(26,"primeng-file-upload",17),e.qZA()()()()()(),e.TgZ(27,"mat-card-actions",18),e.YNc(28,Y,1,0,"reset-form-btn",19),e.TgZ(29,"submit-btn",20),e.NdJ("onClick",function(){return t.submit()}),e.qZA()(),e._UZ(30,"mat-divider"),e.TgZ(31,"app-material-table",21),e.NdJ("onChangePage",function(r){return t.getList(r.pageIndex+1,r.pageSize)})("editRow",function(r){return t.itemToEdit(r)})("deleteRow",function(r){return t.onDelete(r)}),e.qZA()()()()),2&s&&(e.xp6(4),e.Q6J("id",t.formCtrls.id.value),e.xp6(4),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("control",t.formCtrls.en_Name)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.ar_Name)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.module_Id)("submitted",t.submitted)("filter",!0),e.xp6(2),e.Q6J("moduleControl",t.formCtrls.module_Id)("control",t.formCtrls.service_Id)("submitted",t.submitted)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",t.formCtrls.dashboard_Order)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.link)("submitted",t.submitted),e.xp6(2),e.Q6J("control",t.formCtrls.isExistInHome),e.xp6(1),e.Q6J("ngIf",t.formCtrls.isExistInHome.value),e.xp6(2),e.Q6J("control",t.formCtrls.file)("submitted",t.submitted)("multiple",!1)("removeFiles",t.removeFiles)("isFormValid",t.form.valid)("isEdit",null!=t.formCtrls.file),e.xp6(2),e.Q6J("ngIf",t.formCtrls.id.value>0),e.xp6(1),e.Q6J("id",t.formCtrls.id.value),e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)("exportService",t.dashboardService))},dependencies:[p.O5,T.a,P.I,R.Y,V.u,Z.J,L.p,N.T,B.a,m.a8,m.dn,m.n5,m.hq,A.d,G.y,d._Y,d.JL,d.sg]}),a})();var v=o(3710),K=o(8724),j=o(91373);const W=[{path:"dashboard",data:{view:h.S.dashboard_setup},children:[{path:"",pathMatch:C.U.full,component:k,data:{view:h.S.dashboard_setup},canActivate:[v.r]},{path:"dashboard-properties/:id",component:z,data:{view:h.S.dashboard_properties},canActivate:[v.r]},{path:"home-dashboard",component:j.b,data:{view:h.S.home_dashboard},canActivate:[v.r]}]},{path:"properties",component:K.a,data:{view:h.S.properties},canActivate:[v.r]}];let x=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.Bz.forChild(W),f.Bz]}),a})();var X=o(66393);let $=(()=>{class a{}return a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.ez,x,X.m]}),a})()}}]);