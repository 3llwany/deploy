(self.webpackChunkhr=self.webpackChunkhr||[]).push([[783],{61783:(ge,re,S)=>{"use strict";S.r(re),S.d(re,{AttendanceModule:()=>Si});var Q=S(36895),Y=S(92634),ne=S(80458),K=S(36162),U=S(74513),F=S(3710),s=S(24006),v=S(15602),M=S(95751),d=S(35478),T=S(78937),x=S(43949),e=S(94650),L=S(18521);let w=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/ExceptionPlan/GetList",{params:{...t}})}Delete(t){return this.delete("TimeAttendance/ExceptionPlan/Delete",{body:t})}getAll(){return this.get("TimeAttendance/ExceptionPlan/GetAll")}getById(t){return this.get("TimeAttendance/ExceptionPlan/GetAll",{params:{$filter:`Person_Instance_ID eq ${t.Person_INstance_ID}  and Plan_ID eq ${t.Plan_ID} and FromDate eq ${t.FromDate}  and ToDate eq  ${t.ToDate}`}})}create(t){return this.post("TimeAttendance/ExceptionPlan/Create",t)}update(t){return this.post("TimeAttendance/ExceptionPlan/Edit",t)}getEmployeesList(t){return this.get("TimeAttendance/ExceptionPlan/Create_GetAll",{params:t})}upload(t){return this.post("TimeAttendance/UploadExceptionPlan/Upload",t)}download(){return this.get("TimeAttendance/UploadExceptionPlan/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var b=S(79395),g=S(70137),l=S(25273),c=S(12613),h=S(61064),f=S(52682),p=S(46896),y=S(78192),P=S(53267),m=S(73546),D=S(44850),_=S(15362),R=S(47414),q=S(91508),G=S(16354),C=S(92665),u=S(49274);function O(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/plan-adjustment/add"),e.Q6J("params",t.parentParam)}}function A(n,i){if(1&n&&(e.ynx(0),e._UZ(1,"hr")(2,"employee-table-by-multi-policyIds",27),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("control",t.formCtrls.selectedEmployeeIDs)("policyControl",t.formCtrls.policyGroupId)("jobControl",t.formCtrls.jobId)("orgControl",t.formCtrls.orgId)("autoSelectedItems",t.formCtrls.selectedEmployeeIDs.value)("displayCurrentPlan",!0)("splitTableNumber",1)("pageSize",10)("noOfDays",null==t.formCtrls.noOfDays?null:t.formCtrls.noOfDays.value)("exceptionalPlan",t.selectedPlanName)("showFilter",0==t.planId)("hideSelect",t.planId>0)("filterByCode",t.planId>0)("showPaginator",0==t.planId)("employeeCode",t.currentEmpCode)}}function E(n,i){1&n&&(e._UZ(0,"p-message",28),e.ALo(1,"translate")),2&n&&e.s9C("text",e.lcZ(1,1,"canNotEditPlanAdjustment"))}let N=(()=>{class n extends M.U{constructor(t,a){super(),this.planAdjustmentService=t,this.policyDetailsService=a,this.submitted=!1,this.planId=0,this.isLoaded=!1,this.selectedPlanName="",this.canEdit=!0,this.activatedRoute.params.subscribe(o=>{this.planId=Number(o.planId??0),(o.empId||o.planId)&&(this.getByIdParams={Person_INstance_ID:Number(o.empId),Plan_ID:Number(o.planId)})}),this.activatedRoute.queryParams.subscribe(o=>{if(o.fromDate||o.toDate){this.getByIdParams.ToDate=o.toDate,this.getByIdParams.FromDate=o.fromDate;let r=new Date(o.fromDate),I=new Date;I.setHours(0,0,0,0),r.setHours(0,0,0,0),I.getTime()>=r.getTime()&&(this.canEdit=!1)}})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getByIdParams&&this.getById()}ngOnInit(){this.form=this.fb.group({id:[this.getByIdParams?1:0,{nonNullable:!0}],orgId:[[]],jobId:[[]],plan_ID:[null,[s.kI.required]],policyGroupId:[null,[s.kI.required]],is_Apply_Rules:[!0],fromDate:[null,[s.kI.required,x.dN.date]],toDate:[null,[s.kI.required,x.dN.date]],noOfDays:[null],reason_Override:[null],note:[null],selectedEmployeeIDs:[[],[s.kI.required]]},{validator:T.w.compareDates("fromDate","toDate")}),this.formCtrls?.fromDate?.valueChanges.subscribe(t=>{this.formCtrls.policyGroupId.value&&null!=t&&this.planId>0&&this.getPolicyDetails(this.formCtrls.policyGroupId.value,t)}),this.page.pageSize=5}get formCtrls(){return this.form.controls}getById(){this.isLoaded=!1,this.showLoading(),this.planAdjustmentService.getById(this.getByIdParams).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=t.data[0];this.oldPlanAdjustmentData=a,this.form.patchValue(a),this.formCtrls.note.setValue(a.note?.trim()),this.formCtrls.policyGroupId.setValue([a.policyGroupId]),this.onChangeDates(),this.formCtrls.selectedEmployeeIDs.setValue([a?.core_Person_Instance?.core_Person?.id]),this.currentEmpCode=a?.core_Person_Instance?.core_Person?.code,this.getPolicyDetails(a.policyGroupId,this.formCtrls.fromDate.value),this.isLoaded=!0}else this.errorList(t?.message?.messages);this.hideLoading()})}submit(){if(this.submitted=!0,0==this.formCtrls.selectedEmployeeIDs.value.length)return this.warning("selectOneEmployee");if(this.form.valid){let t={PlanException:{Plan_ID:this.formCtrls.plan_ID.value,FromDate:d.M6.mapDateReverse(this.formCtrls.fromDate.value),ToDate:d.M6.mapDateReverse(this.formCtrls.toDate.value),Is_Apply_Rules:this.formCtrls.is_Apply_Rules.value,Reason_Override:this.formCtrls.reason_Override.value,Note:this.formCtrls.note.value},SelectedEmployeeIDs:this.formCtrls.selectedEmployeeIDs.value};this.formCtrls.id.value>0?this.update(t):this.create(t)}}create(t){this.showLoading(),this.planAdjustmentService.create(t).subscribe(a=>{a?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newPlanAdjustment"),this.router.navigate([`/attendance/${this.moduleId}/plan-adjustment`],{queryParams:this.pageParams})):this.errorList(a?.message?.messages),this.hideLoading()})}update(t){if(this.canEdit){let a={...t,OldEmployeeData:{Plan_ID:this.oldPlanAdjustmentData.plan_ID,FromDate:this.oldPlanAdjustmentData.fromDate,ToDate:this.oldPlanAdjustmentData.toDate,Is_Apply_Rules:this.oldPlanAdjustmentData.is_Apply_Rules,Reason_Override:this.oldPlanAdjustmentData.reason_Override,Note:this.oldPlanAdjustmentData.note,person_Instance_ID:this.formCtrls.selectedEmployeeIDs.value[0]}};this.showLoading(),this.planAdjustmentService.update(a).subscribe(o=>{o?.message?.messageType==v.u.Success?(this.updateSuccessfullyMsg("planAdjustmentUpdated"),this.navigateTo(`/attendance/${this.moduleId}/plan-adjustment/edit/${this.getByIdParams.Person_INstance_ID}/${a.PlanException.Plan_ID}`,{fromDate:a.PlanException.FromDate,toDate:a.PlanException.ToDate,...this.parentParam,...this.pageParams})):this.errorList(o?.message?.messages),this.hideLoading()})}}onSelectPlan(t){this.selectedPlanName=t?.length>0?this.msgTranslate(t[0].ar_Name,t[0].en_Name):""}onChangeDates(){let t;t=this.formCtrls.fromDate.value&&this.formCtrls.toDate.value?d.M6.calculateDaysBetweenTwoDates(this.formCtrls.fromDate.value,this.formCtrls.toDate.value):null,this.formCtrls.noOfDays.setValue(t)}getPolicyDetails(t,a){this.policyDetailsService.getPolicyDetailsByDate(t,d.M6.mapDateReverse(a)).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==v.u.Success?this.plans_EnableIds=o.data.plans_SelectedIds:this.errorList(o?.message?.messages)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w),e.Y36(b.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-plan-adjustment"]],features:[e.qOj],decls:39,vars:55,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addPlanAdjustment","editTitle","editPlanAdjustment",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mbottom-35"],["container",""],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25","mbottom-15"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","submitted","filter","multi","disable"],["label","job",3,"control","organizationControl","organizationControlRequired","submitted","filter","multi"],["label","plan",3,"control","submitted","filter","EnabledIds","change"],["label","is_Apply_Rules","labelPosition","before","styleClass","margin-17",3,"control"],["label","effectiveDate",3,"control","submitted","change"],["label","endDate",3,"control","submitted","change"],[3,"control","planCtrl","fromDateCtrl","submitted","disable","filter","multi"],["label","noOfDays",3,"control","submitted","type","disabled"],["label","reasonForOverride",3,"control","submitted"],["label","notes",3,"control","submitted"],[4,"ngIf"],[1,"mtop-20"],["severity","warn",3,"text",4,"ngIf"],["saveLabel","add",3,"id","disabledSave","url","pageParams","submit"],[3,"control","policyControl","jobControl","orgControl","autoSelectedItems","displayCurrentPlan","splitTableNumber","pageSize","noOfDays","exceptionalPlan","showFilter","hideSelect","filterByCode","showPaginator","employeeCode"],["severity","warn",3,"text"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,O,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4,5)(8,"mat-card-title",6),e._UZ(9,"page-title",7),e.qZA(),e._UZ(10,"mat-divider")(11,"div",8),e.TgZ(12,"mat-card-content",9)(13,"form",10)(14,"div",11)(15,"div",12),e._UZ(16,"app-organization-current-structure-dropdown",13),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"app-job-title-by-org-dropdown",14),e.qZA(),e.TgZ(19,"div",12)(20,"app-attendance-plan-dropdown",15),e.NdJ("change",function(r){return a.onSelectPlan(r)}),e.qZA()(),e.TgZ(21,"div",12),e._UZ(22,"app-check-box",16),e.qZA(),e.TgZ(23,"div",12)(24,"app-datepicker",17),e.NdJ("change",function(){return a.onChangeDates()}),e.qZA()(),e.TgZ(25,"div",12)(26,"app-datepicker",18),e.NdJ("change",function(){return a.onChangeDates()}),e.qZA()(),e.TgZ(27,"div",12),e._UZ(28,"policy-groups-by-att-plan-dropdown",19),e.qZA(),e.TgZ(29,"div",12),e._UZ(30,"app-input",20),e.qZA(),e.TgZ(31,"div",12),e._UZ(32,"app-input",21),e.qZA(),e.TgZ(33,"div",12),e._UZ(34,"app-input",22),e.qZA()()(),e.YNc(35,A,3,15,"ng-container",23),e.TgZ(36,"div",24),e.YNc(37,E,2,3,"p-message",25),e.qZA()()(),e.TgZ(38,"app-fixed-card-actions",26),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,51,"attendanceTracker")," / ",e.lcZ(3,53,"plan-adjustment"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/plan-adjustment"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/plan-adjustment/index"),e.Q6J("params",a.pageParams),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("filter",!0)("multi",!0)("disable",a.formCtrls.id.value>0),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("organizationControl",a.formCtrls.orgId)("organizationControlRequired",!0)("submitted",a.submitted)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.plan_ID)("submitted",a.submitted)("filter",!0)("EnabledIds",a.plans_EnableIds),e.xp6(2),e.Q6J("control",a.formCtrls.is_Apply_Rules),e.xp6(2),e.Q6J("control",a.formCtrls.fromDate)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.toDate)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.policyGroupId)("planCtrl",a.formCtrls.plan_ID)("fromDateCtrl",a.formCtrls.fromDate)("submitted",a.submitted)("disable",a.getByIdParams)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.noOfDays)("submitted",a.submitted)("type",a.inputType.number)("disabled",!0),e.xp6(2),e.Q6J("control",a.formCtrls.reason_Override)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.note)("submitted",a.submitted),e.xp6(1),e.Q6J("ngIf",a.formCtrls.policyGroupId.value),e.xp6(2),e.Q6J("ngIf",!a.canEdit),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/plan-adjustment"),e.Q6J("id",a.formCtrls.id.value)("disabledSave",a.formCtrls.id.value>0&&!a.canEdit)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,l.a,c.u,h.a,f.J,p.T,y.C,P.f,m.a8,m.dn,m.n5,D.d,_.s,R.B,q.a,G.t,s._Y,s.JL,s.sg,C.q,u.X$]}),n})();var Z=S(30671),J=(()=>{return(n=J||(J={}))[n.permission=1]="permission",n[n.mission=2]="mission",n[n.vacation=3]="vacation",J;var n})();function k(n){if(n)return n.map(i=>({...i,dayDate:d.M6.mapDate(i.dayDate,"yyyy-MM-dd"),shortDate:d.M6.dayWithName(new Date(i.dayDate)),type:J.vacation}))}var $=S(29341);let ae=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/Vacation/GetList",{params:{...t}})}Delete(t){return this.delete("TimeAttendance/Vacation/Delete",{body:t})}getAll(t){return this.get("TimeAttendance/Vacation/GetAll",{params:t})}getById(t){return this.get("TimeAttendance/Vacation/GetAll",{params:{$filter:`Person_Instance_ID eq ${t.person_Instance_ID}  and Vacation_ID eq ${t.Vacation_ID} and Vacation_From eq ${t.Vacation_From}  and Vacation_To eq  ${t.Vacation_To}`}})}getAllEmployeeCountByperDay(t){return this.get("TimeAttendance/Vacation/GetGroupCountEmpPerDayVacation",{params:t})}create(t){return this.post("TimeAttendance/Vacation/Create",t)}update(t){return this.post("TimeAttendance/Vacation/Edit",t)}GetAllEmployeeBalance(t){return this.post("TimeAttendance/Vacation/GetALLEmployeeBalanceAtSpecificPeriod",t)}upload(t){return this.post("TimeAttendance/UploadVacation/Upload",t)}download(){return this.get("TimeAttendance/UploadVacation/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var te=S(93410),oe=S(29721);let Te=(()=>{class n extends M.U{constructor(t){super(),this.vacationTransactionService=t,this.mandatoryColomns=["Ser","code","employeeName","vacationType","fromDate","toDate","NoOfDays","vacationAttachment","actions"],this.isLoaded=!1,this.optionalColomns=[],this.clickableCols=["vacationAttachment"]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.vacationTransactionService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);const I=function B(n){return n.map(i=>({...i,ID:i.vacation_ID,code:i.core_Person_Instance.core_Person.code,employeeName:(0,d._f)(i.core_Person_Instance.core_Person.ar_Name,i.core_Person_Instance.core_Person.en_Name),vacationType:(0,d._f)(i.att_Vacation.ar_Name,i.att_Vacation.en_Name),fromDate:d.M6.mapDate(i.vacation_From),toDate:d.M6.mapDate(i.vacation_To),NoOfDays:d.M6.calculateDaysBetweenTwoDates(i.vacation_From,i.vacation_To),vacationAttachment:null}))}(r.data);I.map(H=>{H.attachment&&(H.vacationAttachment=this.languageService.translate("download")+'<i class="fas fa-download"></i>')}),this.dataSource=new Z.by(I),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.att_Vacation.en_Name,t.att_Vacation.ar_Name);this.deleteDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){let a={Vacation_ID:t.vacation_ID,Vacation_From:t.vacation_From,Vacation_To:t.vacation_To,person_Instance_ID:t.person_Instance_ID};this.showLoading(),this.vacationTransactionService.Delete(a).subscribe(o=>{o.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("VacationDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}toDownload(t){console.log(t),"vacationAttachment"==t.col&&this.fileService.download(t.data.attachment)}goToEdit(t){this.router.navigate([`/attendance/${this.moduleId}/vacation-transaction/edit/${t.person_Instance_ID}/${t.vacation_ID}`],{queryParams:{fromDate:d.M6.mapDateReverse(t.vacation_From),toDate:d.M6.mapDateReverse(t.vacation_To),parentView:this.getViewName,page:this.page?.pageIndex??1}})}globalFunctionActions(t){t.viewName==U.S.vacation_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_vacation_transaction,downloadPath:$.Z.download_vacation_transaction,name:"vacationTransaction"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-vacation-transaction-index"]],features:[e.qOj],decls:4,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","vacationTransaction","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","clickableCols","actions","page","showPaginator","onChangePage","deleteRow","clickCell","editRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)})("clickCell",function(r){return a.toDownload(r)})("editRow",function(r){return a.goToEdit(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("clickableCols",a.clickableCols)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})();var Ce=S(91347),st=S(72370),lt=S(54334),dt=S(23644),be=S(69846),ke=S(90444),Ie=S(33975);function pt(n,i){if(1&n&&(e._UZ(0,"p-message",3),e.ALo(1,"translate"),e.ALo(2,"translate")),2&n){const t=e.oxw(2);e.cQ8("text","",e.lcZ(1,3,"youSelected")," ",t.noOfSelectedEmployeesWithError()," ",e.lcZ(2,5,"employeesWithInsufficientBalance"),".")}}const ct=function(){return[]};function mt(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"app-material-table",1),e.NdJ("selectedItems",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getSelectedEmployees(o))}),e.qZA(),e.YNc(3,pt,3,7,"p-message",2),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("mandatoryColomns",t.displayedColumns)("optionalColomns",e.DdM(9,ct))("allDataTable",t.allEmployees)("page",t.page)("showFilter",t.showFilter)("isCenterPaginator",!0)("cellWithHoverIconList",t.tableCellWithIcon),e.xp6(1),e.Q6J("ngIf",t.noOfSelectedEmployeesWithError()>0)}}let ut=(()=>{class n extends ke.Q{constructor(t){super(),this.vacationTransactionService=t,this.hideSelect=!1,this.showFilter=!1,this.fromGetById=!1,this.employeeCode="",this.isLoaded=!1,this.displayedColumns=["code","employeeName","jobTitle","currentBalance",Ie.g.arrowColumnName,"remainingBalance",Ie.g.selectAllColumnName],this.displayEmployeesTable=!1,this.oldVacationPeriod=0,this.svg=new be.El,this.tableCellWithIcon=[{col:"currentBalance",img:this.svg.exclamation,hoverText:"requestedVacationDaysExceedEmployeeCurrentBalance",conditionForRow:"hasError",containerClass:"icon-cell-error"}],this.vacationId=null,this.fromDate=null,this.toDate=null,this.empIds=null}ngOnChanges(t){1==t.hideSelect?.currentValue&&(console.log(this.hideSelect),this.displayedColumns.splice(-1))}ngOnInit(){this.vacationControl.valueChanges.subscribe(t=>{this.vacationId!=t&&t&&this.getAll(),this.vacationId=t}),this.fromDateControl.valueChanges.subscribe(t=>{this.fromDate!=t&&t&&this.getAll(),this.fromDate=t}),this.toDateControl.valueChanges.subscribe(t=>{this.toDate!=t&&t&&this.getAll(),this.toDate=t}),this.employeesControl.valueChanges.subscribe(t=>{this.empIds!=t&&t&&this.getAll(),this.empIds=t}),this.page.pageSize=5}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.getAll()}getAll(t){if(t&&(this.employeeCode=t),this.allEmployees=null,this.vacationControl.value>0&&this.fromDateControl.value&&this.toDateControl.value&&this.employeesControl.value?.length>0&&!this.toDateControl.errors){this.displayEmployeesTable=!0;let a={vacationid:this.vacationControl.value,fromdate:d.M6.mapDateReverse(this.fromDateControl.value),todate:d.M6.mapDateReverse(this.toDateControl.value),Person_Instant_IDs:this.employeesControl.value};this.isLoaded=!1,this.vacationTransactionService.GetAllEmployeeBalance(a).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==v.u.Success?(this.fromGetById&&!this.oldVacationPeriod&&(this.oldVacationPeriod=o.data[0].actualPeriod),this.allEmployees=function j(n,i){return n.map(t=>{t.remaningBalance+=i;const a=t.remaningBalance-t.actualPeriod;return{...t,employeeName:(0,d._f)(t.employeeAr,t.employeeEn),jobTitle:(0,d._f)(t.jobTitleName,t.jobTitleNameEn),currentBalance:a<0?`<span class="errorCol">${t.remaningBalance}</span>`:t.remaningBalance,remainingBalance:a<0?'<span class="errorCol">0</span>':a,isSelected:!0,hasError:a<0,convertTo:a<0?"errorCol":""}})}(o.data,this.fromGetById&&this.editVacationId==this.vacationId?this.oldVacationPeriod:0),this.allEmployees.sort((r,I)=>Number(I.hasError)-Number(r.hasError)),this.page.length=this.allEmployees.length,this.isLoaded=!0):this.errorList(o?.message?.messages)})}else this.displayEmployeesTable=!1}getSelectedEmployees(t){this.control.setValue(t.map(a=>a.person_Instance_Id)??null)}noOfSelectedEmployeesWithError(){return this.allEmployees?.filter(t=>t.hasError&&t.isSelected).length}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-vacation-emp-table"]],inputs:{control:"control",employeesControl:"employeesControl",vacationControl:"vacationControl",fromDateControl:"fromDateControl",toDateControl:"toDateControl",hideSelect:"hideSelect",showFilter:"showFilter",fromGetById:"fromGetById",page:"page",editVacationId:"editVacationId"},features:[e.qOj,e.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[1,"table-in-forms",3,"isLoaded","mandatoryColomns","optionalColomns","allDataTable","page","showFilter","isCenterPaginator","cellWithHoverIconList","selectedItems"],["severity","error",3,"text",4,"ngIf"],["severity","error",3,"text"]],template:function(t,a){1&t&&e.YNc(0,mt,4,10,"ng-container",0),2&t&&e.Q6J("ngIf",a.displayEmployeesTable)},dependencies:[Q.O5,te.I,D.d,C.q,u.X$]}),n})();function gt(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/vacation-transaction/add"),e.Q6J("params",t.parentParam)}}let He=(()=>{class n extends M.U{constructor(t,a){super(),this.vacationTransactionService=t,this.policyDetailsService=a,this.submitted=!1,this.vacationId=0,this.activatedRoute.params.subscribe(o=>{this.vacationId=Number(o.vacationId??0),(o.empId||o.vacationId)&&(this.editFilterData={person_Instance_ID:Number(o.empId),Vacation_ID:Number(o.vacationId)})}),this.activatedRoute.queryParams.subscribe(o=>{(o.fromDate||o.toDate)&&(this.editFilterData.Vacation_To=o.toDate,this.editFilterData.Vacation_From=o.fromDate)})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.editFilterData&&this.getById()}ngOnInit(){this.form=this.fb.group({id:[this.editFilterData?1:0,{nonNullable:!0}],orgId:[null],jobId:[null],PersonInstantIDs:[null],policyGroupId:[null,[s.kI.required]],vacation_ID:[null,[s.kI.required]],vacation_From:[null,[s.kI.required,x.dN.date]],vacation_To:[null,[s.kI.required,x.dN.date]],files:[null],note:[null],selectedEmployeeIDs:[[],[s.kI.required]]},{validator:T.w.compareDates("vacation_From","vacation_To")}),this.formCtrls?.vacation_From?.valueChanges.subscribe(t=>{this.formCtrls.policyGroupId.value&&null!=t&&this.vacationId>0&&this.getPolicyDetails(this.formCtrls.policyGroupId.value,t)})}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.vacationTransactionService.getById(this.editFilterData).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=t.data[0];this.oldAttachPath=a.attachment,this.form.patchValue(a),this.formCtrls.PersonInstantIDs.setValue([a?.core_Person_Instance?.core_Person?.id]),this.formCtrls.policyGroupId.setValue([a?.policyGroupId]),this.getPolicyDetails(a.policyGroupId,this.formCtrls.vacation_From.value),this.formCtrls.selectedEmployeeIDs.setValue([a?.core_Person_Instance?.core_Person?.id])}else this.errorList(t?.message?.messages);this.hideLoading()})}submit(){if(this.submitted=!0,0==this.formCtrls.selectedEmployeeIDs.value.length)return this.warning("selectOneEmployee");if(this.form.valid){let t={Vacation_ID:this.formCtrls.vacation_ID.value,Vacation_From:d.M6.mapDateReverse(this.formCtrls.vacation_From.value),Vacation_To:d.M6.mapDateReverse(this.formCtrls.vacation_To.value),Note:this.formCtrls.note.value,files:this.formCtrls.files.value};this.formCtrls.id.value>0?this.update(t):this.create(t)}}create(t){let a={...t,SelectedEmployeeIDs:this.formCtrls.selectedEmployeeIDs.value},o=d.M6.objectToFormData(a);this.showLoading(),this.vacationTransactionService.create(o).subscribe(r=>{r?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newVacationTransaction"),this.router.navigate([`/attendance/${this.moduleId}/vacation-transaction`],{queryParams:this.pageParams})):this.errorList(r?.message?.messages),this.hideLoading()})}update(t){let a={...t,Person_Instance_ID:this.formCtrls.selectedEmployeeIDs.value[0],Vacation_ID_Old:this.editFilterData.Vacation_ID,Vacation_From_Old:this.editFilterData.Vacation_From,Vacation_To_Old:this.editFilterData.Vacation_To,AttachmentPathOld:this.oldAttachPath},o=d.M6.objectToFormData(a);this.showLoading(),this.vacationTransactionService.update(o).subscribe(r=>{r?.message?.messageType==v.u.Success?(this.updateSuccessfullyMsg("vacationTransactionUpdated"),this.navigateTo(`/attendance/${this.moduleId}/vacation-transaction/edit/${this.editFilterData.person_Instance_ID}/${a.Vacation_ID}`,{fromDate:a.Vacation_From,toDate:a.Vacation_To,...this.parentParam,...this.pageParams})):this.errorList(r?.message?.messages),this.hideLoading()})}getPolicyDetails(t,a){this.policyDetailsService.getPolicyDetailsByDate(t,d.M6.mapDateReverse(a)).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==v.u.Success?this.enabledVacationIds=o.data.vacitionsIds:this.errorList(o?.message?.messages)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ae),e.Y36(b.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-vacation-transaction"]],features:[e.qOj],decls:35,vars:65,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addVacationTransaction","editTitle","editVacationTransaction",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mbottom-35","add-vacation-transaction"],["container",""],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25","mbottom-15"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","submitted","filter","multi","disable"],["label","job",3,"control","organizationControl","organizationControlRequired","submitted","filter","multi"],["label","effectiveDate",3,"control","submitted"],["label","endDate",3,"control","submitted"],[3,"control","submitted","filter","EnabledIds"],[3,"control","vacationCtrl","fromDateCtrl","submitted","disable","filter","multi"],[3,"control","policyControl","jobControl","orgControl","submitted","filter","multi","disable"],["label","attachments",3,"control","submitted"],[1,"col-12","col-sm-6"],["label","notes",3,"control","submitted"],[3,"control","employeesControl","vacationControl","fromDateControl","toDateControl","page","showFilter","hideSelect","fromGetById","editVacationId"],["saveLabel","add",3,"id","url","pageParams","submit"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,gt,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4,5)(8,"mat-card-title",6),e._UZ(9,"page-title",7),e.qZA(),e._UZ(10,"mat-divider")(11,"div",8),e.TgZ(12,"mat-card-content",9)(13,"form",10)(14,"div",11)(15,"div",12),e._UZ(16,"app-organization-current-structure-dropdown",13),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"app-job-title-by-org-dropdown",14),e.qZA(),e.TgZ(19,"div",12),e._UZ(20,"app-datepicker",15),e.qZA(),e.TgZ(21,"div",12),e._UZ(22,"app-datepicker",16),e.qZA(),e.TgZ(23,"div",12),e._UZ(24,"app-vacation-type-dropdown",17),e.qZA(),e.TgZ(25,"div",12),e._UZ(26,"policy-groups-by-vacation-dropdown",18),e.qZA(),e.TgZ(27,"div",12),e._UZ(28,"employeeBy-multi-policy-dropdown",19),e.qZA(),e.TgZ(29,"div",12),e._UZ(30,"app-file-input",20),e.qZA(),e.TgZ(31,"div",21),e._UZ(32,"app-input",22),e.qZA()()(),e._UZ(33,"app-add-vacation-emp-table",23),e.qZA()(),e.TgZ(34,"app-fixed-card-actions",24),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,61,"attendanceTracker")," / ",e.lcZ(3,63,"vacationTransaction"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/vacation-transaction"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/vacation-transaction/index"),e.Q6J("params",a.pageParams),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("filter",!0)("multi",!0)("disable",a.formCtrls.id.value>0),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("organizationControl",a.formCtrls.orgId)("organizationControlRequired",!0)("submitted",a.submitted)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.vacation_From)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.vacation_To)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.vacation_ID)("submitted",a.submitted)("filter",!0)("EnabledIds",a.enabledVacationIds),e.xp6(2),e.Q6J("control",a.formCtrls.policyGroupId)("vacationCtrl",a.formCtrls.vacation_ID)("fromDateCtrl",a.formCtrls.vacation_From)("submitted",a.submitted)("disable",a.vacationId>0)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.PersonInstantIDs)("policyControl",a.formCtrls.policyGroupId)("jobControl",a.formCtrls.jobId)("orgControl",a.formCtrls.orgId)("submitted",a.submitted)("filter",!0)("multi",!0)("disable",a.vacationId>0),e.xp6(2),e.Q6J("control",a.formCtrls.files)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.note)("submitted",a.submitted),e.xp6(1),e.Q6J("control",a.formCtrls.selectedEmployeeIDs)("employeesControl",a.formCtrls.PersonInstantIDs)("vacationControl",a.formCtrls.vacation_ID)("fromDateControl",a.formCtrls.vacation_From)("toDateControl",a.formCtrls.vacation_To)("page",a.page)("showFilter",!a.editFilterData)("hideSelect",!!a.editFilterData)("fromGetById",!!a.editFilterData)("editVacationId",null==a.editFilterData?null:a.editFilterData.Vacation_ID),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/vacation-transaction"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,Ce.Y,l.a,h.a,f.J,p.T,y.C,m.a8,m.dn,m.n5,D.d,_.s,st.t,q.a,lt.Z,dt.h,s._Y,s.JL,s.sg,ut,u.X$],styles:[".add-vacation-transaction .small-table .table-container{width:85%;margin:0}  .add-vacation-transaction .p-inline-message.p-inline-message-error{margin-top:20px}"]}),n})();var W=S(26315);let Fe=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/OvertimeRequest/GetList",{params:{...t}})}getAll(t){return this.get("TimeAttendance/OvertimeRequest/GetAll",{params:t})}getById(t){return this.get("TimeAttendance/OvertimeRequest/GetAll",{params:{$filter:`id eq ${t}`,$expand:`${W.db.att_OverTimeRequest},${W.db.Core_Person_Instance}/${W.db.core_Person_Instance_Job_Title}.${W.db.Core_Job_Title},${W.db.Core_Person_Instance}/${W.db.Core_Person}`}})}Delete(t){return this.delete("TimeAttendance/OvertimeRequest/Delete",{params:{OvertimeRequest_ID:t}})}create(t){return this.post("TimeAttendance/overtimeRequest/Create",t)}update(t){return this.post("TimeAttendance/overtimeRequest/Edit",t)}GetAll_EmployeeTableForCreate(t,a,o,r,I,H){return this.get("TimeAttendance/overtimeRequest/Create_GetAll",{params:{filterCode:t??"",FilterOrgs:o?"":a?.toString()??"",FilterJobs:o?.toString()??"",fDate:r??"",Todate:I??"",NumHour:H??""}})}upload(t){return this.post("TimeAttendance/UploadOvertime/Upload",t)}download(){return this.get("TimeAttendance/UploadOvertime/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Qe=S(92393),De=S(47383),_t=S(45874);const yt=function(){return[]};let vt=(()=>{class n extends ke.Q{constructor(t,a){super(),this.overtimeTransactionService=t,this.fb=a,this.employeeCode=null,this.submitted=!1,this.filterByCode=!1,this.disableSelectCheckBox=!1,this.showFilter=!1,this.splitTableNumber=2,this.change=new e.vpe,this.SelectedEmployeeIDs=new e.vpe,this.isLoaded=!1,this.mandatoryColomns=["code","employeeName","jobTitle","calculatedHours",Ie.g.selectAllColumnName],this.numHours=null}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&!this.filterByCode&&this.setNoOfHours(this.form?.value)}ngOnChanges(t){null!=t?.employeeCode?.currentValue&&this.setNoOfHours(this.form?.value,this.employeeCode)}ngOnInit(){this.form=this.fb.group({orgId:this.orgControl,jobId:this.jobControl,fromDate:this.fromDateControl,toDate:this.toDateControl,fromHour:this.fromHourControl,toHour:this.toHourControl}),this.employeeCode&&this.setNoOfHours(this.form?.value,this.employeeCode),this.page.pageSize=5,this.filterByCode||this.form.valueChanges.subscribe(t=>{this.setNoOfHours(t)})}setNoOfHours(t,a){this.employeeCode=a??"",t?.fromHour&&t?.toHour?(this.numHours=d.M6.calculateHoursBetween(t.fromHour,t.toHour),this.setFilter(t)):this.numHours=null}setFilter(t){if(t){let a=d.M6.mapDate(t.fromDate,"yyyy-MM-dd"),o=d.M6.mapDate(t.toDate,"yyyy-MM-dd");null!=t.fromDate&&null!=t.toDate&&null!=this.numHours&&this.getAll(this.employeeCode,t.orgId,t.jobId,a,o,this.numHours)}}getAll(t,a,o,r,I,H){this.isLoaded=!1,this.allEmployees=null,this.overtimeTransactionService.GetAll_EmployeeTableForCreate(t,a,o,r,I,H).pipe(this.cancelRequest()).subscribe(ee=>{ee.message.messageType==v.u.Success?(this.allEmployees=function ft(n){return n.map(i=>({...i,ID:i?.id,code:i?.code,employeeName:(0,d._f)(i?.employeeNameAr,i?.employeeNameEn),jobTitle:(0,d._f)(i?.jobTitleAr,i?.jobTitleEn),calculatedHours:i?.totalOverTimeHour,isSelected:!0}))}(ee.data),this.page.length=this.allEmployees.length,this.isLoaded=!0):this.errorList(ee.message?.messages)})}onChange(t){this.change.emit(t)}getSelectedEmployee(t){this.SelectedEmployeeIDs.emit(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fe),e.Y36(s.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overtime-emp-table"]],inputs:{orgControl:"orgControl",jobControl:"jobControl",fromDateControl:"fromDateControl",toDateControl:"toDateControl",fromHourControl:"fromHourControl",toHourControl:"toHourControl",employeeCode:"employeeCode",submitted:"submitted",filterByCode:"filterByCode",disableSelectCheckBox:"disableSelectCheckBox",page:"page",showFilter:"showFilter",splitTableNumber:"splitTableNumber"},outputs:{change:"change",SelectedEmployeeIDs:"SelectedEmployeeIDs"},features:[e.qOj,e.TTD],decls:1,vars:11,consts:[["filterInputLabel","searchByCode",3,"isLoaded","mandatoryColomns","optionalColomns","page","allDataTable","showFilter","isCenterPaginator","isCustomFilter","filterInputValue","disableSelectCheckBox","selectedItems","onFilterInput"]],template:function(t,a){1&t&&(e.TgZ(0,"app-material-table",0),e.NdJ("selectedItems",function(r){return a.getSelectedEmployee(r)})("onFilterInput",function(r){return a.setNoOfHours(a.form.value,r)}),e.qZA()),2&t&&e.Q6J("isLoaded",a.isLoaded)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",e.DdM(10,yt))("page",a.page)("allDataTable",a.allEmployees)("showFilter",a.showFilter)("isCenterPaginator",!0)("isCustomFilter",!0)("filterInputValue",a.employeeCode)("disableSelectCheckBox",a.disableSelectCheckBox)},dependencies:[te.I]}),n})();function Tt(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/overtime-transaction/add"),e.Q6J("params",t.parentParam)}}function Ct(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"app-overtime-emp-table",24),e.NdJ("SelectedEmployeeIDs",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getSelectedEmployee(o))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("page",t.page)("orgControl",t.formCtrls.orgId)("jobControl",t.formCtrls.jobId)("fromDateControl",t.formCtrls.FromDate)("toDateControl",t.formCtrls.ToDate)("fromHourControl",t.formCtrls.FromHoure)("toHourControl",t.formCtrls.ToHoure)("showFilter",0==t.overtimeId)("disableSelectCheckBox",t.overtimeId>0)("filterByCode",t.overtimeId>0)("employeeCode",null==t.currentPerson||null==t.currentPerson.core_Person?null:t.currentPerson.core_Person.code)}}let Ve=(()=>{class n extends M.U{constructor(t){super(),this.overtimeTransactionService=t,this.submitted=!1,this.overtimeId=0,this.filterEmpByCode=!1,this.filterEmpByJob=!0,this.RepetitionTypeList=[{value:1,label:this.translate("recurring")},{value:2,label:this.translate("continuous")}],this.activatedRoute.params.subscribe(a=>{this.overtimeId=Number(a.id??0)})}ngOnInit(){this.form=this.fb.group({Id:[this.overtimeId,{nonNullable:!0}],orgId:[null],jobId:[null],OverTimeRequesTypetId:[null,[s.kI.required]],RepetitionType:[1],FromDate:[null,[s.kI.required,x.dN.date]],ToDate:[null,[s.kI.required,x.dN.date]],FromHoure:[null,[s.kI.required]],ToHoure:[null,[s.kI.required]],SelectedEmployeeIDs:[null],Person_Instance_ID:[null]},{validator:T.w.compareDates("FromDate","ToDate")})}onChangeBusinessAndCompanyId(){this.overtimeId>0&&this.checkNoBusinessOrCompany()&&this.GetById()}get formCtrls(){return this.form.controls}GetById(){this.showLoading(),this.overtimeTransactionService.getById(this.overtimeId).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=t.data[0];this.form.patchValue(a.att_OverTimeRequest),this.formCtrls.OverTimeRequesTypetId.setValue(a.att_OverTimeRequest.overTimeRequesTypetId),this.formCtrls.RepetitionType.setValue(a.att_OverTimeRequest.repetitionType),this.formCtrls.FromDate.setValue(a.att_OverTimeRequest.fromDate),this.formCtrls.ToDate.setValue(a.att_OverTimeRequest.toDate),this.formCtrls.FromHoure.setValue(a.att_OverTimeRequest.fromHoure),this.formCtrls.ToHoure.setValue(a.att_OverTimeRequest.toHoure),this.formCtrls?.Person_Instance_ID?.setValue(a?.person_Instance_ID),this.currentPerson=a.core_Person_Instance}else this.errorList(t?.message?.messages);this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){let t={Att_OverTimeRequest:{Id:this.formCtrls.Id.value,OverTimeRequesTypetId:this.formCtrls.OverTimeRequesTypetId.value,FromDate:d.M6.mapDateReverse(this.formCtrls.FromDate.value),ToDate:d.M6.mapDateReverse(this.formCtrls.ToDate.value),RepetitionType:this.formCtrls.RepetitionType.value,FromHoure:this.formCtrls.FromHoure.value,ToHoure:this.formCtrls.ToHoure.value},SelectedEmployeeIDs:this.formCtrls.SelectedEmployeeIDs.value,Person_Instance_ID:this.formCtrls.Person_Instance_ID.value};this.formCtrls.Id.value>0?this.update(t):this.create(t)}}create(t){delete t.Person_Instance_ID,this.showLoading(),this.overtimeTransactionService.create(t).subscribe(a=>{a?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newOvertimeTransactionAdded"),this.router.navigate([`/attendance/${this.moduleId}/overtime-transaction`],{queryParams:this.pageParams})):this.errorList(a?.message?.messages),this.hideLoading()})}update(t){delete t.SelectedEmployeeIDs,this.showLoading(),this.overtimeTransactionService.update(t).subscribe(a=>{a?.message?.messageType==v.u.Success?this.updateSuccessfullyMsg("overtimeTransactonUpdated"):this.errorList(a?.message?.messages),this.hideLoading()})}onChangeOverTimeType(t){this.RepetitionTypeList=[{value:1,label:this.translate("recurring")}],t[0]?.id!=Ie.g.earlyAttendanceID?this.RepetitionTypeList.push({value:2,label:this.translate("continuous")}):this.formCtrls.RepetitionType.setValue(1)}getSelectedEmployee(t){let a=[];t?.forEach(o=>a.push(o?.ID)),this.formCtrls.SelectedEmployeeIDs?.setValue(a)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-overtime-transaction"]],features:[e.qOj],decls:33,vars:43,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addOvertimTransaction","editTitle","editOvertimTransaction",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mbottom-35"],["container",""],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","submitted","filter","multi","disable"],[3,"control","organizationControl","submitted","multi","filter","organizationControlRequired"],["label","overtimetype",3,"control","submitted","filter","change"],[1,"col-md-4","col-lg-3","col-sm-6","col-12","ptop-5","pbottom-5"],["label","repetitionTypeName",3,"control","submitted","radioList"],["label","effectiveDate",3,"control","submitted"],["label","endDate",3,"control","submitted"],["label","startHour",3,"control","submitted"],["label","endHour",3,"control","submitted"],[4,"ngIf"],["saveLabel","add",3,"id","url","pageParams","submit"],[1,"table-in-forms",3,"page","orgControl","jobControl","fromDateControl","toDateControl","fromHourControl","toHourControl","showFilter","disableSelectCheckBox","filterByCode","employeeCode","SelectedEmployeeIDs"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,Tt,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4,5)(8,"mat-card-title",6),e._UZ(9,"page-title",7),e.qZA(),e._UZ(10,"mat-divider")(11,"div",8),e.TgZ(12,"mat-card-content",9)(13,"form",10)(14,"div",11)(15,"div",12),e._UZ(16,"app-organization-current-structure-dropdown",13),e.qZA(),e.TgZ(17,"div",12),e._UZ(18,"app-job-title-by-org-dropdown",14),e.qZA(),e.TgZ(19,"div",12)(20,"app-overtime-typ-dropdown",15),e.NdJ("change",function(r){return a.onChangeOverTimeType(r)}),e.qZA()(),e.TgZ(21,"div",16),e._UZ(22,"app-radio-button",17),e.qZA(),e.TgZ(23,"div",12),e._UZ(24,"app-datepicker",18),e.qZA(),e.TgZ(25,"div",12),e._UZ(26,"app-datepicker",19),e.qZA(),e.TgZ(27,"div",12),e._UZ(28,"app-timepicker",20),e.qZA(),e.TgZ(29,"div",12),e._UZ(30,"app-timepicker",21),e.qZA()()(),e.YNc(31,Ct,3,11,"ng-container",22),e.qZA()(),e.TgZ(32,"app-fixed-card-actions",23),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,39,"attendanceTracker")," / ",e.lcZ(3,41,"OvertimeTransaction"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/overtime-transaction"),e.Q6J("id",a.formCtrls.Id.value)("title",a.formCtrls.Id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.formCtrls.Id.value>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/overtime-transaction/index"),e.Q6J("params",a.pageParams),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("filter",!0)("multi",!0)("disable",a.overtimeId>0),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("organizationControl",a.formCtrls.orgId)("submitted",a.submitted)("multi",!0)("filter",!0)("organizationControlRequired",!0),e.xp6(2),e.Q6J("control",a.formCtrls.OverTimeRequesTypetId)("submitted",a.submitted)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.RepetitionType)("submitted",a.submitted)("radioList",a.RepetitionTypeList),e.xp6(2),e.Q6J("control",a.formCtrls.FromDate)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ToDate)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.FromHoure)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.ToHoure)("submitted",a.submitted),e.xp6(1),e.Q6J("ngIf",a.formCtrls.FromDate.value&&a.formCtrls.ToDate.value&&a.formCtrls.FromHoure.value&&a.formCtrls.ToHoure.value),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/overtime-transaction"),e.Q6J("id",a.formCtrls.Id.value)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,Qe._,h.a,De.E,f.J,p.T,y.C,m.a8,m.dn,m.n5,D.d,_.s,q.a,_t.c,s._Y,s.JL,s.sg,vt,u.X$]}),n})();var je=S(24850);function It(n){if(n)return n.map(i=>({...i,dayDate:d.M6.mapDate(i.dayDate,"yyyy-MM-dd"),shortDate:d.M6.dayWithName(new Date(i.dayDate)),type:J.mission}))}let we=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/Mission/GetList",{params:{...t,$expand:`${W.db.Core_Person_Instance}/${W.db.Core_Person},${W.db.att_Mission}/${W.db.att_MissionType}`}}).pipe((0,je.U)(a=>(a.data=function bt(n){if(n)return n.map(i=>({...i,id:i?.mission_ID,employeeName:(0,d._f)(i?.core_Person_Instance?.core_Person?.ar_Name,i?.core_Person_Instance?.core_Person?.en_Name),code:i?.core_Person_Instance?.core_Person?.code,location:i?.att_Mission.location,from_Date:d.M6.mapDate(i?.att_Mission?.from_Date,"dd/MM/yyyy"),to_Date:d.M6.mapDate(i?.att_Mission?.to_Date,"dd/MM/yyyy"),from_Hour:d.M6.mapTime(i?.att_Mission?.from_Hour),to_Hour:d.M6.mapTime(i?.att_Mission?.to_Hour)}))}(a.data),a)))}getAll(t){return this.get("TimeAttendance/Mission/GetAll",{params:{...t,$expand:`${W.db.Core_Person_Instance}/${W.db.Core_Person},${W.db.att_Mission}/${W.db.att_MissionType}`}})}getById(t){return this.get("TimeAttendance/Mission/GetAll",{params:{$filter:`mission_ID eq ${t}`,$expand:`${W.db.Core_Person_Instance}/${W.db.Core_Person},${W.db.att_Mission}/${W.db.att_MissionType}`}})}getAllEmployeeCountByperDay(t){return this.get("TimeAttendance/Mission/GetGroupCountEmpPerDayMission",{params:t})}create(t){return this.post("TimeAttendance/Mission/Create",t)}update(t){return this.post("TimeAttendance/Mission/Edit",t)}Delete(t){return this.delete("TimeAttendance/Mission/Delete",{params:{Mission_Id:t}})}upload(t){return this.post("TimeAttendance/UploadMissionTrans/Upload",t)}download(){return this.get("TimeAttendance/UploadMissionTrans/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Dt=(()=>{class n extends M.U{constructor(t){super(),this.missionService=t,this.mandatoryColomns=["id","employeeName","code","mission_type","location","from_Date","to_Date","from_Hour","to_Hour","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.missionService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);r.data.map(I=>{I.mission_type=I.att_Mission.is_Internal?this.translate("internal"):I.att_Mission.is_External?this.translate("external"):"---"}),this.dataSource=new Z.by(r.data),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages)})}onDelete(t){this.deleteDialog(t.employeeName).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.missionService.Delete(t.mission_ID).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("mission_transaction_deleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}globalFunctionActions(t){t.viewName==U.S.mission_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_mission,downloadPath:$.Z.download_mission,name:"mission_transaction"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(we))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-mission-transaction-index"]],features:[e.qOj],decls:4,vars:8,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","mission_transaction","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})();var X=S(65938);const At=[{ar_Name:"\u0644\u0627 \u064a\u062d\u062a\u0627\u062c \u062a\u0648\u0642\u0639\u0627\u062a",en_Name:"No Signatures",id:0},{ar_Name:"\u062a\u0648\u0642\u064a\u0639 \u062f\u062e\u0648\u0644",en_Name:"Start Signatures",id:1},{ar_Name:"\u062a\u0648\u0642\u064a\u0639 \u062e\u0631\u0648\u062c",en_Name:"End Signatures",id:2},{ar_Name:"\u062a\u0648\u0642\u064a\u0639 \u062f\u062e\u0648\u0644 \u0648\u062e\u0631\u0648\u062c",en_Name:"Start and End Signatures",id:3}],Pt=[{ar_Name:"\u062f\u0627\u062e\u0644\u064a",en_Name:"Internal",id:1},{ar_Name:"\u062e\u0627\u0631\u062c\u064a",en_Name:"External",id:2}],wt=[{ar_Name:"\u0644\u0627 \u064a\u0648\u062c\u062f \u0625\u0636\u0627\u0641\u064a",en_Name:"NO Overtime Time",id:0},{ar_Name:"\u0628\u0639\u062f \u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u0639\u0645\u0644",en_Name:"After Mission",id:1},{ar_Name:"\u0642\u0628\u0644 \u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u0639\u0645\u0644",en_Name:"Before Mission",id:2},{ar_Name:"\u0642\u0628\u0644 \u0648\u0628\u0639\u062f \u0645\u0648\u0627\u0639\u064a\u062f \u0627\u0644\u0639\u0645\u0644",en_Name:"After and Before Mission",id:3}];var se=(()=>{return(n=se||(se={}))[n.no=0]="no",n[n.start=1]="start",n[n.end=2]="end",n[n.both=3]="both",se;var n})(),ce=(()=>{return(n=ce||(ce={}))[n.internal=1]="internal",n[n.external=2]="external",ce;var n})(),le=(()=>{return(n=le||(le={}))[n.no=0]="no",n[n.after=1]="after",n[n.before=2]="before",n[n.both=3]="both",le;var n})(),xt=S(22530),Me=S(68506),Lt=S(68756);function Ot(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/mission-transaction/add"),e.Q6J("params",t.parentParam)}}let Be=(()=>{class n extends M.U{constructor(t,a,o){super(),this.missionService=t,this.data=a,this.dialogRef=o,this.submitted=!1,this.missionId=0,this.approvalSignaturesList=At,this.missionTypeList=Pt,this.overtimeApprovalList=wt,this.filterEmpByCode=!1,this.filterEmpByJob=!0,this.activatedRoute.params.subscribe(r=>{this.missionId=Number(r.id??0)})}ngOnInit(){this.form=this.fb.group({id:[this.missionId,{nonNullable:!0}],orgId:[null],jobId:[null],from_Date:[null,[s.kI.required,x.dN.date]],to_Date:[null,[s.kI.required,x.dN.date]],iS_Full_Day:[!1,[s.kI.required]],is_Continuous:[!1,[s.kI.required]],from_Hour:[null,[s.kI.required]],to_Hour:[null,[s.kI.required]],gov_ID:[null,[s.kI.required]],location:[null,[s.kI.required]],iS_Allow_Allowance:[!1,[s.kI.required]],allowance_Value:[null,[s.kI.required,x.dN.gt(0)]],purpose:[null],need_Start_Sign:[!1,[s.kI.required]],need_End_Sign:[!1,[s.kI.required]],beforE_OVERTIME_APPROVED:[!1,[s.kI.required]],afteR_OVERTIME_APPROVED:[!1,[s.kI.required]],is_External:[!1,[s.kI.required]],is_Internal:[!1,[s.kI.required]],note:[null],addMode_EmployeeIDs:[null],approval_signatures:[null,[s.kI.required]],missionType:[null,[s.kI.required]],overtime_approval:[null,[s.kI.required]]},{validators:[T.w.compareDates("from_Date","to_Date"),T.w.timeBefore("from_Hour","to_Hour")]}),this.onChangeAllow_Allowance(!1)}onChangeBusinessAndCompanyId(){this.missionId>0&&this.checkNoBusinessOrCompany()&&this.GetById()}get formCtrls(){return this.form.controls}GetById(){this.showLoading(),this.missionService.getById(this.missionId).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=t.data[0];this.form.patchValue(a.att_Mission),this.formCtrls.approval_signatures.setValue(function St(n){return n.need_Start_Sign&&!n.need_End_Sign?se.start:!n.need_Start_Sign&&n.need_End_Sign?se.end:n.need_Start_Sign&&n.need_End_Sign?se.both:n.need_Start_Sign||n.need_End_Sign?void 0:se.no}(a.att_Mission)),this.formCtrls.overtime_approval.setValue(function Zt(n){return n.afteR_OVERTIME_APPROVED&&!n.beforE_OVERTIME_APPROVED?le.after:!n.afteR_OVERTIME_APPROVED&&n.beforE_OVERTIME_APPROVED?le.before:n.afteR_OVERTIME_APPROVED&&n.beforE_OVERTIME_APPROVED?le.both:n.afteR_OVERTIME_APPROVED||n.beforE_OVERTIME_APPROVED?void 0:le.no}(a.att_Mission)),this.currentPerson=a.core_Person_Instance,this.filterEmpByCode=!0,this.filterEmpByJob=!1,a.att_Mission.is_External?this.formCtrls.missionType.setValue(ce.external):a.att_Mission.is_Internal&&this.formCtrls.missionType.setValue(ce.internal)}else this.errorList(t?.message?.messages);this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){let t={mission:{id:this.formCtrls.id.value,from_Date:d.M6.mapDateReverse(this.formCtrls.from_Date.value),to_Date:d.M6.mapDateReverse(this.formCtrls.to_Date.value),location:this.formCtrls.location.value,from_Hour:this.formCtrls.from_Hour.value,to_Hour:this.formCtrls.to_Hour.value,need_Start_Sign:this.formCtrls.need_Start_Sign.value,need_End_Sign:this.formCtrls.need_End_Sign.value,beforE_OVERTIME_APPROVED:this.formCtrls.beforE_OVERTIME_APPROVED.value,afteR_OVERTIME_APPROVED:this.formCtrls.afteR_OVERTIME_APPROVED.value,is_Full_Day:this.formCtrls.iS_Full_Day.value,is_Allow_Allowance:this.formCtrls.iS_Allow_Allowance.value,allowance_Value:this.formCtrls.allowance_Value.value,purpose:this.formCtrls.purpose.value,gov_ID:this.formCtrls.gov_ID.value,note:this.formCtrls.note.value,is_External:this.formCtrls.is_External.value,is_Internal:this.formCtrls.is_Internal.value,is_Continuous:this.formCtrls.is_Continuous.value,missionTypeId:null},addMode_EmployeeIDs:this.formCtrls.addMode_EmployeeIDs.value};0==t?.mission?.id?this.create(t):this.update(t)}}create(t){this.showLoading(),this.missionService.create(t).subscribe(a=>{if(a?.message?.messageType==v.u.Success){this.addSuccessfullyMsg("canEditOrRemoveFromIndex","new_mission_transaction_added"),this.formCtrls.id.setValue(this.missionId);let o=`/attendance/${this.moduleId}/mission-transaction`;this.data.isDialog||this.router.navigateByUrl(o),this.data.isDialog&&this.dialogRef.close()}else this.errorList(a?.message?.messages);this.hideLoading()})}update(t){this.showLoading(),this.missionService.update(t).subscribe(a=>{a?.message?.messageType==v.u.Success?(this.updateSuccessfullyMsg("mission_transaction_updated"),this.GetById()):this.errorList(a?.message?.messages),this.hideLoading()})}onChangeFull_Day(t){t&&(this.formCtrls.from_Hour.reset(),this.formCtrls.to_Hour.reset())}onChangeIsContinuous(t){t?(this.form.clearValidators(),this.form.setValidators([T.w.compareDates("from_Date","to_Date")])):this.form.setValidators([T.w.compareDates("from_Date","to_Date"),T.w.timeBefore("from_Hour","to_Hour")]),this.form.updateValueAndValidity(),this.formCtrls.from_Hour.updateValueAndValidity()}onChangeAllow_Allowance(t){t?this.formCtrls.allowance_Value.setValidators([s.kI.required,x.dN.gt(0)]):(this.formCtrls.allowance_Value.reset(),this.formCtrls.purpose.reset(),this.formCtrls.allowance_Value.removeValidators([s.kI.required,x.dN.gt(0)])),this.formCtrls.allowance_Value.updateValueAndValidity(),this.formCtrls.purpose.updateValueAndValidity()}onChangeSignatures(t){let a=this.formCtrls.approval_signatures.value;a===se.start?(this.formCtrls.need_Start_Sign.setValue(!0),this.formCtrls.need_End_Sign.setValue(!1)):a===se.end?(this.formCtrls.need_End_Sign.setValue(!0),this.formCtrls.need_Start_Sign.setValue(!1)):a===se.both?(this.formCtrls.need_End_Sign.setValue(!0),this.formCtrls.need_Start_Sign.setValue(!0)):(this.formCtrls.need_Start_Sign.setValue(!1),this.formCtrls.need_End_Sign.setValue(!1))}onChangeMissionType(t){let a=this.formCtrls.missionType.value;a===ce.internal?(this.formCtrls.is_Internal.setValue(!0),this.formCtrls.is_External.setValue(!1)):a===ce.external?(this.formCtrls.is_External.setValue(!0),this.formCtrls.is_Internal.setValue(!1)):(this.formCtrls.is_Internal.setValue(!1),this.formCtrls.is_External.setValue(!1))}onChangeOvertime_approval(t){let a=this.formCtrls.overtime_approval.value;a===le.after?(this.formCtrls.afteR_OVERTIME_APPROVED.setValue(!0),this.formCtrls.beforE_OVERTIME_APPROVED.setValue(!1)):a===le.before?(this.formCtrls.beforE_OVERTIME_APPROVED.setValue(!0),this.formCtrls.afteR_OVERTIME_APPROVED.setValue(!1)):a===le.both?(this.formCtrls.beforE_OVERTIME_APPROVED.setValue(!0),this.formCtrls.afteR_OVERTIME_APPROVED.setValue(!0)):(this.formCtrls.beforE_OVERTIME_APPROVED.setValue(!1),this.formCtrls.afteR_OVERTIME_APPROVED.setValue(!1))}getSelectedEmployee(t){let a=[];t.forEach(o=>a.push(o?.person_Instance_Id)),this.formCtrls.addMode_EmployeeIDs.setValue(this.currentPerson?[this.currentPerson.id]:a)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(we),e.Y36(X.WI),e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-mission-transaction"]],features:[e.qOj],decls:49,vars:77,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","add_mission_transaction","editTitle","edit_mission_transaction",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card"],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],[1,"mt-2"],[3,"formGroup"],[1,"row"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","submitted","disable","filter","multi"],[3,"control","organizationControl","submitted","multi","filter","organizationControlRequired"],["label","effectiveDate",3,"control","submitted"],["label","to_Date",3,"control","submitted"],["label","full_day_mission","color","primary","labelPosition","before","styleClass","margin-17",3,"control","onChange"],["label","continuous","color","primary","labelPosition","before","styleClass","margin-17",3,"control","onChange"],["label","from_Hour",3,"control","submitted","disabled"],["label","to_Hour",3,"control","submitted","disabled"],[3,"control","submitted","filterByCountry","filter"],["label","location",3,"control","submitted"],["label","allow_allowance","color","primary","labelPosition","before","styleClass","margin-17",3,"control","onChange"],["label","allowance",3,"control","submitted","type","disabled"],["label","purpose",3,"control","submitted","disabled"],["label","approval_signatures",3,"control","multi","List","submitted","filter","change"],["label","mission_type",3,"control","multi","List","submitted","filter","change"],["label","overtime_approval",3,"control","multi","List","submitted","filter","change"],["label","note",3,"control"],[3,"jobControl","orgControl","showFilter","hideSelect","filterByCode","showPaginator","employeeCode","selectedEmployee"],["saveLabel","add",3,"id","url","pageParams","submit"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,Ot,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4)(7,"mat-card-title",5),e._UZ(8,"page-title",6),e.qZA(),e.TgZ(9,"mat-card-content",7)(10,"form",8)(11,"div",9)(12,"div",10),e._UZ(13,"app-organization-current-structure-dropdown",11),e.qZA(),e.TgZ(14,"div",10),e._UZ(15,"app-job-title-by-org-dropdown",12),e.qZA(),e.TgZ(16,"div",10),e._UZ(17,"app-datepicker",13),e.qZA(),e.TgZ(18,"div",10),e._UZ(19,"app-datepicker",14),e.qZA(),e.TgZ(20,"div",10)(21,"app-check-box",15),e.NdJ("onChange",function(r){return a.onChangeFull_Day(r)}),e.qZA()(),e.TgZ(22,"div",10)(23,"app-check-box",16),e.NdJ("onChange",function(r){return a.onChangeIsContinuous(r)}),e.qZA()(),e.TgZ(24,"div",10),e._UZ(25,"app-timepicker",17),e.qZA(),e.TgZ(26,"div",10),e._UZ(27,"app-timepicker",18),e.qZA(),e.TgZ(28,"div",10),e._UZ(29,"governorate-dropdown",19),e.qZA(),e.TgZ(30,"div",10),e._UZ(31,"app-input",20),e.qZA(),e.TgZ(32,"div",10)(33,"app-check-box",21),e.NdJ("onChange",function(r){return a.onChangeAllow_Allowance(r)}),e.qZA()(),e.TgZ(34,"div",10),e._UZ(35,"app-input",22),e.qZA(),e.TgZ(36,"div",10),e._UZ(37,"app-input",23),e.qZA(),e.TgZ(38,"div",10)(39,"app-prime-dropdown",24),e.NdJ("change",function(r){return a.onChangeSignatures(r)}),e.qZA()(),e.TgZ(40,"div",10)(41,"app-prime-dropdown",25),e.NdJ("change",function(r){return a.onChangeMissionType(r)}),e.qZA()(),e.TgZ(42,"div",10)(43,"app-prime-dropdown",26),e.NdJ("change",function(r){return a.onChangeOvertime_approval(r)}),e.qZA()(),e.TgZ(44,"div",10),e._UZ(45,"app-input",27),e.qZA()()(),e._UZ(46,"hr"),e.TgZ(47,"employee-by-job-table",28),e.NdJ("selectedEmployee",function(r){return a.getSelectedEmployee(r)}),e.qZA()()(),e.TgZ(48,"app-fixed-card-actions",29),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,73,"attendanceTracker")," / ",e.lcZ(3,75,"mission_transaction"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/mission-transaction"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.missionId>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/mission-transaction"),e.Q6J("params",a.pageParams),e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("disable",a.missionId>0)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("organizationControl",a.formCtrls.orgId)("submitted",a.submitted)("multi",!0)("filter",!0)("organizationControlRequired",!0),e.xp6(2),e.Q6J("control",a.formCtrls.from_Date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.to_Date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.iS_Full_Day),e.xp6(2),e.Q6J("control",a.formCtrls.is_Continuous),e.xp6(2),e.Q6J("control",a.formCtrls.from_Hour)("submitted",a.submitted)("disabled",a.formCtrls.iS_Full_Day.value),e.xp6(2),e.Q6J("control",a.formCtrls.to_Hour)("submitted",a.submitted)("disabled",a.formCtrls.iS_Full_Day.value),e.xp6(2),e.Q6J("control",a.formCtrls.gov_ID)("submitted",a.submitted)("filterByCountry",!1)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.location)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.iS_Allow_Allowance),e.xp6(2),e.Q6J("control",a.formCtrls.allowance_Value)("submitted",a.submitted)("type",a.inputType.number)("disabled",!a.formCtrls.iS_Allow_Allowance.value),e.xp6(2),e.Q6J("control",a.formCtrls.purpose)("submitted",a.submitted)("disabled",!a.formCtrls.iS_Allow_Allowance.value),e.xp6(2),e.Q6J("control",a.formCtrls.approval_signatures)("multi",!1)("List",a.approvalSignaturesList)("submitted",a.submitted)("filter",!1),e.xp6(2),e.Q6J("control",a.formCtrls.missionType)("multi",!1)("List",a.missionTypeList)("submitted",a.submitted)("filter",!1),e.xp6(2),e.Q6J("control",a.formCtrls.overtime_approval)("multi",!1)("List",a.overtimeApprovalList)("submitted",a.submitted)("filter",!1),e.xp6(2),e.Q6J("control",a.formCtrls.note),e.xp6(2),e.Q6J("jobControl",a.formCtrls.jobId)("orgControl",a.formCtrls.orgId)("showFilter",0==a.missionId)("hideSelect",a.missionId>0)("filterByCode",a.missionId>0)("showPaginator",0==a.missionId)("employeeCode",null==a.currentPerson||null==a.currentPerson.core_Person?null:a.currentPerson.core_Person.code),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/mission-transaction"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,l.a,c.u,h.a,De.E,f.J,p.T,y.C,xt.R,m.a8,m.dn,m.n5,Me.t,Lt.n,_.s,q.a,s._Y,s.JL,s.sg,u.X$]}),n})();function Ge(n){return n.map(i=>({...i,id:i.penalty_Transaction_ID,employeeName:(0,d._f)(i.core_Person_Instance?.core_Person?.ar_Name,i.core_Person_Instance?.core_Person?.en_Name),code:i.core_Person_Instance?.core_Person?.code,violation:(0,d._f)(i.penalty_Transaction?.att_Violation?.ar_Name,i.penalty_Transaction?.att_Violation?.en_Name),date:d.M6.mapDate(i.penalty_Transaction?.date),repetition:i.penalty_Transaction?.repetition_No,penaltyValuePerDay:i.penalty_Transaction?.penalty_Value,effectOnPayroll:i.penalty_Transaction?.trans_Status,moneyValue:i.penalty_Transaction?.moneyValue}))}let Se=(()=>{class n extends L.K{constructor(){super(),this.expand=`${W.db.Core_Person_Instance}.${W.db.Core_Person},${W.db.penalty_Transaction}.${W.db.Att_Violation}`}getList(t){return this.get("TimeAttendance/PenaltyTransaction/GetList",{params:{...t,$expand:this.expand}})}getAll(){return this.get("TimeAttendance/PenaltyTransaction/GetAll",{params:{$expand:this.expand}})}getRepetitionAndPenaltyValue(t,a,o){return this.get("TimeAttendance/PenaltyTransaction/GetPenaltyValue",{params:{PersonInstanceID:t,ViolationID:a,TransactionDate:o}})}getById(t){return this.get("TimeAttendance/PenaltyTransaction/GetAll",{params:{$filter:`penalty_Transaction_ID eq ${t}`,$expand:this.expand}})}getPenalityWithRepetation(t,a){return this.get("TimeAttendance/PenaltyTransaction/GetPenalityWithRepetation",{params:{ViolationID:t,PersonInstanceID:a}})}create(t){return this.post("TimeAttendance/PenaltyTransaction/Create",t)}update(t){return this.post("TimeAttendance/PenaltyTransaction/Edit",t)}Delete(t,a){return this.delete("TimeAttendance/PenaltyTransaction/Delete",{params:{PenalityTrans_ID:t,Person_Instance_ID:a}})}exportExcel(){return this.getAll().pipe((0,je.U)(t=>(t.data=Ge(t.data),t)))}createAttachment(t){return this.post("TimeAttendance/PenaltyTransaction/Create_PenalityAttachment",t)}getAllAttachmentsByPenaltyTraId(t){return this.get("TimeAttendance/PenaltyTransaction/GetPenaltyTransactionAttachment",{params:{Penalty_Transaction_ID:t}})}deleteAttachment(t){return this.delete("TimeAttendance/PenaltyTransaction/Delete_Attachments",{params:{AttachmentID:t}})}upload(t){return this.post("TimeAttendance/PenaltyTransaction/Upload",t)}download(){return this.get("TimeAttendance/PenaltyTransaction/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var de=S(57566),_e=S(98814),Mt=S(58313),he=S(79417),Rt=S(59549),Nt=S(10266),Ut=S(96308),qt=S(25054),Et=S(79117);function Jt(n,i){1&n&&(e.TgZ(0,"th",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"attachment")," "))}function kt(n,i){if(1&n&&e._UZ(0,"p-image",28),2&n){const t=e.oxw().$implicit,a=e.oxw(2);e.Q6J("src",a.penaltyTransactionId>0?a.fileService.preview(null==t.comm_Attachment?null:t.comm_Attachment.path):a.fileService.urlFromFile(t))}}function Ht(n,i){if(1&n&&(e.TgZ(0,"div",29),e._UZ(1,"img",30),e.qZA()),2&n){const t=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("src",a.fileService.getFileIcon(a.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.en_Name:t.name),e.LSH)}}function Qt(n,i){if(1&n&&(e.TgZ(0,"td",19)(1,"div",20)(2,"section",21),e.YNc(3,kt,1,1,"p-image",22),e.YNc(4,Ht,2,1,"ng-template",null,23,e.W1O),e.qZA(),e.TgZ(6,"section",24)(7,"div",25)(8,"div",26),e._uU(9),e.qZA(),e.TgZ(10,"div",27)(11,"span"),e._uU(12),e.ALo(13,"fileSize"),e.qZA(),e.TgZ(14,"span"),e._uU(15),e.ALo(16,"date"),e.qZA()()()()()()),2&n){const t=i.$implicit,a=e.MAs(5),o=e.oxw(2);e.xp6(3),e.Q6J("ngIf",o.fileService.isImage(o.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.mime:t.type))("ngIfElse",a),e.xp6(5),e.Q6J("matTooltip",o.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.en_Name:t.name),e.xp6(1),e.hij(" ",o.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.en_Name:t.name," "),e.xp6(3),e.hij(" ",e.lcZ(13,6,o.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.size:t.size)," "),e.xp6(3),e.hij(" ",e.xi3(16,8,o.penaltyTransactionId>0?null==t.comm_Attachment?null:t.comm_Attachment.create_Date:o.today,"d MMM, y")," ")}}function Vt(n,i){1&n&&(e.TgZ(0,"th",18),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"actions")," "))}function jt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"td",19)(1,"div",31)(2,"i",32),e.NdJ("click",function(){const r=e.CHM(t).$implicit,I=e.oxw(2);return e.KtG(I.penaltyTransactionId>0?I.fileService.downloadFromServer(null==r.comm_Attachment?null:r.comm_Attachment.id):I.fileService.downloadFileObject(r))}),e.qZA(),e.TgZ(3,"app-row-functions",33),e.NdJ("deleteRow",function(){const o=e.CHM(t),r=o.$implicit,I=o.index,H=e.oxw(2);return e.KtG(H.penaltyTransactionId>0?H.onDelete(r):H.deleteAttachFromList(r,I))}),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("actions",t.rowFunctions)}}function Bt(n,i){1&n&&e._UZ(0,"tr",34)}function Gt(n,i){1&n&&e._UZ(0,"tr",35)}function zt(n,i){if(1&n&&(e.TgZ(0,"mat-card-content",9)(1,"div",10)(2,"table",11),e.ynx(3,12),e.YNc(4,Jt,3,3,"th",13),e.YNc(5,Qt,17,11,"td",14),e.BQk(),e.ynx(6,15),e.YNc(7,Vt,3,3,"th",13),e.YNc(8,jt,4,1,"td",14),e.BQk(),e.YNc(9,Bt,1,0,"tr",16),e.YNc(10,Gt,1,0,"tr",17),e.qZA()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("dataSource",t.dataSource),e.xp6(7),e.Q6J("matHeaderRowDef",t.mandatoryColomns),e.xp6(1),e.Q6J("matRowDefColumns",t.mandatoryColomns)}}function Yt(n,i){if(1&n&&(e.TgZ(0,"div",36),e._UZ(1,"app-table-skeleton",37),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("displayedColumns",t.mandatoryColomns)}}let ze=(()=>{class n extends M.U{constructor(t){super(),this.penaltyTransactionService=t,this.penaltyTransactionId=0,this.submitted=!1,this.mandatoryColomns=["attachment","actions"],this.isLoaded=!1,this.svg=new be.El,this.today=new Date,this.removeFile=!1}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.penaltyTransactionId>0?this.getAllPenaltyAttachments():(this.isLoaded=!0,this.dataSource=new Z.by([]))}ngOnInit(){this.form=this.fb.group({id:[this.penaltyTransactionId,{nonNullable:!0}],files:[null,[s.kI.required]]})}ngOnChanges(t){t.penaltyTransactionId&&!t.penaltyTransactionId.firstChange&&t.penaltyTransactionId.currentValue!=t.penaltyTransactionId.previousValue&&this.checkNoBusinessOrCompany()&&this.getAllPenaltyAttachments()}get formCtrls(){return this.form.controls}getAllPenaltyAttachments(){this.dataSource=new Z.by(null),this.isLoaded=!1,this.penaltyTransactionService.getAllAttachmentsByPenaltyTraId(this.penaltyTransactionId).subscribe(t=>{t.message.messageType==v.u.Success?(this.dataSource=new Z.by(t.data),this.isLoaded=!0):this.errorList(t?.message?.messages)})}submit(){if(this.submitted=!0,this.removeFile=!1,this.form.valid)if(this.penaltyTransactionId>0){let a=d.M6.objectToFormData({id:this.formCtrls.id.value,files:this.formCtrls.files.value});this.create(a)}else this.dataSource.data=[...this.dataSource.data,this.formCtrls.files.value],setTimeout(()=>{this.clearForm()},500)}create(t){this.showLoading(),this.penaltyTransactionService.createAttachment(t).subscribe(a=>{a?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canRemoveFromIndex","newPenaltyTransactionAttachment"),this.clearForm(),this.getAllPenaltyAttachments()):this.errorList(a?.message?.messages),this.hideLoading()})}deleteAttachFromList(t,a){this.deleteDialog(t.name).subscribe(r=>{if(r){const I=[...this.dataSource.data];I.splice(a,1),this.dataSource.data=I}})}onDelete(t){let a=t.comm_Attachment?.en_Name;this.deleteDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.penaltyTransactionService.deleteAttachment(t.attachment_ID).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("penaltyTransactionAttachmentRemoved"),this.getAllPenaltyAttachments()):this.errorList(a?.message?.messages),this.hideLoading()})}clearForm(){this.form.reset(),this.submitted=!1,this.removeFile=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-penalty-transaction-attachments"]],inputs:{penaltyTransactionId:"penaltyTransactionId"},features:[e.qOj,e.TTD],decls:11,vars:11,consts:[[3,"formGroup"],[1,"row"],[1,"col-12","pleft-18","pright-18"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],["htmlId","penalty-attach",3,"control","submitted","removeFile"],[1,"col-lg-3","col-md-4","col-sm-6","col-12","ptop-5"],["icon","pi pi-plus-circle","addLabel","add",3,"color","iconPositionBefore","onClick"],["class","table-in-forms penalty-attachments-table",4,"ngIf"],["class","mtop-25",4,"ngIf"],[1,"table-in-forms","penalty-attachments-table"],["appScrollableHorizontal","",1,"mat-elevation-z8","f-w","table-container","mtop-33"],["mat-table","","matSort","",1,"auto-width-table",3,"dataSource"],["matColumnDef","attachment"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"attachment-table-file-container"],[1,"table-file-preview","file-preview-container"],["alt","image","class","img-view","preview","true",3,"src",4,"ngIf","ngIfElse"],["noImage",""],[1,"table-attach-main-data"],[1,"data"],[1,"name","interMedium",3,"matTooltip"],[1,"size-date"],["alt","image","preview","true",1,"img-view",3,"src"],[1,"file-view"],["alt","file",3,"src"],[1,"actions-td"],[1,"ft-download","pointer",3,"click"],[3,"actions","deleteRow"],["mat-header-row",""],["mat-row",""],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"mat-label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3),e._UZ(6,"app-file-input",4),e.qZA(),e.TgZ(7,"div",5)(8,"submit-btn",6),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()(),e.YNc(9,zt,11,3,"mat-card-content",7),e.YNc(10,Yt,2,1,"div",8)),2&t&&(e.Q6J("formGroup",a.form),e.xp6(3),e.hij(" ",e.lcZ(4,9,"attachments")," "),e.xp6(3),e.Q6J("control",a.formCtrls.files)("submitted",a.submitted)("removeFile",a.removeFile),e.xp6(2),e.Q6J("color",a.btn.darkBlue)("iconPositionBefore",!1),e.xp6(1),e.Q6J("ngIf",(null==a.dataSource||null==a.dataSource.data?null:a.dataSource.data.length)>0&&a.isLoaded),e.xp6(1),e.Q6J("ngIf",!a.isLoaded))},dependencies:[Q.O5,Ce.Y,de.p,_e.I,Mt.h,he.c,Rt.hX,m.dn,Nt.gM,Z.BZ,Z.fO,Z.as,Z.w1,Z.Dz,Z.nj,Z.ge,Z.ev,Z.XQ,Z.Gk,Ut.YE,s._Y,s.JL,s.sg,qt.E,Q.uU,u.X$,Et.H],styles:[".penalty-attachments-table .table-container{width:-moz-fit-content;width:fit-content}  .penalty-attachments-table .table-container .auto-width-table{width:auto;table-layout:auto}  .penalty-attachments-table .table-container .actions-td{display:flex;gap:5px 15px}  .penalty-attachments-table .table-container .actions-td .ft-download{color:#71839b}"]}),n})(),Wt=(()=>{class n extends M.U{constructor(t,a,o){super(),this.penaltyTransactionService=t,this.dialogRef=a,this.data=o,this.mandatoryColomns=["repetition","penaltyValuePerDay"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getAll()}ngOnInit(){}getAll(){this.dataSource=new Z.by(null),this.isLoaded=!1,this.penaltyTransactionService.getPenalityWithRepetation(this.data.violation.id,this.data.personInstanceID).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==v.u.Success?(this.dataSource=new Z.by(function Ft(n){return n.map(i=>({...i,repetition:i.repetation,penaltyValuePerDay:i.penality.name}))}(t.data??[])),this.isLoaded=!0):this.errorList(t?.message?.messages)})}onCloseDialog(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se),e.Y36(X.so),e.Y36(X.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-repetition-penalty-dialog"]],features:[e.qOj],decls:7,vars:7,consts:[["mat-dialog-title","",2,"margin-bottom","0 !important"],[3,"title"],[1,"mx-0","mb-2"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showPaginator","showFilter"],["label","ok","mat-dialog-close","","styleClass","w-100 btn-no-margin",1,"w-100"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2),e._UZ(4,"app-material-table",3),e.qZA(),e.TgZ(5,"mat-dialog-actions"),e._UZ(6,"submit-btn",4),e.qZA()),2&t&&(e.xp6(2),e.Q6J("title",a.msgTranslate(null==a.data.violation?null:a.data.violation.ar_Name,null==a.data.violation?null:a.data.violation.en_Name)),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("showPaginator",!1)("showFilter",!1))},dependencies:[te.I,de.p,p.T,X.ZT,X.uh,X.xY,X.H8]}),n})();var Ye=S(70502),$t=S(24928),Kt=S(98721);function Xt(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/penalty-transaction/add"),e.Q6J("params",t.parentParam)}}function ea(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",11)(2,"app-input",23),e.NdJ("clickSuffixIcon",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openPenaltyAndRepetitionDialog())}),e.qZA()(),e.TgZ(3,"div",11),e._UZ(4,"app-penalty-dropdown",24),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("control",t.formCtrls.repetition_No)("submitted",t.submitted)("disabled",!0)("suffixIcon",t.formCtrls.violation_ID.value>0&&t.formCtrls.person_Instance_ID.value>0?"fas fa-info-circle violationInfo":null)("allowDisabledIconClick",!0),e.xp6(2),e.Q6J("control",t.formCtrls.penalty_Value)("submitted",t.submitted)("filter",!0)("isIdAsValue",!1)}}function ta(n,i){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"app-input",25),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.moneyValue)("submitted",t.submitted)("type",t.inputType.number)}}let We=(()=>{class n extends M.U{constructor(t,a){super(),this.penaltyTransactionService=t,this.dialog=a,this.penaltyTransactionId=0,this.submitted=!1,this.activatedRoute.params.subscribe(o=>{this.penaltyTransactionId=Number(o.id??0)})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.penaltyTransactionId>0&&this.getById()}ngOnInit(){this.form=this.fb.group({id:[this.penaltyTransactionId,{nonNullable:!0}],person_Instance_ID:[null,[s.kI.required]],date:[null,[s.kI.required,x.dN.date]],violation_ID:[null,[s.kI.required]],repetition_No:[null],penalty_Value:[null],moneyValue:[null],effectOnPayroll:[null],note:[null]})}get formCtrls(){return this.form.controls}getById(){this.showLoading(),this.penaltyTransactionService.getById(this.penaltyTransactionId).subscribe(t=>{t.message.messageType==v.u.Success?(this.penaltyTransaction=t.data[0],this.form.patchValue(t.data[0]),this.form.patchValue(t.data[0].penalty_Transaction),this.formCtrls.effectOnPayroll.setValue(t.data[0].penalty_Transaction?.trans_Status),this.onChangeViolation([t.data[0].penalty_Transaction.att_Violation])):this.errorList(t?.message?.messages),this.hideLoading()})}submit(){if(this.submitted=!0,this.form.valid){let t={date:d.M6.mapDateReverse(this.formCtrls.date.value),violation_ID:this.formCtrls.violation_ID.value,trans_Status:this.formCtrls.effectOnPayroll.value,note:this.formCtrls.note.value};this.selectedViolation.ismoney?t.moneyValue=this.formCtrls.moneyValue.value:(t.penalty_Value=this.formCtrls.penalty_Value.value,t.Repetition_No=this.formCtrls.repetition_No.value),this.formCtrls.id.value>0?this.update(t):this.create(t)}}create(t){let a={Person_Instance_ID:this.formCtrls.person_Instance_ID.value,Penalty_Trans:{...t},files:this.PenaltyTraAttachComponent.dataSource.data},o=d.M6.objectToFormData(a);this.showLoading(),this.penaltyTransactionService.create(o).subscribe(r=>{r?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newPenaltyTransaction"),this.penaltyTransactionId=r.data.penalty_Transaction.id,this.formCtrls.id.setValue(this.penaltyTransactionId),this.navigateTo(`/attendance/${this.moduleId}/penalty-transaction/edit/${this.penaltyTransactionId}`)):this.errorList(r?.message?.messages),this.hideLoading()})}update(t){let a={Penalty_Trans:{...t,id:this.penaltyTransactionId}};this.showLoading(),this.penaltyTransactionService.update(a).subscribe(o=>{o?.message?.messageType==v.u.Success?this.updateSuccessfullyMsg("penaltyTransactionUpdated"):this.errorList(o?.message?.messages),this.hideLoading()})}onChangeViolation(t){this.selectedViolation=t?.length>0?t[0]:null,this.selectedViolation?.ismoney?(this.formCtrls.moneyValue.setValidators([s.kI.required]),this.formCtrls.penalty_Value.clearValidators()):(this.formCtrls.penalty_Value.setValidators([s.kI.required]),this.formCtrls.moneyValue.clearValidators()),this.formCtrls.penalty_Value.updateValueAndValidity(),this.formCtrls.moneyValue.updateValueAndValidity(),this.getRepetitionValue()}getRepetitionValue(){!this.selectedViolation?.ismoney&&this.formCtrls.person_Instance_ID.value>0&&this.formCtrls.date.value&&this.formCtrls.violation_ID.value>0?this.formCtrls.violation_ID.value==this.penaltyTransaction?.penalty_Transaction.violation_ID?(this.formCtrls.repetition_No.setValue(this.penaltyTransaction.penalty_Transaction?.repetition_No),this.formCtrls.penalty_Value.setValue(this.penaltyTransaction.penalty_Transaction?.penalty_Value)):(this.showLoading(),this.penaltyTransactionService.getRepetitionAndPenaltyValue(this.formCtrls.person_Instance_ID.value,this.formCtrls.violation_ID.value,d.M6.mapDateReverse(this.formCtrls.date.value)).subscribe(t=>{t?.message?.messageType==v.u.Success?(this.formCtrls.penalty_Value.setValue(Number(t.data.penalty_Value)),this.formCtrls.repetition_No.setValue(t.data.repetition_No)):this.errorList(t?.message?.messages),this.hideLoading()})):this.formCtrls.repetition_No.setValue(null)}openPenaltyAndRepetitionDialog(){if(this.selectedViolation)return this.dialog.open(Wt,{data:{violation:this.selectedViolation,personInstanceID:this.formCtrls.person_Instance_ID.value},width:"25vw",minWidth:"410px",maxHeight:"98vh",panelClass:"setup-dialog"}).afterClosed().subscribe(()=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se),e.Y36(X.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-penalty-transaction"]],viewQuery:function(t,a){if(1&t&&e.Gf(ze,5),2&t){let o;e.iGM(o=e.CRH())&&(a.PenaltyTraAttachComponent=o.first)}},features:[e.qOj],decls:29,vars:37,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","addPenaltyTransaction","editTitle","editPenaltyTransaction",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mbottom-35","add-penalty-transaction"],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25","mbottom-15"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","submitted","filter","isPersonInstance","disabled","changeFromScreenOnly","change"],["label","date",3,"control","submitted","change"],[3,"control","employeeControl","submitted","filter","changeFromScreenOnly","change"],[4,"ngIf"],["class","col-lg-3 col-md-4 col-sm-6 col-12",4,"ngIf"],[1,"col-lg-3","col-md-4","col-sm-6","col-12","ptop-14","text-center"],["label","effectOnPayroll","labelPosition","before",3,"control","submitted"],["label","notes",3,"control","submitted"],[1,"mtop-15","mbottom-30"],[3,"penaltyTransactionId"],["saveLabel","add",3,"id","url","pageParams","submit"],["label","repetition",3,"control","submitted","disabled","suffixIcon","allowDisabledIconClick","clickSuffixIcon"],["label","penaltyValuePerDay",3,"control","submitted","filter","isIdAsValue"],["label","moneyValue",3,"control","submitted","type"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,Xt,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4)(7,"mat-card-title",5),e._UZ(8,"page-title",6),e.qZA(),e._UZ(9,"mat-divider")(10,"div",7),e.TgZ(11,"mat-card-content",8)(12,"form",9)(13,"div",10)(14,"div",11)(15,"app-employee-dropdown",12),e.NdJ("change",function(){return a.getRepetitionValue()}),e.qZA()(),e.TgZ(16,"div",11)(17,"app-datepicker",13),e.NdJ("change",function(){return a.getRepetitionValue()}),e.qZA()(),e.TgZ(18,"div",11)(19,"app-violation-by-employee-dropdown",14),e.NdJ("change",function(r){return a.onChangeViolation(r)}),e.qZA()(),e.YNc(20,ea,5,9,"ng-container",15),e.YNc(21,ta,2,3,"div",16),e.TgZ(22,"div",17),e._UZ(23,"app-check-box",18),e.qZA(),e.TgZ(24,"div",11),e._UZ(25,"app-input",19),e.qZA()()(),e._UZ(26,"mat-divider",20)(27,"app-penalty-transaction-attachments",21),e.qZA()(),e.TgZ(28,"app-fixed-card-actions",22),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,33,"attendanceTracker")," / ",e.lcZ(3,35,"penaltyTransaction"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/penalty-transaction"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/penalty-transaction/index"),e.Q6J("params",a.pageParams),e.xp6(7),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.person_Instance_ID)("submitted",a.submitted)("filter",!0)("isPersonInstance",!0)("disabled",a.penaltyTransactionId>0)("changeFromScreenOnly",!0),e.xp6(2),e.Q6J("control",a.formCtrls.date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.violation_ID)("employeeControl",a.formCtrls.person_Instance_ID)("submitted",a.submitted)("filter",!0)("changeFromScreenOnly",!0),e.xp6(1),e.Q6J("ngIf",!(null!=a.selectedViolation&&a.selectedViolation.ismoney)),e.xp6(1),e.Q6J("ngIf",null==a.selectedViolation?null:a.selectedViolation.ismoney),e.xp6(2),e.Q6J("control",a.formCtrls.effectOnPayroll)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.note)("submitted",a.submitted),e.xp6(2),e.Q6J("penaltyTransactionId",a.penaltyTransactionId),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/penalty-transaction"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,l.a,c.u,h.a,f.J,p.T,Ye.J,y.C,m.a8,m.dn,m.n5,D.d,$t.D,Kt.W,s._Y,s.JL,s.sg,ze,u.X$],styles:[".violationInfo{color:#169ed9;cursor:pointer;font-size:16px;margin-top:3px}"]}),n})();const aa=[{id:1,ar_Name:"\u0623\u0630\u0646  \u062f\u062e\u0648\u0644",en_Name:"IN"},{id:2,ar_Name:"\u0623\u0630\u0646  \u062e\u0631\u0648\u062c",en_Name:" Out"},{id:3,ar_Name:"\u0623\u0630\u0646 \u0646\u0635\u0641 \u064a\u0648\u0645",en_Name:"Half of Day"}];var n,fe=(()=>{return(n=fe||(fe={}))[n.in=1]="in",n[n.out=2]="out",n[n.halfOfDay=3]="halfOfDay",fe;var n})();(n=fe||(fe={})).getValue=function i(t){switch(t){case n.in:return"in";case n.out:return"out";case n.halfOfDay:return"halfOfDay";default:return""}};let Ze=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/Permission/GetList",{params:{...t,$expand:`${W.db.att_Permission},${W.db.att_Permission}.${W.db.att_Permission_Setup}`}})}getAll(t){return this.get("TimeAttendance/Permission/GetAll",{params:{...t,$expand:`${W.db.att_Permission},${W.db.att_Permission}.${W.db.att_Permission_Setup},${W.db.att_Permission},${W.db.Core_Person_Instance}/${W.db.core_Person_Instance_Job_Title}.${W.db.Core_Job_Title}`}})}getAllEmployeeCountByperDay(t){return this.get("TimeAttendance/Permission/GetGroupCountEmpPerDayPermission",{params:t})}getById(t){return this.get("TimeAttendance/Permission/GetAll",{params:{$filter:`permission_ID eq ${t}`,$expand:`${W.db.att_Permission},${W.db.Core_Person_Instance}/${W.db.core_Person_Instance_Job_Title}.${W.db.Core_Job_Title}`}})}create(t){return this.post("TimeAttendance/Permission/Create",t)}update(t){return this.post("TimeAttendance/Permission/Edit",t)}Delete(t,a){return this.delete("TimeAttendance/Permission/Delete",{params:{Permission_ID:t,Person_Instance_ID:a}})}upload(t){return this.post("TimeAttendance/Permission/Upload",t)}download(){return this.get("TimeAttendance/Permission/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var na=S(71353),ia=S(57681);function oa(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/permission-transaction/add"),e.Q6J("params",t.parentParam)}}function ra(n,i){if(1&n&&(e.ynx(0),e._UZ(1,"hr")(2,"employee-table-by-multi-policyIds",25),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("control",t.formCtrls.selectedEmployeeIDs)("policyControl",t.formCtrls.policyGroupId)("jobControl",t.formCtrls.jobId)("orgControl",t.formCtrls.orgId)("showFilter",0==t.permissionId)("hideSelect",t.permissionId>0)("filterByCode",t.permissionId>0)("showPaginator",0==t.permissionId)("employeeCode",null==t.currentPerson||null==t.currentPerson.core_Person?null:t.currentPerson.core_Person.code)}}let $e=(()=>{class n extends M.U{constructor(t,a,o,r){super(),this.permissionService=t,this.policyDetailsService=a,this.data=o,this.dialogRef=r,this.submitted=!1,this.permissionId=0,this.permissionPatternList=aa,this.filterEmpByCode=!1,this.filterEmpByJob=!0,this.activatedRoute.params.subscribe(I=>{this.permissionId=Number(I.id??0)})}ngOnInit(){this.form=this.fb.group({id:[this.permissionId,{nonNullable:!0}],orgId:[null],jobId:[null],permission_Date:[null,[s.kI.required,x.dN.date]],across_Mid_Night:[!1,[s.kI.required]],permission_To_Date:[null],from_Hour:[null,[s.kI.required]],to_Houre:[null,[s.kI.required]],permission_Type:[null,[s.kI.required]],policyGroupId:[null,[s.kI.required]],permission_Setup_Id:[null,[s.kI.required]],note:[null],selectedEmployeeIDs:[null],Person_Instance_Id:[null]},{validators:T.w.compareDates("permission_Date","permission_To_Date")}),this.formCtrls?.permission_Date?.valueChanges.subscribe(t=>{t&&0==this.permissionId&&this.onChangeCross_Mid_Night(this.formCtrls.across_Mid_Night.value),this.formCtrls.policyGroupId.value&&null!=t&&this.permissionId>0&&this.getPolicyDetails(this.formCtrls.policyGroupId.value,t)})}onChangeBusinessAndCompanyId(){this.permissionId>0&&this.checkNoBusinessOrCompany()&&this.GetById()}get formCtrls(){return this.form.controls}GetById(){this.showLoading(),this.permissionService.getById(this.permissionId).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=t.data[0];this.form.patchValue(a.att_Permission),this.currentPerson=a.core_Person_Instance,this.formCtrls.Person_Instance_Id.setValue(a.person_Instance_ID),this.formCtrls.policyGroupId.setValue([a.policyGroupId]),this.formCtrls.policyGroupId.disable(),this.getPolicyDetails(a.policyGroupId,this.formCtrls.permission_Date.value),this.filterEmpByCode=!0,this.filterEmpByJob=!1}else this.errorList(t?.message?.messages);this.hideLoading()})}submit(){if(this.submitted=!0,0!=this.permissionId||0!=this.formCtrls.selectedEmployeeIDs?.value?.length){if(this.form.valid){let t={permission:{id:this.formCtrls.id.value,permission_Date:d.M6.mapDateReverse(this.formCtrls.permission_Date.value),permission_To_Date:d.M6.mapDateReverse(this.formCtrls.permission_To_Date.value),from_Hour:this.formCtrls.from_Hour.value,to_Houre:this.formCtrls.to_Houre.value,across_Mid_Night:this.formCtrls.across_Mid_Night.value,permission_Type:this.formCtrls.permission_Type.value,permission_Setup_Id:this.formCtrls.permission_Setup_Id.value,note:this.formCtrls.note.value},selectedEmployeeIDs:this.formCtrls.selectedEmployeeIDs.value,Person_Instance_Id:this.formCtrls.Person_Instance_Id.value};0==t?.permission?.id?this.create(t):this.update(t)}}else this.info("selectOneEmployee")}create(t){delete t.Person_Instance_Id,t.selectedEmployeeIDs.length>0?(this.showLoading(),this.permissionService.create(t).subscribe(a=>{if(a?.message?.messageType==v.u.Success){this.addSuccessfullyMsg("canEditOrRemoveFromIndex","new_permission_transaction_added");let o=`/attendance/${this.moduleId}/permission-transaction`;this.data.isDialog||this.router.navigateByUrl(o),this.data.isDialog&&this.dialogRef.close()}else this.errorList(a?.message?.messages);this.hideLoading()})):this.error("selectOneEmployee")}update(t){delete t.selectedEmployeeIDs,this.showLoading(),this.permissionService.update(t).subscribe(a=>{a?.message?.messageType==v.u.Success?this.updateSuccessfullyMsg("permission_transaction_updated"):this.errorList(a?.message?.messages),this.hideLoading()})}onChangeCross_Mid_Night(t){const a=this.formCtrls?.permission_Date?.value;let o=new Date(a);o.setDate(new Date(a).getDate()+1),t&&this.formCtrls.permission_To_Date.setValue(o),t||this.formCtrls.permission_To_Date.setValue(a)}getPolicyDetails(t,a){this.policyDetailsService.getPolicyDetailsByDate(t,d.M6.mapDateReverse(a)).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==v.u.Success?this.permissionSetup_SelectedIds=o.data.permissionSetup_SelectedIds:this.errorList(o?.message?.messages)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ze),e.Y36(b.P),e.Y36(X.WI),e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-permission-transaction"]],features:[e.qOj],decls:36,vars:57,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","add_permission_transaction","editTitle","edit_permission_transaction",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mb-4"],[1,"title-no-margin"],["title","generalInfo",1,"stepper-section-title"],[1,"mt-2"],[3,"formGroup"],[1,"row"],[1,"col-md-4","col-lg-3","col-12"],[3,"control","submitted","disable","filter","multi"],[3,"control","organizationControl","submitted","multi","filter","organizationControlRequired"],["label","effectiveDate",3,"control","submitted"],["label","across_Mid_Night","color","primary","labelPosition","before","styleClass","margin-17",3,"control","onChange"],["label","endDate",3,"control","submitted","disable"],["label","startHour",3,"control","submitted"],["label","endHour",3,"control","submitted"],["label","permission_setup",3,"control","multi","submitted","EnabledIds","filter"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],[3,"control","permissionSetupCtrl","fromDateCtrl","submitted","disable","filter","multi"],["label","permission_pattern",3,"control","multi","List","submitted","filter"],["label","note",3,"control"],[4,"ngIf"],["saveLabel","add",3,"id","url","pageParams","submit"],[3,"control","policyControl","jobControl","orgControl","showFilter","hideSelect","filterByCode","showPaginator","employeeCode"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.YNc(4,oa,1,2,"app-add-new-btn",2),e._UZ(5,"app-back-btn",3),e.qZA(),e.TgZ(6,"mat-card",4)(7,"mat-card-title",5),e._UZ(8,"page-title",6),e.qZA(),e.TgZ(9,"mat-card-content",7)(10,"form",8)(11,"div",9)(12,"div",10),e._UZ(13,"app-organization-current-structure-dropdown",11),e.qZA(),e.TgZ(14,"div",10),e._UZ(15,"app-job-title-by-org-dropdown",12),e.qZA(),e.TgZ(16,"div",10),e._UZ(17,"app-datepicker",13),e.qZA(),e.TgZ(18,"div",10)(19,"app-check-box",14),e.NdJ("onChange",function(r){return a.onChangeCross_Mid_Night(r)}),e.qZA()(),e.TgZ(20,"div",10),e._UZ(21,"app-datepicker",15),e.qZA(),e.TgZ(22,"div",10),e._UZ(23,"app-timepicker",16),e.qZA(),e.TgZ(24,"div",10),e._UZ(25,"app-timepicker",17),e.qZA(),e.TgZ(26,"div",10),e._UZ(27,"app-permission-type-dropdown",18),e.qZA(),e.TgZ(28,"div",19),e._UZ(29,"policy-groups-by-permission-dropdown",20),e.qZA(),e.TgZ(30,"div",10),e._UZ(31,"app-prime-dropdown",21),e.qZA(),e.TgZ(32,"div",10),e._UZ(33,"app-input",22),e.qZA()()(),e.YNc(34,ra,3,9,"ng-container",23),e.qZA()(),e.TgZ(35,"app-fixed-card-actions",24),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,53,"attendanceTracker")," / ",e.lcZ(3,55,"PermissionTransaction"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/permission-transaction"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"add")("parentLinkParams",a.pageParams),e.xp6(3),e.Q6J("ngIf",a.permissionId>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/permission-transaction"),e.Q6J("params",a.pageParams),e.xp6(5),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.orgId)("submitted",a.submitted)("disable",a.permissionId>0)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.jobId)("organizationControl",a.formCtrls.orgId)("submitted",a.submitted)("multi",!0)("filter",!0)("organizationControlRequired",!0),e.xp6(2),e.Q6J("control",a.formCtrls.permission_Date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.across_Mid_Night),e.xp6(2),e.Q6J("control",a.formCtrls.permission_To_Date)("submitted",a.submitted)("disable",!0),e.xp6(2),e.Q6J("control",a.formCtrls.from_Hour)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.to_Houre)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.permission_Setup_Id)("multi",!1)("submitted",a.submitted)("EnabledIds",a.permissionSetup_SelectedIds)("filter",!1),e.xp6(2),e.Q6J("control",a.formCtrls.policyGroupId)("permissionSetupCtrl",a.formCtrls.permission_Setup_Id)("fromDateCtrl",a.formCtrls.permission_Date)("submitted",a.submitted)("disable",a.permissionId>0)("filter",!0)("multi",!0),e.xp6(2),e.Q6J("control",a.formCtrls.permission_Type)("multi",!1)("List",a.permissionPatternList)("submitted",a.submitted)("filter",!1),e.xp6(2),e.Q6J("control",a.formCtrls.note),e.xp6(1),e.Q6J("ngIf",a.formCtrls.policyGroupId.value),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/permission-transaction"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.pageParams))},dependencies:[Q.O5,g.Q,l.a,c.u,h.a,De.E,f.J,p.T,y.C,P.f,m.a8,m.dn,m.n5,Me.t,_.s,na._,q.a,ia.Q,s._Y,s.JL,s.sg,u.X$]}),n})(),Ke=(()=>{class n extends L.K{constructor(){super()}calculateAttendance(t){return this.post("TimeAttendance/Attendence/Calculate",t)}getFromDateDropdown(){return this.get("TimeAttendance/Attendence/Periods")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),sa=(()=>{class n extends M.U{constructor(t,a){super(),this.fingerprintsService=t,this.dialogRef=a,this.submitted=!1}ngOnInit(){this.form=this.fb.group({calculation_time:[null,[s.kI.required,x.dN.gt(0)]]})}get formCtrls(){return this.form.controls}submit(){this.submitted=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ke),e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-auto-track-attendance-dialog"]],features:[e.qOj],decls:14,vars:4,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0","ml-3"],["title","auto_track_attendance",1,"d-inline-block","mtop-10"],[1,"container-fluid","mx-0","h-100","mtop-2"],["dialogContainer",""],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-12","col-12","mb-1"],["label","calculation_time",3,"control","submitted"],["align","end"],["styleClass","w-100","icon","fas fa-save",3,"iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2,3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",4),e._UZ(9,"div",7),e.TgZ(10,"div",7),e._UZ(11,"app-timepicker",8),e.qZA()()()()(),e.TgZ(12,"mat-card-actions",9)(13,"submit-btn",10),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()),2&t&&(e.xp6(7),e.Q6J("formGroup",a.form),e.xp6(4),e.Q6J("control",a.formCtrls.calculation_time)("submitted",a.submitted),e.xp6(2),e.Q6J("iconPositionBefore",!1))},dependencies:[De.E,de.p,p.T,m.hq,X.uh,X.xY,s._Y,s.JL,s.sg]}),n})();const la=function(){return[]};let da=(()=>{class n extends M.U{constructor(t,a){super(),this.fingerprintsService=t,this.dialogRef=a,this.submitted=!1,this.enableIds=[],this.getFromDateDropdown()}ngOnInit(){this.form=this.fb.group({employeeIds:[null],from_Date:[null,[s.kI.required]],transfer_penalties:[!1,[s.kI.required]],transfer_penaltiesFor:[null],noOfDays:[null,[x.dN.gt(0)]]}),this.formCtrls.transfer_penalties.valueChanges.subscribe(t=>{t||(this.formCtrls.transfer_penaltiesFor.reset(),this.formCtrls.noOfDays.reset())})}get formCtrls(){return this.form.controls}submit(){if(this.submitted=!0,this.form.valid){const t={Personid:this.form.value.employeeIds,FromDate:this.form.value.from_Date,ToBeTransfered:this.form.value.transfer_penalties,PersonidToTransferPenalities:this.form.value.transfer_penaltiesFor};this.showLoading(),this.fingerprintsService.calculateAttendance(t).subscribe(a=>{a?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("successfully_calculateAttendance"),this.dialogRef.close()):this.errorList(a?.message?.messages),this.hideLoading()})}}getFromDateDropdown(){this.fingerprintsService.getFromDateDropdown().subscribe(t=>{if(t?.message?.messageType==v.u.Success){let a=[];t.data.dates.map(o=>{let r={id:o,ar_Name:d.M6.mapDate(o),en_Name:d.M6.mapDate(o)};a.push(r)}),this.fromDateList=a,this.formCtrls.from_Date.setValue(t.data.defualt)}else this.errorList(t?.message?.messages);this.hideLoading()})}onSelectEmployee(t){this.enableIds=[],t?.length>0?t.map(a=>{this.enableIds.push(a.id)}):this.enableIds=[],this.formCtrls.transfer_penaltiesFor.reset()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ke),e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-calculate-attendance-dialog"]],features:[e.qOj],decls:19,vars:16,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0","ml-3"],["title","calculate_attendance",1,"d-inline-block","mtop-10"],[1,"container-fluid","mt-2","mx-0","h-100"],["dialogContainer",""],[1,"row"],[1,"col-12"],[3,"formGroup"],[1,"col-md-12","col-12","mb-1"],[3,"control","submitted","change"],[1,"col-md-12","col-12"],["label","from_Date",3,"control","submitted","List","filter"],[1,"col-md-12","col-12","mb-2"],["label","transfer_penalties","color","primary","labelPosition","before","styleClass","margin-17 justify-content-around",3,"control"],["label","transfer_penalties_for",3,"control","submitted","disabled","enableIds","multi"],["align","end",1,"mb-0"],["icon","fas fa-save",1,"w-95","m-auto","d-block",3,"styleClass","iconPositionBefore","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2,3)(5,"div",4)(6,"div",5)(7,"form",6)(8,"div",4)(9,"div",7)(10,"app-employee-dropdown",8),e.NdJ("change",function(r){return a.onSelectEmployee(r)}),e.qZA()(),e.TgZ(11,"div",9),e._UZ(12,"app-prime-dropdown",10),e.qZA(),e.TgZ(13,"div",11),e._UZ(14,"app-check-box",12),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-employee-dropdown",13),e.qZA()()()()(),e.TgZ(17,"mat-card-actions",14)(18,"submit-btn",15),e.NdJ("onClick",function(){return a.submit()}),e.qZA()()()),2&t&&(e.xp6(7),e.Q6J("formGroup",a.form),e.xp6(3),e.Q6J("control",a.formCtrls.employeeIds)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.from_Date)("submitted",a.submitted)("List",a.fromDateList)("filter",!0),e.xp6(2),e.Q6J("control",a.formCtrls.transfer_penalties),e.xp6(2),e.Q6J("control",a.formCtrls.transfer_penaltiesFor)("submitted",a.submitted)("disabled",!a.formCtrls.transfer_penalties.value||(null==a.enableIds?null:a.enableIds.length)>0&&a.formCtrls.transfer_penalties.value)("enableIds",a.formCtrls.transfer_penalties.value?a.enableIds:e.DdM(15,la))("multi",!0),e.xp6(2),e.MGl("styleClass","",a.btn.block," m-auto"),e.Q6J("iconPositionBefore",!1))},dependencies:[c.u,de.p,p.T,Ye.J,m.hq,X.uh,X.xY,Me.t,s._Y,s.JL,s.sg]}),n})();var Re=S(28255),Ne=S(17489),pa=S(59683);const ca=function(){return[]};let ma=(()=>{class n extends M.U{constructor(t,a,o,r,I){super(),this.missionService=t,this.permissionService=a,this.vacationService=o,this.data=r,this.dialogRef=I,this.mandatoryColomns=["code","employeeName","jobTitle"],"permission"==r.type&&(this.mandatoryColomns.push("permissionType"),this.pageTitle="permission_for",this.permissionService.getAll({$filter:`att_Permission/permission_Date le ${r.date} and att_Permission/permission_To_Date ge ${this.data.date}`}).subscribe(ee=>{ee.data.map(V=>{V.code=V.core_Person_Instance?.core_Person?.code,V.employeeName=(0,d._f)(V.core_Person_Instance?.core_Person?.ar_Name,V.core_Person_Instance?.core_Person?.en_Name),V.jobTitle=(0,d._f)(V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name,V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name),V.permissionType=V?.att_Permission?.att_Permission_Setup?.name}),this.dataSource=new Z.by(ee.data),this.isLoaded=!0})),"mission"==r.type&&(this.mandatoryColomns.push("location"),this.pageTitle="mission_for",this.missionService.getAll({$filter:`att_Mission/from_Date le ${this.data.date} and att_Mission/to_Date ge ${this.data.date}`}).subscribe(ee=>{ee.data.map(V=>{V.code=V.core_Person_Instance?.core_Person?.code,V.employeeName=(0,d._f)(V.core_Person_Instance?.core_Person?.ar_Name,V.core_Person_Instance?.core_Person?.en_Name),V.jobTitle=(0,d._f)(V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name,V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name),V.location=V?.att_Mission?.location}),this.dataSource=new Z.by(ee.data),this.isLoaded=!0})),"vacation"==r.type&&(this.mandatoryColomns.push("vacationType"),this.pageTitle="vacation_for",this.vacationService.getAll({$filter:`vacation_From ge ${this.data.date} and ${this.data.date} le vacation_To`}).subscribe(ee=>{ee.data.map(V=>{V.code=V.core_Person_Instance?.core_Person?.code,V.employeeName=(0,d._f)(V.core_Person_Instance?.core_Person?.ar_Name,V.core_Person_Instance?.core_Person?.en_Name),V.jobTitle=(0,d._f)(V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name,V.core_Person_Instance?.core_Person_Instance_Job_Title[0]?.core_Job_Title?.ar_Name),V.vacationType=(0,d._f)(V.att_Vacation.ar_Name,V.att_Vacation.en_Name)}),this.dataSource=new Z.by(ee.data),this.isLoaded=!0}))}parseCustomDate(t){const a=parseInt(t.split(" ")[1],10),o=(new Date).getMonth(),r=(new Date).getFullYear();return new Date(r,o,a)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(we),e.Y36(Ze),e.Y36(ae),e.Y36(X.WI),e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home-employee-dialog"]],features:[e.qOj],decls:7,vars:10,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0","ml-3"],[1,"d-inline-block","mtop-10",3,"title"],[1,"mx-0","px-0"],[1,"table-in-forms",3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","showPaginator","showFilter","showSpaceTop"],[1,"border-0"],["label","ok",1,"w-270",3,"styleClass","onClick"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA(),e.TgZ(3,"mat-dialog-content",2),e._UZ(4,"app-material-table",3),e.qZA(),e.TgZ(5,"mat-dialog-actions",4)(6,"submit-btn",5),e.NdJ("onClick",function(){return a.dialogRef.close()}),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("title",a.pageTitle),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",e.DdM(9,ca))("showPaginator",!1)("showFilter",!1)("showSpaceTop",!1),e.xp6(2),e.Q6J("styleClass",a.btn.block))},dependencies:[te.I,de.p,p.T,X.uh,X.xY,X.H8],styles:[".w-270[_ngcontent-%COMP%]{width:270px!important}"]}),n})();var ua=S(30567);function _a(n){if(n)return n.map(i=>({...i,dayDate:d.M6.mapDate(i.dayDate,"yyyy-MM-dd"),shortDate:d.M6.dayWithName(new Date(i.dayDate)),type:J.permission}))}var ye=S(9615);function ha(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"span",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.daily_operations_dialog("permission",o.dayDate))}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;let a;e.xp6(1),e.hij(" ",e.lcZ(2,3,"permission_for")," "),e.xp6(3),e.AsE(" ",null!==(a=t.count)&&void 0!==a?a:0," ",e.lcZ(5,5,"Employees")," ")}}function fa(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"span",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.daily_operations_dialog("mission",o.dayDate))}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;let a;e.xp6(1),e.hij(" ",e.lcZ(2,3,"mission_for")," "),e.xp6(3),e.AsE(" ",null!==(a=t.count)&&void 0!==a?a:0," ",e.lcZ(5,5,"Employees")," ")}}function ya(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"span",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.daily_operations_dialog("vacation",o.dayDate))}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;let a;e.xp6(1),e.hij(" ",e.lcZ(2,3,"vacation_for")," "),e.xp6(3),e.AsE(" ",null!==(a=t.count)&&void 0!==a?a:0," ",e.lcZ(5,5,"Employees")," ")}}function va(n,i){if(1&n&&(e.TgZ(0,"li",7)(1,"span",8),e._uU(2),e.qZA(),e.YNc(3,ha,6,7,"ng-container",0),e.YNc(4,fa,6,7,"ng-container",0),e.YNc(5,ya,6,7,"ng-container",0),e.qZA()),2&n){const t=i.$implicit,a=e.oxw(3);e.xp6(2),e.hij(" ",t.shortDate," "),e.xp6(1),e.Q6J("ngIf",t.type==a.attendanceType.permission),e.xp6(1),e.Q6J("ngIf",t.type==a.attendanceType.mission),e.xp6(1),e.Q6J("ngIf",t.type==a.attendanceType.vacation)}}function Ta(n,i){if(1&n&&(e.TgZ(0,"ul",5),e.YNc(1,va,6,4,"li",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.paginatedItems)}}function Ca(n,i){1&n&&(e.TgZ(0,"div",11),e._UZ(1,"p-skeleton",12),e.qZA())}const ba=function(){return[]};function Ia(n,i){if(1&n&&e.YNc(0,Ca,2,0,"div",10),2&n){const t=e.oxw(2);e.Q6J("ngForOf",e.DdM(1,ba).constructor(t.isDailog?6:3))}}function Da(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ta,2,1,"ul",3),e.YNc(2,Ia,1,2,"ng-template",null,4,e.W1O),e.qZA()),2&n){const t=e.MAs(3),a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.isLoaded)("ngIfElse",t)}}function Aa(n,i){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"img",14),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.assetsManager.empty,e.LSH)}}function Pa(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-prime-paginator",15),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getList(o.pageIndex+1,o.pageSize))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("page",t.page)("isDialogSize",!0)}}let Ue=(()=>{class n extends M.U{constructor(t,a,o){super(),this.missionService=t,this.permissionService=a,this.vacationService=o,this.isDailog=!1,this.permissionLoaded=!1,this.missionLoaded=!1,this.vacationLoaded=!1,this.todayShort=d.M6.dayWithName(),this.today=d.M6.mapDateReverse((new Date).toString()),this.missionList=[],this.permissionList=[],this.vacationList=[],this.allDataList=[],this.paginatedItems=[],this.attendanceType=J,this.isLoaded=!1,this.assetsManager=new be.Sp}ngOnInit(){let t=new Date;t.setDate(t.getDate()+6),this.lastDay=d.M6.mapDateReverse(t.toString()),this.requestModel={fromDate:this.today,toDate:this.isDailog?this.lastDay:this.today,PageNumber:this.firstPage,pageSize:this.page.pageSize},(0,ua.D)(this.missionService.getAllEmployeeCountByperDay(this.requestModel),this.permissionService.getAllEmployeeCountByperDay(this.requestModel),this.vacationService.getAllEmployeeCountByperDay(this.requestModel)).subscribe(a=>{this.allDataList=[...It(a[0].data),..._a(a[1].data),...k(a[2].data)],this.allDataList.sort((o,r)=>{let I=o.dayDate.split(" ")[1],H=r.dayDate.split(" ")[1];return Number(I)-Number(H)}),this.isLoaded=!0,this.getList(this.firstPage,5)})}getList(t,a){this.page.pageIndex=t,a&&(this.page.dialogSize=a);const o=a*t;this.paginatedItems=this.allDataList.slice(o-a,o),this.page.length=this.allDataList.length}daily_operations_dialog(t,a){this.dialogsService.addEditDialog(ma,{type:t,date:a},{panelClass:"dialog-emp-form",width:"65%"}).afterClosed().subscribe(o=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(we),e.Y36(Ze),e.Y36(ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["daily-operation-card"]],inputs:{isDailog:"isDailog"},features:[e.qOj],decls:3,vars:3,consts:[[4,"ngIf"],["class","text-center",4,"ngIf"],[3,"page","isDialogSize","onChangePage",4,"ngIf"],["class","list-group",4,"ngIf","ngIfElse"],["notLoaded",""],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"badge","badge-light","mr-2"],[1,"babyBlue","pointer",3,"click"],["class","col-12 mb-2",4,"ngFor","ngForOf"],[1,"col-12","mb-2"],["borderRadius","10px","styleClass","mb-2","width","100%","height","53px"],[1,"text-center"],[3,"src"],[3,"page","isDialogSize","onChangePage"]],template:function(t,a){1&t&&(e.YNc(0,Da,4,2,"div",0),e.YNc(1,Aa,2,1,"div",1),e.YNc(2,Pa,1,2,"app-prime-paginator",2)),2&t&&(e.Q6J("ngIf",a.allDataList.length>0),e.xp6(1),e.Q6J("ngIf",0==a.allDataList.length&&a.isLoaded),e.xp6(1),e.Q6J("ngIf",a.page.length>a.page.dialogSize&&a.isDailog))},dependencies:[Q.sg,Q.O5,ye.m,Ne.O,u.X$],styles:[".list-group-item[_ngcontent-%COMP%]{border-radius:5px;box-shadow:0 4px 4px #00000008;border:none;border-top:solid 1px #f4f4f4;border-bottom:solid 1px #f4f4f4;background-color:#fff;margin-bottom:10px;font-family:interMedium,sans-serif;font-size:13px;color:#333;padding:0!important}.badge[_ngcontent-%COMP%]{width:47px;height:47px;white-space:normal;white-space:initial;line-height:normal;margin-top:7px;margin-bottom:7px;text-align:center}.badge-light[_ngcontent-%COMP%]{padding:10px 5px;border-radius:6px;box-shadow:0 4px 26px #6f6f721f;background-color:#fff;font-size:12px;font-weight:600;color:#374761}  .mat-paginator[ng-reflect-hide-page-size=true] .mat-paginator-range-label{display:none!important}  .p-paginator .p-inputwrapper-filled,   .mat-paginator-range-actions{display:none!important}"]}),n})();const wa=function(n){return{parentView:n}},Sa=function(n,i){return{"text-right mr-3":n,"text-left ml-3":i}};function Za(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e.NdJ("click",function(){const r=e.CHM(t).$implicit,I=e.oxw(2);return e.KtG(I.onClickFun(r))}),e.TgZ(2,"div",12)(3,"div",13)(4,"div",14),e._UZ(5,"img",15),e.qZA(),e.TgZ(6,"div",16)(7,"h3",17),e._uU(8),e.ALo(9,"translate"),e.qZA()()()()()()}if(2&n){const t=i.$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("routerLink",t.path)("queryParams",e.VKq(9,wa,a.getViewName)),e.xp6(1),e.Tol(t.color),e.xp6(3),e.Q6J("src",a.svg[t.icon],e.LSH),e.xp6(1),e.Q6J("ngClass",e.WLB(11,Sa,a.languageService.isArabic,a.languageService.isEnglish)),e.xp6(2),e.Oqu(e.lcZ(9,7,t.name))}}function xa(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Za,10,14,"div",9),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.globalFunctions)}}function La(n,i){1&n&&(e.TgZ(0,"div",10),e._UZ(1,"p-skeleton",18),e.qZA())}const Oa=function(){return[]};function Fa(n,i){1&n&&e.YNc(0,La,2,0,"div",9),2&n&&e.Q6J("ngForOf",e.DdM(1,Oa).constructor(3))}function Ma(n,i){if(1&n&&(e.TgZ(0,"div",6)(1,"div",19)(2,"div",20),e._UZ(3,"powerbi-dashboard",21),e.qZA()(),e.TgZ(4,"div",22)(5,"div",20),e._UZ(6,"powerbi-dashboard",21),e.qZA()(),e.TgZ(7,"div",23)(8,"div",20),e._UZ(9,"powerbi-dashboard",21),e.qZA()(),e.TgZ(10,"div",24)(11,"div",25),e._UZ(12,"powerbi-dashboard",21),e.qZA()(),e.TgZ(13,"div",26)(14,"div",25),e._UZ(15,"powerbi-dashboard",21),e.qZA()(),e.TgZ(16,"div",23)(17,"mat-card",27)(18,"mat-card-title",28),e._UZ(19,"page-title",29),e.TgZ(20,"button",30),e._uU(21),e.ALo(22,"titlecase"),e.ALo(23,"translate"),e._UZ(24,"i",31),e.qZA(),e.TgZ(25,"mat-menu",null,32)(27,"a",33),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"a",33),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"a",33),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"a",33),e._uU(37),e.ALo(38,"translate"),e.qZA()()(),e._UZ(39,"div",34),e.TgZ(40,"mat-card-content",35),e._UZ(41,"daily-operation-card"),e.qZA()()()()),2&n){const t=e.MAs(26),a=e.oxw();e.xp6(3),e.Q6J("embedConfig",a.embedConfig)("eventHandlers",a.eventHandlers),e.xp6(3),e.Q6J("embedConfig",a.embedConfig)("eventHandlers",a.eventHandlers),e.xp6(3),e.Q6J("embedConfig",a.embedConfig)("eventHandlers",a.eventHandlers),e.xp6(3),e.Q6J("embedConfig",a.embedConfig)("eventHandlers",a.eventHandlers),e.xp6(3),e.Q6J("embedConfig",a.embedConfig)("eventHandlers",a.eventHandlers),e.xp6(5),e.Tol(a.btn.lightOutline),e.Q6J("matMenuTriggerFor",t),e.xp6(1),e.hij(" ",e.lcZ(22,22,e.lcZ(23,24,"createNew"))," "),e.xp6(6),e.MGl("routerLink","/attendance/",a.moduleId,"/vacation-transaction/index"),e.xp6(1),e.hij(" ",e.lcZ(29,26,"vacationTransaction")," "),e.xp6(2),e.MGl("routerLink","/attendance/",a.moduleId,"/mission-transaction/index"),e.xp6(1),e.hij(" ",e.lcZ(32,28,"mission_transaction")," "),e.xp6(2),e.MGl("routerLink","/attendance/",a.moduleId,"/permission-transaction/index"),e.xp6(1),e.hij(" ",e.lcZ(35,30,"PermissionTransaction")," "),e.xp6(2),e.MGl("routerLink","/attendance/",a.moduleId,"/overtime-transaction/index"),e.xp6(1),e.hij(" ",e.lcZ(38,32,"OvertimeTransaction")," ")}}let Ra=(()=>{class n extends M.U{constructor(){super(),this.svg=new be.El,this.embedConfig={type:"dashboard",id:"",embedUrl:"https://app.powerbi.com/view?r=eyJrIjoiYTZlYWRmMTEtMDQ4MS00NmQzLTgxYjAtNzIzODBjZWI4ZDM0IiwidCI6IjliZDQzOWMzLTk3YWEtNDdlMC1iYjJiLWNlYmI2MGRmNmRlZSJ9",accessToken:"",settings:{panes:{filters:{expanded:!1,visible:!1}}}},this.eventHandlers=new Map([["loaded",()=>console.log("Report loaded")],["rendered",()=>console.log("Report rendered")],["error",t=>console.log(t.detail)]])}ngOnInit(){}onClickFun(t){"auto_track_attendance"==t.name&&this.auto_track_attendance(),"calculate_attendance"==t.name&&this.calculate_attendance()}auto_track_attendance(){this.dialogsService.addEditDialog(sa,{},{panelClass:"dialog-emp-form",width:"25%"}).afterClosed().subscribe(t=>{})}calculate_attendance(){this.dialogsService.addEditDialog(da,{},{panelClass:"dialog-emp-form",width:"25%"}).afterClosed().subscribe(t=>{})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-fingerprints-home"]],features:[e.qOj],decls:10,vars:2,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","fingerprints","parentTitle","attendanceTracker"],[1,"row","my-3"],[4,"ngIf","ngIfElse"],["loading",""],["class","row",4,"ngIf"],[1,"row"],[1,"col-12"],["src","assets/Home/att/Frame 1000011530.svg"],["class","col-md-4 col-12 mb-2",4,"ngFor","ngForOf"],[1,"col-md-4","col-12","mb-2"],[3,"routerLink","queryParams","click"],[1,"card-box"],[1,"media","p-0"],[1,"media-left","align-self-center"],["width","33",3,"src"],[1,"media-body",3,"ngClass"],[1,"card-text"],["borderRadius","10px","width","100%","height","100px"],[1,"col-md-5","col-12","px-2","mb-2"],[1,"dashboard-container"],["cssClassName","border-0 border-radius-10 chart h-100",3,"embedConfig","eventHandlers"],[1,"col-md-4","col-12","px-2","mb-2"],[1,"col-md-3","col-12","px-2","mb-2"],[1,"col-md-5","col-12","px-2","mb-2","mtop-15"],[1,"dashboard-container-small"],[1,"col-md-4","col-12","px-2","mb-2","mtop-15"],[1,"form-card"],[1,"title-no-margin","border-0"],["title","daily_operations","titleStyleClass","font-size-18"],[1,"menu-row-dropdown","font-size-13","pl-1","pr-1",3,"matMenuTriggerFor"],[1,"ft-chevron-down","font-size-15"],["menuRow","matMenu"],["mat-menu-item","",3,"routerLink"],[1,"clearfix"],[1,"container-fluid","px-0"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,xa,2,1,"ng-container",3),e.YNc(4,Fa,1,2,"ng-template",null,4,e.W1O),e.qZA(),e.YNc(6,Ma,42,34,"div",5),e.TgZ(7,"div",6)(8,"div",7),e._UZ(9,"img",8),e.qZA()()),2&t){const o=e.MAs(5);e.xp6(3),e.Q6J("ngIf",(null==a.globalFunctions?null:a.globalFunctions.length)>0)("ngIfElse",o)}},dependencies:[Q.mk,Q.sg,Q.O5,ne.yS,p.T,m.a8,m.dn,m.n5,Re.VK,Re.OP,Re.p6,Ne.O,pa.Ch,Ue,Q.rS,u.X$],styles:[".dashboard-container{height:400px}  .dashboard-container-small{height:272px}  .chart>iframe{border:none!important;border-radius:10px!important}img[_ngcontent-%COMP%]{width:100%;height:100%;display:block}"]}),n})(),Xe=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/ManuallyCheckTime/GetList",{params:{...t}})}getById(t){return this.get("TimeAttendance/ManuallyCheckTime/GetAll",{params:{$filter:`person_Instance_ID eq ${t.Person_Instance_ID} and checkInTime eq ${t.checkInTime}z`,$expand:`${W.db.Core_Person_Instance}.${W.db.Core_Person}`}})}create(t){return this.post("TimeAttendance/ManuallyCheckTime/Create",t)}update(t){return this.post("TimeAttendance/ManuallyCheckTime/Edit",t)}getEmployeesList(t){return this.get("TimeAttendance/ManuallyCheckTime/Create_GetAll",{params:t})}Delete(t,a){return this.delete("TimeAttendance/ManuallyCheckTime/Delete",{params:{Person_Instance_ID:t,CheckTime:a}})}upload(t){return this.post("TimeAttendance/UploadRegisterFingerprint/Upload",t)}download(){return this.get("TimeAttendance/UploadRegisterFingerprint/Download",{responseType:"arraybuffer"})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function qa(n,i){if(1&n&&e._UZ(0,"app-add-new-btn",3),2&n){const t=e.oxw();e.MGl("url","/attendance/",t.moduleId,"/fingerprints/register-fingerprint/add"),e.Q6J("params",t.parentParam)}}function Ea(n,i){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"app-organization-current-structure-dropdown",22),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.orgId)("submitted",t.submitted)("filter",!0)("multi",!0)}}function Ja(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"app-job-title-by-org-dropdown",23),e.NdJ("change",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getFilteredEmployees())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("control",t.formCtrls.jobId)("organizationControl",t.formCtrls.orgId)("organizationControlRequired",!0)("submitted",t.submitted)("filter",!0)("multi",!0)}}function ka(n,i){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"mat-divider"),e.TgZ(2,"app-material-table",24),e.NdJ("selectedItems",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getSelectedEmployees(o))})("onFilterInput",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getFilteredEmployees(o))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("actions",t.rowFunctions)("allDataTable",t.allEmployees)("showFilter",!0)("isCenterPaginator",!0)("isCustomFilter",!0)("disableSelectCheckBox",!!t.editFilterData)}}let et=(()=>{class n extends M.U{constructor(t){super(),this.registerFingerprintService=t,this.submitted=!1,this.isLoaded=!1,this.mandatoryColomns=["code","employeeName","jobTitle","currentPlan","shiftSchedule",Ie.g.selectAllColumnName],this.optionalColomns=[],this.backParams={...this.pageParams,parentView:U.S.fingerprints_home},this.typeList=[{value:"I",label:"inFingerprint"},{value:"O",label:"outFingerprint"}],this.activatedRoute.params.subscribe(a=>{a.empId&&(this.editFilterData={Person_Instance_ID:Number(a.empId),checkInTime:a.checkInTime})})}onChangeBusinessAndCompanyId(){this.checkNoBusinessOrCompany()&&this.editFilterData&&this.getById()}ngOnInit(){this.form=this.fb.group({id:[this.editFilterData?1:0,{nonNullable:!0}],orgId:[[]],jobId:[[]],date:[null,[s.kI.required,x.dN.date]],is_Absent:[!1],checktime:[null,[s.kI.required]],checktype:["I",[s.kI.required]],note:[null],selectedEmployeeIDs:[[],[s.kI.required]]}),this.page.pageSize=5}get formCtrls(){return this.form.controls}getById(){this.isLoaded=!0,this.showLoading(),this.registerFingerprintService.getById(this.editFilterData).subscribe(t=>{t.message.messageType==v.u.Success?(this.form.patchValue(t.data[0]),this.formCtrls.date.setValue(t.data[0].checkInTime),this.formCtrls.checktime.setValue(t.data[0].is_Absent?null:t.data[0].checkInTime.split("T")[1]),this.currentEmpCode=t.data[0]?.core_Person_Instance?.core_Person?.code,this.getFilteredEmployees(this.currentEmpCode)):this.errorList(t?.message?.messages),this.hideLoading()})}submit(){if(this.submitted=!0,0==this.formCtrls.selectedEmployeeIDs.value.length)return this.warning("selectOneEmployee");if(this.form.valid){let t=d.M6.mapDateReverse(this.formCtrls.date.value),a={IPersonManuallyCheckInTime:{CheckInTime:t+"T"+this.formCtrls.checktime.value,CHECKTYPE:this.formCtrls.checktype.value,Note:this.formCtrls.note.value,is_Absent:this.formCtrls.is_Absent.value}};a.IPersonManuallyCheckInTime.is_Absent&&(a.IPersonManuallyCheckInTime.CheckInTime=t+"T00:00:00",a.IPersonManuallyCheckInTime.CHECKTYPE=null),this.formCtrls.id.value>0?this.update(a):this.create(a)}}create(t){let a={...t,SelectedEmployeeIDs:this.formCtrls.selectedEmployeeIDs.value};this.showLoading(),this.registerFingerprintService.create(a).subscribe(o=>{o?.message?.messageType==v.u.Success?(this.addSuccessfullyMsg("canEditOrRemoveFromIndex","newRegisterFingerprint"),this.router.navigate([`/attendance/${this.moduleId}/fingerprints/register-fingerprint`],{queryParams:{...this.pageParams,parentView:this.viewsManager.fingerprints_home}})):this.errorList(o?.message?.messages),this.hideLoading()})}update(t){let a={...t,Person_Instance_ID:this.editFilterData.Person_Instance_ID,CheckInTime_Old:this.editFilterData.checkInTime};this.showLoading(),this.registerFingerprintService.update(a).subscribe(o=>{o?.message?.messageType==v.u.Success?(this.updateSuccessfullyMsg("registerFingerprintUpdated"),this.navigateTo(`/attendance/${this.moduleId}/fingerprints/register-fingerprint/edit/${this.editFilterData.Person_Instance_ID}/${a.IPersonManuallyCheckInTime.CheckInTime}`,{...this.parentParam,...this.pageParams})):this.errorList(o?.message?.messages),this.hideLoading()})}returnCurrentSearchParams(t){return{FilterOrgs:this.formCtrls.jobId.value?"":this.formCtrls.orgId.value?.join(",")??"",FilterJobs:this.formCtrls.jobId.value?.join(",")??"",FilterCode:t??this.currentEmpCode??"",Date:d.M6.mapDateReverse(this.formCtrls.date.value)}}getFilteredEmployees(t){if((!this.editFilterData||t)&&this.formCtrls.date.value){let a=this.returnCurrentSearchParams(t);if(this.lastSearchedParams&&d.M6.isTwoObjectsAreEqual(a,this.lastSearchedParams))return;this.lastSearchedParams=a,this.isLoaded=!1,this.allEmployees=null,this.registerFingerprintService.getEmployeesList(a).pipe(this.cancelRequest()).subscribe(o=>{if(o.message.messageType==v.u.Success){if(!o.data)return this.allEmployees=[],void(this.isLoaded=!0);let r=this.returnCurrentSearchParams(t);if(!d.M6.isTwoObjectsAreEqual(a,r))return;this.allEmployees=function Na(n){return n.map(i=>{let t=(0,d._f)(i.shiftAr,i.shiftEn),a="",o="";return t&&([a,o]=t.split(":")),{...i,employeeName:(0,d._f)(i.employeeNameAr,i.employeeNameEn),jobTitle:(0,d._f)(i.jobTitleAr,i.jobTitleEn),currentPlan:(0,d._f)(i.planAr,i.planEn),shiftSchedule:a||o?a+`<i class='convert-to-icon pi ${(0,d._f)("pi-angle-double-left","pi-angle-double-right")}'></i>`+o:"",isSelected:!0}})}(o.data),this.getSelectedEmployees(this.allEmployees),this.page.length=this.allEmployees.length,this.isLoaded=!0}else this.errorList(o?.message?.messages)})}}getSelectedEmployees(t){this.formCtrls.selectedEmployeeIDs.setValue(t.map(a=>a.id))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Xe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-register-fingerprint"]],features:[e.qOj],decls:30,vars:35,consts:[[1,"title-no-margin","title-section","fixed-title"],["addTitle","registerFingerprint","editTitle","editRegisterFingerprint",3,"id","parentTitle","parentTitleLink","title","parentLinkParams"],[3,"url","params",4,"ngIf"],[3,"url","params"],[1,"form-card","mbottom-35"],["container",""],[1,"title-no-margin","border-0"],["title","generalInfo"],[1,"clearfix"],[1,"container-fluid","mtop-25","mbottom-15"],[3,"formGroup"],[1,"row"],["class","col-lg-3 col-md-4 col-sm-6 col-12",4,"ngIf"],[1,"col-lg-3","col-md-4","col-sm-6","col-12"],["label","date",3,"control","submitted","change"],["label","absent","labelPosition","before","styleClass","margin-17",3,"control"],["label","fingerprint",3,"control","submitted","disabled"],[1,"col-lg-3","col-md-4","col-sm-6","col-12","ptop-7","pbottom-5"],["label","type",3,"control","submitted","radioList","disabled"],["label","notes",3,"control","submitted"],[4,"ngIf"],["saveLabel","add",3,"id","url","pageParams","submit"],[3,"control","submitted","filter","multi"],["label","job",3,"control","organizationControl","organizationControlRequired","submitted","filter","multi","change"],["filterInputLabel","searchByCode",1,"table-in-forms",3,"isLoaded","mandatoryColomns","optionalColomns","page","actions","allDataTable","showFilter","isCenterPaginator","isCustomFilter","disableSelectCheckBox","selectedItems","onFilterInput"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ALo(4,"translate"),e.YNc(5,qa,1,2,"app-add-new-btn",2),e._UZ(6,"app-back-btn",3),e.qZA(),e.TgZ(7,"mat-card",4,5)(9,"mat-card-title",6),e._UZ(10,"page-title",7),e.qZA(),e._UZ(11,"mat-divider")(12,"div",8),e.TgZ(13,"mat-card-content",9)(14,"form",10)(15,"div",11),e.YNc(16,Ea,2,4,"div",12),e.YNc(17,Ja,2,6,"div",12),e.TgZ(18,"div",13)(19,"app-datepicker",14),e.NdJ("change",function(){return a.getFilteredEmployees()}),e.qZA()(),e.TgZ(20,"div",13),e._UZ(21,"app-check-box",15),e.qZA(),e.TgZ(22,"div",13),e._UZ(23,"app-timepicker",16),e.qZA(),e.TgZ(24,"div",17),e._UZ(25,"app-radio-button",18),e.qZA(),e.TgZ(26,"div",13),e._UZ(27,"app-input",19),e.qZA()()(),e.YNc(28,ka,3,10,"ng-container",20),e.qZA()(),e.TgZ(29,"app-fixed-card-actions",21),e.NdJ("submit",function(){return a.submit()}),e.qZA()),2&t&&(e.xp6(1),e.cQ8("parentTitle","",e.lcZ(2,29,"attendanceTracker")," / ",e.lcZ(3,31,"fingerprints")," / ",e.lcZ(4,33,"registerFingerprint"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/fingerprints/register-fingerprint"),e.Q6J("id",a.formCtrls.id.value)("title",a.formCtrls.id.value>0?"edit":"register")("parentLinkParams",a.backParams),e.xp6(4),e.Q6J("ngIf",a.formCtrls.id.value>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/fingerprints/register-fingerprint/index"),e.Q6J("params",a.backParams),e.xp6(8),e.Q6J("formGroup",a.form),e.xp6(2),e.Q6J("ngIf",0==a.formCtrls.id.value),e.xp6(1),e.Q6J("ngIf",0==a.formCtrls.id.value),e.xp6(2),e.Q6J("control",a.formCtrls.date)("submitted",a.submitted),e.xp6(2),e.Q6J("control",a.formCtrls.is_Absent),e.xp6(2),e.Q6J("control",a.formCtrls.checktime)("submitted",a.submitted)("disabled",a.formCtrls.is_Absent.value),e.xp6(2),e.Q6J("control",a.formCtrls.checktype)("submitted",a.submitted)("radioList",a.typeList)("disabled",a.formCtrls.is_Absent.value),e.xp6(2),e.Q6J("control",a.formCtrls.note)("submitted",a.submitted),e.xp6(1),e.Q6J("ngIf",a.editFilterData||a.formCtrls.date.value),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/fingerprints/register-fingerprint"),e.Q6J("id",a.formCtrls.id.value)("pageParams",a.backParams))},dependencies:[Q.O5,g.Q,l.a,Qe._,te.I,c.u,h.a,De.E,f.J,p.T,y.C,m.a8,m.dn,m.n5,D.d,_.s,q.a,s._Y,s.JL,s.sg,u.X$]}),n})(),tt=(()=>{class n extends L.K{constructor(){super()}getList(t){return this.get("TimeAttendance/DeviceTranceUpload/GetList",{params:t})}getAll(){return this.get("TimeAttendance/DeviceTranceUpload/GetAll")}Delete(t,a){return this.delete("TimeAttendance/DeviceTranceUpload/Delete",{params:{CheckTime:a,Person_Instance_ID:t}})}download(){return this.get("TimeAttendance/DeviceTranceUpload/Download",{responseType:"arraybuffer"})}upload(t){return this.post("TimeAttendance/DeviceTranceUpload/Upload",t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Va=(()=>{class n extends M.U{constructor(t){super(),this.loadFingerprintService=t,this.mandatoryColomns=["Ser","employeeName","budgeNumber","date","time","device","deviceCompany","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.page.pageIndex=t,a&&(this.page.pageSize=a),this.loadFingerprintService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{r.message.messageType==v.u.Success?(this.dataSource=new Z.by(function Ha(n){return n.map(i=>({...i,employeeName:(0,d._f)(i.core_Person_Instance?.core_Person?.ar_Name,i.core_Person_Instance?.core_Person?.en_Name),date:d.M6.mapDate(i.trans_Date_Time),time:d.M6.mapTime(i.trans_Date_Time.split("T")[1],!0),budgeNumber:i.badgenumber,device:i.att_Device?.name,deviceCompany:(0,d._f)(i.company?.ar_Name,i.company?.en_Name)}))}(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta):this.errorList(r?.message?.messages)})}onDelete(t){this.deleteDialog(t.employeeName).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.loadFingerprintService.Delete(t.person_Instance_ID,t.trans_Date_Time).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("loadFingerprintRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(tt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-load-fingerprint-index"]],features:[e.qOj],decls:6,vars:15,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","loadFingerprints",3,"parentTitle","parentTitleLink","globalFunctions"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"mat-card",2)(5,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)}),e.qZA()()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,11,"attendanceTracker")," / ",e.lcZ(3,13,"fingerprints"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/fingerprints/home"),e.Q6J("globalFunctions",a.subGlobalFunctions),e.xp6(4),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0))},dependencies:[te.I,p.T,m.a8,m.n5,u.X$]}),n})();var ja=S(857);function Ba(n,i){if(1&n&&(e.ynx(0),e._UZ(1,"mat-divider",4)(2,"app-material-table",16),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("isLoaded",t.isLoaded)("dataSource",t.dataSource)("mandatoryColomns",t.mandatoryColomns)("optionalColomns",t.optionalColomns)("page",t.page)("showPaginator",!1)}}let Ga=(()=>{class n extends M.U{constructor(t){super(),this.loadFingerprintService=t,this.mandatoryColomns=["code","employeeName","date","time","device"],this.isLoaded=!1,this.optionalColomns=[],this.submitted=!1,this.removeFiles=!1,this.backParams={...this.pageParams,parentView:U.S.fingerprints_home}}ngOnInit(){this.form=this.fb.group({file:[null,[s.kI.required]]})}download(){this.showLoading(),this.loadFingerprintService.download().subscribe(t=>{this.fileService.downloadBufferFile(t,"Finger_Print.xlsx"),this.hideLoading()})}upload(){if(!this.form.valid)return void this.error("mustSelectFile");this.showLoading();let t=d.M6.objectToFormData(this.form.value);this.loadFingerprintService.upload(t).subscribe(a=>{a.message.messageType==v.u.Success?(this.success("uploadSuccessfully"),this.form.reset(),this.removeFiles=!0,this.dataSource=new Z.by(function Qa(n){return n.map(i=>({...i,employeeName:(0,d._f)(i.employee_Ar,i.employee_En),date:`${i.date.day.padStart(2,"0")}-${i.date.month.padStart(2,"0")}-${i.date.year}`}))}(a.data)),this.isLoaded=!0):this.errorList(a.message.messages),this.hideLoading()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(tt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upload-fingerprint"]],features:[e.qOj],decls:34,vars:35,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","uploadFingerprints",3,"parentTitle","parentTitleLink","parentLinkParams","globalFunctions"],[3,"url","params"],[1,"finger-upload","mt-3","mbottom-20"],[1,"mt-2"],["title","generalInfo",1,"stepper-section-title"],[1,"container-fluid","mt-5"],[1,"row"],[1,"col-12","col-md-10","col-lg-7"],[1,"col-12","col-md-2","col-lg-2"],["icon","pi pi-arrow-down\n        ","label","download",3,"iconPositionBefore","onClick"],[1,"col-12"],[1,"mt-3","mbottom-35"],["icon","pi pi-arrow-up",3,"control","submitted","multiple","removeFiles","isFormValid"],[4,"ngIf"],["saveLabel","add",3,"url","pageParams","submit"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","page","showPaginator"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.ALo(4,"translate"),e._UZ(5,"app-back-btn",2),e.qZA(),e.TgZ(6,"mat-card",3)(7,"mat-card-title",4),e._UZ(8,"page-title",5),e.qZA(),e._UZ(9,"mat-divider",4),e.TgZ(10,"mat-card-content",6)(11,"div",7)(12,"div",8)(13,"p"),e._uU(14),e.ALo(15,"translate"),e.TgZ(16,"span"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.TgZ(19,"div",9)(20,"submit-btn",10),e.NdJ("onClick",function(){return a.download()}),e.qZA()(),e.TgZ(21,"div",11),e._UZ(22,"mat-divider",12),e.qZA(),e.TgZ(23,"div",8)(24,"p"),e._uU(25),e.ALo(26,"translate"),e.TgZ(27,"span"),e._uU(28),e.ALo(29,"translate"),e.qZA()()(),e.TgZ(30,"div",9),e._UZ(31,"primeng-file-upload",13),e.qZA()(),e.YNc(32,Ba,3,6,"ng-container",14),e.qZA()(),e.TgZ(33,"app-fixed-card-actions",15),e.NdJ("submit",function(){return a.upload()}),e.qZA()),2&t&&(e.xp6(1),e.cQ8("parentTitle","",e.lcZ(2,21,"attendanceTracker")," / ",e.lcZ(3,23,"fingerprints")," / ",e.lcZ(4,25,"loadFingerprints"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/fingerprints/load-fingerprint"),e.Q6J("parentLinkParams",a.backParams)("globalFunctions",a.subGlobalFunctions),e.xp6(4),e.MGl("url","/attendance/",a.moduleId,"/fingerprints/load-fingerprint"),e.Q6J("params",a.backParams),e.xp6(9),e.hij(" ",e.lcZ(15,27,"downloadFingerprintTemplate")," "),e.xp6(3),e.hij("( ",e.lcZ(18,29,"downloadTemplateAndFillItWithData")," )"),e.xp6(3),e.Q6J("iconPositionBefore",!1),e.xp6(5),e.hij(" ",e.lcZ(26,31,"uploadFingerprintTemplate")," "),e.xp6(3),e.hij("( ",e.lcZ(29,33,"uploadTemplateAfterAddingAllData")," )"),e.xp6(3),e.Q6J("control",a.form.controls.file)("submitted",a.submitted)("multiple",!1)("removeFiles",a.removeFiles)("isFormValid",a.form.valid),e.xp6(1),e.Q6J("ngIf",(null==a.dataSource?null:a.dataSource.data.length)>0),e.xp6(1),e.MGl("url","/attendance/",a.moduleId,"/fingerprints/load-fingerprint"),e.Q6J("pageParams",a.pageParams))},dependencies:[Q.O5,te.I,ja.J,h.a,de.p,p.T,y.C,m.a8,m.dn,m.n5,D.d,u.X$],styles:["p[_ngcontent-%COMP%]{font-size:22px;color:#374761;font-weight:500}span[_ngcontent-%COMP%]{color:#8c8c8c;font-size:20px}"]}),n})();function at(n){let i=[];return n.forEach(t=>{t.exeptionPlan.forEach(a=>{i.push({date:d.M6.mapDateReverse(a),resourceId:t.person_Instance_ID,className:"plan-adjustment"})}),t.permissions.forEach(a=>{i.push({date:d.M6.mapDateReverse(a),resourceId:t.person_Instance_ID,className:"permission"})}),t.vacations.forEach(a=>{i.push({date:d.M6.mapDateReverse(a.vacation_Date_Duration.vacation_date),resourceId:t.person_Instance_ID,className:"vacation"})}),t.overtimes.forEach(a=>{i.push({date:d.M6.mapDateReverse(a),resourceId:t.person_Instance_ID,className:"overtime"})}),t.missions.forEach(a=>{i.push({date:d.M6.mapDateReverse(a),resourceId:t.person_Instance_ID,className:"mission"})}),t.penalities.forEach(a=>{i.push({date:d.M6.mapDateReverse(a),resourceId:t.person_Instance_ID,className:"penalty"})})}),i}var nt=S(27450);let za=(()=>{class n extends M.U{constructor(t){super(),this.dialogRef=t}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-daily-operation-dialog"]],features:[e.qOj],decls:8,vars:2,consts:[["mat-dialog-title","",1,"primary-color","font-size-20","m-0"],["title","upcomingTimeOff",1,"d-inline-block","mtop-5","mbottom-10"],[1,"container-fluid","mx-0","h-100"],["dialogContainer",""],[3,"isDailog"],[1,"full-width-action-dialog"],["icon","far fa-check-circle","label","done",3,"iconPositionBefore","click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"h4"),e._UZ(2,"page-title",1),e.qZA()(),e.TgZ(3,"mat-dialog-content",2,3),e._UZ(5,"daily-operation-card",4),e.TgZ(6,"mat-dialog-actions",5)(7,"submit-btn",6),e.NdJ("click",function(){return a.dialogRef.close()}),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("isDailog",!0),e.xp6(2),e.Q6J("iconPositionBefore",!1))},dependencies:[de.p,p.T,X.uh,X.xY,X.H8,Ue],styles:[".setup-dialog .mat-dialog-container{overflow:hidden!important}"]}),n})();var Ya=S(20408),Wa=S(89320),$a=S(26135);const Ka=function(n){return{parentView:n}},Xa=function(n,i){return{"text-right mr-2":n,"text-left ml-2":i}};function en(n,i){if(1&n&&(e.TgZ(0,"div",22)(1,"a",23)(2,"div",24)(3,"div",25)(4,"div",26),e._UZ(5,"img",27),e.qZA(),e.TgZ(6,"div",28)(7,"h3",29),e._uU(8),e.ALo(9,"translate"),e.qZA()()()()()()),2&n){const t=i.$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("routerLink",t.path)("queryParams",e.VKq(9,Ka,a.getViewName)),e.xp6(1),e.Tol(t.color),e.xp6(3),e.Q6J("src",a.svg[t.icon],e.LSH),e.xp6(1),e.Q6J("ngClass",e.WLB(11,Xa,a.languageService.isArabic,a.languageService.isEnglish)),e.xp6(2),e.Oqu(e.lcZ(9,7,t.name))}}function tn(n,i){if(1&n&&(e.ynx(0),e.YNc(1,en,10,14,"div",21),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.globalFunctions)}}function an(n,i){1&n&&(e.TgZ(0,"div",31),e._UZ(1,"p-skeleton",32),e.qZA())}const it=function(){return[]};function nn(n,i){1&n&&e.YNc(0,an,2,0,"div",30),2&n&&e.Q6J("ngForOf",e.DdM(1,it).constructor(6))}function on(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",35),e.NdJ("click",function(){const r=e.CHM(t).$implicit,I=e.oxw(2);return e.KtG(I.getCurentEmployee(r.id))}),e._UZ(1,"img",36),e.TgZ(2,"span",37),e._uU(3),e.qZA()()}if(2&n){const t=i.$implicit,a=e.oxw(2);e.ekj("selected",a.personInstanceId==t.id),e.xp6(1),e.Q6J("src",(null==t||null==t.core_Person?null:t.core_Person.imagePath)??a.assets.user_avatar_rounded,e.LSH),e.xp6(1),e.Q6J("title",a.languageService.isArabic?null==t.core_Person?null:t.core_Person.ar_Name:null==t.core_Person?null:t.core_Person.en_Name),e.xp6(1),e.hij(" ",a.languageService.isArabic?null==t.core_Person?null:t.core_Person.ar_Name:null==t.core_Person?null:t.core_Person.en_Name," ")}}function rn(n,i){if(1&n&&(e.TgZ(0,"div",33),e.YNc(1,on,4,5,"div",34),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.employeeList)}}function sn(n,i){1&n&&e._UZ(0,"p-skeleton",41)}function ln(n,i){if(1&n&&(e.TgZ(0,"div",39),e.YNc(1,sn,1,0,"p-skeleton",40),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.formCtrls.organizationId.value>0)}}function dn(n,i){1&n&&e.YNc(0,ln,2,1,"div",38),2&n&&e.Q6J("ngForOf",e.DdM(1,it).constructor(6))}function pn(n,i){if(1&n&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,3,"vacationBalance")," : "),e.xp6(3),e.AsE("",t.vacationBalance," ",e.lcZ(6,5,"days"),"")}}function cn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",42)(1,"mat-card",43)(2,"employee-card-schedual",44),e.NdJ("vacationBalance",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.getVacationBalance(o))}),e.qZA(),e.YNc(3,pn,7,7,"div",45),e.qZA(),e.TgZ(4,"mat-card",46)(5,"mat-card-title"),e._UZ(6,"page-title",47),e.TgZ(7,"a",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openDailyOperationDialog())}),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"mat-card-content",49),e._UZ(11,"daily-operation-card"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("employeeInstanceId",t.personInstanceId),e.xp6(1),e.Q6J("ngIf",t.vacationBalance>0),e.xp6(5),e.hij("",e.lcZ(9,3,"see_all")," ")}}let mn=(()=>{class n extends M.U{constructor(t,a){super(),this.employeesService=t,this.employeeWorkScheduleService=a,this.svg=new be.El,this.fullView=!1,this.currentDate=d.M6.dayWithName(),this.vacationBalance=0,this.isLoaded=!0}ngOnInit(){this.form=this.fb.group({organizationId:[]})}get formCtrls(){return this.form.controls}getEmployees(){this.employeeList=[],this.employeeEventsList=[],this.isLoaded=!1,this.formCtrls.organizationId.value>0&&this.employeesService.getAllByOrgId(this.formCtrls.organizationId.value).subscribe(t=>{t.message.messageType==v.u.Success?(this.employeeList=t.data,this.isLoaded=!0,this.getEmployeesCalendarData()):this.errorList(t?.message?.messages)})}getEmployeesCalendarData(){this.employeeList?.length>0&&(this.employeeEventsList=[],this.showLoading(),this.employeeWorkScheduleService.getCardMultiEmp(this.employeeList.map(t=>t.id),d.M6.mapDateReverse(this.calendarComponent.startDate.toString())).subscribe(t=>{t.message.messageType==v.u.Success?this.employeeEventsList=at(t.data):t.message.messageType==v.u.Warning?(this.errorList(t?.message?.messages),this.employeeEventsList=at(t.data)):this.errorList(t?.message?.messages),this.hideLoading()}))}getCurentEmployee(t){this.personInstanceId=t==this.personInstanceId?0:t}openDailyOperationDialog(){this.dialogsService.addEditDialog(za,null,{panelClass:"setup-dialog",width:"424px",height:"615px"}).afterClosed().subscribe(()=>{})}getVacationBalance(t){this.vacationBalance=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ya.M),e.Y36(Wa.c))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-daily-operations"]],viewQuery:function(t,a){if(1&t&&e.Gf(nt.w,5),2&t){let o;e.iGM(o=e.CRH())&&(a.calendarComponent=o.first)}},features:[e.qOj],decls:26,vars:16,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","daily_transaction","parentTitle","attendanceTracker"],["data-toggle","buttons",1,"btn-group","btn-group-toggle","float-right"],[3,"ngClass","click"],[1,"pi","pi-list","fa-rotate-180"],[1,"fa","fa-bars"],[1,"clearfix"],[1,"row","my-3"],[4,"ngIf","ngIfElse"],["loading",""],[1,"row"],[1,"mb-3"],[1,"row","calendar-emp-container"],[1,"col-md-4","col-6","mb-2","employees-container",3,"ngClass"],[1,"dropdown"],[3,"control","filter","change"],["class","emp-daily-container",4,"ngIf","ngIfElse"],["Loading",""],[1,"col-md-8","col-6","calendar-container",3,"ngClass"],[3,"resources","events","selectedResourceId","dateChanged"],["class","col-12 col-md-12 col-lg-3 p-0",4,"ngIf"],["class","col-lg-2 col-md-4 col-12 mb-2",4,"ngFor","ngForOf"],[1,"col-lg-2","col-md-4","col-12","mb-2"],[3,"routerLink","queryParams"],[1,"card-box"],[1,"media","p-0"],[1,"media-left","align-self-center"],["width","33",3,"src"],[1,"media-body",3,"ngClass"],[1,"card-text"],["class","col-md-2 col-12 mb-2",4,"ngFor","ngForOf"],[1,"col-md-2","col-12","mb-2"],["borderRadius","10px","width","100%","height","100px"],[1,"emp-daily-container"],["class","emp-daily-operation-card",3,"selected","click",4,"ngFor","ngForOf"],[1,"emp-daily-operation-card",3,"click"],[3,"src"],[3,"title"],["class","col-12 mb-2",4,"ngFor","ngForOf"],[1,"col-12","mb-2"],["borderRadius","10px","width","100%","height","50px",4,"ngIf"],["borderRadius","10px","width","100%","height","50px"],[1,"col-12","col-md-12","col-lg-3","p-0"],[1,"card-scedual"],[3,"employeeInstanceId","vacationBalance"],[4,"ngIf"],[1,"mt-3"],["title","upcomingTimeOff"],[1,"float-right",3,"click"],[1,"container-fluid","px-0"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.TgZ(2,"div",2)(3,"button",3),e.NdJ("click",function(){return a.fullView=!1}),e._UZ(4,"i",4),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return a.fullView=!0}),e._UZ(6,"i",5),e.qZA()(),e._UZ(7,"div",6),e.qZA(),e.TgZ(8,"mat-card-content")(9,"div",7),e.YNc(10,tn,2,1,"ng-container",8),e.YNc(11,nn,1,2,"ng-template",null,9,e.W1O),e.qZA(),e.TgZ(13,"div",10)(14,"div")(15,"mat-card",11)(16,"div",12)(17,"div",13)(18,"div",14)(19,"app-organization-current-structure-dropdown",15),e.NdJ("change",function(){return a.getEmployees()}),e.qZA()(),e.YNc(20,rn,2,1,"div",16),e.YNc(21,dn,1,2,"ng-template",null,17,e.W1O),e.qZA(),e.TgZ(23,"div",18)(24,"app-full-calendar",19),e.NdJ("dateChanged",function(){return a.getEmployeesCalendarData()}),e.qZA()()()()(),e.YNc(25,cn,12,5,"div",20),e.qZA()()),2&t){const o=e.MAs(12),r=e.MAs(22);e.xp6(3),e.Q6J("ngClass",a.fullView?"btn float-right":"btn btn-darkBlue float-right"),e.xp6(2),e.Q6J("ngClass",a.fullView?"btn  btn-darkBlue float-right":"btn float-right"),e.xp6(5),e.Q6J("ngIf",(null==a.globalFunctions?null:a.globalFunctions.length)>0)("ngIfElse",o),e.xp6(4),e.Tol(a.fullView?"col-12 col-md-12 col-lg-12":"col-12 col-md-12 col-lg-9"),e.xp6(3),e.Q6J("ngClass",a.fullView?"col-lg-3 ":"col-lg-4"),e.xp6(2),e.Q6J("control",a.formCtrls.organizationId)("filter",!0),e.xp6(1),e.Q6J("ngIf",a.isLoaded)("ngIfElse",r),e.xp6(3),e.Q6J("ngClass",a.fullView?"col-lg-9":"col-lg-8"),e.xp6(1),e.Q6J("resources",a.employeeList)("events",a.employeeEventsList)("selectedResourceId",a.personInstanceId),e.xp6(1),e.Q6J("ngIf",!a.fullView)}},dependencies:[Q.mk,Q.sg,Q.O5,ne.yS,p.T,$a.X,nt.w,m.a8,m.dn,m.n5,q.a,Ne.O,Ue,u.X$],styles:[".btn[_ngcontent-%COMP%]{border:solid 1.5px #374761}.card-scedual[_ngcontent-%COMP%]{background:#fafafa;padding:0}.card-scedual[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#8c8c8c;margin-left:1.5rem;margin-right:1.5rem}.card-scedual[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#101317}.mat-card-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:16px;font-weight:500;text-decoration:underline;color:#374761;cursor:pointer}  .p-datepicker .p-datepicker-header .p-datepicker-title .p-datepicker-year,   .p-datepicker .p-datepicker-header .p-datepicker-title .p-datepicker-month{padding-top:0!important;padding-bottom:0!important}  .p-datepicker-year{display:block!important;font-size:14.7px!important;font-weight:500!important;line-height:1.33!important;color:#8f9bb3!important;margin-left:1.5rem;margin-right:2.5rem}  .calendar-emp-container{position:relative;margin:-1px}  .calendar-emp-container .employees-container{padding:80px 0 0}  .calendar-emp-container .employees-container .dropdown{padding:0 30px 0 0;margin-bottom:2.2px}  .calendar-emp-container .employees-container div:has(.p-skeleton){padding:0 30px 0 0}  .calendar-emp-container .employees-container .emp-daily-container{display:flex;flex-direction:column;gap:8px 0}  .calendar-emp-container .employees-container .emp-daily-container .emp-daily-operation-card{height:75px;border:1.6px solid #fff;padding:0 16px;display:flex;justify-content:flex-start;align-items:center;gap:16px;border-radius:5px 0 0 5px;cursor:pointer}  .calendar-emp-container .employees-container .emp-daily-container .emp-daily-operation-card span{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;line-clamp:3;-webkit-line-clamp:3;-webkit-box-orient:vertical}  .calendar-emp-container .employees-container .emp-daily-container .emp-daily-operation-card.selected{border-color:#169ed9;border-right:none;background-color:#169ed91a}  .calendar-emp-container .employees-container .emp-daily-container .emp-daily-operation-card img{width:50px;height:50px;border-radius:50%}  .calendar-emp-container .calendar-container{position:static;position:initial;padding:0}  .calendar-emp-container .calendar-container .fc-header-toolbar.fc-toolbar{margin-top:8px}  .calendar-emp-container .calendar-container.col-lg-8 .fc-header-toolbar.fc-toolbar{width:33.3333333333%}  .calendar-emp-container .calendar-container.col-lg-9 .fc-header-toolbar.fc-toolbar{width:25%}"]}),n})();var z=S(78512);let Ae=(()=>{class n extends L.K{constructor(){super()}getAttendanceCard(t){return this.post("AttReport/AttendanceCard/GetAttendanceCard",t)}GetPersonInstanceLst(t){return this.post("AttReport/AttendanceCard/GetPersonInstanceLst",t)}GetAttendanceCardForEmp(t){return this.post("AttReport/AttendanceCard/GetAttendanceCardForEmp",t)}getMissions(t){return this.post("AttReport/RptMissions/GetMissionsData",t)}getPermissions(t){return this.post("AttReport/RptPermissions/GetPermissionsData",t)}getSignSheetData(t){return this.post("AttReport/RptSignSheet/GetSignSheetReport",t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var un=S(15861),gn=S(4159),rt=S.n(gn),qe=S(53583),_n=S(12983),hn=S.n(_n),fn=S(1421);let xe=(()=>{class n{constructor(t){this.languageService=t}exportDivsToPdf(t,a){return(0,un.Z)(function*(){const o=document.getElementsByClassName(t),r=new qe.default("p","mm","a4");let I=[];const H=[];Array.from(o).forEach((ee,V)=>{I.push(rt()(ee).then(pe=>{const Oe=pe.toDataURL("image/png"),ue=210*pe.height/pe.width;V>0&&r.addPage(),r.addImage(Oe,"PNG",0,0,210,ue)}))}),yield Promise.all(I).then(()=>{H.forEach(ee=>{ee.classList.remove("mat-expanded")}),r.save(`${a}.pdf`)})})()}exportChart(t,a,o,r){r.$display.next(!0);const I=t.nativeElement,H=document.getElementById(a),ee=H.scrollWidth+100,V=H.offsetHeight+100;H.style.width=ee+"px",H.style.height=V+"px",H.style.overflow="unset",rt()(I,{width:ee,height:V}).then(pe=>{const Oe=pe.toDataURL("image/png");if("image"==o){const ue=document.createElement("a");ue.href=Oe,ue.download=a+".jpeg",ue.click()}else if("pdf"==o){var me=new qe.default("l","mm",[.265*(ee+30),.265*(V+20)]);const ue=me.internal.pageSize.getWidth(),Zi=me.internal.pageSize.getHeight();me.addImage(Oe,"PNG",20,20,ue-30,Zi-30),me.save(a+".pdf")}H.style.width="auto",H.style.height="auto",H.style.overflow="scroll",r.$display.next(!1)})}exportDataToTablePdf(t,a,o){const r=new qe.default;let I=t.map(H=>({header:d.M6.translate(H,this.languageService),dataKey:H}));a.map((H,ee)=>{H.Ser=ee+1}),hn()(r,{columns:I,body:a}),r.save(`${o}.pdf`)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(fn.T))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Le=S(67579),Ee=S(93665),Pe=S(99515),ie=S(37084);const yn=["rpt_att_card"];function vn(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"date"),e.ALo(4,"translate"),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.HOy(" ",e.lcZ(2,4,"from")," (",e.xi3(3,6,t.fromDate,"yyyy/MM/dd"),") ",e.lcZ(4,9,"to")," (",e.xi3(5,11,t.toDate,"yyyy/MM/dd"),") ")}}function Tn(n,i){if(1&n&&(e.ynx(0),e._UZ(1,"app-view-data-row-item",42),e.BQk()),2&n){const t=i.$implicit,a=e.oxw(4);e.xp6(1),e.Q6J("label",a.msgTranslate(t.element_Ar_name,t.element_En_Name))("value",t.ele_value)}}function Cn(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td")(13,"div",25),e._UZ(14,"app-view-data-row-item",26)(15,"app-view-data-row-item",27),e.qZA()(),e.TgZ(16,"td")(17,"div",25),e._UZ(18,"app-view-data-row-item",26)(19,"app-view-data-row-item",27),e.qZA()(),e.TgZ(20,"td")(21,"div",25),e._UZ(22,"app-view-data-row-item",26)(23,"app-view-data-row-item",28)(24,"app-view-data-row-item",29)(25,"app-view-data-row-item",30),e.qZA()(),e.TgZ(26,"td"),e._uU(27),e.qZA(),e.TgZ(28,"td")(29,"div",25),e._UZ(30,"app-view-data-row-item",26)(31,"app-view-data-row-item",31)(32,"app-view-data-row-item",32),e.qZA()(),e.TgZ(33,"td")(34,"div",25),e._UZ(35,"app-view-data-row-item",33)(36,"app-view-data-row-item",34)(37,"app-view-data-row-item",35)(38,"app-view-data-row-item",31)(39,"app-view-data-row-item",32)(40,"app-view-data-row-item",36),e.qZA()(),e.TgZ(41,"td")(42,"div",25),e._UZ(43,"app-view-data-row-item",33)(44,"app-view-data-row-item",34)(45,"app-view-data-row-item",37)(46,"app-view-data-row-item",31)(47,"app-view-data-row-item",32)(48,"app-view-data-row-item",36),e.qZA()(),e.TgZ(49,"td")(50,"div",25),e._UZ(51,"app-view-data-row-item",38),e.ALo(52,"date"),e._UZ(53,"app-view-data-row-item",39),e.ALo(54,"date"),e.qZA()(),e.TgZ(55,"td")(56,"div",25),e._UZ(57,"app-view-data-row-item",38),e.ALo(58,"date"),e._UZ(59,"app-view-data-row-item",39),e.ALo(60,"date"),e.qZA()(),e.TgZ(61,"td")(62,"div",25),e._UZ(63,"app-view-data-row-item",26)(64,"app-view-data-row-item",40)(65,"app-view-data-row-item",41),e.qZA()(),e.TgZ(66,"td"),e._uU(67),e.qZA(),e.TgZ(68,"td")(69,"div",25),e.YNc(70,Tn,2,2,"ng-container",23),e.qZA()()()),2&n){const t=i.$implicit,a=e.oxw(3);e.xp6(2),e.Oqu(a.msgTranslate(t.dayNameArabic,t.dayNameEnglish)),e.xp6(2),e.Oqu(e.xi3(5,45,t.tR_Date,"dd/MM/yyyy")),e.xp6(3),e.Oqu(e.xi3(8,48,t.timE_IN_1,"dd/MM/yyyy hh:mm a")),e.xp6(3),e.Oqu(e.xi3(11,51,t.timE_OUT_1,"dd/MM/yyyy hh:mm a")),e.xp6(4),e.Q6J("value",t.in_Sensor_Name),e.xp6(1),e.Q6J("value",t.in_Sensor_IP),e.xp6(3),e.Q6J("value",t.ouT_Sensor_Name),e.xp6(1),e.Q6J("value",t.ouT_Sensor_IP),e.xp6(3),e.Q6J("value",a.msgTranslate(t.vacation_Ar_name,t.vacation_En_name)),e.xp6(1),e.Q6J("value",t.vacation_deductibleValue),e.xp6(1),e.Q6J("value",a.msgTranslate(t.week_END_Ar_Name,t.week_END_En_Name)),e.xp6(1),e.Q6J("value",a.msgTranslate(t.official_Holiday_Ar_Name,t.official_Holiday_En_Name)),e.xp6(2),e.hij(" ",a.msgTranslate(t.ar_Policy,t.en_Policy)," "),e.xp6(3),e.Q6J("value",a.msgTranslate(t.ar_Shift,t.en_Shift)),e.xp6(1),e.Q6J("value",t.start_Time),e.xp6(1),e.Q6J("value",t.end_Time),e.xp6(3),e.Q6J("isDate",!0)("value",t.continuous_Mission_From_Date),e.xp6(1),e.Q6J("isDate",!0)("value",t.continuous_Mission_To_Date),e.xp6(1),e.Q6J("isBool",!0)("value",t.mission_Continuous_IS_Full_Day),e.xp6(1),e.Q6J("value",t.continuous_Mission_From_Hour),e.xp6(1),e.Q6J("value",t.continuous_Mission_To_Hour),e.xp6(1),e.Q6J("value",t.mission_Continuous_Location),e.xp6(3),e.Q6J("isDate",!0)("value",t.mission_From_Date),e.xp6(1),e.Q6J("isDate",!0)("value",t.mission_To_Date),e.xp6(1),e.Q6J("isBool",!0)("value",t.iS_Full_Day),e.xp6(1),e.Q6J("value",t.mission_From_Hour),e.xp6(1),e.Q6J("value",t.mission_To_Hour),e.xp6(1),e.Q6J("value",t.mission_Location),e.xp6(3),e.Q6J("value",e.xi3(52,54,t.inPir_From_Hour,"dd/MM/yyyy hh:mm a")),e.xp6(2),e.Q6J("value",e.xi3(54,57,t.inPir_To_Hour,"dd/MM/yyyy hh:mm a")),e.xp6(4),e.Q6J("value",e.xi3(58,60,t.outPir_From_Hour,"dd/MM/yyyy hh:mm a")),e.xp6(2),e.Q6J("value",e.xi3(60,63,t.outPir_To_Hour,"dd/MM/yyyy hh:mm a")),e.xp6(4),e.Q6J("value",a.msgTranslate(t.ar_Overtime,t.en_Overtime)),e.xp6(1),e.Q6J("isDate",!0)("value",t.overtimeRequest_From),e.xp6(1),e.Q6J("isDate",!0)("value",t.overtimeRequest_To),e.xp6(2),e.hij(" ",t.unpaidLeave," "),e.xp6(3),e.Q6J("ngForOf",t.elements)}}function bn(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"table",20)(2,"thead",21)(3,"tr",22)(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"th"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"th"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"th"),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"th"),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"th"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"th"),e._uU(50),e.ALo(51,"translate"),e.qZA()()(),e.TgZ(52,"tbody"),e.YNc(53,Cn,71,66,"tr",23),e.qZA()(),e.TgZ(54,"app-prime-paginator",24),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.GetAttendanceCardForEmp(o.pageIndex+1))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(5),e.hij(" ",e.lcZ(6,20,"day"),""),e.xp6(3),e.hij(" ",e.lcZ(9,22,"date"),""),e.xp6(3),e.hij(" ",e.lcZ(12,24,"Sign-In"),""),e.xp6(3),e.hij(" ",e.lcZ(15,26,"Sign-Out"),""),e.xp6(3),e.hij(" ",e.lcZ(18,28,"In Device"),""),e.xp6(3),e.hij(" ",e.lcZ(21,30,"Out Device"),""),e.xp6(3),e.hij(" ",e.lcZ(24,32,"vacations"),""),e.xp6(3),e.hij(" ",e.lcZ(27,34,"PolicyGroup"),""),e.xp6(3),e.hij(" ",e.lcZ(30,36,"Shift"),""),e.xp6(3),e.hij(" ",e.lcZ(33,38,"Continuous Missions"),""),e.xp6(3),e.hij(" ",e.lcZ(36,40,"missions"),""),e.xp6(3),e.hij(" ",e.lcZ(39,42,"in permission"),""),e.xp6(3),e.hij(" ",e.lcZ(42,44,"out permission"),""),e.xp6(3),e.hij(" ",e.lcZ(45,46,"overtime"),""),e.xp6(3),e.hij(" ",e.lcZ(48,48,"Unpaid Leave"),""),e.xp6(3),e.hij(" ",e.lcZ(51,50,"Elements"),""),e.xp6(3),e.Q6J("ngForOf",t.personTable),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const In=function(){return["","","","","","","","","",""]};function Dn(n,i){1&n&&(e.TgZ(0,"div",43),e._UZ(1,"app-table-skeleton",44),e.qZA()),2&n&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,In)))}function An(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,vn,6,14,"div",9),e.TgZ(6,"div")(7,"submit-btn",10),e.NdJ("onClick",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.print())}),e.qZA()()(),e.TgZ(8,"mat-card-content",11,12)(10,"div",13),e._UZ(11,"app-view-data-row-item",14)(12,"app-view-data-row-item",15)(13,"app-view-data-row-item",16)(14,"app-view-data-row-item",17)(15,"app-view-data-row-item",18),e.qZA(),e.YNc(16,bn,55,52,"ng-container",9),e.YNc(17,Dn,2,2,"div",19),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,9,"results")),e.xp6(2),e.Q6J("ngIf",t.fromDate||t.toDate),e.xp6(6),e.Q6J("value",null==t.person?null:t.person.code),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.person?null:t.person.ar_Person,null==t.person?null:t.person.en_Person)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.person?null:t.person.ar_Job,null==t.person?null:t.person.en_Job)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.person?null:t.person.ar_Org,null==t.person?null:t.person.en_Org)),e.xp6(1),e.Q6J("value",t.TotalUnpaidLeave),e.xp6(1),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let Pn=(()=>{class n extends M.U{constructor(t,a,o){super(),this.reportService=t,this.exportService=a,this.loading=o,this.submitted=!1,this.isLoaded=!1,this.TotalUnpaidLeave=0,this.paramsList=[{name:"Structure_id",id:z.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:z.A.StructureType_Id},{name:"Org_IDs",id:z.A.Org_IDs},{name:"Status_IDs",id:z.A.Status_IDs},{name:"Person_Instance_ID",id:z.A.Person_Instance_ID},{name:"DateFrom",id:z.A.DateFrom,isRequired:!0},{name:"DateTo",id:z.A.DateTo,isRequired:!0},{name:"WithChilds",id:z.A.WithChilds,isRequired:!0}]}ngOnInit(){this.page.pageSize=1,this.page.numberOfNavs=10}submit(t){this.params={Structure_id:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_Ids:t.Org_IDs,Status_IDs:t.Status_IDs,Person_Instance_ID:t.Person_Instance_ID,Financial_Company_IDs:t.Financial_Company_IDs,DateFrom:t.DateFrom,DateTo:t.DateTo,WithChilds:t.WithChilds,PolicyGroupTypeIDs:t.PolicyGroupTypeIDs},this.fromDate=t.DateFrom,this.toDate=t.DateTo,this.GetPersonInstanceLst()}GetPersonInstanceLst(){this.page.length=0,this.PersonInstanceLst=null,this.reportService.GetPersonInstanceLst(this.params).pipe(this.cancelRequest()).subscribe(t=>{if(t.message.messageType==v.u.Success){const a=String(this.params.Person_Instance_ID).split(",");this.PersonInstanceLst=null!=this.params.Person_Instance_ID?t.data.filter(o=>a.includes(o.person_Instance_ID.toString())):t.data,this.page.length=this.PersonInstanceLst.length,this.submitted=!0,this.PersonInstanceLst.length>0&&this.GetAttendanceCardForEmp(1)}else this.errorList(t?.message?.messages)})}GetAttendanceCardForEmp(t){this.isLoaded=!1,this.personTable=null,this.TotalUnpaidLeave=0,this.page.pageIndex=t,this.person=this.PersonInstanceLst[t-1];let a=this.params;a.Person_Instance_ID=this.person?.person_Instance_ID.toString(),this.reportService.GetAttendanceCardForEmp(a).pipe(this.cancelRequest()).subscribe(o=>{o.message.messageType==v.u.Success?(o.data.map(r=>{r.elements.map(I=>{I.ele_value=function ot(n,i){if(null!=n){if("H"===i){if(n<0){const t=Math.abs(n);return`-${Math.trunc(t/60)}:${String(t%60).padStart(2,"0")}`}return`${Math.trunc(n/60)}:${String(n%60).padStart(2,"0")}`}return n}}(I.element_Value,I.en_Name)}),r.elements.sort((I,H)=>I.reportOrder-H.reportOrder),r.unpaidLeave=r.from_Transaction_From_ID||0!=r.transvac_is_Paid||0!==r.vacation_deductibleValue?r.from_Transaction_From_ID||0!=r.transvac_is_Paid?0:r.vacation_deductibleValue:"-",this.TotalUnpaidLeave+=Number(r.unpaidLeave)??0}),this.personTable=o.data,this.isLoaded=!0):this.errorList(o?.message?.messages)})}print(){this.exportService.exportChart(this.rpt_att_card,"attendance_card","pdf",this.loading)}onScroll(t){let a=document.getElementById("fixed-header");if(a)if(a.getBoundingClientRect().top<=0){const r=document.getElementsByClassName("rpt-table")[0].getBoundingClientRect().top;a.style.position="sticky",a.style.top=`${Math.abs(r)}px`}else a.style.position="static",a.style.top="auto"}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae),e.Y36(xe),e.Y36(Le.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-attendance-card-rep2"]],viewQuery:function(t,a){if(1&t&&e.Gf(yn,5),2&t){let o;e.iGM(o=e.CRH())&&(a.rpt_att_card=o.first)}},hostBindings:function(t,a){1&t&&e.NdJ("scroll",function(r){return a.onScroll(r)},!1,e.Jf7)},features:[e.qOj],decls:11,vars:8,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","DetailedAttendance",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"paramsList","onSubmit"],["class","form-card att-card-rep",4,"ngIf"],[1,"form-card","att-card-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["label","print",3,"onClick"],["id","rpt_att_card",1,"container-fluid"],["rpt_att_card",""],[1,"view-data-row-container","my-4"],["label","code",1,"col-2",3,"value"],["label","employeeName",1,"col-3","col-md",3,"value"],["label","job",1,"col-3","col-md",3,"value"],["label","organization",1,"col-3","col-md",3,"value"],["label","TotalUnpaidLeave","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",1,"col-2","col-md","text-center",3,"value"],["class","mtop-25",4,"ngIf"],["id","attendance_card","appScrollableHorizontal","",1,"table","rpt-table","fixed-columns-table","mt-3","d-block","overflow-scroll"],[1,"thead-light"],["id","fixed-header"],[4,"ngFor","ngForOf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],[1,"view-data-row-container"],["label","name","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","IP","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","deductible_Value","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","weekend","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","officialHolidays","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","start_Time","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","end_Time","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","from_Date","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isDate","value"],["label","to_Date","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isDate","value"],["label","mission_Continuous_IS_Full_Day","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isBool","value"],["valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap","label","location",3,"value"],["label","iS_Full_Day","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isBool","value"],["label","from_Hour","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","to_Hour","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"value"],["label","from","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isDate","value"],["label","to","valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"isDate","value"],["valueStyleClass","text-wrap-nowrap","titleStyleClass","text-wrap-nowrap",3,"label","value"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(r){return a.submit(r)}),e.qZA()()(),e.YNc(10,An,18,11,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,4,"attendanceReports")),e.xp6(6),e.hij(" ",e.lcZ(8,6,"filter_options")," "),e.xp6(2),e.Q6J("paramsList",a.paramsList),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[Q.sg,Q.O5,de.p,p.T,_e.I,ye.m,Ee.l,he.c,Pe.n,m.a8,m.dn,m.n5,ie.pp,ie.ib,ie.yz,ie.yK,Q.uU,u.X$],styles:[".view-data-row-container[_ngcontent-%COMP%]{flex-wrap:nowrap}  .att-card-rep .fixed-columns-table td:first-child,   .att-card-rep .fixed-columns-table th:first-child{position:sticky;left:-1px;z-index:10;background-color:#fff}  .att-card-rep .fixed-columns-table td:nth-child(2),   .att-card-rep .fixed-columns-table th:nth-child(2){position:sticky;left:100px;z-index:10;background-color:#fff}"]}),n})();var Je=S(58350);const Zn=["rpt_att_card"];function xn(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"date"),e.ALo(4,"translate"),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.HOy(" ",e.lcZ(2,4,"from")," (",e.xi3(3,6,t.fromDate,"yyyy/MM/dd"),") ",e.lcZ(4,9,"to")," (",e.xi3(5,11,t.toDate,"yyyy/MM/dd"),") ")}}function Ln(n,i){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.uIk("rowspan",t.missions.length),e.xp6(1),e.hij(" ",e.xi3(2,2,t.missionDate,"dd/MM/yyyy")," ")}}function On(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,Ln,3,5,"td",9),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA()(),e.BQk()),2&n){const t=i.$implicit,a=i.index,o=e.oxw().index,r=e.oxw(3);e.xp6(2),e.Q6J("ngIf",0===a),e.xp6(2),e.hij(" ",r.getSerOfAllDataTable(o,a)," "),e.xp6(2),e.hij(" ",e.xi3(7,10,t.date_From,"dd/MM/yyyy")," "),e.xp6(3),e.Oqu(e.xi3(10,13,t.date_To,"dd/MM/yyyy")),e.xp6(3),e.hij(" ",t.iS_Full_Day?"yes":"no"," "),e.xp6(2),e.hij(" ",t.is_Continuous?"yes":"no"," "),e.xp6(2),e.hij(" ",t.from_Hour," "),e.xp6(2),e.hij(" ",t.to_Hour," "),e.xp6(2),e.hij(" ",t.location," "),e.xp6(2),e.hij(" ",t.note," ")}}function Fn(n,i){if(1&n&&(e.ynx(0),e.YNc(1,On,23,16,"ng-container",21),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t.missions)}}function Mn(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",14),e._UZ(2,"app-view-data-row-item",15)(3,"app-view-data-row-item",16)(4,"app-view-data-row-item",17)(5,"app-view-data-row-item",18),e.qZA(),e.TgZ(6,"table",19)(7,"thead",20)(8,"tr")(9,"th"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"th"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"th"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"th"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"th"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"th"),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"th"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"th"),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"th"),e._uU(37),e.ALo(38,"translate"),e.qZA()()(),e.TgZ(39,"tbody"),e.YNc(40,Fn,2,1,"ng-container",21),e.qZA()(),e.TgZ(41,"app-prime-paginator",22),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeDataInPage(o.pageIndex))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("value",null==t.empMissionsTable?null:t.empMissionsTable.code),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empMissionsTable?null:t.empMissionsTable.ar_Name,null==t.empMissionsTable?null:t.empMissionsTable.en_Name)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empMissionsTable?null:t.empMissionsTable.ar_Job,null==t.empMissionsTable?null:t.empMissionsTable.en_Job)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empMissionsTable?null:t.empMissionsTable.ar_Org,null==t.empMissionsTable?null:t.empMissionsTable.en_Org)),e.xp6(5),e.Oqu(e.lcZ(11,18,"date")),e.xp6(3),e.Oqu(e.lcZ(14,20,"Ser")),e.xp6(3),e.Oqu(e.lcZ(17,22,"from")),e.xp6(3),e.Oqu(e.lcZ(20,24,"to")),e.xp6(3),e.Oqu(e.lcZ(23,26,"iS_Full_Day")),e.xp6(3),e.Oqu(e.lcZ(26,28,"continuous")),e.xp6(3),e.Oqu(e.lcZ(29,30,"starting")),e.xp6(3),e.Oqu(e.lcZ(32,32,"ending")),e.xp6(3),e.Oqu(e.lcZ(35,34,"location")),e.xp6(3),e.Oqu(e.lcZ(38,36,"notes")),e.xp6(3),e.Q6J("ngForOf",t.empMissionsTable.mappedMissions),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const Rn=function(){return["","","","","","",""]};function Nn(n,i){1&n&&(e.TgZ(0,"div",23),e._UZ(1,"app-table-skeleton",24),e.qZA()),2&n&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,Rn)))}function Un(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,xn,6,14,"div",9),e.TgZ(6,"div")(7,"submit-btn",10),e.NdJ("onClick",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.print())}),e.qZA()()(),e.TgZ(8,"mat-card-content",11,12),e.YNc(10,Mn,42,38,"ng-container",9),e.YNc(11,Nn,2,2,"div",13),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"results")),e.xp6(2),e.Q6J("ngIf",t.fromDate||t.toDate),e.xp6(5),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let qn=(()=>{class n extends M.U{constructor(t,a,o){super(),this.attReportService=t,this.exportService=a,this.loading=o,this.submitted=!1,this.isLoaded=!1,this.reportId=0,this.paramsList=[{name:"Structure_id",id:z.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:z.A.StructureType_Id},{name:"Org_IDs",id:z.A.Org_IDs},{name:"WithChilds",id:z.A.WithChilds,isRequired:!0},{name:"Status_IDs",id:z.A.Status_IDs},{name:"Person_Instance_ID",id:z.A.Person_Instance_ID},{name:"DateFrom",id:z.A.DateFrom,isRequired:!0},{name:"DateTo",id:z.A.DateTo,isRequired:!0},{name:"Financial_Company_IDs",id:z.A.Financial_Company_IDs}]}ngOnInit(){this.page.pageSize=1}onModulesChanged(){this.reportId=this.getReportGUIid(this.getViewName)}submit(t){this.params={Structure_id:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_Ids:t.Org_IDs,WithChilds:t.WithChilds,Person_Instance_ID:t.Person_Instance_ID?.toString(),Status_IDs:t.Status_IDs,DateFrom:t.DateFrom,DateTo:t.DateTo,Financial_Company_IDs:t.Financial_Company_IDs},this.submitted=!0,this.fromDate=t.DateFrom,this.toDate=t.DateTo,this.getMissionsData()}getMissionsData(){this.isLoaded=!1,this.missionsTableAll=null,this.empMissionsTable=null,this.attReportService.getMissions(this.params).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==v.u.Success?(this.missionsTableAll=function Sn(n){let i=[];return n.map(t=>{t.rptMissionsEmployeeVMs.map(a=>{i.push({en_Org:t.en_Org,ar_Org:t.ar_Org,ar_Job:a.ar_Job,en_Job:a.en_Job,code:a.code,ar_Name:a.ar_Name,en_Name:a.en_Name,mappedMissions:Je.$.groupBy(a.rptMissionsDataVMs,"date_From","missionDate","missions")})})}),i}(t.data),this.page.length=this.missionsTableAll.length,this.changeDataInPage(0),this.isLoaded=!0):this.errorList(t?.message?.messages)})}changeDataInPage(t){this.page.pageIndex=t+1,this.empMissionsTable=this.missionsTableAll[t]}print(){this.exportService.exportChart(this.rpt_att_card,"mission_card","pdf",this.loading)}getSerOfAllDataTable(t,a){return this.empMissionsTable.mappedMissions.slice(0,t).reduce((o,r)=>o+r.missions.length,0)+a+1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae),e.Y36(xe),e.Y36(Le.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-missions-card-rep"]],viewQuery:function(t,a){if(1&t&&e.Gf(Zn,5),2&t){let o;e.iGM(o=e.CRH())&&(a.rpt_att_card=o.first)}},features:[e.qOj],decls:11,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","missionsCard",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"reportId","paramsList","onSubmit"],["class","form-card mission-card-rep",4,"ngIf"],[1,"form-card","mission-card-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["label","print",3,"onClick"],["id","rpt_att_card",1,"container-fluid"],["rpt_att_card",""],["class","mtop-25",4,"ngIf"],[1,"view-data-row-container","my-4"],["label","code",1,"col-3","col-md",3,"value"],["label","employeeName",1,"col-3","col-md",3,"value"],["label","job",1,"col-3","col-md",3,"value"],["label","organization",1,"col-3","col-md",3,"value"],["id","mission_card","appScrollableHorizontal","",1,"table","rpt-table","mt-3","overflow-scroll","d-block"],[1,"thead-light"],[4,"ngFor","ngForOf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(r){return a.submit(r)}),e.qZA()()(),e.YNc(10,Un,12,6,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,5,"attendanceReports")),e.xp6(6),e.hij(" ",e.lcZ(8,7,"filter_options")," "),e.xp6(2),e.Q6J("reportId",a.reportId)("paramsList",a.paramsList),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[Q.sg,Q.O5,de.p,p.T,_e.I,ye.m,Ee.l,he.c,Pe.n,m.a8,m.dn,m.n5,ie.pp,ie.ib,ie.yz,ie.yK,Q.uU,u.X$],styles:[".mission-card-rep td,   .mission-card-rep th{width:11%}"]}),n})();function En(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"date"),e.ALo(4,"translate"),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.HOy(" ",e.lcZ(2,4,"from")," (",e.xi3(3,6,t.fromDate,"yyyy/MM/dd"),") ",e.lcZ(4,9,"to")," (",e.xi3(5,11,t.toDate,"yyyy/MM/dd"),") ")}}function Jn(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(4).$implicit,a=e.oxw(3);e.xp6(1),e.uIk("rowspan",a.getNoOfMissionInOrg(t)),e.xp6(1),e.hij(" ",a.getSerOfAllDataTable(t.org_ID)," "),e.xp6(1),e.uIk("rowspan",a.getNoOfMissionInOrg(t)),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Org,t.en_Org)," ")}}function kn(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit,a=e.oxw(4);e.xp6(1),e.uIk("rowspan",t.rptMissionsDataVMs.length),e.xp6(1),e.hij(" ",t.code," "),e.xp6(1),e.uIk("rowspan",t.rptMissionsDataVMs.length),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Name,t.en_Name)," "),e.xp6(1),e.uIk("rowspan",t.rptMissionsDataVMs.length),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Job,t.en_Job)," ")}}function Hn(n,i){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.uIk("rowspan",t.missions.length),e.xp6(1),e.hij(" ",e.xi3(2,2,t.missionDate,"dd/MM/yyyy")," ")}}function Qn(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,Jn,5,4,"ng-container",9),e.YNc(3,kn,7,6,"ng-container",9),e.YNc(4,Hn,3,5,"td",9),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA()(),e.BQk()),2&n){const t=i.$implicit,a=i.index,o=e.oxw().index,r=e.oxw().index;e.xp6(2),e.Q6J("ngIf",0===r&&0===o&&0===a),e.xp6(1),e.Q6J("ngIf",0===o&&0===a),e.xp6(1),e.Q6J("ngIf",0===a),e.xp6(2),e.hij(" ",e.xi3(7,11,t.date_From,"dd/MM/yyyy")," "),e.xp6(3),e.Oqu(e.xi3(10,14,t.date_To,"dd/MM/yyyy")),e.xp6(3),e.hij(" ",t.iS_Full_Day?"yes":"no"," "),e.xp6(2),e.hij(" ",t.is_Continuous?"yes":"no"," "),e.xp6(2),e.hij(" ",t.from_Hour," "),e.xp6(2),e.hij(" ",t.to_Hour," "),e.xp6(2),e.hij(" ",t.location," "),e.xp6(2),e.hij(" ",t.note," ")}}function Vn(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Qn,23,17,"ng-container",15),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t.missions)}}function jn(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Vn,2,1,"ng-container",15),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t.mappedMissions)}}function Bn(n,i){if(1&n&&(e.ynx(0),e.YNc(1,jn,2,1,"ng-container",15),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t.rptMissionsEmployeeVMs)}}function Gn(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"table",13)(2,"thead",14)(3,"tr")(4,"th"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"th"),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"th"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"th"),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"th"),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"th"),e._uU(44),e.ALo(45,"translate"),e.qZA()()(),e.TgZ(46,"tbody"),e.YNc(47,Bn,2,1,"ng-container",15),e.qZA()(),e.TgZ(48,"app-prime-paginator",16),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeDataInPage(o.pageIndex))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(5),e.Oqu(e.lcZ(6,18,"Ser")),e.xp6(3),e.Oqu(e.lcZ(9,20,"organization")),e.xp6(3),e.Oqu(e.lcZ(12,22,"code")),e.xp6(3),e.Oqu(e.lcZ(15,24,"name")),e.xp6(3),e.Oqu(e.lcZ(18,26,"jobTitle")),e.xp6(3),e.Oqu(e.lcZ(21,28,"missionDate")),e.xp6(3),e.Oqu(e.lcZ(24,30,"fromDate")),e.xp6(3),e.Oqu(e.lcZ(27,32,"toDate")),e.xp6(3),e.Oqu(e.lcZ(30,34,"iS_Full_Day")),e.xp6(3),e.Oqu(e.lcZ(33,36,"continuous")),e.xp6(3),e.Oqu(e.lcZ(36,38,"from_Hour")),e.xp6(3),e.Oqu(e.lcZ(39,40,"to_Hour")),e.xp6(3),e.Oqu(e.lcZ(42,42,"location")),e.xp6(3),e.Oqu(e.lcZ(45,44,"notes")),e.xp6(3),e.Q6J("ngForOf",t.missionsTable),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const zn=function(){return["","","","","","",""]};function Yn(n,i){1&n&&(e.TgZ(0,"div",17),e._UZ(1,"app-table-skeleton",18),e.qZA()),2&n&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,zn)))}function Wn(n,i){if(1&n&&(e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,En,6,14,"div",9),e._UZ(6,"div"),e.qZA(),e.TgZ(7,"mat-card-content",10,11),e.YNc(9,Gn,49,46,"ng-container",9),e.YNc(10,Yn,2,2,"div",12),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"results")),e.xp6(2),e.Q6J("ngIf",t.fromDate||t.toDate),e.xp6(4),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let $n=(()=>{class n extends M.U{constructor(t){super(),this.attReportService=t,this.submitted=!1,this.isLoaded=!1,this.reportId=0,this.paramsList=[{name:"Structure_id",id:z.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:z.A.StructureType_Id},{name:"Org_IDs",id:z.A.Org_IDs},{name:"WithChilds",id:z.A.WithChilds,isRequired:!0},{name:"Status_IDs",id:z.A.Status_IDs},{name:"Person_Instance_ID",id:z.A.Person_Instance_ID},{name:"DateFrom",id:z.A.DateFrom,isRequired:!0},{name:"DateTo",id:z.A.DateTo,isRequired:!0},{name:"Financial_Company_IDs",id:z.A.Financial_Company_IDs}]}ngOnInit(){}onModulesChanged(){this.reportId=this.getReportGUIid(this.getViewName)}submit(t){this.params={Structure_id:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_Ids:t.Org_IDs,WithChilds:t.WithChilds,Person_Instance_ID:t.Person_Instance_ID?.toString(),Status_IDs:t.Status_IDs,DateFrom:t.DateFrom,DateTo:t.DateTo,Financial_Company_IDs:t.Financial_Company_IDs},this.submitted=!0,this.fromDate=t.DateFrom,this.toDate=t.DateTo,this.getMissionsData()}getMissionsData(){this.isLoaded=!1,this.missionsTable=null,this.attReportService.getMissions(this.params).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==v.u.Success?(this.page.length=t.data.length,this.missionsTableAll=function wn(n){return n.map(i=>{i.rptMissionsEmployeeVMs.map(t=>{t.mappedMissions=Je.$.groupBy(t.rptMissionsDataVMs,"date_From","missionDate","missions")})}),n}(t.data),this.missionsTable=this.missionsTableAll.slice(0,this.page.pageSize),this.isLoaded=!0):this.errorList(t?.message?.messages)})}changeDataInPage(t){this.page.pageIndex=t+1;let a=t*this.page.pageSize;this.missionsTable=this.missionsTableAll.slice(a,a+this.page.pageSize)}getNoOfMissionInOrg(t){return t.rptMissionsEmployeeVMs.reduce((a,o)=>a+o.rptMissionsDataVMs.length,0)}getSerOfAllDataTable(t){return this.missionsTableAll?.findIndex(a=>a.org_ID==t)+1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-missions-details-rep"]],features:[e.qOj],decls:11,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","missionsDetails",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"reportId","paramsList","onSubmit"],["class","form-card mission-details-rep",4,"ngIf"],[1,"form-card","mission-details-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["id","rpt_att_card",1,"container-fluid"],["rpt_att_card",""],["class","mtop-25",4,"ngIf"],["id","rpt-table","appScrollableHorizontal","",1,"table","rpt-table","mt-3","overflow-scroll","d-block"],[1,"thead-light"],[4,"ngFor","ngForOf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(r){return a.submit(r)}),e.qZA()()(),e.YNc(10,Wn,11,6,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,5,"attendanceReports")),e.xp6(6),e.hij(" ",e.lcZ(8,7,"filter_options")," "),e.xp6(2),e.Q6J("reportId",a.reportId)("paramsList",a.paramsList),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[Q.sg,Q.O5,p.T,_e.I,ye.m,he.c,Pe.n,m.a8,m.dn,m.n5,ie.pp,ie.ib,ie.yz,ie.yK,Q.uU,u.X$]}),n})();const Xn=["rpt_att_card"];function ei(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"date"),e.ALo(4,"translate"),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.HOy(" ",e.lcZ(2,4,"from")," (",e.xi3(3,6,t.fromDate,"yyyy/MM/dd"),") ",e.lcZ(4,9,"to")," (",e.xi3(5,11,t.toDate,"yyyy/MM/dd"),") ")}}function ti(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"translate"),e.ALo(9,"date"),e.ALo(10,"translate"),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.qZA()(),e.BQk()),2&n){const t=i.$implicit,a=i.index,o=e.oxw(3);e.xp6(3),e.hij(" ",a+1," "),e.xp6(2),e.hij(" ",o.msgTranslate(t.dayNameArabic,t.dayNameEnglish)," "),e.xp6(2),e.HOy(" ",e.lcZ(8,10,"from"),": ",e.xi3(9,12,t.permission_From_Date,"dd/MM/yyyy")," - ",e.lcZ(10,15,"to"),": ",e.xi3(11,17,t.permission_To_Date,"dd/MM/yyyy")," "),e.xp6(6),e.hij(" ",t.from_Hour," "),e.xp6(2),e.hij(" ",t.to_Hour," "),e.xp6(2),e.hij(" ",t.permission_Period," "),e.xp6(2),e.hij(" ",t.note," ")}}function ai(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",14),e._UZ(2,"app-view-data-row-item",15)(3,"app-view-data-row-item",16)(4,"app-view-data-row-item",17)(5,"app-view-data-row-item",18),e.qZA(),e.TgZ(6,"table",19)(7,"thead",20)(8,"tr")(9,"th"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"th"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"th"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"th"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"th"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"th"),e._uU(28),e.ALo(29,"translate"),e.qZA()()(),e.TgZ(30,"tbody"),e.YNc(31,ti,20,20,"ng-container",21),e.qZA()(),e.TgZ(32,"app-prime-paginator",22),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeDataInPage(o.pageIndex))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("value",null==t.empPermissionsTable?null:t.empPermissionsTable.code),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empPermissionsTable?null:t.empPermissionsTable.ar_Name,null==t.empPermissionsTable?null:t.empPermissionsTable.en_Name)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empPermissionsTable?null:t.empPermissionsTable.ar_Job,null==t.empPermissionsTable?null:t.empPermissionsTable.en_Job)),e.xp6(1),e.Q6J("value",t.msgTranslate(null==t.empPermissionsTable?null:t.empPermissionsTable.ar_Org,null==t.empPermissionsTable?null:t.empPermissionsTable.en_Org)),e.xp6(5),e.Oqu(e.lcZ(11,15,"Ser")),e.xp6(3),e.Oqu(e.lcZ(14,17,"day")),e.xp6(3),e.Oqu(e.lcZ(17,19,"date")),e.xp6(3),e.Oqu(e.lcZ(20,21,"from")),e.xp6(3),e.Oqu(e.lcZ(23,23,"to")),e.xp6(3),e.Oqu(e.lcZ(26,25,"duration")),e.xp6(3),e.Oqu(e.lcZ(29,27,"notes")),e.xp6(3),e.Q6J("ngForOf",null==t.empPermissionsTable?null:t.empPermissionsTable.rptPermissionsDataVMs),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const ni=function(){return["","","","","","",""]};function ii(n,i){1&n&&(e.TgZ(0,"div",23),e._UZ(1,"app-table-skeleton",24),e.qZA()),2&n&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,ni)))}function oi(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,ei,6,14,"div",9),e.TgZ(6,"div")(7,"submit-btn",10),e.NdJ("onClick",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.print())}),e.qZA()()(),e.TgZ(8,"mat-card-content",11,12),e.YNc(10,ai,33,29,"ng-container",9),e.YNc(11,ii,2,2,"div",13),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"results")),e.xp6(2),e.Q6J("ngIf",t.fromDate||t.toDate),e.xp6(5),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let ri=(()=>{class n extends M.U{constructor(t,a,o){super(),this.attReportService=t,this.exportService=a,this.loading=o,this.submitted=!1,this.isLoaded=!1,this.reportId=0,this.paramsList=[{name:"Structure_id",id:z.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:z.A.StructureType_Id},{name:"Org_IDs",id:z.A.Org_IDs},{name:"WithChilds",id:z.A.WithChilds,isRequired:!0},{name:"Status_IDs",id:z.A.Status_IDs},{name:"Person_Instance_ID",id:z.A.Person_Instance_ID},{name:"DateFrom",id:z.A.DateFrom,isRequired:!0},{name:"DateTo",id:z.A.DateTo,isRequired:!0},{name:"Financial_Company_IDs",id:z.A.Financial_Company_IDs}]}ngOnInit(){this.page.pageSize=1}onModulesChanged(){this.reportId=this.getReportGUIid(this.getViewName)}submit(t){this.params={Structure_id:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_Ids:t.Org_IDs,WithChilds:t.WithChilds,Person_Instance_ID:t.Person_Instance_ID?.toString(),Status_IDs:t.Status_IDs,DateFrom:t.DateFrom,DateTo:t.DateTo,Financial_Company_IDs:t.Financial_Company_IDs},this.submitted=!0,this.fromDate=t.DateFrom,this.toDate=t.DateTo,this.getPermissionsData()}getPermissionsData(){this.isLoaded=!1,this.permissionsTableAll=null,this.empPermissionsTable=null,this.attReportService.getPermissions(this.params).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==v.u.Success?(this.permissionsTableAll=function Kn(n){let i=[];return n.map(t=>{t.rptPermissionsEmployeeVMs.map(a=>{i.push({...a,en_Org:t.en_Org,ar_Org:t.ar_Org})})}),i}(t.data),this.page.length=this.permissionsTableAll.length,this.changeDataInPage(0),this.isLoaded=!0):this.errorList(t?.message?.messages)})}changeDataInPage(t){this.page.pageIndex=t+1,this.empPermissionsTable=this.permissionsTableAll[t]}print(){this.exportService.exportChart(this.rpt_att_card,"permission_details","pdf",this.loading)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae),e.Y36(xe),e.Y36(Le.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-permission-details-rep"]],viewQuery:function(t,a){if(1&t&&e.Gf(Xn,5),2&t){let o;e.iGM(o=e.CRH())&&(a.rpt_att_card=o.first)}},features:[e.qOj],decls:11,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","permissionsDetails",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"reportId","paramsList","onSubmit"],["class","form-card permission-details-rep",4,"ngIf"],[1,"form-card","permission-details-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["label","print",3,"onClick"],["id","permission_details",1,"container-fluid"],["rpt_att_card",""],["class","mtop-25",4,"ngIf"],[1,"view-data-row-container","my-4"],["label","code",1,"col-3","col-md",3,"value"],["label","employeeName",1,"col-3","col-md",3,"value"],["label","job",1,"col-3","col-md",3,"value"],["label","organization",1,"col-3","col-md",3,"value"],["id","rpt-table","appScrollableHorizontal","",1,"table","rpt-table","mt-3","overflow-scroll","d-block"],[1,"thead-light"],[4,"ngFor","ngForOf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(r){return a.submit(r)}),e.qZA()()(),e.YNc(10,oi,12,6,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,5,"attendanceReports")),e.xp6(6),e.hij(" ",e.lcZ(8,7,"filter_options")," "),e.xp6(2),e.Q6J("reportId",a.reportId)("paramsList",a.paramsList),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[Q.sg,Q.O5,de.p,p.T,_e.I,ye.m,Ee.l,he.c,Pe.n,m.a8,m.dn,m.n5,ie.pp,ie.ib,ie.yz,ie.yK,Q.uU,u.X$],styles:[".permission-details-rep td,   .permission-details-rep th{width:16%}"]}),n})();const li=["rpt_att_card"];function di(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"date"),e.ALo(4,"translate"),e.ALo(5,"date"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.HOy(" ",e.lcZ(2,4,"from")," (",e.xi3(3,6,t.fromDate,"yyyy/MM/dd"),") ",e.lcZ(4,9,"to")," (",e.xi3(5,11,t.toDate,"yyyy/MM/dd"),") ")}}function pi(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit,a=e.oxw(3);e.xp6(1),e.uIk("rowspan",t.noOfSignData),e.xp6(1),e.hij(" ",a.getSerOfAllDataTable(t.org_Id)," "),e.xp6(1),e.uIk("rowspan",t.noOfSignData),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Org,t.en_Org)," ")}}function ci(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit,a=e.oxw(4);e.xp6(1),e.uIk("rowspan",t.signData.length),e.xp6(1),e.hij(" ",t.code," "),e.xp6(1),e.uIk("rowspan",t.signData.length),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Person,t.en_Person)," "),e.xp6(1),e.uIk("rowspan",t.signData.length),e.xp6(1),e.hij(" ",a.msgTranslate(t.ar_Job,t.en_Job)," ")}}function mi(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,pi,5,4,"ng-container",9),e.YNc(3,ci,7,6,"ng-container",9),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"date"),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.qZA()(),e.BQk()),2&n){const t=i.$implicit,a=i.index,o=e.oxw().index;e.xp6(2),e.Q6J("ngIf",0===o&&0===a),e.xp6(1),e.Q6J("ngIf",0===a),e.xp6(2),e.hij(" ",e.xi3(6,8,t.tR_DATE,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",e.xi3(9,11,t.timE_IN_1,"hh:mm:ss a")," "),e.xp6(3),e.hij(" ",t.in_Device," "),e.xp6(2),e.hij(" ",e.xi3(14,14,t.tR_DATE,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",e.xi3(17,17,t.timE_OUT_1,"hh:mm:ss a")," "),e.xp6(3),e.hij(" ",t.out_Device," ")}}function ui(n,i){if(1&n&&(e.ynx(0),e.YNc(1,mi,20,20,"ng-container",17),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t.signData)}}function gi(n,i){if(1&n&&(e.ynx(0),e.YNc(1,ui,2,1,"ng-container",17),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",null==t?null:t.mappedEmployees)}}function _i(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"table",13)(2,"thead",14)(3,"tr")(4,"th",15),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",15),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th",15),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th",15),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th",15),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",16),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th",16),e._uU(23),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"tr")(26,"th"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"th"),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"th"),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"th"),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"th"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"th"),e._uU(42),e.ALo(43,"translate"),e.qZA()()(),e.TgZ(44,"tbody"),e.YNc(45,gi,2,1,"ng-container",17),e.qZA()(),e.TgZ(46,"app-prime-paginator",18),e.NdJ("onChangePage",function(o){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeDataInPage(o.pageIndex))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(5),e.Oqu(e.lcZ(6,17,"Ser")),e.xp6(3),e.Oqu(e.lcZ(9,19,"organization")),e.xp6(3),e.Oqu(e.lcZ(12,21,"code")),e.xp6(3),e.Oqu(e.lcZ(15,23,"employeeName")),e.xp6(3),e.Oqu(e.lcZ(18,25,"jobTitle")),e.xp6(3),e.Oqu(e.lcZ(21,27,"signIn")),e.xp6(3),e.Oqu(e.lcZ(24,29,"signOut")),e.xp6(4),e.Oqu(e.lcZ(28,31,"date")),e.xp6(3),e.Oqu(e.lcZ(31,33,"time")),e.xp6(3),e.Oqu(e.lcZ(34,35,"device")),e.xp6(3),e.Oqu(e.lcZ(37,37,"date")),e.xp6(3),e.Oqu(e.lcZ(40,39,"time")),e.xp6(3),e.Oqu(e.lcZ(43,41,"device")),e.xp6(3),e.Q6J("ngForOf",t.signSheetTable),e.xp6(1),e.Q6J("page",t.page)("isCenterPaginator",!0)("hidePageSizeOption",!0)}}const hi=function(){return["","","","","","",""]};function fi(n,i){1&n&&(e.TgZ(0,"div",19),e._UZ(1,"app-table-skeleton",20),e.qZA()),2&n&&(e.xp6(1),e.Q6J("displayedColumns",e.DdM(1,hi)))}function yi(n,i){if(1&n&&(e.TgZ(0,"mat-card",7)(1,"mat-card-title",8)(2,"div",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,di,6,14,"div",9),e._UZ(6,"div"),e.qZA(),e.TgZ(7,"mat-card-content",10,11),e.YNc(9,_i,47,43,"ng-container",9),e.YNc(10,fi,2,2,"div",12),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"results")),e.xp6(2),e.Q6J("ngIf",t.fromDate||t.toDate),e.xp6(4),e.Q6J("ngIf",t.isLoaded),e.xp6(1),e.Q6J("ngIf",!t.isLoaded)}}let vi=(()=>{class n extends M.U{constructor(t,a,o){super(),this.attReportService=t,this.exportService=a,this.loading=o,this.submitted=!1,this.isLoaded=!1,this.reportId=0,this.paramsList=[{name:"Structure_id",id:z.A.Structure_id,isRequired:!0},{name:"StructureType_Id",id:z.A.StructureType_Id},{name:"Org_IDs",id:z.A.Org_IDs},{name:"WithChilds",id:z.A.WithChilds,isRequired:!0},{name:"Status_IDs",id:z.A.Status_IDs},{name:"Person_Instance_ID",id:z.A.Person_Instance_ID},{name:"DateFrom",id:z.A.DateFrom,isRequired:!0},{name:"DateTo",id:z.A.DateTo,isRequired:!0},{name:"Financial_Company_IDs",id:z.A.Financial_Company_IDs}]}ngOnInit(){this.page.pageSize=1}onModulesChanged(){this.reportId=this.getReportGUIid(this.getViewName)}submit(t){this.params={Structure_id:t.Structure_id,StructureType_Id:t.StructureType_Id,Org_Ids:t.Org_IDs,WithChilds:t.WithChilds,Person_Instance_ID:t.Person_Instance_ID?.toString(),Status_IDs:t.Status_IDs,DateFrom:t.DateFrom,DateTo:t.DateTo,Financial_Company_IDs:t.Financial_Company_IDs},this.submitted=!0,this.fromDate=t.DateFrom,this.toDate=t.DateTo,this.getSignSheetData()}getSignSheetData(){this.isLoaded=!1,this.signSheetTable=null,this.attReportService.getSignSheetData(this.params).pipe(this.cancelRequest()).subscribe(t=>{t.message.messageType==v.u.Success?(this.page.length=t.data.length,this.signSheetTableAll=function si(n){let i=[];return n.forEach(t=>{let a=Je.$.groupBy(t.signSheetEmployeeData,"person_Instance_ID","person_Instance_ID","data").map(o=>({person_Instance_ID:o.person_Instance_ID,code:o.data[0].code,ar_Person:o.data[0].ar_Person,en_Person:o.data[0].en_Person,ar_Job:o.data[0].ar_Job,en_Job:o.data[0].en_Job,signData:o.data.map(r=>({tR_DATE:r.tR_DATE,timE_IN_1:r.timE_IN_1,timE_OUT_1:r.timE_OUT_1,in_Device:r.in_Device,out_Device:r.out_Device}))}));if(t.signSheetEmployeeData.length>50){let o=0;for(;o<a.length;){let r=0;for(let I=o;I<a.length;I++)if(r+=a[I].signData.length,r>=50||I==a.length-1){i.push({org_Id:t.id,ar_Org:t.ar_Org,en_Org:t.en_Org,noOfSignData:r,mappedEmployees:a.slice(o,I+1)}),o=I+1;break}}}else i.push({org_Id:t.id,ar_Org:t.ar_Org,en_Org:t.en_Org,noOfSignData:t.signSheetEmployeeData.length,mappedEmployees:a})}),i}(t.data),this.signSheetTable=this.signSheetTableAll.slice(0,this.page.pageSize),this.isLoaded=!0):this.errorList(t?.message?.messages)})}changeDataInPage(t){this.page.pageIndex=t+1;let a=t*this.page.pageSize;this.signSheetTable=this.signSheetTableAll.slice(a,a+this.page.pageSize)}print(){this.exportService.exportChart(this.rpt_att_card,"signIn_Out","pdf",this.loading)}getSerOfAllDataTable(t){return this.signSheetTableAll.map(o=>o.org_Id).filter((o,r,I)=>o!==I[r-1]).findIndex(o=>o==t)+1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ae),e.Y36(xe),e.Y36(Le.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sign-in-out-sheet-rep"]],viewQuery:function(t,a){if(1&t&&e.Gf(li,5),2&t){let o;e.iGM(o=e.CRH())&&(a.rpt_att_card=o.first)}},features:[e.qOj],decls:11,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","signInOutSheet",3,"parentTitle"],[1,"d-block","mt-2"],["expanded",""],[1,"page-title"],[3,"reportId","paramsList","onSubmit"],["class","form-card sign-sheet-rep",4,"ngIf"],[1,"form-card","sign-sheet-rep"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["id","signIn_Out",1,"container-fluid"],["rpt_att_card",""],["class","mtop-25",4,"ngIf"],["id","rpt-table","appScrollableHorizontal","",1,"table","rpt-table","mt-3","overflow-scroll","d-block"],[1,"thead-light"],["rowspan","2"],["colspan","3"],[4,"ngFor","ngForOf"],[3,"page","isCenterPaginator","hidePageSizeOption","onChangePage"],[1,"mtop-25"],[3,"displayedColumns"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0),e._UZ(1,"page-title",1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-accordion",2)(4,"mat-expansion-panel",3)(5,"mat-expansion-panel-header")(6,"mat-panel-title",4),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"app-reports-params",5),e.NdJ("onSubmit",function(r){return a.submit(r)}),e.qZA()()(),e.YNc(10,yi,11,6,"mat-card",6)),2&t&&(e.xp6(1),e.s9C("parentTitle",e.lcZ(2,5,"attendanceReports")),e.xp6(6),e.hij(" ",e.lcZ(8,7,"filter_options")," "),e.xp6(2),e.Q6J("reportId",a.reportId)("paramsList",a.paramsList),e.xp6(1),e.Q6J("ngIf",a.submitted))},dependencies:[Q.sg,Q.O5,p.T,_e.I,ye.m,he.c,Pe.n,m.a8,m.dn,m.n5,ie.pp,ie.ib,ie.yz,ie.yK,Q.uU,u.X$]}),n})(),Ti=(()=>{class n extends M.U{constructor(t){super(),this.registerFingerprintService=t,this.mandatoryColomns=["Ser","code","employeeName","jobTitle","plan","date","fingerPrint","typeFinger","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.registerFingerprintService.getList(o).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);r.data.map(H=>{"O"==H.typeFinger&&(H.typeFinger="Out"),"I"==H.typeFinger&&(H.typeFinger="IN"),(null==H.fingerPrint||""==H.fingerPrint)&&(H.fingerPrint=`<span class="badge-danger">${this.languageService.translate("absent")}</span>`)});const I=function Ua(n){return n.map(i=>({...i,code:i?.code,employeeName:(0,d._f)(i?.employeeNameAr,i?.employeeNameEn),jobTitle:(0,d._f)(i?.jobTitleAr,i?.jobTitleEn),plan:(0,d._f)(i?.planAr,i?.planEn),fingerPrint:i?.fingerPrint,typeFinger:i?.typeFinger,date:d.M6.mapDate(i?.date,"dd/MM/yyyy")}))}(r.data);this.dataSource=new Z.by(I),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages);this.hideLoading()})}onDelete(t){this.deleteDialog(t.employeeName).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.registerFingerprintService.Delete(t.persosn_instance_Id,t.checkTimeDate).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("registerFingerprintRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}goToEdit(t){this.router.navigate([`/attendance/${this.moduleId}/fingerprints/register-fingerprint/edit/${t.persosn_instance_Id}/${t.checkTimeDate}`],{queryParams:{parentView:this.getViewName,page:this.page?.pageIndex??1}})}globalFunctionActions(t){t.viewName==U.S.upload_register_fingerprint&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_register_fingerprint,downloadPath:$.Z.download_register_fingerprint,name:"registerFingerprint"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Xe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-register-fingerprint-index"]],features:[e.qOj],decls:6,vars:16,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","registerFingerprint",3,"parentTitle","parentTitleLink","globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","isRowClickable","onChangePage","deleteRow","editRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"mat-card",2)(5,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)})("editRow",function(r){return a.goToEdit(r)}),e.qZA()()),2&t&&(e.xp6(1),e.hYB("parentTitle","",e.lcZ(2,12,"attendanceTracker")," / ",e.lcZ(3,14,"fingerprints"),""),e.MGl("parentTitleLink","/attendance/",a.moduleId,"/fingerprints/home"),e.Q6J("globalFunctions",a.subGlobalFunctions),e.xp6(4),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0)("isRowClickable",!1))},dependencies:[te.I,p.T,m.a8,m.n5,u.X$]}),n})();var ve=(()=>(function(n){n[n.Repeated=1]="Repeated",n[n.Continous=2]="Continous"}(ve||(ve={})),ve))();!function(n){n.getValue=function i(t){switch(t){case n.Repeated:return"Repeated";case n.Continous:return"Continous";default:return""}}}(ve||(ve={}));let Ci=(()=>{class n extends M.U{constructor(t){super(),this.overtimeTransactionService=t,this.mandatoryColomns=["Ser","ID","code","employeeName","repetitionTypeName","from_Date","to_Date","from_Hour","to_Hour","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.overtimeTransactionService.getList(o).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);r.data.map(H=>{H.repetitionTypeName=this.translate(ve.getValue(H.att_OverTimeRequest.repetitionType))});const I=function ht(n){return n.map(i=>({...i,ID:i.id,code:i.core_Person_Instance.core_Person.code,employeeName:(0,d._f)(i.core_Person_Instance.core_Person.ar_Name,i.core_Person_Instance.core_Person.en_Name),repetitionType:i.att_OverTimeRequest.repetitionType,from_Date:d.M6.mapDate(i.att_OverTimeRequest.fromDate,"dd/MM/yyyy"),to_Date:d.M6.mapDate(i.att_OverTimeRequest.toDate,"dd/MM/yyyy"),from_Hour:i.att_OverTimeRequest.fromHoure,to_Hour:i.att_OverTimeRequest.toHoure}))}(r.data);this.dataSource=new Z.by(I),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages);this.hideLoading()})}onDelete(t){this.deleteDialog(t.employeeName).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.overtimeTransactionService.Delete(t.ID).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("overtimeTransactionDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}globalFunctionActions(t){t.viewName==U.S.overtime_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_Overtime_transaction,downloadPath:$.Z.download_Overtime_transaction,name:"OvertimeTransaction"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overtime-transaction-index"]],features:[e.qOj],decls:4,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","OvertimeTransaction","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","isRowClickable","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0)("isRowClickable",!1))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})(),bi=(()=>{class n extends M.U{constructor(t){super(),this.penaltyTransactionService=t,this.mandatoryColomns=["Ser","employeeName","code","violation","date","repetition","penaltyValuePerDay","effectOnPayroll","moneyValue","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.penaltyTransactionService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new Z.by(Ge(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages)})}onDelete(t){this.deleteDialog(t.employeeName+" - "+t.violation).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.penaltyTransactionService.Delete(t.penalty_Transaction_ID,t.person_Instance_ID).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("penaltyTransactionRemoved"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}globalFunctionActions(t){t.viewName==U.S.penalty_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_penalty_transaction,downloadPath:$.Z.download_penalty_transaction,name:"penaltyTransaction"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-penalty-transaction-index"]],features:[e.qOj],decls:4,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","penaltyTransaction","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","exportService","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0)("exportService",a.penaltyTransactionService))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})(),Ii=(()=>{class n extends M.U{constructor(t){super(),this.permissionTransactionService=t,this.mandatoryColomns=["Ser","id","employeeName","code","permission_setup","permission_pattern","from_Date","to_Date","to_Hour","from_Hour","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a);let o={PageNumber:t,pageSize:this.page.pageSize};this.showLoading(),this.permissionTransactionService.getList(o).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);r.data.map(H=>{H.permission_pattern=this.translate(fe.getValue(H.att_Permission.permission_Type))});const I=function ga(n){return n.map(i=>({...i,id:i?.permission_ID,code:i?.core_Person_Instance?.core_Person.code,employeeName:(0,d._f)(i?.core_Person_Instance?.core_Person.ar_Name,i?.core_Person_Instance?.core_Person.en_Name),permission_setup:i?.att_Permission?.att_Permission_Setup?.name,type:i?.att_Permission?.permission_Type,from_Date:d.M6.mapDate(i?.att_Permission?.permission_Date,"dd/MM/yyyy"),to_Date:d.M6.mapDate(i?.att_Permission?.permission_To_Date,"dd/MM/yyyy"),to_Hour:i?.att_Permission?.from_Hour,from_Hour:i?.att_Permission?.to_Houre}))}(r.data);this.dataSource=new Z.by(I),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages);this.hideLoading()})}onDelete(t){this.deleteDialog(t.employeeName).subscribe(o=>{o&&this.delete(t)})}delete(t){this.showLoading(),this.permissionTransactionService.Delete(t.id,t.person_Instance_ID).subscribe(a=>{a.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("PermissionTransactionDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(a?.message?.messages),this.hideLoading()})}globalFunctionActions(t){t.viewName==U.S.permission_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_permission_transaction,downloadPath:$.Z.download_permission_transaction,name:"PermissionTransaction"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Ze))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-permission-transaction-index"]],features:[e.qOj],decls:4,vars:9,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","PermissionTransaction","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","isRowClickable","onChangePage","deleteRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0)("isRowClickable",!1))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})(),Ai=(()=>{class n extends M.U{constructor(t){super(),this.planAdjustmentService=t,this.mandatoryColomns=["Ser","code","employeeName","att_Plan_Name","fromDate","toDate","NoOfDays","actions"],this.isLoaded=!1,this.optionalColomns=[]}onChangeBusinessAndCompanyId(){this.dataSource?.data?.length>0&&(this.dataSource=new Z.by(null)),this.checkNoBusinessOrCompany()&&this.getList(this.pageFromUrl>0?this.pageFromUrl:this.firstPage)}ngOnInit(){}getList(t,a){this.dataSource=new Z.by(null),this.isLoaded=!1,this.removePageParams(),this.page.pageIndex=t,a&&(this.page.pageSize=a),this.planAdjustmentService.getList({PageNumber:t,pageSize:this.page.pageSize}).pipe(this.cancelRequest()).subscribe(r=>{if(r.message.messageType==v.u.Success){if(0==r.data.length&&t>1)return void this.getList(this.prevPage);this.dataSource=new Z.by(function Di(n){return n.map(i=>({...i,plan_ID:i.plan_ID,code:i.core_Person_Instance.core_Person.code,employeeName:(0,d._f)(i.core_Person_Instance.core_Person.ar_Name,i.core_Person_Instance.core_Person.en_Name),att_Plan_Name:(0,d._f)(i.att_Plan.ar_Name,i.att_Plan.en_Name),fromDate:d.M6.mapDateReverse(i.fromDate),toDate:d.M6.mapDateReverse(i.toDate),NoOfDays:d.M6.calculateDaysBetweenTwoDates(i.fromDate,i.toDate)}))}(r.data)),this.isLoaded=!0,this.page.length=r.meta.totalItemCount,this.page.meta=r.meta}else this.errorList(r?.message?.messages)})}onDelete(t){let a=this.msgTranslate(t.att_Plan.en_Name,t.att_Plan.ar_Name);this.deleteDialog(a).subscribe(o=>{o&&this.delete(t)})}delete(t){let a={Person_INstance_ID:t.person_Instance_ID,Plan_ID:t.plan_ID,FromDate:t.fromDate,ToDate:t.toDate};this.showLoading(),this.planAdjustmentService.Delete(a).subscribe(o=>{o.message.messageType==v.u.Success?(this.deleteSuccessfullyMsg("planDeleted"),this.getList(1==this.dataSource.data.length&&this.currentPage>1?this.prevPage:this.currentPage,this.page.pageSize)):this.errorList(o?.message?.messages),this.hideLoading()})}goToEdit(t){this.router.navigate([`/attendance/${this.moduleId}/plan-adjustment/edit/${t.person_Instance_ID}/${t.plan_ID}`],{queryParams:{fromDate:t.fromDate,toDate:t.toDate,parentView:this.getViewName,page:this.page?.pageIndex??1}})}globalFunctionActions(t){t.viewName==U.S.plan_adjustment_upload&&this.openUploadDialog()}openUploadDialog(){this.dialogsService.uploadDownloadDialog({uploadPath:$.Z.upload_plan_adjustment_transaction,downloadPath:$.Z.download_plan_adjustment_transaction,name:"plan-adjustment"},{}).afterClosed().subscribe(a=>{})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-plan-adjustment-index"]],features:[e.qOj],decls:4,vars:8,consts:[[1,"title-no-margin","title-section","fixed-title"],["title","plan-adjustment","parentTitle","attendanceTracker","TitleHasGlobalFunc","",3,"globalFunctions","action"],[1,"index-card"],[3,"isLoaded","dataSource","mandatoryColomns","optionalColomns","actions","page","showPaginator","onChangePage","deleteRow","editRow"]],template:function(t,a){1&t&&(e.TgZ(0,"mat-card-title",0)(1,"page-title",1),e.NdJ("action",function(r){return a.globalFunctionActions(r)}),e.qZA()(),e.TgZ(2,"mat-card",2)(3,"app-material-table",3),e.NdJ("onChangePage",function(r){return a.getList(r.pageIndex+1,r.pageSize)})("deleteRow",function(r){return a.onDelete(r)})("editRow",function(r){return a.goToEdit(r)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("globalFunctions",a.globalFunctions),e.xp6(2),e.Q6J("isLoaded",a.isLoaded)("dataSource",a.dataSource)("mandatoryColomns",a.mandatoryColomns)("optionalColomns",a.optionalColomns)("actions",a.rowFunctions)("page",a.page)("showPaginator",!0))},dependencies:[te.I,p.T,oe.X,m.a8,m.n5]}),n})();const Pi=[{path:"plan-adjustment",data:{view:U.S.plan_adjustment},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Ai,data:{view:U.S.plan_adjustment_index},canActivate:[F.r]},{path:"add",component:N,data:{view:U.S.plan_adjustment_add},canActivate:[F.r]},{path:"edit/:empId/:planId",component:N,data:{view:U.S.plan_adjustment_add},canActivate:[F.r]}]},{path:"vacation-transaction",data:{view:U.S.vacation_transaction},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Te,data:{view:U.S.vacation_transaction_index},canActivate:[F.r]},{path:"add",component:He,data:{view:U.S.add_vacation_transaction},canActivate:[F.r]},{path:"edit/:empId/:vacationId",component:He,data:{view:U.S.add_vacation_transaction},canActivate:[F.r]}]},{path:"overtime-transaction",data:{view:U.S.overtime_transaction},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Ci,data:{view:U.S.overtime_transaction_index},canActivate:[F.r]},{path:"add",component:Ve,data:{view:U.S.add_overtime_transaction},canActivate:[F.r]},{path:"edit/:id",component:Ve,data:{view:U.S.add_overtime_transaction},canActivate:[F.r]}]},{path:"mission-transaction",data:{view:U.S.att_mission_transaction},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Dt,data:{view:U.S.att_mission_transaction_index},canActivate:[F.r]},{path:"add",component:Be,data:{view:U.S.att_mission_transaction_add},canActivate:[F.r]},{path:"edit/:id",component:Be,data:{view:U.S.att_mission_transaction_add},canActivate:[F.r]}]},{path:"penalty-transaction",data:{view:U.S.penalty_transaction},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:bi,data:{view:U.S.penalty_transaction_index},canActivate:[F.r]},{path:"add",component:We,data:{view:U.S.add_penalty_transaction},canActivate:[F.r]},{path:"edit/:id",component:We,data:{view:U.S.add_penalty_transaction},canActivate:[F.r]}]},{path:"fingerprints",data:{view:U.S.fingerprints},children:[{path:"",redirectTo:"home",pathMatch:K.U.full},{path:"home",component:Ra,data:{view:U.S.fingerprints_home},canActivate:[F.r]},{path:"register-fingerprint",data:{view:U.S.register_fingerprint},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Ti,data:{view:U.S.register_fingerprint_index},canActivate:[F.r]},{path:"add",component:et,data:{view:U.S.add_register_fingerprint},canActivate:[F.r]},{path:"edit/:empId/:checkInTime",component:et,data:{view:U.S.add_register_fingerprint},canActivate:[F.r]}]},{path:"load-fingerprint",data:{view:U.S.load_fingerprint},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Va,data:{view:U.S.load_fingerprint_index},canActivate:[F.r]},{path:"upload",component:Ga,data:{view:U.S.upload_fingerprint},canActivate:[F.r]}]}]},{path:"permission-transaction",data:{view:U.S.permission_transaction},children:[{path:"",redirectTo:"index",pathMatch:K.U.full},{path:"index",component:Ii,data:{view:U.S.permission_transaction_index},canActivate:[F.r]},{path:"add",component:$e,data:{view:U.S.add_permission_transaction},canActivate:[F.r]},{path:"edit/:id",component:$e,data:{view:U.S.add_permission_transaction},canActivate:[F.r]}]},{path:"daily-operation",component:mn,data:{view:U.S.daily_operation},canActivate:[F.r]},{path:"reports",data:{view:U.S.attendance_rep},children:[{path:"",redirectTo:"attendance_card",pathMatch:K.U.full},{path:"attendance_card",component:Pn,data:{view:U.S.attendance_card_rep},canActivate:[F.r]},{path:"missions-card",component:qn,data:{view:U.S.missions_card_report},canActivate:[F.r]},{path:"missions-details",component:$n,data:{view:U.S.missions_details_report},canActivate:[F.r]},{path:"permission-details",component:ri,data:{view:U.S.permission_details_report},canActivate:[F.r]},{path:"sign-sheet",component:vi,data:{view:U.S.sign_in_out_sheet_report},canActivate:[F.r]}]}];let wi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[ne.Bz.forChild(Pi),ne.Bz]}),n})(),Si=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Q.ez,wi,Y.m]}),n})()},79395:(ge,re,S)=>{"use strict";S.d(re,{P:()=>K});var Q=S(18521),Y=S(591),ne=S(94650);let K=(()=>{class U extends Q.K{constructor(){super(),this.policyGroupDetails$=new Y.X(null)}getPolicyDetails(s){return this.get("OrgManagement/PolicyGroup/GetPolicyGroupDetails",{params:{PolicyGroupId:s}})}getPolicyDetailsByDate(s,v){return this.get("OrgManagement/PolicyGroup/GetPolicyGroupDetailsByDate",{params:{PolicyGroupId:s,date:v}})}SavePolicyDetailsPermissions(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsPermissions",s)}SavePolicyDetailsVacations(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsVacations",s)}SavePolicyDetailsOfficialHolidays(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsOfficialHolidaies",s)}SavePolicyDetailsPenalty(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsPenalty",s)}SavePolicyDetailsPlans(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsPlans",s)}SavePolicyDetailsPayments(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsPayments",s)}SavePolicyDetailsTemplate(s){return this.post("OrgManagement/PolicyGroup/SavePolicyGroupDetailsRequestesTemplate",s)}}return U.\u0275fac=function(s){return new(s||U)},U.\u0275prov=ne.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})()},3710:(ge,re,S)=>{"use strict";S.d(re,{r:()=>U});var Q=S(94650),Y=S(67579),ne=S(24280),K=S(80458);let U=(()=>{class F{constructor(v,M){this.viewsService=v,this.router=M,this.loadingService=(0,Q.f3M)(Y.b),this.UserModules=this.viewsService.UserModules$.getValue(),this.loading=document.getElementById("page-loading")}canActivate(v,M){let d=v.data?.view;if(this.showLoading(),this.UserModules?.length>0){if(this.viewsService.isViewAllowed(d))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}else this.viewsService.UserModules$.subscribe(T=>{if(T?.length>0){if(this.viewsService.isViewAllowed(d))return this.hideLoading(),!0;this.router.navigateByUrl("/auth/access-denied"),this.hideLoading()}})}showLoading(){this.loading.style.display="block",this.loading.style.opacity="1",this.loading.style.zIndex="998"}hideLoading(){this.loading.style.display="none",this.loading.style.opacity="0",this.loading.style.zIndex="0"}}return F.\u0275fac=function(v){return new(v||F)(Q.LFG(ne.Z),Q.LFG(K.F0))},F.\u0275prov=Q.Yz7({token:F,factory:F.\u0275fac,providedIn:"root"}),F})()},29341:(ge,re,S)=>{"use strict";S.d(re,{Z:()=>Q});let Q=(()=>{class Y{}return Y.upload_kpi="UploadKPI/Upload",Y.download_kpi="UploadKPI/Download",Y.upload_Org="UploadOrg/Upload",Y.download_Org="UploadOrg/Download",Y.upload_job_profile="OrgManagement/UploadJobTitle/Upload",Y.download_job_profile="OrgManagement/UploadJobTitle/Download",Y.upload_org_structure="OrgManagement/UploadOrgStructure/Upload",Y.download_org_structure="OrgManagement/UploadOrgStructure/Download",Y.upload_org_kpi="OrgManagement/UploadOrgKpi/Upload",Y.download_org_kpi="OrgManagement/UploadOrgKpi/Download",Y.upload_mission="TimeAttendance/UploadMissionTrans/Upload",Y.download_mission="TimeAttendance/UploadMissionTrans/Download",Y.upload_register_fingerprint="TimeAttendance/UploadRegisterFinger/Upload",Y.download_register_fingerprint="TimeAttendance/UploadRegisterFinger/Download",Y.upload_Overtime_transaction="TimeAttendance/UploadOvertime/Upload",Y.download_Overtime_transaction="TimeAttendance/UploadOvertime/Download",Y.upload_penalty_transaction="TimeAttendance/UploadPenalityTrans/Upload",Y.download_penalty_transaction="TimeAttendance/UploadPenalityTrans/Download",Y.upload_permission_transaction="TimeAttendance/UploadPermission/Upload",Y.download_permission_transaction="TimeAttendance/UploadPermission/Download",Y.upload_vacation_transaction="TimeAttendance/UploadVacation/Upload",Y.download_vacation_transaction="TimeAttendance/UploadVacation/Download",Y.upload_plan_adjustment_transaction="TimeAttendance/UploadExceptionPlan/Upload",Y.download_plan_adjustment_transaction="TimeAttendance/UploadExceptionPlan/Download",Y.upload_employees="personnel/UploadEmployee/Upload",Y.download_employees="personnel/UploadEmployee/Download",Y})()},58350:(ge,re,S)=>{"use strict";S.d(re,{$:()=>Y});var Q=S(94650);let Y=(()=>{class ne{constructor(){}static groupBy(U,F,s="key",v="List"){const M=U.reduce((d,T)=>(d[T[F]]?d[T[F]].push(T):d[T[F]]=[T],d),{});return Object.keys(M).map(d=>({[s]:d,[v]:M[d]}))}groupByPartOfProperty(U,F,s,v="key",M="List"){const d=U.reduce((T,x)=>{let e=x[F].trim().slice(0,s).toUpperCase();return T[e]?T[e].push(x):T[e]=[x],T},{});return Object.keys(d).map(T=>({[v]:T,[M]:d[T]}))}}return ne.\u0275fac=function(U){return new(U||ne)},ne.\u0275prov=Q.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})()},12983:function(ge,re,S){var Q;typeof globalThis<"u"?globalThis:typeof this<"u"||(typeof window<"u"?window:typeof self<"u"?self:global),ge.exports=(Q=function(){try{return S(53583)}catch{}}(),function(){"use strict";var Y={172:function(F,s){var T,v=this&&this.__extends||(T=function(x,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,w){L.__proto__=w}||function(L,w){for(var b in w)Object.prototype.hasOwnProperty.call(w,b)&&(L[b]=w[b])})(x,e)},function(x,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function L(){this.constructor=x}T(x,e),x.prototype=null===e?Object.create(e):(L.prototype=e.prototype,new L)});Object.defineProperty(s,"__esModule",{value:!0}),s.CellHookData=s.HookData=void 0;var M=function T(x,e,L){this.table=e,this.pageNumber=e.pageNumber,this.pageCount=this.pageNumber,this.settings=e.settings,this.cursor=L,this.doc=x.getDocument()};s.HookData=M;var d=function(T){function x(e,L,w,b,g,l){var c=T.call(this,e,L,l)||this;return c.cell=w,c.row=b,c.column=g,c.section=b.section,c}return v(x,T),x}(M);s.CellHookData=d},340:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0});var M=v(4),d=v(136),T=v(744),x=v(776),e=v(664),L=v(972);s.default=function w(b){b.API.autoTable=function(){for(var g=[],l=0;l<arguments.length;l++)g[l]=arguments[l];var c;1===g.length?c=g[0]:(console.error("Use of deprecated autoTable initiation"),(c=g[2]||{}).columns=g[0],c.body=g[1]);var h=(0,x.parseInput)(this,c),f=(0,L.createTable)(this,h);return(0,e.drawTable)(this,f),this},b.API.lastAutoTable=!1,b.API.previousAutoTable=!1,b.API.autoTable.previous=!1,b.API.autoTableText=function(g,l,c,h){(0,d.default)(g,l,c,h,this)},b.API.autoTableSetDefaults=function(g){return T.DocHandler.setDefaults(g,this),this},b.autoTableSetDefaults=function(g,l){T.DocHandler.setDefaults(g,l)},b.API.autoTableHtmlToJson=function(g,l){var c;if(void 0===l&&(l=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var h=new T.DocHandler(this),f=(0,M.parseHtml)(h,g,window,l,!1),y=f.body;return{columns:(null===(c=f.head[0])||void 0===c?void 0:c.map(function(m){return m.content}))||[],rows:y,data:y}},b.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var g=this.lastAutoTable;return g&&g.finalY?g.finalY:0},b.API.autoTableAddPageContent=function(g){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),b.API.autoTable.globalDefaults||(b.API.autoTable.globalDefaults={}),b.API.autoTable.globalDefaults.addPageContent=g,this},b.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}},136:function(F,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=function v(M,d,T,x,e){x=x||{};var w=e.internal.scaleFactor,b=e.internal.getFontSize()/w,l=b*(e.getLineHeightFactor?e.getLineHeightFactor():1.15),h="",f=1;if(("middle"===x.valign||"bottom"===x.valign||"center"===x.halign||"right"===x.halign)&&(f=(h="string"==typeof M?M.split(/\r\n|\r|\n/g):M).length||1),T+=b*(2-1.15),"middle"===x.valign?T-=f/2*l:"bottom"===x.valign&&(T-=f*l),"center"===x.halign||"right"===x.halign){var p=b;if("center"===x.halign&&(p*=.5),h&&f>=1){for(var y=0;y<h.length;y++)e.text(h[y],d-e.getStringUnitWidth(h[y])*p,T),T+=l;return e}d-=e.getStringUnitWidth(M)*p}return"justify"===x.halign?e.text(M,d,T,{maxWidth:x.maxWidth||100,align:"justify"}):e.text(M,d,T),e}},420:function(F,s){function d(e,L){var w=e>0,b=L||0===L;return w&&b?"DF":w?"S":b?"F":null}function T(e,L){var w,b,g,l;if(e=e||L,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:L}return"object"==typeof e?("number"==typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"==typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(w=e.left)&&void 0!==w?w:L,top:null!==(b=e.top)&&void 0!==b?b:L,right:null!==(g=e.right)&&void 0!==g?g:L,bottom:null!==(l=e.bottom)&&void 0!==l?l:L}):("number"!=typeof e&&(e=L),{top:e,right:e,bottom:e,left:e})}Object.defineProperty(s,"__esModule",{value:!0}),s.getPageAvailableWidth=s.parseSpacing=s.getFillStyle=s.addTableBorder=s.getStringWidth=void 0,s.getStringWidth=function v(e,L,w){return w.applyStyles(L,!0),(Array.isArray(e)?e:[e]).map(function(l){return w.getTextWidth(l)}).reduce(function(l,c){return Math.max(l,c)},0)},s.addTableBorder=function M(e,L,w,b){var g=L.settings.tableLineWidth;e.applyStyles({lineWidth:g,lineColor:L.settings.tableLineColor});var c=d(g,!1);c&&e.rect(w.x,w.y,L.getWidth(e.pageSize().width),b.y-w.y,c)},s.getFillStyle=d,s.parseSpacing=T,s.getPageAvailableWidth=function x(e,L){var w=T(L.settings.margin,0);return e.pageSize().width-(w.left+w.right)}},796:function(F,s){var x,v=this&&this.__extends||(x=function(e,L){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,b){w.__proto__=b}||function(w,b){for(var g in b)Object.prototype.hasOwnProperty.call(b,g)&&(w[g]=b[g])})(e,L)},function(e,L){if("function"!=typeof L&&null!==L)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function w(){this.constructor=e}x(e,L),e.prototype=null===L?Object.create(L):(w.prototype=L.prototype,new w)});Object.defineProperty(s,"__esModule",{value:!0}),s.getTheme=s.defaultStyles=s.HtmlRowInput=void 0;var M=function(x){function e(L){var w=x.call(this)||this;return w._element=L,w}return v(e,x),e}(Array);s.HtmlRowInput=M,s.defaultStyles=function d(x){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/x,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}},s.getTheme=function T(x){return{striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[x]}},903:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.parseCss=void 0;var M=v(420);function x(w,b){var g=e(w,b);if(!g)return null;var l=g.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!l||!Array.isArray(l))return null;var c=[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])];return 0===parseInt(l[4])||isNaN(c[0])||isNaN(c[1])||isNaN(c[2])?null:c}function e(w,b){var g=b(w);return"rgba(0, 0, 0, 0)"===g||"transparent"===g||"initial"===g||"inherit"===g?null==w.parentElement?null:e(w.parentElement,b):g}s.parseCss=function d(w,b,g,l,c){var h={},f=1.3333333333333333,p=x(b,function(A){return c.getComputedStyle(A).backgroundColor});null!=p&&(h.fillColor=p);var y=x(b,function(A){return c.getComputedStyle(A).color});null!=y&&(h.textColor=y);var P=function L(w,b){var g=[w.paddingTop,w.paddingRight,w.paddingBottom,w.paddingLeft],l=96/(72/b),c=(parseInt(w.lineHeight)-parseInt(w.fontSize))/b/2,h=g.map(function(p){return parseInt(p||"0")/l}),f=(0,M.parseSpacing)(h,0);return c>f.top&&(f.top=c),c>f.bottom&&(f.bottom=c),f}(l,g);P&&(h.cellPadding=P);var m="borderTopColor",D=f*g,_=l.borderTopWidth;if(l.borderBottomWidth===_&&l.borderRightWidth===_&&l.borderLeftWidth===_){var R=(parseFloat(_)||0)/D;R&&(h.lineWidth=R)}else h.lineWidth={top:(parseFloat(l.borderTopWidth)||0)/D,right:(parseFloat(l.borderRightWidth)||0)/D,bottom:(parseFloat(l.borderBottomWidth)||0)/D,left:(parseFloat(l.borderLeftWidth)||0)/D},h.lineWidth.top||(h.lineWidth.right?m="borderRightColor":h.lineWidth.bottom?m="borderBottomColor":h.lineWidth.left&&(m="borderLeftColor"));var q=x(b,function(A){return c.getComputedStyle(A)[m]});null!=q&&(h.lineColor=q);var G=["left","right","center","justify"];-1!==G.indexOf(l.textAlign)&&(h.halign=l.textAlign),-1!==(G=["middle","bottom","top"]).indexOf(l.verticalAlign)&&(h.valign=l.verticalAlign);var C=parseInt(l.fontSize||"");isNaN(C)||(h.fontSize=C/f);var u=function T(w){var b="";return("bold"===w.fontWeight||"bolder"===w.fontWeight||parseInt(w.fontWeight)>=700)&&(b="bold"),("italic"===w.fontStyle||"oblique"===w.fontStyle)&&(b+="italic"),b}(l);u&&(h.fontStyle=u);var O=(l.fontFamily||"").toLowerCase();return-1!==w.indexOf(O)&&(h.font=O),h}},744:function(F,s){Object.defineProperty(s,"__esModule",{value:!0}),s.DocHandler=void 0;var v={},M=function(){function d(T){this.jsPDFDocument=T,this.userStyles={textColor:T.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:T.internal.getFontSize(),fontStyle:T.internal.getFont().fontStyle,font:T.internal.getFont().fontName,lineWidth:T.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:T.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return d.setDefaults=function(T,x){void 0===x&&(x=null),x?x.__autoTableDocumentDefaults=T:v=T},d.unifyColor=function(T){return Array.isArray(T)?T:"number"==typeof T?[T,T,T]:"string"==typeof T?[T]:null},d.prototype.applyStyles=function(T,x){var e,L,w;void 0===x&&(x=!1),T.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(T.fontStyle);var b=this.jsPDFDocument.internal.getFont(),g=b.fontStyle,l=b.fontName;if(T.font&&(l=T.font),T.fontStyle){g=T.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(g)&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(c[0]),g=c[0])}if(this.jsPDFDocument.setFont(l,g),T.fontSize&&this.jsPDFDocument.setFontSize(T.fontSize),!x){var h=d.unifyColor(T.fillColor);h&&(e=this.jsPDFDocument).setFillColor.apply(e,h),(h=d.unifyColor(T.textColor))&&(L=this.jsPDFDocument).setTextColor.apply(L,h),(h=d.unifyColor(T.lineColor))&&(w=this.jsPDFDocument).setDrawColor.apply(w,h),"number"==typeof T.lineWidth&&this.jsPDFDocument.setLineWidth(T.lineWidth)}},d.prototype.splitTextToSize=function(T,x,e){return this.jsPDFDocument.splitTextToSize(T,x,e)},d.prototype.rect=function(T,x,e,L,w){return this.jsPDFDocument.rect(T,x,e,L,w)},d.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},d.prototype.getTextWidth=function(T){return this.jsPDFDocument.getTextWidth(T)},d.prototype.getDocument=function(){return this.jsPDFDocument},d.prototype.setPage=function(T){this.jsPDFDocument.setPage(T)},d.prototype.addPage=function(){return this.jsPDFDocument.addPage()},d.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},d.prototype.getGlobalOptions=function(){return v||{}},d.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},d.prototype.pageSize=function(){var T=this.jsPDFDocument.internal.pageSize;return null==T.width&&(T={width:T.getWidth(),height:T.getHeight()}),T},d.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},d.prototype.getLineHeightFactor=function(){var T=this.jsPDFDocument;return T.getLineHeightFactor?T.getLineHeightFactor():1.15},d.prototype.getLineHeight=function(T){return T/this.scaleFactor()*this.getLineHeightFactor()},d.prototype.pageNumber=function(){var T=this.jsPDFDocument.internal.getCurrentPageInfo();return T?T.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},d}();s.DocHandler=M},4:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.parseHtml=void 0;var M=v(903),d=v(796);function x(L,w,b,g,l,c){for(var h=new d.HtmlRowInput(g),f=0;f<g.cells.length;f++){var p=g.cells[f],y=b.getComputedStyle(p);if(l||"none"!==y.display){var P=void 0;c&&(P=(0,M.parseCss)(L,p,w,y,b)),h.push({rowSpan:p.rowSpan,colSpan:p.colSpan,styles:P,_element:p,content:e(p)})}}var m=b.getComputedStyle(g);if(h.length>0&&(l||"none"!==m.display))return h}function e(L){var w=L.cloneNode(!0);return w.innerHTML=w.innerHTML.replace(/\n/g,"").replace(/ +/g," "),w.innerHTML=w.innerHTML.split(/<br.*?>/).map(function(b){return b.trim()}).join("\n"),w.innerText||w.textContent||""}s.parseHtml=function T(L,w,b,g,l){var c,h,f;void 0===g&&(g=!1),void 0===l&&(l=!1),f="string"==typeof w?b.document.querySelector(w):w;var p=Object.keys(L.getFontList()),y=L.scaleFactor(),P=[],m=[],D=[];if(!f)return console.error("Html table could not be found with input: ",w),{head:P,body:m,foot:D};for(var _=0;_<f.rows.length;_++){var R=f.rows[_],q=null===(h=null===(c=R?.parentElement)||void 0===c?void 0:c.tagName)||void 0===h?void 0:h.toLowerCase(),G=x(p,y,b,R,g,l);!G||("thead"===q?P.push(G):"tfoot"===q?D.push(G):m.push(G))}return{head:P,body:m,foot:D}}},776:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.parseInput=void 0;var M=v(4),d=v(356),T=v(420),x=v(744),e=v(792);function h(f,p,y){var P=f[0]||p[0]||y[0]||[],m=[];return Object.keys(P).filter(function(D){return"_element"!==D}).forEach(function(D){var R,_=1;"object"==typeof(R=Array.isArray(P)?P[parseInt(D)]:P[D])&&!Array.isArray(R)&&(_=R?.colSpan||1);for(var q=0;q<_;q++){var G;G=Array.isArray(P)?m.length:D+(q>0?"_".concat(q):""),m.push({dataKey:G})}}),m}s.parseInput=function L(f,p){var y=new x.DocHandler(f),P=y.getDocumentOptions(),m=y.getGlobalOptions();(0,e.default)(y,m,P,p);var _,D=(0,d.assign)({},m,P,p);typeof window<"u"&&(_=window);var R=function w(f,p,y){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},m=function(q){if("columnStyles"===q)P.columnStyles=(0,d.assign)({},f[q],p[q],y[q]);else{var A=[f,p,y].map(function(E){return E[q]||{}});P[q]=(0,d.assign)({},A[0],A[1],A[2])}},D=0,_=Object.keys(P);D<_.length;D++)m(_[D]);return P}(m,P,p),q=function b(f,p,y){for(var m={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},D=0,_=[f,p,y];D<_.length;D++){var R=_[D];R.didParseCell&&m.didParseCell.push(R.didParseCell),R.willDrawCell&&m.willDrawCell.push(R.willDrawCell),R.didDrawCell&&m.didDrawCell.push(R.didDrawCell),R.willDrawPage&&m.willDrawPage.push(R.willDrawPage),R.didDrawPage&&m.didDrawPage.push(R.didDrawPage)}return m}(m,P,p),G=function g(f,p){var y,P,m,D,_,R,q,G,C,u,O,A,Z,J,E=(0,T.parseSpacing)(p.margin,40/f.scaleFactor()),N=null!==(y=function l(f,p){var y=f.getLastAutoTable(),P=f.scaleFactor(),m=f.pageNumber(),D=!1;return y&&y.startPageNumber&&(D=y.startPageNumber+y.pageNumber-1===m),"number"==typeof p?p:null!=p&&!1!==p||!D||null==y?.finalY?null:y.finalY+20/P}(f,p.startY))&&void 0!==y?y:E.top;Z=!0===p.showFoot?"everyPage":!1===p.showFoot?"never":null!==(P=p.showFoot)&&void 0!==P?P:"everyPage",J=!0===p.showHead?"everyPage":!1===p.showHead?"never":null!==(m=p.showHead)&&void 0!==m?m:"everyPage";var B=null!==(D=p.useCss)&&void 0!==D&&D,$=null!==(_=p.horizontalPageBreakRepeat)&&void 0!==_?_:null;return{includeHiddenHtml:null!==(R=p.includeHiddenHtml)&&void 0!==R&&R,useCss:B,theme:p.theme||(B?"plain":"striped"),startY:N,margin:E,pageBreak:null!==(q=p.pageBreak)&&void 0!==q?q:"auto",rowPageBreak:null!==(G=p.rowPageBreak)&&void 0!==G?G:"auto",tableWidth:null!==(C=p.tableWidth)&&void 0!==C?C:"auto",showHead:J,showFoot:Z,tableLineWidth:null!==(u=p.tableLineWidth)&&void 0!==u?u:0,tableLineColor:null!==(O=p.tableLineColor)&&void 0!==O?O:200,horizontalPageBreak:!!p.horizontalPageBreak,horizontalPageBreakRepeat:$,horizontalPageBreakBehaviour:null!==(A=p.horizontalPageBreakBehaviour)&&void 0!==A?A:"afterAllRows"}}(y,D),C=function c(f,p,y){var P=p.head||[],m=p.body||[],D=p.foot||[];if(p.html)if(y){var R=(0,M.parseHtml)(f,p.html,y,p.includeHiddenHtml,p.useCss)||{};P=R.head||P,m=R.body||P,D=R.foot||P}else console.error("Cannot parse html in non browser environment");return{columns:p.columns||h(P,m,D),head:P,body:m,foot:D}}(y,D,_);return{id:p.tableId,content:C,hooks:q,styles:R,settings:G}}},792:function(F,s){function M(d){d.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),d.minCellHeight||(d.minCellHeight=d.rowHeight)):d.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),d.cellWidth||(d.cellWidth=d.columnWidth))}Object.defineProperty(s,"__esModule",{value:!0}),s.default=function v(d,T,x,e){for(var L=function(l){l&&"object"!=typeof l&&console.error("The options parameter should be of type object, is: "+typeof l),typeof l.extendWidth<"u"&&(l.tableWidth=l.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof l.margins<"u"&&(typeof l.margin>"u"&&(l.margin=l.margins),console.error("Use of deprecated option: margins, use margin instead.")),l.startY&&"number"!=typeof l.startY&&(console.error("Invalid value for startY option",l.startY),delete l.startY),!l.didDrawPage&&(l.afterPageContent||l.beforePageContent||l.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),l.didDrawPage=function(D){d.applyStyles(d.userStyles),l.beforePageContent&&l.beforePageContent(D),d.applyStyles(d.userStyles),l.afterPageContent&&l.afterPageContent(D),d.applyStyles(d.userStyles),l.afterPageAdd&&D.pageNumber>1&&D.afterPageAdd(D),d.applyStyles(d.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(D){l[D]&&console.error('The "'.concat(D,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(D){var _=D[0],R=D[1];l[R]&&(console.error("Use of deprecated option ".concat(R,". Use ").concat(_," instead")),l[_]=l[R])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(D){var _="string"==typeof D?D:D[0],R="string"==typeof D?D:D[1];typeof l[_]<"u"&&(typeof l.styles[R]>"u"&&(l.styles[R]=l[_]),console.error("Use of deprecated option: "+_+", use the style "+R+" instead."))});for(var c=0,h=["styles","bodyStyles","headStyles","footStyles"];c<h.length;c++)M(l[h[c]]||{});for(var p=l.columnStyles||{},y=0,P=Object.keys(p);y<P.length;y++)M(p[P[y]]||{})},w=0,b=[T,x,e];w<b.length;w++)L(b[w])}},260:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.Column=s.Cell=s.Row=s.Table=void 0;var M=v(796),d=v(172),T=v(420),x=function(){function b(g,l){this.pageNumber=1,this.pageCount=1,this.id=g.id,this.settings=g.settings,this.styles=g.styles,this.hooks=g.hooks,this.columns=l.columns,this.head=l.head,this.body=l.body,this.foot=l.foot}return b.prototype.getHeadHeight=function(g){return this.head.reduce(function(l,c){return l+c.getMaxCellHeight(g)},0)},b.prototype.getFootHeight=function(g){return this.foot.reduce(function(l,c){return l+c.getMaxCellHeight(g)},0)},b.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},b.prototype.callCellHooks=function(g,l,c,h,f,p){for(var y=0,P=l;y<P.length;y++){var _=!1===(0,P[y])(new d.CellHookData(g,this,c,h,f,p));if(c.text=Array.isArray(c.text)?c.text:[c.text],_)return!1}return!0},b.prototype.callEndPageHooks=function(g,l){g.applyStyles(g.userStyles);for(var c=0,h=this.hooks.didDrawPage;c<h.length;c++)(0,h[c])(new d.HookData(g,this,l))},b.prototype.callWillDrawPageHooks=function(g,l){for(var c=0,h=this.hooks.willDrawPage;c<h.length;c++)(0,h[c])(new d.HookData(g,this,l))},b.prototype.getWidth=function(g){if("number"==typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(h,f){return h+f.wrappedWidth},0);var c=this.settings.margin;return g-c.left-c.right},b}();s.Table=x;var e=function(){function b(g,l,c,h,f){void 0===f&&(f=!1),this.height=0,this.raw=g,g instanceof M.HtmlRowInput&&(this.raw=g._element,this.element=g._element),this.index=l,this.section=c,this.cells=h,this.spansMultiplePages=f}return b.prototype.getMaxCellHeight=function(g){var l=this;return g.reduce(function(c,h){var f;return Math.max(c,(null===(f=l.cells[h.index])||void 0===f?void 0:f.height)||0)},0)},b.prototype.hasRowSpan=function(g){var l=this;return g.filter(function(c){var h=l.cells[c.index];return!!h&&h.rowSpan>1}).length>0},b.prototype.canEntireRowFit=function(g,l){return this.getMaxCellHeight(l)<=g},b.prototype.getMinimumRowHeight=function(g,l){var c=this;return g.reduce(function(h,f){var p=c.cells[f.index];if(!p)return 0;var y=l.getLineHeight(p.styles.fontSize),m=p.padding("vertical")+y;return m>h?m:h},0)},b}();s.Row=e;var L=function(){function b(g,l,c){var h,f;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=l,this.section=c,this.raw=g;var p=g;null==g||"object"!=typeof g||Array.isArray(g)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=g.rowSpan||1,this.colSpan=g.colSpan||1,p=null!==(f=null!==(h=g.content)&&void 0!==h?h:g.title)&&void 0!==f?f:g,g._element&&(this.raw=g._element)),this.text=(null!=p?""+p:"").split(/\r\n|\r|\n/g)}return b.prototype.getTextPos=function(){var g,c;if("top"===this.styles.valign)g=this.y+this.padding("top");else if("bottom"===this.styles.valign)g=this.y+this.height-this.padding("bottom");else{var l=this.height-this.padding("vertical");g=this.y+l/2+this.padding("top")}if("right"===this.styles.halign)c=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var h=this.width-this.padding("horizontal");c=this.x+h/2+this.padding("left")}else c=this.x+this.padding("left");return{x:c,y:g}},b.prototype.getContentHeight=function(g,l){void 0===l&&(l=1.15);var f=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/g*l)+this.padding("vertical");return Math.max(f,this.styles.minCellHeight)},b.prototype.padding=function(g){var l=(0,T.parseSpacing)(this.styles.cellPadding,0);return"vertical"===g?l.top+l.bottom:"horizontal"===g?l.left+l.right:l[g]},b}();s.Cell=L;var w=function(){function b(g,l,c){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=g,this.raw=l,this.index=c}return b.prototype.getMaxCustomCellWidth=function(g){for(var l=0,c=0,h=g.allRows();c<h.length;c++){var p=h[c].cells[this.index];p&&"number"==typeof p.styles.cellWidth&&(l=Math.max(l,p.styles.cellWidth))}return l},b}();s.Column=w},356:function(F,s){Object.defineProperty(s,"__esModule",{value:!0}),s.assign=void 0,s.assign=function v(M,d,T,x,e){if(null==M)throw new TypeError("Cannot convert undefined or null to object");for(var L=Object(M),w=1;w<arguments.length;w++){var b=arguments[w];if(null!=b)for(var g in b)Object.prototype.hasOwnProperty.call(b,g)&&(L[g]=b[g])}return L}},972:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.createTable=void 0;var M=v(744),d=v(260),T=v(324),x=v(796),e=v(356);function b(f,p,y,P,m,D){var _={};return p.map(function(q,G){for(var C=0,u={},O=0,A=0,E=0,N=y;E<N.length;E++){var Z=N[E];if(null==_[Z.index]||0===_[Z.index].left)if(0===A){var J,B={};"object"==typeof(J=Array.isArray(q)?q[Z.index-O-C]:q[Z.dataKey])&&!Array.isArray(J)&&(B=J?.styles||{});var j=h(f,Z,G,m,P,D,B),k=new d.Cell(J,j,f);u[Z.dataKey]=k,u[Z.index]=k,_[Z.index]={left:k.rowSpan-1,times:A=k.colSpan-1}}else A--,O++;else _[Z.index].left--,A=_[Z.index].times,C++}return new d.Row(q,G,f,u)})}function g(f,p){var y={};return f.forEach(function(P){if(null!=P.raw){var m=function l(f,p){if("head"===f){if("object"==typeof p)return p.header||p.title||null;if("string"==typeof p||"number"==typeof p)return p}else if("foot"===f&&"object"==typeof p)return p.footer;return null}(p,P.raw);null!=m&&(y[P.dataKey]=m)}}),Object.keys(y).length>0?y:null}function h(f,p,y,P,m,D,_){var q,R=(0,x.getTheme)(P);"head"===f?q=m.headStyles:"body"===f?q=m.bodyStyles:"foot"===f&&(q=m.footStyles);var G=(0,e.assign)({},R.table,R[f],m.styles,q),u="body"===f&&(m.columnStyles[p.dataKey]||m.columnStyles[p.index])||{},O="body"===f&&y%2==0?(0,e.assign)({},R.alternateRow,m.alternateRowStyles):{},A=(0,x.defaultStyles)(D),E=(0,e.assign)({},A,G,O,u);return(0,e.assign)(E,_)}s.createTable=function L(f,p){var y=new M.DocHandler(f),P=function w(f,p){var m,y=f.content,P=function c(f){return f.map(function(p,y){var P,m,D;return D="object"==typeof p&&null!==(m=null!==(P=p.dataKey)&&void 0!==P?P:p.key)&&void 0!==m?m:y,new d.Column(D,p,y)})}(y.columns);0===y.head.length&&(m=g(P,"head"))&&y.head.push(m),0===y.foot.length&&(m=g(P,"foot"))&&y.foot.push(m);var D=f.settings.theme,_=f.styles;return{columns:P,head:b("head",y.head,P,_,D,p),body:b("body",y.body,P,_,D,p),foot:b("foot",y.foot,P,_,D,p)}}(p,y.scaleFactor()),m=new d.Table(p,P);return(0,T.calculateWidths)(y,m),y.applyStyles(y.userStyles),m}},664:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.addPage=s.drawTable=void 0;var M=v(420),d=v(260),T=v(744),x=v(356),e=v(136),L=v(224);function g(C,u,O,A){var E=u.settings;C.applyStyles(C.userStyles),("firstPage"===E.showHead||"everyPage"===E.showHead)&&u.head.forEach(function(N){return m(C,u,N,O,A)})}function c(C,u,O,A,E,N){C.applyStyles(C.userStyles),N=N??u.body.length;var Z=Math.min(O+N,u.body.length),J=-1;return u.body.slice(O,Z).forEach(function(B,j){var $=R(C,u,O+j===u.body.length-1,A);B.canEntireRowFit($,E)&&(m(C,u,B,A,E),J=O+j)}),J}function h(C,u,O,A){var E=u.settings;C.applyStyles(C.userStyles),("lastPage"===E.showFoot||"everyPage"===E.showFoot)&&u.foot.forEach(function(N){return m(C,u,N,O,A)})}function f(C,u,O){var A=O.getLineHeight(C.styles.fontSize),E=C.padding("vertical"),N=Math.floor((u-E)/A);return Math.max(0,N)}function P(C,u,O,A,E,N,Z){var J=R(C,u,A,N);if(O.canEntireRowFit(J,Z))m(C,u,O,N,Z);else if(function y(C,u,O,A){var E=C.pageSize().height,N=A.settings.margin,J=E-(N.top+N.bottom);"body"===u.section&&(J-=A.getHeadHeight(A.columns)+A.getFootHeight(A.columns));var B=u.getMinimumRowHeight(A.columns,C),j=B<O;if(B>J)return console.error("Will not be able to print row ".concat(u.index," correctly since it's minimum height is larger than page height")),!0;if(!j)return!1;var k=u.hasRowSpan(A.columns);return u.getMaxCellHeight(A.columns)>J?(k&&console.error("The content of row ".concat(u.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(k||"avoid"===A.settings.rowPageBreak)}(C,O,J,u)){var B=function p(C,u,O,A){var E={};C.spansMultiplePages=!0,C.height=0;for(var N=0,Z=0,J=O.columns;Z<J.length;Z++)if(j=C.cells[(B=J[Z]).index]){Array.isArray(j.text)||(j.text=[j.text]);var k=new d.Cell(j.raw,j.styles,j.section);(k=(0,x.assign)(k,j)).text=[];var $=f(j,u,A);j.text.length>$&&(k.text=j.text.splice($,j.text.length));var ae=A.scaleFactor(),te=A.getLineHeightFactor();j.contentHeight=j.getContentHeight(ae,te),j.contentHeight>=u&&(j.contentHeight=u,k.styles.minCellHeight-=u),j.contentHeight>C.height&&(C.height=j.contentHeight),k.contentHeight=k.getContentHeight(ae,te),k.contentHeight>N&&(N=k.contentHeight),E[B.index]=k}var oe=new d.Row(C.raw,-1,C.section,E,!0);oe.height=N;for(var Te=0,Ce=O.columns;Te<Ce.length;Te++){var B,j;(k=oe.cells[(B=Ce[Te]).index])&&(k.height=oe.height),(j=C.cells[B.index])&&(j.height=C.height)}return oe}(O,J,u,C);m(C,u,O,N,Z),q(C,u,E,N,Z),P(C,u,B,A,E,N,Z)}else q(C,u,E,N,Z),P(C,u,O,A,E,N,Z)}function m(C,u,O,A,E){A.x=u.settings.margin.left;for(var N=0,Z=E;N<Z.length;N++){var J=Z[N],B=O.cells[J.index];if(B)if(C.applyStyles(B.styles),B.x=A.x,B.y=A.y,!1!==u.callCellHooks(C,u.hooks.willDrawCell,B,O,J,A)){D(C,B,A);var k=B.getTextPos();(0,e.default)(B.text,k.x,k.y,{halign:B.styles.halign,valign:B.styles.valign,maxWidth:Math.ceil(B.width-B.padding("left")-B.padding("right"))},C.getDocument()),u.callCellHooks(C,u.hooks.didDrawCell,B,O,J,A),A.x+=J.width}else A.x+=J.width;else A.x+=J.width}A.y+=O.height}function D(C,u,O){var A=u.styles;if(C.getDocument().setFillColor(C.getDocument().getFillColor()),"number"==typeof A.lineWidth){var E=(0,M.getFillStyle)(A.lineWidth,A.fillColor);E&&C.rect(u.x,O.y,u.width,u.height,E)}else"object"==typeof A.lineWidth&&(A.fillColor&&C.rect(u.x,O.y,u.width,u.height,"F"),function _(C,u,O,A){var E,N,Z,J;function B(j,k,$,ae,te){C.getDocument().setLineWidth(j),C.getDocument().line(k,$,ae,te,"S")}A.top&&(E=O.x,Z=O.x+u.width,A.right&&(Z+=.5*A.right),A.left&&(E-=.5*A.left),B(A.top,E,N=O.y,Z,J=O.y)),A.bottom&&(E=O.x,Z=O.x+u.width,A.right&&(Z+=.5*A.right),A.left&&(E-=.5*A.left),B(A.bottom,E,N=O.y+u.height,Z,J=O.y+u.height)),A.left&&(N=O.y,J=O.y+u.height,A.top&&(N-=.5*A.top),A.bottom&&(J+=.5*A.bottom),B(A.left,E=O.x,N,Z=O.x,J)),A.right&&(N=O.y,J=O.y+u.height,A.top&&(N-=.5*A.top),A.bottom&&(J+=.5*A.bottom),B(A.right,E=O.x+u.width,N,Z=O.x+u.width,J))}(C,u,O,A.lineWidth))}function R(C,u,O,A){var E=u.settings.margin.bottom,N=u.settings.showFoot;return("everyPage"===N||"lastPage"===N&&O)&&(E+=u.getFootHeight(u.columns)),C.pageSize().height-A.y-E}function q(C,u,O,A,E,N){void 0===E&&(E=[]),void 0===N&&(N=!1),C.applyStyles(C.userStyles),"everyPage"===u.settings.showFoot&&!N&&u.foot.forEach(function(J){return m(C,u,J,A,E)}),u.callEndPageHooks(C,A);var Z=u.settings.margin;(0,M.addTableBorder)(C,u,O,A),G(C),u.pageNumber++,u.pageCount++,A.x=Z.left,A.y=Z.top,O.y=Z.top,u.callWillDrawPageHooks(C,A),"everyPage"===u.settings.showHead&&(u.head.forEach(function(J){return m(C,u,J,A,E)}),C.applyStyles(C.userStyles))}function G(C){var u=C.pageNumber();return C.setPage(u+1),C.pageNumber()===u&&(C.addPage(),!0)}s.drawTable=function w(C,u){var O=u.settings,A=O.startY,E=O.margin,N={x:E.left,y:A},Z=u.getHeadHeight(u.columns)+u.getFootHeight(u.columns),J=A+E.bottom+Z;"avoid"===O.pageBreak&&(J+=u.body.reduce(function(ae,te){return ae+te.height},0));var k=new T.DocHandler(C);("always"===O.pageBreak||null!=O.startY&&J>k.pageSize().height)&&(G(k),N.y=E.top),u.callWillDrawPageHooks(k,N);var $=(0,x.assign)({},N);u.startPageNumber=k.pageNumber(),O.horizontalPageBreak?function b(C,u,O,A){var E=(0,L.calculateAllColumnsCanFitInPage)(C,u);if("afterAllRows"===u.settings.horizontalPageBreakBehaviour)E.forEach(function(j,k){C.applyStyles(C.userStyles),k>0?q(C,u,O,A,j.columns,!0):g(C,u,A,j.columns),function l(C,u,O,A,E){C.applyStyles(C.userStyles),u.body.forEach(function(N,Z){P(C,u,N,Z===u.body.length-1,O,A,E)})}(C,u,O,A,j.columns),h(C,u,A,j.columns)});else for(var Z=-1,J=E[0],B=function(){var j=Z;if(J){C.applyStyles(C.userStyles);var k=J.columns;Z>=0?q(C,u,O,A,k,!0):g(C,u,A,k),j=c(C,u,Z+1,A,k),h(C,u,A,k)}var $=j-Z;E.slice(1).forEach(function(ae){C.applyStyles(C.userStyles),q(C,u,O,A,ae.columns,!0),c(C,u,Z+1,A,ae.columns,$),h(C,u,A,ae.columns)}),Z=j};Z<u.body.length-1;)B()}(k,u,$,N):(k.applyStyles(k.userStyles),("firstPage"===O.showHead||"everyPage"===O.showHead)&&u.head.forEach(function(ae){return m(k,u,ae,N,u.columns)}),k.applyStyles(k.userStyles),u.body.forEach(function(ae,te){P(k,u,ae,te===u.body.length-1,$,N,u.columns)}),k.applyStyles(k.userStyles),("lastPage"===O.showFoot||"everyPage"===O.showFoot)&&u.foot.forEach(function(ae){return m(k,u,ae,N,u.columns)})),(0,M.addTableBorder)(k,u,$,N),u.callEndPageHooks(k,N),u.finalY=N.y,C.lastAutoTable=u,C.previousAutoTable=u,C.autoTable&&(C.autoTable.previous=u),k.applyStyles(k.userStyles)},s.addPage=q},224:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.calculateAllColumnsCanFitInPage=void 0;var M=v(420);function d(x,e,L){var w;void 0===L&&(L={});var b=(0,M.getPageAvailableWidth)(x,e),g=new Map,l=[],c=[],h=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?h=e.settings.horizontalPageBreakRepeat:("string"==typeof e.settings.horizontalPageBreakRepeat||"number"==typeof e.settings.horizontalPageBreakRepeat)&&(h=[e.settings.horizontalPageBreakRepeat]),h.forEach(function(P){var m=e.columns.find(function(D){return D.dataKey===P||D.index===P});m&&!g.has(m.index)&&(g.set(m.index,!0),l.push(m.index),c.push(e.columns[m.index]),b-=m.wrappedWidth)});for(var f=!0,p=null!==(w=L?.start)&&void 0!==w?w:0;p<e.columns.length;)if(g.has(p))p++;else{var y=e.columns[p].wrappedWidth;if(!(f||b>=y))break;f=!1,l.push(p),c.push(e.columns[p]),b-=y,p++}return{colIndexes:l,columns:c,lastIndex:p-1}}s.calculateAllColumnsCanFitInPage=function T(x,e){for(var L=[],w=0;w<e.columns.length;w++){var b=d(x,e,{start:w});b.columns.length&&(L.push(b),w=b.lastIndex)}return L}},324:function(F,s,v){Object.defineProperty(s,"__esModule",{value:!0}),s.ellipsize=s.resizeColumns=s.calculateWidths=void 0;var M=v(420);function x(l,c,h){for(var f=c,p=l.reduce(function(C,u){return C+u.wrappedWidth},0),y=0;y<l.length;y++){var P=l[y],_=P.width+f*(P.wrappedWidth/p),R=h(P),q=_<R?R:_;c-=q-P.width,P.width=q}if(c=Math.round(1e10*c)/1e10){var G=l.filter(function(C){return!(c<0)||C.width>h(C)});G.length&&(c=x(G,c,h))}return c}function b(l,c,h,f,p){return l.map(function(y){return function g(l,c,h,f,p){var y=1e4*f.scaleFactor();if((c=Math.ceil(c*y)/y)>=(0,M.getStringWidth)(l,h,f))return l;for(;c<(0,M.getStringWidth)(l+p,h,f)&&!(l.length<=1);)l=l.substring(0,l.length-1);return l.trim()+p}(y,c,h,f,p)})}s.calculateWidths=function d(l,c){!function T(l,c){var h=l.scaleFactor(),f=c.settings.horizontalPageBreak,p=(0,M.getPageAvailableWidth)(l,c);c.allRows().forEach(function(y){for(var P=0,m=c.columns;P<m.length;P++){var D=m[P],_=y.cells[D.index];if(_){c.callCellHooks(l,c.hooks.didParseCell,_,y,D,null);var q=_.padding("horizontal");_.contentWidth=(0,M.getStringWidth)(_.text,_.styles,l)+q;var G=(0,M.getStringWidth)(_.text.join(" ").split(/[^\S\u00A0]+/),_.styles,l);_.minReadableWidth=G+_.padding("horizontal"),"number"==typeof _.styles.cellWidth?(_.minWidth=_.styles.cellWidth,_.wrappedWidth=_.styles.cellWidth):"wrap"===_.styles.cellWidth||!0===f?_.contentWidth>p?(_.minWidth=p,_.wrappedWidth=p):(_.minWidth=_.contentWidth,_.wrappedWidth=_.contentWidth):(_.minWidth=_.styles.minCellWidth||10/h,_.wrappedWidth=_.contentWidth,_.minWidth>_.wrappedWidth&&(_.wrappedWidth=_.minWidth))}}}),c.allRows().forEach(function(y){for(var P=0,m=c.columns;P<m.length;P++){var D=m[P],_=y.cells[D.index];if(_&&1===_.colSpan)D.wrappedWidth=Math.max(D.wrappedWidth,_.wrappedWidth),D.minWidth=Math.max(D.minWidth,_.minWidth),D.minReadableWidth=Math.max(D.minReadableWidth,_.minReadableWidth);else{var R=c.styles.columnStyles[D.dataKey]||c.styles.columnStyles[D.index]||{},q=R.cellWidth||R.minCellWidth;q&&"number"==typeof q&&(D.minWidth=q,D.wrappedWidth=q)}_&&(_.colSpan>1&&!D.minWidth&&(D.minWidth=_.minWidth),_.colSpan>1&&!D.wrappedWidth&&(D.wrappedWidth=_.minWidth))}})}(l,c);var h=[],f=0;c.columns.forEach(function(y){var P=y.getMaxCustomCellWidth(c);P?y.width=P:(y.width=y.wrappedWidth,h.push(y)),f+=y.width});var p=c.getWidth(l.pageSize().width)-f;p&&(p=x(h,p,function(y){return Math.max(y.minReadableWidth,y.minWidth)})),p&&(p=x(h,p,function(y){return y.minWidth})),p=Math.abs(p),!c.settings.horizontalPageBreak&&p>.1/l.scaleFactor()&&(p=p<1?p:Math.round(p),console.warn("Of the table content, ".concat(p," units width could not fit page"))),function L(l){for(var c=l.allRows(),h=0;h<c.length;h++)for(var f=c[h],p=null,y=0,P=0,m=0;m<l.columns.length;m++){var D=l.columns[m];if((P-=1)>1&&l.columns[m+1])y+=D.width,delete f.cells[D.index];else if(p){var _=p;delete f.cells[D.index],p=null,_.width=D.width+y}else{if(!(_=f.cells[D.index]))continue;if(P=_.colSpan,y=0,_.colSpan>1){p=_,y+=D.width;continue}_.width=D.width+y}}}(c),function w(l,c){for(var h={count:0,height:0},f=0,p=l.allRows();f<p.length;f++){for(var y=p[f],P=0,m=l.columns;P<m.length;P++){var _=y.cells[m[P].index];if(_){c.applyStyles(_.styles,!0);var R=_.width-_.padding("horizontal");if("linebreak"===_.styles.overflow)_.text=c.splitTextToSize(_.text,R+1/c.scaleFactor(),{fontSize:_.styles.fontSize});else if("ellipsize"===_.styles.overflow)_.text=b(_.text,R,_.styles,c,"...");else if("hidden"===_.styles.overflow)_.text=b(_.text,R,_.styles,c,"");else if("function"==typeof _.styles.overflow){var q=_.styles.overflow(_.text,R);_.text="string"==typeof q?[q]:q}_.contentHeight=_.getContentHeight(c.scaleFactor(),c.getLineHeightFactor());var G=_.contentHeight/_.rowSpan;_.rowSpan>1&&h.count*h.height<G*_.rowSpan?h={height:G,count:_.rowSpan}:h&&h.count>0&&h.height>G&&(G=h.height),G>y.height&&(y.height=G)}}h.count--}}(c,l),function e(l){for(var c={},h=1,f=l.allRows(),p=0;p<f.length;p++)for(var y=f[p],P=0,m=l.columns;P<m.length;P++){var D=m[P],_=c[D.index];if(h>1)h--,delete y.cells[D.index];else if(_)_.cell.height+=y.height,h=_.cell.colSpan,delete y.cells[D.index],_.left--,_.left<=1&&delete c[D.index];else{var R=y.cells[D.index];if(!R)continue;if(R.height=y.height,R.rowSpan>1){var q=f.length-p;c[D.index]={cell:R,left:R.rowSpan>q?q:R.rowSpan,row:y}}}}}(c)},s.resizeColumns=x,s.ellipsize=b},964:function(F){if(typeof Q>"u"){var s=new Error("Cannot find module 'undefined'");throw s.code="MODULE_NOT_FOUND",s}F.exports=Q}},ne={};function K(F){var s=ne[F];if(void 0!==s)return s.exports;var v=ne[F]={exports:{}};return Y[F].call(v.exports,v,v.exports,K),v.exports}var U={};return function(){var F=U;Object.defineProperty(F,"__esModule",{value:!0}),F.Cell=F.Column=F.Row=F.Table=F.CellHookData=F.__drawTable=F.__createTable=F.applyPlugin=void 0;var s=K(340),v=K(776),M=K(664),d=K(972),T=K(260);Object.defineProperty(F,"Table",{enumerable:!0,get:function(){return T.Table}});var x=K(172);Object.defineProperty(F,"CellHookData",{enumerable:!0,get:function(){return x.CellHookData}});var e=K(260);function L(c){(0,s.default)(c)}Object.defineProperty(F,"Cell",{enumerable:!0,get:function(){return e.Cell}}),Object.defineProperty(F,"Column",{enumerable:!0,get:function(){return e.Column}}),Object.defineProperty(F,"Row",{enumerable:!0,get:function(){return e.Row}}),F.applyPlugin=L,F.__createTable=function b(c,h){var f=(0,v.parseInput)(c,h);return(0,d.createTable)(c,f)},F.__drawTable=function g(c,h){(0,M.drawTable)(c,h)};try{var l=K(964);l.jsPDF&&(l=l.jsPDF),L(l)}catch{}F.default=function w(c,h){var f=(0,v.parseInput)(c,h),p=(0,d.createTable)(c,f);(0,M.drawTable)(c,p)}}(),U}())}}]);